---
title: 887. é¸¡è›‹æ‰è½

date: 2020-05-28 00:12:12

categories: 2020å¹´5æœˆ

tags: [LeetCode,Math,Binary Search,Dynamic Programming]

---

ç¡®å®šä¸æ‘”ç¢é¸¡è›‹çš„ä¸´ç•Œæ¥¼å±‚çš„æœ€å°ç§»åŠ¨æ¬¡æ•°

<!-- more -->

# ğŸ“–é¢˜ç›®æè¿°ï¼š
ä½ å°†è·å¾—Â KÂ ä¸ªé¸¡è›‹ï¼Œå¹¶å¯ä»¥ä½¿ç”¨ä¸€æ ‹ä»Â 1Â åˆ°Â NÂ Â å…±æœ‰ NÂ å±‚æ¥¼çš„å»ºç­‘ã€‚

æ¯ä¸ªè›‹çš„åŠŸèƒ½éƒ½æ˜¯ä¸€æ ·çš„ï¼Œå¦‚æœä¸€ä¸ªè›‹ç¢äº†ï¼Œä½ å°±ä¸èƒ½å†æŠŠå®ƒæ‰ä¸‹å»ã€‚

ä½ çŸ¥é“å­˜åœ¨æ¥¼å±‚Â F ï¼Œæ»¡è¶³Â 0 <= F <= N ä»»ä½•ä»é«˜äº FÂ çš„æ¥¼å±‚è½ä¸‹çš„é¸¡è›‹éƒ½ä¼šç¢ï¼Œä»Â FÂ æ¥¼å±‚æˆ–æ¯”å®ƒä½çš„æ¥¼å±‚è½ä¸‹çš„é¸¡è›‹éƒ½ä¸ä¼šç ´ã€‚

æ¯æ¬¡ç§»åŠ¨ï¼Œä½ å¯ä»¥å–ä¸€ä¸ªé¸¡è›‹ï¼ˆå¦‚æœä½ æœ‰å®Œæ•´çš„é¸¡è›‹ï¼‰å¹¶æŠŠå®ƒä»ä»»ä¸€æ¥¼å±‚Â XÂ æ‰”ä¸‹ï¼ˆæ»¡è¶³Â 1 <= X <= Nï¼‰ã€‚

ä½ çš„ç›®æ ‡æ˜¯ç¡®åˆ‡åœ°çŸ¥é“ F çš„å€¼æ˜¯å¤šå°‘ã€‚

æ— è®º F çš„åˆå§‹å€¼å¦‚ä½•ï¼Œä½ ç¡®å®š F çš„å€¼çš„æœ€å°ç§»åŠ¨æ¬¡æ•°æ˜¯å¤šå°‘ï¼Ÿ

Â 

ç¤ºä¾‹ 1ï¼š

    è¾“å…¥ï¼šK = 1, N = 2
    è¾“å‡ºï¼š2
    è§£é‡Šï¼š
    é¸¡è›‹ä» 1 æ¥¼æ‰è½ã€‚å¦‚æœå®ƒç¢äº†ï¼Œæˆ‘ä»¬è‚¯å®šçŸ¥é“ F = 0 ã€‚
    å¦åˆ™ï¼Œé¸¡è›‹ä» 2 æ¥¼æ‰è½ã€‚å¦‚æœå®ƒç¢äº†ï¼Œæˆ‘ä»¬è‚¯å®šçŸ¥é“ F = 1 ã€‚
    å¦‚æœå®ƒæ²¡ç¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬è‚¯å®šçŸ¥é“ F = 2 ã€‚
    å› æ­¤ï¼Œåœ¨æœ€åçš„æƒ…å†µä¸‹æˆ‘ä»¬éœ€è¦ç§»åŠ¨ 2 æ¬¡ä»¥ç¡®å®š F æ˜¯å¤šå°‘ã€‚
ç¤ºä¾‹ 2ï¼š
    
    è¾“å…¥ï¼šK = 2, N = 6
    è¾“å‡ºï¼š3
ç¤ºä¾‹ 3ï¼š
    
    è¾“å…¥ï¼šK = 3, N = 14
    è¾“å‡ºï¼š4

æç¤ºï¼š
    
    1 <= K <= 100
    1 <= N <= 10000
# ğŸ“–æ–‡å­—é¢˜è§£

æœ¬é¢˜æ˜¯è°·æ­Œçš„ä¸€é“ç»å…¸é¢è¯•é¢˜ã€‚ç”±äºæœ¬é¢˜è¿‡äºç»å…¸ï¼Œè°·æ­Œå…¬å¸å·²ç»ä¸å†å°†è¿™é¢˜ä½œä¸ºé¢è¯•çš„å€™é€‰é¢˜ç›®äº†ã€‚

æœ¬é¢˜éš¾åº¦è¾ƒé«˜ï¼Œè¦æƒ³é€šè¿‡æœ¬é¢˜ï¼Œéœ€è¦ä¸€å®šçš„åŠ¨æ€è§„åˆ’ä¼˜åŒ–æˆ–æ•°å­¦åŠŸåº•ã€‚æœ¬é¢˜çš„æ ‡å‡†è§£æ³•ä¸ºåŠ¨æ€è§„åˆ’ï¼Œç”±äºç¯‡å¹…æœ‰é™ï¼Œä¸ä¼šå™è¿° **åŠ¨æ€è§„åˆ’çš„è¾¹ç•Œæ¡ä»¶**ã€**è‡ªåº•å‘ä¸Šçš„åŠ¨æ€è§„åˆ’å’Œè‡ªé¡¶å‘ä¸‹çš„åŠ¨æ€è§„åˆ’åˆ†åˆ«æ€ä¹ˆå®ç°** ç­‰è¾ƒä¸ºåŸºç¡€çš„çŸ¥è¯†ï¼Œè€Œæ˜¯æŠŠé‡ç‚¹æ”¾åœ¨æ¨å¯¼åŠ¨æ€è§„åˆ’çŠ¶æ€è½¬ç§»æ–¹ç¨‹çš„è¿‡ç¨‹ï¼Œä»¥åŠä¼˜åŒ–çš„æ€è·¯ã€è¯æ˜ä»¥åŠæ–¹æ³•ã€‚

è¯»è€…åº”å½“æœŸæœ›åœ¨é˜…è¯»å®Œæœ¬é¢˜è§£åï¼Œèƒ½å¤Ÿå¯¹æ–¹æ³•ä¸€æœ‰ä¸€ä¸ªå¤§è‡´çš„æ€è·¯ï¼Œå¹¶ä¸”å¯ä»¥åœ¨å°è¯•ä¸­ç¼–å†™å‡ºä»£ç ã€‚æ–¹æ³•ä¸€å·²ç»æ˜¯å¾ˆä¼˜ç§€çš„è§£æ³•ï¼Œæœ¬é¢˜è§£ä¹Ÿç€é‡äºæ­¤ã€‚è€Œå¯¹äºæ–¹æ³•äºŒå’Œæ–¹æ³•ä¸‰ï¼Œå·²ç»è¶…è¿‡äº†é¢è¯•éš¾åº¦ï¼Œæ˜¯ç«èµ›ä¸­çš„è€ƒç‚¹ï¼Œä»…ä¾›è¯»è€…æŒ‘æˆ˜è‡ªæˆ‘çš„æé™ã€‚

## æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’ + äºŒåˆ†æœç´¢

**æ€è·¯å’Œç®—æ³•**

æˆ‘ä»¬å¯ä»¥è€ƒè™‘ä½¿ç”¨åŠ¨æ€è§„åˆ’æ¥åšè¿™é“é¢˜ï¼ŒçŠ¶æ€å¯ä»¥è¡¨ç¤ºæˆ *(K, N)*ï¼Œå…¶ä¸­ *K* ä¸ºé¸¡è›‹æ•°ï¼Œ*N* ä¸ºæ¥¼å±‚æ•°ã€‚å½“æˆ‘ä»¬ä»ç¬¬ *X* æ¥¼æ‰”é¸¡è›‹çš„æ—¶å€™ï¼š

- å¦‚æœé¸¡è›‹ä¸ç¢ï¼Œé‚£ä¹ˆçŠ¶æ€å˜æˆ *(K, N-X)*ï¼Œå³æˆ‘ä»¬é¸¡è›‹çš„æ•°ç›®ä¸å˜ï¼Œä½†ç­”æ¡ˆåªå¯èƒ½åœ¨ä¸Šæ–¹çš„ *N-X* å±‚æ¥¼äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æŠŠåŸé—®é¢˜ç¼©å°æˆäº†ä¸€ä¸ªè§„æ¨¡ä¸º *(K, N-X)* çš„å­é—®é¢˜ï¼›

- å¦‚æœé¸¡è›‹ç¢äº†ï¼Œé‚£ä¹ˆçŠ¶æ€å˜æˆ *(K-1, X-1)*ï¼Œå³æˆ‘ä»¬å°‘äº†ä¸€ä¸ªé¸¡è›‹ï¼Œä½†æˆ‘ä»¬çŸ¥é“ç­”æ¡ˆåªå¯èƒ½åœ¨ç¬¬ *X* æ¥¼ä¸‹æ–¹çš„ *X-1* å±‚æ¥¼ä¸­äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬æŠŠåŸé—®é¢˜ç¼©å°æˆäº†ä¸€ä¸ªè§„æ¨¡ä¸º *(K-1, X-1)* çš„å­é—®é¢˜ã€‚

è¿™æ ·ä¸€æ¥ï¼Œæˆ‘ä»¬å®šä¹‰ *dp(K, N)* ä¸ºåœ¨çŠ¶æ€ *(K, N)* ä¸‹æœ€å°‘éœ€è¦çš„æ­¥æ•°ã€‚æ ¹æ®ä»¥ä¸Šåˆ†ææˆ‘ä»¬å¯ä»¥åˆ—å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š

![dp(K,N)=1+\min\limits_{1\leqX\leqN}\Big(\max(dp(K-1,X-1),dp(K,N-X))\Big) ](./p___dp_K,_N__=_1_+_minlimits_{1_leq_X_leq_N}_Big__max_dp_K-1,_X-1_,_dp_K,_N-X___Big___.png) 

è¿™ä¸ªçŠ¶æ€è½¬ç§»æ–¹ç¨‹æ˜¯å¦‚ä½•å¾—æ¥çš„å‘¢ï¼Ÿå¯¹äº *dp(K, N)* è€Œè¨€ï¼Œæˆ‘ä»¬åƒä¸Šé¢åˆ†æçš„é‚£æ ·ï¼Œæšä¸¾ç¬¬ä¸€ä¸ªé¸¡è›‹æ‰”åœ¨çš„æ¥¼å±‚æ•° *X*ã€‚ç”±äºæˆ‘ä»¬å¹¶ä¸çŸ¥é“çœŸæ­£çš„ *F* å€¼ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»ä¿è¯ **é¸¡è›‹ç¢äº†ä¹‹åæ¥ä¸‹æ¥éœ€è¦çš„æ­¥æ•°** å’Œ **é¸¡è›‹æ²¡ç¢ä¹‹åæ¥ä¸‹æ¥éœ€è¦çš„æ­¥æ•°** äºŒè€…çš„ **æœ€å¤§å€¼** æœ€å°ï¼Œè¿™æ ·å°±ä¿è¯äº†åœ¨ **æœ€åæƒ…å†µä¸‹ï¼ˆä¹Ÿå°±æ˜¯æ— è®º *F* çš„å€¼å¦‚ä½•ï¼‰** *dp(K, N)* çš„å€¼æœ€å°ã€‚å¦‚æœèƒ½ç†è§£è¿™ä¸€ç‚¹ï¼Œä¹Ÿå°±èƒ½ç†è§£ä¸Šé¢çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼Œå³æœ€å°åŒ– ![\max(dp(K-1,X-1),dp(K,N-X)) ](./p__max_dp_K-1,_X-1_,_dp_K,_N-X___.png) ã€‚

å¦‚æœæˆ‘ä»¬ç›´æ¥æš´åŠ›è½¬ç§»æ±‚è§£æ¯ä¸ªçŠ¶æ€çš„ *dp* å€¼ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯ä¸º *O(KN^2)*ï¼Œå³ä¸€å…±æœ‰ *O(KN)* ä¸ªçŠ¶æ€ï¼Œå¯¹äºæ¯ä¸ªçŠ¶æ€æšä¸¾æ‰”é¸¡è›‹çš„æ¥¼å±‚ *X*ï¼Œéœ€è¦ *O(N)* çš„æ—¶é—´ã€‚è¿™æ— ç–‘åœ¨å½“å‰æ•°æ®èŒƒå›´ä¸‹æ˜¯ä¼šè¶…å‡ºæ—¶é—´é™åˆ¶çš„ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦æƒ³åŠæ³•ä¼˜åŒ–æšä¸¾çš„æ—¶é—´å¤æ‚åº¦ã€‚

æˆ‘ä»¬è§‚å¯Ÿåˆ° *dp(K, N)* æ˜¯ä¸€ä¸ªå…³äº *N* çš„å•è°ƒé€’å¢å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨é¸¡è›‹æ•° *K* å›ºå®šçš„æƒ…å†µä¸‹ï¼Œæ¥¼å±‚æ•° *N* è¶Šå¤šï¼Œéœ€è¦çš„æ­¥æ•°ä¸€å®šä¸ä¼šå˜å°‘ã€‚åœ¨ä¸Šè¿°çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸­ï¼Œç¬¬ä¸€é¡¹ ![\mathcal{T_1}(X)=dp(K-1,X-1) ](./p__mathcal{T_1}_X__=_dp_K-1,_X-1__.png)  æ˜¯ä¸€ä¸ªéš *X* çš„å¢åŠ è€Œå•è°ƒé€’å¢çš„å‡½æ•°ï¼Œç¬¬äºŒé¡¹ ![\mathcal{T_2}(X)=dp(K,N-X) ](./p__mathcal{T_2}_X__=_dp_K,_N-X__.png)  æ˜¯ä¸€ä¸ªéšç€ *X* çš„å¢åŠ è€Œå•è°ƒé€’å‡çš„å‡½æ•°ã€‚

è¿™å¦‚ä½•å¸®åŠ©æˆ‘ä»¬æ¥ä¼˜åŒ–è¿™ä¸ªé—®é¢˜å‘¢ï¼Ÿå½“ *X* å¢åŠ æ—¶ï¼Œ![\mathcal{T_1}(X) ](./p__mathcal{T_1}_X__.png)  å•è°ƒé€’å¢è€Œ ![\mathcal{T_2}(X) ](./p__mathcal{T_2}_X__.png)  å•è°ƒé€’å‡ï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡åœ¨ä¸€ä¸ªç›´è§’åæ ‡ç³»ä¸­ï¼Œæ¨ªåæ ‡ä¸º *X*ï¼Œçºµåæ ‡ä¸º ![\mathcal{T_1}(X) ](./p__mathcal{T_1}_X__.png)  å’Œ ![\mathcal{T_2}(X) ](./p__mathcal{T_2}_X__.png) ã€‚å½“ä¸€ä¸ªå‡½æ•°å•è°ƒé€’å¢è€Œå¦ä¸€ä¸ªå‡½æ•°å•è°ƒé€’å‡æ—¶ï¼Œæˆ‘ä»¬å¦‚ä½•æ‰¾åˆ°ä¸€ä¸ªä½ç½®ä½¿å¾—å®ƒä»¬çš„æœ€å¤§å€¼æœ€å°å‘¢ï¼Ÿ

 [fig1](https://assets.leetcode-cn.com/solution-static/887_fig1.jpg)

å¦‚ä¸Šå›¾æ‰€ç¤ºï¼Œå¦‚æœè¿™ä¸¤ä¸ªå‡½æ•°éƒ½æ˜¯è¿ç»­å‡½æ•°ï¼Œé‚£ä¹ˆæˆ‘ä»¬åªéœ€è¦æ‰¾å‡ºè¿™ä¸¤ä¸ªå‡½æ•°çš„äº¤ç‚¹ï¼Œåœ¨äº¤ç‚¹å¤„å°±èƒ½ä¿è¯è¿™ä¸¤ä¸ªå‡½æ•°çš„æœ€å¤§å€¼æœ€å°ã€‚ä½†åœ¨æœ¬é¢˜ä¸­ï¼Œ![\mathcal{T_1}(X) ](./p__mathcal{T_1}_X__.png)  å’Œ ![\mathcal{T_2}(X) ](./p__mathcal{T_2}_X__.png)  éƒ½æ˜¯ç¦»æ•£å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ*X* çš„å€¼åªèƒ½å– *1, 2, 3* ç­‰ç­‰ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬éœ€è¦æ‰¾åˆ°æœ€å¤§çš„æ»¡è¶³ ![\mathcal{T_1}(X)<\mathcal{T_2}(X) ](./p__mathcal{T_1}_X____mathcal{T_2}_X__.png)  çš„ *X_0*ï¼Œä»¥åŠæœ€å°çš„æ»¡è¶³ ![\mathcal{T_1}(X)\geq\mathcal{T_2}(X) ](./p__mathcal{T_1}_X__geq_mathcal{T_2}_X__.png)  çš„ *X_1*ï¼Œå¯¹åº”åˆ°ä¸Šå›¾ä¸­ï¼Œå°±æ˜¯ç¦»è¿™ä¸¤ä¸ªå‡½æ•°ï¼ˆæƒ³è±¡ä¸­çš„ï¼‰äº¤ç‚¹å·¦å³ä¸¤ä¾§æœ€è¿‘çš„æ•´æ•°ã€‚

æˆ‘ä»¬åªéœ€è¦æ¯”è¾ƒåœ¨ *X_0* å’Œ *X_1* å¤„ä¸¤ä¸ªå‡½æ•°çš„æœ€å¤§å€¼ï¼Œå–ä¸€ä¸ªæœ€å°çš„ä½œä¸º *X* å³å¯ã€‚åœ¨æ•°å­¦ä¸Šï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜å‡º *X_0* å’Œ *X_1* ç›¸å·® *1*ï¼Œè¿™ä¹Ÿæ˜¯æ¯”è¾ƒæ˜¾ç„¶çš„ï¼Œå› ä¸ºå®ƒä»¬æ­£å¥½å¤¹ä½äº†é‚£ä¸ªæƒ³è±¡ä¸­çš„äº¤ç‚¹ï¼Œå¹¶ä¸”ç›¸è·å°½å¯èƒ½åœ°è¿‘ã€‚å› æ­¤æˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨äºŒåˆ†æŸ¥æ‰¾çš„æ–¹æ³•æ‰¾å‡º *X_0*ï¼Œå†å¾—åˆ° *X_1*ï¼š

- æˆ‘ä»¬åœ¨æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„ *X* ä¸Šè¿›è¡ŒäºŒåˆ†æŸ¥æ‰¾ã€‚å¯¹äºçŠ¶æ€ *(K, N)* è€Œè¨€ï¼Œ*X* å³ä¸º *[1, N]* ä¸­çš„ä»»ä¸€æ•´æ•°ï¼›

- åœ¨äºŒåˆ†æŸ¥æ‰¾çš„è¿‡ç¨‹ä¸­ï¼Œå‡è®¾å½“å‰è¿™ä¸€æ­¥æˆ‘ä»¬æŸ¥æ‰¾åˆ°äº† ![X_\textit{mid} ](./p__X_textit{mid}_.png) ï¼Œå¦‚æœ ![\mathcal{T_1}(X_\textit{mid})>\mathcal{T_2}(X_\textit{mid}) ](./p__mathcal{T_1}_X_textit{mid}____mathcal{T_2}_X_textit{mid}__.png) ï¼Œé‚£ä¹ˆçœŸæ­£çš„ *X_0* ä¸€å®šåœ¨ ![X_\textit{mid} ](./p__X_textit{mid}_.png)  çš„å·¦ä¾§ï¼Œå¦åˆ™çœŸæ­£çš„ *X_0* åœ¨ ![X_\textit{mid} ](./p__X_textit{mid}_.png)  çš„å³ä¾§ã€‚

äºŒåˆ†æŸ¥æ‰¾çš„å†™æ³•å› äººè€Œå¼‚ï¼Œæœ¬è´¨ä¸Šæˆ‘ä»¬å°±æ˜¯éœ€è¦æ‰¾åˆ°æœ€å¤§çš„æ»¡è¶³ ![\mathcal{T_1}(X)<\mathcal{T_2}(X) ](./p__mathcal{T_1}_X____mathcal{T_2}_X__.png)  çš„ *X_0*ï¼Œæ ¹æ® ![X_\textit{mid} ](./p__X_textit{mid}_.png)  è¿›è¡ŒäºŒåˆ†è¾¹ç•Œçš„è°ƒæ•´ã€‚åœ¨å¾—åˆ°äº† *X_0* åï¼Œæˆ‘ä»¬å¯ä»¥çŸ¥é“ *X_1* å³ä¸º *X_0 + 1*ï¼Œæ­¤æ—¶æˆ‘ä»¬åªéœ€è¦æ¯”è¾ƒ ![\max(\mathcal{T_1}(X_0),\mathcal{T_2}(X_0)) ](./p__max_mathcal{T_1}_X_0_,_mathcal{T_2}_X_0___.png)  å’Œ ![\max(\mathcal{T_1}(X_1),\mathcal{T_2}(X_1)) ](./p__max_mathcal{T_1}_X_1_,_mathcal{T_2}_X_1___.png) ï¼Œå–è¾ƒå°çš„é‚£ä¸ªå¯¹åº”çš„ä½ç½®ä½œä¸º *X* å³å¯ã€‚

è¿™æ ·ä¸€æ¥ï¼Œå¯¹äºç»™å®šçš„çŠ¶æ€ *(K, N)*ï¼Œæˆ‘ä»¬åªéœ€è¦ ![O(\logN) ](./p__O_log_N__.png)  çš„æ—¶é—´ï¼Œé€šè¿‡äºŒåˆ†æŸ¥æ‰¾å°±èƒ½å¾—åˆ°æœ€ä¼˜çš„é‚£ä¸ª *X*ï¼Œå› æ­¤æ—¶é—´å¤æ‚åº¦ä» *O(KN^2)* é™ä½è‡³ ![O(KN\logN) ](./p__O_KN_log_N__.png) ï¼Œå¯ä»¥é€šè¿‡æœ¬é¢˜ã€‚

```java [solution1-Java]
class Solution {
    public int superEggDrop(int K, int N) {
        return dp(K, N);
    }

    Map<Integer, Integer> memo = new HashMap();
    public int dp(int K, int N) {
        if (!memo.containsKey(N * 100 + K)) {
            int ans;
            if (N == 0)
                ans = 0;
            else if (K == 1)
                ans = N;
            else {
                int lo = 1, hi = N;
                while (lo + 1 < hi) {
                    int x = (lo + hi) / 2;
                    int t1 = dp(K-1, x-1);
                    int t2 = dp(K, N-x);

                    if (t1 < t2)
                        lo = x;
                    else if (t1 > t2)
                        hi = x;
                    else
                        lo = hi = x;
                }

                ans = 1 + Math.min(Math.max(dp(K-1, lo-1), dp(K, N-lo)),
                                   Math.max(dp(K-1, hi-1), dp(K, N-hi)));
            }

            memo.put(N * 100 + K, ans);
        }

        return memo.get(N * 100 + K);
    }
}
```

```python [solution1-Python3]
class Solution:
    def superEggDrop(self, K: int, N: int) -> int:
        memo = {}
        def dp(k, n):
            if (k, n) not in memo:
                if n == 0:
                    ans = 0
                elif k == 1:
                    ans = n
                else:
                    lo, hi = 1, n
                    # keep a gap of 2 X values to manually check later
                    while lo + 1 < hi:
                        x = (lo + hi) // 2
                        t1 = dp(k-1, x-1)
                        t2 = dp(k, n-x)

                        if t1 < t2:
                            lo = x
                        elif t1 > t2:
                            hi = x
                        else:
                            lo = hi = x

                    ans = 1 + min(max(dp(k-1, x-1), dp(k, n-x))
                                  for x in (lo, hi))

                memo[k, n] = ans
            return memo[k, n]

        return dp(K, N)
```

```C++ [solution1-C++]
class Solution {
    unordered_map<int, int> memo;
    int dp(int K, int N) {
        if (memo.find(N * 100 + K) == memo.end()) {
            int ans;
            if (N == 0) ans = 0;
            else if (K == 1) ans = N;
            else {
                int lo = 1, hi = N;
                while (lo + 1 < hi) {
                    int x = (lo + hi) / 2;
                    int t1 = dp(K-1, x-1);
                    int t2 = dp(K, N-x);

                    if (t1 < t2) lo = x;
                    else if (t1 > t2) hi = x;
                    else lo = hi = x;
                }

                ans = 1 + min(max(dp(K-1, lo-1), dp(K, N-lo)),
                                   max(dp(K-1, hi-1), dp(K, N-hi)));
            }

            memo[N * 100 + K] = ans;
        }

        return memo[N * 100 + K];
    }
public:
    int superEggDrop(int K, int N) {
        return dp(K, N);
    }
};
```

**å¤æ‚åº¦åˆ†æ**

* æ—¶é—´å¤æ‚åº¦ï¼š![O(K*N\logN) ](./p__O_K_*_N_log_N__.png) ã€‚æˆ‘ä»¬éœ€è¦è®¡ç®— *O(K * N)* ä¸ªçŠ¶æ€ï¼Œæ¯ä¸ªçŠ¶æ€è®¡ç®—æ—¶éœ€è¦ ![O(\logN) ](./p__O_log_N__.png)  çš„æ—¶é—´è¿›è¡ŒäºŒåˆ†æœç´¢ã€‚

* ç©ºé—´å¤æ‚åº¦ï¼š*O(K * N)*ã€‚æˆ‘ä»¬éœ€è¦ *O(K * N)* çš„ç©ºé—´å­˜å‚¨æ¯ä¸ªçŠ¶æ€çš„è§£ã€‚

## æ–¹æ³•äºŒï¼šå†³ç­–å•è°ƒæ€§

**è¯´æ˜**

æ–¹æ³•äºŒæ¶‰åŠå†³ç­–å•è°ƒæ€§ï¼Œæ˜¯ç«èµ›ä¸­çš„è€ƒç‚¹ã€‚è¿™é‡Œæˆ‘ä»¬ä¸ä¼šå™è¿° **ä½•ä¸ºå†³ç­–å•è°ƒæ€§** ä»¥åŠ **å¦‚ä½•æ ¹æ®å†³ç­–å•è°ƒæ€§å†™å‡ºä¼˜åŒ–çš„åŠ¨æ€è§„åˆ’**ï¼Œè€Œæ˜¯ä»…æŒ‡å‡ºå†³ç­–å•è°ƒæ€§çš„å­˜åœ¨æ€§ã€‚

**æ€è·¯**

æˆ‘ä»¬é‡æ–°å†™ä¸‹æ–¹æ³•ä¸€ä¸­çš„çŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š

![dp(K,N)=1+\min\limits_{1\leqX\leqN}\Big(\max(dp(K-1,X-1),dp(K,N-X))\Big) ](./p___dp_K,_N__=_1_+_minlimits_{1_leq_X_leq_N}_Big__max_dp_K-1,_X-1_,_dp_K,_N-X___Big___.png) 

å¹¶ä¸”å‡è®¾ ![X_\textit{opt} ](./p__X_textit{opt}_.png)  æ˜¯ä½¿å¾— *dp(K, N)* å–åˆ°æœ€ä¼˜å€¼çš„æœ€å°å†³ç­–ç‚¹ *X_0*ã€‚

![X_\textit{opt}=\arg\min\limits_{1\leqX\leqN}\Big(\max(dp(K-1,X-1),dp(K,N-X))\Big) ](./p___X_textit{opt}_=_arg_minlimits_{1_leq_X_leq_N}_Big__max_dp_K-1,_X-1_,_dp_K,_N-X___Big___.png) 

åœ¨æ–¹æ³•ä¸€ä¸­ï¼Œæˆ‘ä»¬æ˜¯é€šè¿‡äºŒåˆ†æŸ¥æ‰¾çš„æ–¹æ³•ï¼Œæ‰¾åˆ° *X_0* å’Œ *X_1* ä¸­æœ€ä¼˜çš„ä½œä¸º ![X_\textit{opt} ](./p__X_textit{opt}_.png)  çš„ï¼Œé‚£ä¹ˆè¿˜æœ‰ä»€ä¹ˆæ›´å¥½çš„æ–¹æ³•å—ï¼Ÿ

æˆ‘ä»¬å›ºå®š *K*ï¼Œéšç€ *N* çš„å¢åŠ ï¼Œå¯¹äºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸­ *dp(K-1, X-1)* è¿™ä¸€é¡¹ï¼Œå®ƒçš„å€¼æ˜¯ä¸å˜çš„ï¼Œå› ä¸ºå®ƒå’Œ *N* æ— å…³ã€‚è€Œå¯¹äºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ä¸­ *dp(K, N-X)* è¿™ä¸€é¡¹ï¼Œéšç€ *N* çš„å¢åŠ ï¼Œå®ƒçš„å€¼ä¹Ÿä¼šå¢åŠ ã€‚åœ¨æ–¹æ³•ä¸€ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“ *dp(K-1, X-1)* éšç€ *X* å•è°ƒé€’å¢ï¼Œè€Œ *dp(K, N-X)* éšç€ *X* å•è°ƒé€’å‡ï¼Œé‚£ä¹ˆå½“ *N* å¢åŠ æ—¶ï¼Œ*dp(K, N-X)* å¯¹åº”çš„å‡½æ•°æŠ˜çº¿å›¾åœ¨æ¯ä¸ªæ•´æ•°ç‚¹ä¸Šéƒ½æ˜¯å¢åŠ çš„ï¼Œå› æ­¤åœ¨ *dp(K-1, X-1)* ä¸å˜çš„æƒ…å†µä¸‹ï¼Œ![X_\textit{opt} ](./p__X_textit{opt}_.png)  æ˜¯å•è°ƒé€’å¢çš„ã€‚

æˆ‘ä»¬å¯ä»¥æƒ³è±¡ä¸€æ¡æ–œç‡ä¸ºè´Ÿçš„ç›´çº¿å’Œä¸€æ¡æ–œç‡ä¸ºæ­£çš„ç›´çº¿ï¼Œå½“æ–œç‡ä¸ºè´Ÿçš„ç›´çº¿ï¼ˆç±»æ¯” *dp(K, N-X)*ï¼‰å‘ä¸Šå¹³ç§»ï¼ˆç±»æ¯” *N* çš„å¢åŠ ï¼‰æ—¶ï¼Œå®ƒå’Œæ–œç‡ä¸ºæ­£çš„ç›´çº¿ï¼ˆç±»æ¯” *dp(K-1, X-1)*ï¼‰çš„äº¤ç‚¹ä¼šä¸€ç›´å‘å³ç§»åŠ¨ï¼Œè¿™ä¸ªäº¤ç‚¹å°±ç¡®å®šäº† ![X_\textit{opt} ](./p__X_textit{opt}_.png) ï¼Œè¿™ä¸æ–¹æ³•ä¸€ä¹Ÿæ˜¯ä¸€è‡´çš„ã€‚

å› æ­¤å½“æˆ‘ä»¬å›ºå®š *K* æ—¶ï¼Œéšç€ *N* çš„å¢åŠ ï¼Œ*dp(K, N)* å¯¹åº”çš„æœ€ä¼˜è§£çš„åæ ‡ ![X_\textit{opt} ](./p__X_textit{opt}_.png)  å•è°ƒé€’å¢ï¼Œè¿™æ ·ä¸€æ¥æ¯ä¸ª *dp(K, N)* çš„å‡æ‘Šæ—¶é—´å¤æ‚åº¦ä¸º *O(1)*ã€‚

```java [solution2-Java]
class Solution {
    public int superEggDrop(int K, int N) {
        // Right now, dp[i] represents dp(1, i)
        int[] dp = new int[N+1];
        for (int i = 0; i <= N; ++i)
            dp[i] = i;

        for (int k = 2; k <= K; ++k) {
            // Now, we will develop dp2[i] = dp(k, i)
            int[] dp2 = new int[N+1];
            int x = 1;
            for (int n = 1; n <= N; ++n) {
                // Let's find dp2[n] = dp(k, n)
                // Increase our optimal x while we can make our answer better.
                // Notice max(dp[x-1], dp2[n-x]) > max(dp[x], dp2[n-x-1])
                // is simply max(T1(x-1), T2(x-1)) > max(T1(x), T2(x)).
                while (x < n && Math.max(dp[x-1], dp2[n-x]) > Math.max(dp[x], dp2[n-x-1]))
                    x++;

                // The final answer happens at this x.
                dp2[n] = 1 + Math.max(dp[x-1], dp2[n-x]);
            }

            dp = dp2;
        }

        return dp[N];
    }
}
```

```python [solution2-Python3]
class Solution:
    def superEggDrop(self, K: int, N: int) -> int:
        # Right now, dp[i] represents dp(1, i)
        dp = list(range(N+1))
        dp2 = [0] * (N+1)
        for k in range(2, K+1):
            # Now, we will develop dp2[i] = dp(k, i)
            x = 1
            for n in range(1, N+1):
                # Let's find dp2[n] = dp(k, n)
                # Increase our optimal x while we can make our answer better.
                # Notice max(dp[x-1], dp2[n-x]) > max(dp[x], dp2[n-x-1])
                # is simply max(T1(x-1), T2(x-1)) > max(T1(x), T2(x)).
                while x < n and max(dp[x-1], dp2[n-x]) >= max(dp[x], dp2[n-x-1]):
                    x += 1

                # The final answer happens at this x.
                dp2[n] = 1 + max(dp[x-1], dp2[n-x])

            dp = dp2[:]

        return dp[-1]
```

```C++ [solution2-C++]
class Solution {
public:
    int superEggDrop(int K, int N) {
        int dp[N + 1];
        for (int i = 0; i <= N; ++i) dp[i] = i;

        for (int k = 2; k <= K; ++k) {
            int dp2[N + 1];
            int x = 1; 
            dp2[0] = 0;
            for (int n = 1; n <= N; ++n) {
                while (x < n && max(dp[x-1], dp2[n-x]) >= max(dp[x], dp2[n-x-1])) x++;
                dp2[n] = 1 + max(dp[x-1], dp2[n-x]);
            }
            for (int n = 1; n <= N; ++n) dp[n] = dp2[n];
        }
        return dp[N];
    }
};
```

**å¤æ‚åº¦åˆ†æ**

* æ—¶é—´å¤æ‚åº¦ï¼š*O(K * N)*ã€‚æˆ‘ä»¬éœ€è¦è®¡ç®— *O(K * N)* ä¸ªçŠ¶æ€ï¼ŒåŒæ—¶å¯¹äºæ¯ä¸ª *K*ï¼Œæœ€ä¼˜è§£æŒ‡é’ˆåªä¼šä» *0* åˆ° *N* èµ°ä¸€æ¬¡ï¼Œå¤æ‚åº¦ä¹Ÿæ˜¯ *O(K * N)*ã€‚å› æ­¤æ€»ä½“å¤æ‚åº¦ä¸º *O(K * N)*ã€‚

* ç©ºé—´å¤æ‚åº¦ï¼š*O(N)*ã€‚å› ä¸º *dp* æ¯ä¸€å±‚çš„è§£åªä¾èµ–äºä¸Šä¸€å±‚çš„è§£ï¼Œå› æ­¤æˆ‘ä»¬æ¯æ¬¡åªä¿ç•™ä¸€å±‚çš„è§£ï¼Œéœ€è¦çš„ç©ºé—´å¤æ‚åº¦ä¸º *O(N)*ã€‚

## æ–¹æ³•ä¸‰ï¼šæ•°å­¦æ³•

**è¯´æ˜**

æ–¹æ³•ä¸‰æ¶‰åŠé€†å‘æ€ç»´ï¼Œæ˜¯ä¸€ç§æ²¡è§è¿‡å°±ä¸å¤ªå¯èƒ½æƒ³å‡ºæ¥ï¼Œè¯»è¿‡é¢˜è§£ä¹Ÿå¾ˆå®¹æ˜“å¿˜è®°çš„æ–¹æ³•ã€‚

**æ€è·¯**

åè¿‡æ¥æƒ³è¿™ä¸ªé—®é¢˜ï¼šå¦‚æœæˆ‘ä»¬å¯ä»¥åš *T* æ¬¡æ“ä½œï¼Œè€Œä¸”æœ‰ *K* ä¸ªé¸¡è›‹ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½æ‰¾åˆ°ç­”æ¡ˆçš„æœ€é«˜çš„ *N* æ˜¯å¤šå°‘ï¼Ÿæˆ‘ä»¬è®¾ *f(T, K)* ä¸ºåœ¨ä¸Šè¿°æ¡ä»¶ä¸‹çš„ *N*ã€‚å¦‚æœæˆ‘ä»¬æ±‚å‡ºäº†æ‰€æœ‰çš„ *f(T, K)*ï¼Œé‚£ä¹ˆåªéœ€è¦æ‰¾å‡ºæœ€å°çš„æ»¡è¶³ ![f(T,K)\geqN ](./p__f_T,_K__geq_N_.png)  çš„ *T*ã€‚

é‚£ä¹ˆæˆ‘ä»¬å¦‚ä½•æ±‚å‡º *f(T, K)* å‘¢ï¼Ÿæˆ‘ä»¬è¿˜æ˜¯ä½¿ç”¨åŠ¨æ€è§„åˆ’ã€‚å› ä¸ºæˆ‘ä»¬éœ€è¦æ‰¾å‡ºæœ€é«˜çš„ *N*ï¼Œå› æ­¤æˆ‘ä»¬ä¸å¿…æ€è€ƒåˆ°åº•åœ¨å“ªé‡Œæ‰”è¿™ä¸ªé¸¡è›‹ï¼Œæˆ‘ä»¬åªéœ€è¦æ‰”å‡ºä¸€ä¸ªé¸¡è›‹ï¼Œçœ‹çœ‹åˆ°åº•å‘ç”Ÿäº†ä»€ä¹ˆï¼š

- å¦‚æœé¸¡è›‹æ²¡æœ‰ç¢ï¼Œé‚£ä¹ˆå¯¹åº”çš„æ˜¯ *f(T - 1, K)*ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¿™ä¸€å±‚çš„ä¸Šæ–¹å¯ä»¥æœ‰ *f(T - 1, K)* å±‚ï¼›

- å¦‚æœé¸¡è›‹ç¢äº†ï¼Œé‚£ä¹ˆå¯¹åº”çš„æ˜¯ *f(T - 1, K - 1)*ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è¿™ä¸€å±‚çš„ä¸‹æ–¹å¯ä»¥æœ‰ *f(T - 1ï¼Œ K - 1)* å±‚ã€‚

å› æ­¤æˆ‘ä»¬å°±å¯ä»¥å†™å‡ºçŠ¶æ€è½¬ç§»æ–¹ç¨‹ï¼š

*
f(T, K) = 1 + f(T-1, K-1) + f(T-1, K)
*

è¾¹ç•Œæ¡ä»¶ä¸ºï¼šå½“ ![T\geq1 ](./p__T_geq_1_.png)  çš„æ—¶å€™ *f(T, 1) = T*ï¼Œå½“ ![K\geq1 ](./p__K_geq_1_.png)  æ—¶ï¼Œ*f(1, K) = 1*ã€‚

é‚£ä¹ˆé—®é¢˜æ¥äº†ï¼š***T* æœ€å¤§å¯ä»¥è¾¾åˆ°å¤šå°‘**ï¼Ÿç”±äºæˆ‘ä»¬åœ¨è¿›è¡ŒåŠ¨æ€è§„åˆ’æ—¶ï¼Œ*T* åœ¨é¢˜ç›®ä¸­å¹¶æ²¡æœ‰ç»™å‡ºï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦è¿›è¡Œåˆ°åŠ¨æ€è§„åˆ’çš„å“ªä¸€æ­¥å‘¢ï¼Ÿå¯ä»¥å‘ç°ï¼Œæ“ä½œæ¬¡æ•°æ˜¯ä¸€å®šä¸ä¼šè¶…è¿‡æ¥¼å±‚æ•°çš„ï¼Œå› æ­¤ ![T\leqN ](./p__T_leq_N_.png) ï¼Œæˆ‘ä»¬åªè¦ç®—å‡ºåœ¨ *f(N, K)* å†…çš„æ‰€æœ‰ *f* å€¼å³å¯ã€‚

```java [solution3-Java]
class Solution {
    public int superEggDrop(int K, int N) {
        if (N == 1) {
            return 1;
        }
        int[][] f = new int[N + 1][K + 1];
        for (int i = 1; i <= K; ++i) {
            f[1][i] = 1;
        }
        int ans = -1;
        for (int i = 2; i <= N; ++i) {
            for (int j = 1; j <= K; ++j) {
                f[i][j] = 1 + f[i - 1][j - 1] + f[i - 1][j];
            }
            if (f[i][K] >= N) {
                ans = i;
                break;
            }
        }
        return ans;
    }
}
```

```python [solution3-Python3]
class Solution:
    def superEggDrop(self, K: int, N: int) -> int:
        if N == 1:
            return 1
        f = [[0] * (K + 1) for _ in range(N + 1)]
        for i in range(1, K + 1):
            f[1][i] = 1
        ans = -1
        for i in range(2, N + 1):
            for j in range(1, K + 1):
                f[i][j] = 1 + f[i - 1][j - 1] + f[i - 1][j]
            if f[i][K] >= N:
                ans = i
                break
        return ans
```

```C++ [solution3-C++]
class Solution {
public:
    int superEggDrop(int K, int N) {
        if (N == 1) {
            return 1;
        }
        vector<vector<int>> f(N + 1, vector<int>(K + 1));
        for (int i = 1; i <= K; ++i) {
            f[1][i] = 1;
        }
        int ans = -1;
        for (int i = 2; i <= N; ++i) {
            for (int j = 1; j <= K; ++j) {
                f[i][j] = 1 + f[i - 1][j - 1] + f[i - 1][j];
            }
            if (f[i][K] >= N) {
                ans = i;
                break;
            }
        }
        return ans;
    }
};
```

**å¤æ‚åº¦åˆ†æ**

* æ—¶é—´å¤æ‚åº¦ï¼š*O(K*N)*ã€‚äº‹å®ä¸Šï¼Œæ›´å‡†ç¡®çš„æ—¶é—´å¤æ‚åº¦åº”å½“ä¸º *O(K * T)*ï¼Œæˆ‘ä»¬ä¸åŠ è¯æ˜åœ°ç»™å‡º *N = O(T^K)*ï¼Œå› æ­¤æœ‰ ![O(K*T)=O(K*\sqrt\[K\]{N}) ](./p__O_K_*_T__=_O_K_*_sqrt_K_{N}__.png) ã€‚

* ç©ºé—´å¤æ‚åº¦ï¼š*O(K*N)*ã€‚

# å‚è€ƒèµ„æ–™ï¼š
ã€1ã€‘https://leetcode-cn.com/problems/super-egg-drop/solution/ji-dan-diao-luo-by-leetcode-solution-2/
