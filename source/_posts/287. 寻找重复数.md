title: 287. å¯»æ‰¾é‡å¤æ•°

date: 2020-8-25 16:12:12

categories: 2020å¹´8æœˆ

tags: [Leetcode,Array,Two Pointers,Binary Search]

---

ç»™å®šä¸€ä¸ªåŒ…å«Â n + 1 ä¸ªæ•´æ•°çš„æ•°ç»„Â numsï¼Œå…¶æ•°å­—éƒ½åœ¨ 1 åˆ° nÂ ä¹‹é—´ï¼ˆåŒ…æ‹¬ 1 å’Œ nï¼‰ï¼Œå¯çŸ¥è‡³å°‘å­˜åœ¨ä¸€ä¸ªé‡å¤çš„æ•´æ•°ã€‚å‡è®¾åªæœ‰ä¸€ä¸ªé‡å¤çš„æ•´æ•°ï¼Œæ‰¾å‡ºè¿™ä¸ªé‡å¤çš„æ•°ã€‚

<!-- more -->


ç¤ºä¾‹ 1:

    è¾“å…¥: [1,3,4,2,2]
    è¾“å‡º: 2
ç¤ºä¾‹ 2:
    
    è¾“å…¥: [3,1,3,4,2]
    è¾“å‡º: 3
è¯´æ˜ï¼š

    ä¸èƒ½æ›´æ”¹åŸæ•°ç»„ï¼ˆå‡è®¾æ•°ç»„æ˜¯åªè¯»çš„ï¼‰ã€‚
    åªèƒ½ä½¿ç”¨é¢å¤–çš„ O(1) çš„ç©ºé—´ã€‚
    æ—¶é—´å¤æ‚åº¦å°äº O(n2) ã€‚
    æ•°ç»„ä¸­åªæœ‰ä¸€ä¸ªé‡å¤çš„æ•°å­—ï¼Œä½†å®ƒå¯èƒ½ä¸æ­¢é‡å¤å‡ºç°ä¸€æ¬¡ã€‚

# ğŸ“º è§†é¢‘é¢˜è§£  
[287. å¯»æ‰¾é‡å¤æ•°.mp4](95ade126-7621-420e-97fb-4fe2784fad01)

# ğŸ“– æ–‡å­—é¢˜è§£
## æ–¹æ³•ä¸€ï¼šäºŒåˆ†æŸ¥æ‰¾

**æ€è·¯å’Œç®—æ³•**

æˆ‘ä»¬å®šä¹‰ cnt[i] è¡¨ç¤º nums[]  æ•°ç»„ä¸­å°äºç­‰äº *i* çš„æ•°æœ‰å¤šå°‘ä¸ªï¼Œå‡è®¾æˆ‘ä»¬é‡å¤çš„æ•°æ˜¯ target ï¼Œé‚£ä¹ˆ [1,target-1] é‡Œçš„æ‰€æœ‰æ•°æ»¡è¶³ cnt[i] <=iï¼Œ*[target,n]* é‡Œçš„æ‰€æœ‰æ•°æ»¡è¶³ cnt[i] > iï¼Œå…·æœ‰å•è°ƒæ€§ã€‚

ä»¥ç¤ºä¾‹ 1 ä¸ºä¾‹ï¼Œæˆ‘ä»¬åˆ—å‡ºæ¯ä¸ªæ•°å­—çš„ cnt  å€¼ï¼š

nums | 1 | 2 | 3 | 4
:-: | :-: | :-: | :-: | :-:
cnt | 1 | 3 | 4 | 5 

ç¤ºä¾‹ä¸­é‡å¤çš„æ•´æ•°æ˜¯ *2*ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹åˆ° *[1,1]* ä¸­çš„æ•°æ»¡è¶³ cnt[i] <=iï¼Œ*[2,4]* ä¸­çš„æ•°æ»¡è¶³cnt[i] > i ã€‚

å¦‚æœçŸ¥é“  cnt[]  æ•°ç»„éšæ•°å­— *i* é€æ¸å¢å¤§å…·æœ‰å•è°ƒæ€§ï¼ˆå³ target  å‰ cnt[i] <=iï¼Œtarget  å cnt[i] > iï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ç›´æ¥åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾æ¥æ‰¾åˆ°é‡å¤çš„æ•°ã€‚

ä½†è¿™ä¸ªæ€§è´¨ä¸€å®šæ˜¯æ­£ç¡®çš„å—ï¼Ÿè€ƒè™‘ nums[]  æ•°ç»„ä¸€å…±æœ‰ *n+1* ä¸ªä½ç½®ï¼Œæˆ‘ä»¬å¡«å…¥çš„æ•°å­—éƒ½åœ¨ *[1,n]* é—´ï¼Œæœ‰ä¸”åªæœ‰ä¸€ä¸ªæ•°é‡å¤æ”¾äº†ä¸¤æ¬¡ä»¥ä¸Šã€‚å¯¹äºæ‰€æœ‰æµ‹è¯•ç”¨ä¾‹ï¼Œè€ƒè™‘ä»¥ä¸‹ä¸¤ç§æƒ…å†µï¼š

- å¦‚æœæµ‹è¯•ç”¨ä¾‹çš„æ•°ç»„ä¸­target å‡ºç°äº†ä¸¤æ¬¡ï¼Œå…¶ä½™çš„æ•°å„å‡ºç°äº†ä¸€æ¬¡ï¼Œè¿™ä¸ªæ—¶å€™è‚¯å®šæ»¡è¶³ä¸Šæ–‡æåŠçš„æ€§è´¨ï¼Œå› ä¸ºå°äº target çš„æ•° *i* æ»¡è¶³ cnt[i]=i ï¼Œå¤§äºç­‰äº target  çš„æ•° *j* æ»¡è¶³ *cnt[j]=j+1*ã€‚

- å¦‚æœæµ‹è¯•ç”¨ä¾‹çš„æ•°ç»„ä¸­ target å‡ºç°äº†ä¸‰æ¬¡åŠä»¥ä¸Šï¼Œé‚£ä¹ˆå¿…ç„¶æœ‰ä¸€äº›æ•°ä¸åœ¨ nums[]  æ•°ç»„ä¸­äº†ï¼Œè¿™ä¸ªæ—¶å€™ç›¸å½“äºæˆ‘ä»¬ç”¨ target å»æ›¿æ¢äº†è¿™äº›æ•°ï¼Œæˆ‘ä»¬è€ƒè™‘æ›¿æ¢çš„æ—¶å€™å¯¹ cnt[]æ•°ç»„çš„å½±å“ã€‚å¦‚æœæ›¿æ¢çš„æ•° *i* å°äº target ï¼Œé‚£ä¹ˆ[i,target-1] çš„ cntå€¼å‡å‡ä¸€ï¼Œå…¶ä»–ä¸å˜ï¼Œæ»¡è¶³æ¡ä»¶ã€‚å¦‚æœæ›¿æ¢çš„æ•° *j* å¤§äºç­‰äº targetï¼Œé‚£ä¹ˆ[target,j-1]çš„ cnt å€¼å‡åŠ ä¸€ï¼Œå…¶ä»–ä¸å˜ï¼Œäº¦æ»¡è¶³æ¡ä»¶ã€‚

å› æ­¤æˆ‘ä»¬ç”Ÿæˆçš„æ•°ç»„ä¸€å®šå…·æœ‰ä¸Šè¿°æ€§è´¨çš„ã€‚
<details>
    <summary>äºŒåˆ†æŸ¥æ‰¾C++</summary>
    
```C++ [sol1-C++]
class Solution {
public:
    int findDuplicate(vector<int>& nums) {
        int n = nums.size();
        int l = 1, r = n - 1, ans = -1;
        while (l <= r) {
            int mid = (l + r) >> 1;
            int cnt = 0;
            for (int i = 0; i < n; ++i) {
                cnt += nums[i] <= mid;
            }
            if (cnt <= mid) {
                l = mid + 1;
            } else {
                r = mid - 1;
                ans = mid;
            }
        }
        return ans;
    }
};
```
</details>
<details>
    <summary>äºŒåˆ†æŸ¥æ‰¾JavaScript</summary>
    
```JavaScript [sol1-JavaScript]
var findDuplicate = function(nums) {
    const n = nums.length;
    let l = 1, r = n - 1, ans = -1;
    while (l <= r) {
        let mid = (l + r) >> 1;
        let cnt = 0;
        for (let i = 0; i < n; ++i) {
            cnt += nums[i] <= mid;
        }
        if (cnt <= mid) {
            l = mid + 1;
        } else {
            r = mid - 1;
            ans = mid;
        }
    }
    return ans;
};
```
</details>
<details>
    <summary>äºŒåˆ†æŸ¥æ‰¾Java</summary>

```Java [sol1-Java]
class Solution {
    public int findDuplicate(int[] nums) {
        int n = nums.length;
        int l = 1, r = n - 1, ans = -1;
        while (l <= r) {
            int mid = (l + r) >> 1;
            int cnt = 0;
            for (int i = 0; i < n; ++i) {
                if (nums[i] <= mid) {
                    cnt++;
                }
            }
            if (cnt <= mid) {
                l = mid + 1;
            } else {
                r = mid - 1;
                ans = mid;
            }
        }
        return ans;

    }
}
```
</details>
<details>
    <summary>äºŒåˆ†æŸ¥æ‰¾golang</summary>

```golang [sol1-Golang]
func findDuplicate(nums []int) int {
    n := len(nums)
    l, r := 1, n - 1
    ans := -1
    for l <= r {
        mid := (l + r) >> 1
        cnt := 0
        for i := 0; i < n; i++ {
            if nums[i] <= mid {
                cnt++
            }
        }
        if cnt <= mid {
            l = mid + 1
        } else {
            r = mid - 1
            ans = mid
        }
    }
    return ans
}
```
</details>


**å¤æ‚åº¦åˆ†æ**


- æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)  ï¼Œå…¶ä¸­ *n* ä¸º nums[] æ•°ç»„çš„é•¿åº¦ã€‚äºŒåˆ†æŸ¥æ‰¾æœ€å¤šéœ€è¦äºŒåˆ† O(logn)æ¬¡ï¼Œæ¯æ¬¡åˆ¤æ–­çš„æ—¶å€™éœ€è¦*O(n)* éå† nums[]  æ•°ç»„æ±‚è§£å°äºç­‰äºmidçš„æ•°çš„ä¸ªæ•°ï¼Œå› æ­¤æ€»æ—¶é—´å¤æ‚åº¦ä¸ºO(nlogn)ã€‚

- ç©ºé—´å¤æ‚åº¦ï¼š*O(1)*ã€‚æˆ‘ä»¬åªéœ€è¦å¸¸æ•°ç©ºé—´å­˜æ”¾è‹¥å¹²å˜é‡ã€‚

## æ–¹æ³•äºŒï¼šäºŒè¿›åˆ¶

**æ€è·¯å’Œç®—æ³•**

è¿™ä¸ªæ–¹æ³•æˆ‘ä»¬æ¥å°†æ‰€æœ‰æ•°äºŒè¿›åˆ¶å±•å¼€æŒ‰ä½è€ƒè™‘å¦‚ä½•æ‰¾å‡ºé‡å¤çš„æ•°ï¼Œå¦‚æœæˆ‘ä»¬èƒ½ç¡®å®šé‡å¤æ•°æ¯ä¸€ä½æ˜¯ *1* è¿˜æ˜¯ *0* å°±å¯ä»¥æŒ‰ä½è¿˜åŸå‡ºé‡å¤çš„æ•°æ˜¯ä»€ä¹ˆã€‚

è€ƒè™‘åˆ°ç¬¬ *i* ä½ï¼Œæˆ‘ä»¬è®° nums[] æ•°ç»„ä¸­äºŒè¿›åˆ¶å±•å¼€åç¬¬ *i* ä½ä¸º *1* çš„æ•°æœ‰ *x* ä¸ªï¼Œæ•°å­— *[1,n]* è¿™ *n* ä¸ªæ•°äºŒè¿›åˆ¶å±•å¼€åç¬¬ *i* ä½ä¸º *1* çš„æ•°æœ‰ *y* ä¸ªï¼Œé‚£ä¹ˆé‡å¤çš„æ•°ç¬¬ *i* ä½ä¸º *1* å½“ä¸”ä»…å½“ *x>y*ã€‚

ä»ç„¶ä»¥ç¤ºä¾‹ 1 ä¸ºä¾‹ï¼Œå¦‚ä¸‹çš„è¡¨æ ¼åˆ—å‡ºäº†æ¯ä¸ªæ•°å­—äºŒè¿›åˆ¶ä¸‹æ¯ä¸€ä½æ˜¯ *1* è¿˜æ˜¯ *0* ä»¥åŠå¯¹åº”ä½çš„ *x* å’Œ *y* æ˜¯å¤šå°‘ï¼š

&nbsp; | 1 | 3 | 4 | 2 | 2 | x | y
:-: | :-: | :-: | :-: | :-: |  :-: | :-: | :-:
ç¬¬ 0 ä½ | 1 | 1 | 0 | 0 | 0 | 2 | 2 
ç¬¬ 1 ä½ | 0 | 1 | 0 | 1 | 1 | 3 | 2 
ç¬¬ 2 ä½ | 0 | 0 | 1 | 0 | 0 | 1 | 1 

æ›´å¤šæ€è·¯è¯¦è§£è§[^1]

<details>
    <summary>äºŒè¿›åˆ¶C++</summary>

```C++ [sol2-C++]
class Solution {
public:
    int findDuplicate(vector<int>& nums) {
        int n = nums.size(), ans = 0;
        // ç¡®å®šäºŒè¿›åˆ¶ä¸‹æœ€é«˜ä½æ˜¯å¤šå°‘
        int bit_max = 31;
        while (!((n - 1) >> bit_max)) {
            bit_max -= 1;
        }
        for (int bit = 0; bit <= bit_max; ++bit) {
            int x = 0, y = 0;
            for (int i = 0; i < n; ++i) {
                if (nums[i] & (1 << bit)) {
                    x += 1;
                }
                if (i >= 1 && (i & (1 << bit))) {
                    y += 1;
                }
            }
            if (x > y) {
                ans |= 1 << bit;
            }
        }
        return ans;
    }
};
```
</details>
<details>
    <summary>äºŒè¿›åˆ¶JavaScript</summary>

```JavaScript [sol2-JavaScript]
var findDuplicate = function(nums) {
    const n = nums.length;
    let ans = 0;
    // ç¡®å®šäºŒè¿›åˆ¶ä¸‹æœ€é«˜ä½æ˜¯å¤šå°‘
    let bit_max = 31;
    while (!((n - 1) >> bit_max)) {
        bit_max -= 1;
    }
    for (let bit = 0; bit <= bit_max; ++bit) {
        let x = 0, y = 0;
        for (let i = 0; i < n; ++i) {
            if (nums[i] & (1 << bit)) {
                x += 1;
            }
            if (i >= 1 && (i & (1 << bit))) {
                y += 1;
            }
        }
        if (x > y) {
            ans |= 1 << bit;
        }
    }
    return ans;
};
```
</details>
<details>
    <summary>äºŒè¿›åˆ¶Java</summary>

```Java [sol2-Java]
class Solution {
    public int findDuplicate(int[] nums) {
        int n = nums.length, ans = 0;
        int bit_max = 31;
        //ä»¤bit_maxä¸ºn-1çš„æœ€é«˜ä½æ•°
        while (((n - 1) >> bit_max) == 0) {
            bit_max -= 1;
        }
        for (int bit = 0; bit <= bit_max; ++bit) {
            int x = 0, y = 0;
            for (int i = 0; i < n; ++i) {
                if ((nums[i] & (1 << bit)) != 0) {
                    x += 1;
                }
                if (((i & (1 << bit)) != 0)) {
                    y += 1;
                }
            }
            if (x > y) {
                ans |= 1 << bit;
            }
        }
        return ans;
    }
}
```
</details>
<details>
    <summary>äºŒè¿›åˆ¶golang</summary>

```golang [sol2-Golang]
func findDuplicate(nums []int) int {
    n := len(nums)
    ans := 0
    bit_max := 31
    for ((n-1) >> bit_max) == 0 {
        bit_max--
    }
    for bit := 0; bit <= bit_max; bit++ {
        x, y := 0, 0
        for i := 0; i < n; i++ {
            if (nums[i] & (1 << bit)) > 0 {
                x++
            }
            if i >= 1 && (i & (1 << bit)) > 0 {
                y++
            }
        }
        if x > y {
            ans |= 1 << bit
        }
    }
    return ans
}
```
</details>

**å¤æ‚åº¦è¯æ˜**

- æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn)ã€‚

- ç©ºé—´å¤æ‚åº¦ï¼š*O(1)*ã€‚æˆ‘ä»¬åªéœ€è¦å¸¸æ•°ç©ºé—´å­˜æ”¾è‹¥å¹²å˜é‡ã€‚

## æ–¹æ³•ä¸‰ï¼šå¿«æ…¢æŒ‡é’ˆ

æ›´å¤šæ€è·¯è¯¦è§£è§[^1]

<details>
    <summary>å¿«æ…¢æŒ‡é’ˆC++</summary>

```C++ [sol3-C++]
class Solution {
public:
    int findDuplicate(vector<int>& nums) {
        int slow = 0, fast = 0;
        do {
            slow = nums[slow];
            fast = nums[nums[fast]];
        } while (slow != fast);
        slow = 0;
        while (slow != fast) {
            slow = nums[slow];
            fast = nums[fast];
        }
        return slow;
    }
};
```
</details>
<details>
    <summary>å¿«æ…¢æŒ‡é’ˆJavaScript</summary>

```JavaScript [sol3-JavaScript]
var findDuplicate = function(nums) {
    let slow = 0, fast = 0;
    do {
        slow = nums[slow];
        fast = nums[nums[fast]];
    } while (slow != fast);
    slow = 0;
    while (slow != fast) {
        slow = nums[slow];
        fast = nums[fast];
    }
    return slow;
};
```
</details>
<details>
    <summary>å¿«æ…¢æŒ‡é’ˆJava</summary>

```Java [sol3-Java]
class Solution {
    public int findDuplicate(int[] nums) {
        int slow = 0, fast = 0;
        do {
            slow = nums[slow];
            fast = nums[nums[fast]];
        } while (slow != fast);
        slow = 0;
        while (slow != fast) {
            slow = nums[slow];
            fast = nums[fast];
        }
        return slow;
    }
}
```
</details>
<details>
    <summary>å¿«æ…¢æŒ‡é’ˆgolang</summary>

```golang [sol3-Golang]
func findDuplicate(nums []int) int {
    slow, fast := 0, 0
    for slow, fast = nums[slow], nums[nums[fast]]; slow != fast; slow, fast = nums[slow], nums[nums[fast]] { }
    slow = 0
    for slow != fast {
        slow = nums[slow]
        fast = nums[fast]
    }
    return slow
}
```
</details>


**å¤æ‚åº¦åˆ†æ**

- æ—¶é—´å¤æ‚åº¦ï¼š*O(n)*ã€‚ã€ŒFloyd åˆ¤åœˆç®—æ³•ã€æ—¶é—´å¤æ‚åº¦ä¸ºçº¿æ€§çš„æ—¶é—´å¤æ‚åº¦ã€‚

- ç©ºé—´å¤æ‚åº¦ï¼š*O(1)*ã€‚æˆ‘ä»¬åªéœ€è¦å¸¸æ•°ç©ºé—´å­˜æ”¾è‹¥å¹²å˜é‡ã€‚

[^1]:https://leetcode-cn.com/problems/find-the-duplicate-number/solution/xun-zhao-zhong-fu-shu-by-leetcode-solution/