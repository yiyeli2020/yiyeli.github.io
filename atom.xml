<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Yiye Li</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2020-07-02T14:38:21.897Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Yiye Li</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>238. é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯</title>
    <link href="http://yoursite.com/2020/07/02/238.%20%E9%99%A4%E8%87%AA%E8%BA%AB%E4%BB%A5%E5%A4%96%E6%95%B0%E7%BB%84%E7%9A%84%E4%B9%98%E7%A7%AF/"/>
    <id>http://yoursite.com/2020/07/02/238. é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯/</id>
    <published>2020-07-02T14:52:12.000Z</published>
    <updated>2020-07-02T14:38:21.897Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•´æ•°æ•°ç»„ numsï¼Œå…¶ä¸­ n &gt; 1ï¼Œè¿”å›è¾“å‡ºæ•°ç»„ output ï¼Œå…¶ä¸­ output[i] ç­‰äº nums ä¸­é™¤ nums[i] ä¹‹å¤–å…¶ä½™å„å…ƒç´ çš„ä¹˜ç§¯ã€‚</p><a id="more"></a><p>ç¤ºä¾‹:</p><pre><code>è¾“å…¥: [1,2,3,4]è¾“å‡º: [24,12,8,6]æç¤ºï¼šé¢˜ç›®æ•°æ®ä¿è¯æ•°ç»„ä¹‹ä¸­ä»»æ„å…ƒç´ çš„å…¨éƒ¨å‰ç¼€å…ƒç´ å’Œåç¼€ï¼ˆç”šè‡³æ˜¯æ•´ä¸ªæ•°ç»„ï¼‰çš„ä¹˜ç§¯éƒ½åœ¨ 32 ä½æ•´æ•°èŒƒå›´å†…ã€‚è¯´æ˜: è¯·ä¸è¦ä½¿ç”¨é™¤æ³•ï¼Œä¸”åœ¨ O(n) æ—¶é—´å¤æ‚åº¦å†…å®Œæˆæ­¤é¢˜ã€‚</code></pre><p>è¿›é˜¶ï¼š</p><p>ä½ å¯ä»¥åœ¨å¸¸æ•°ç©ºé—´å¤æ‚åº¦å†…å®Œæˆè¿™ä¸ªé¢˜ç›®å—ï¼Ÿï¼ˆ å‡ºäºå¯¹ç©ºé—´å¤æ‚åº¦åˆ†æçš„ç›®çš„ï¼Œè¾“å‡ºæ•°ç»„ä¸è¢«è§†ä¸ºé¢å¤–ç©ºé—´ã€‚ï¼‰</p><h3 id="ğŸ“ºè§†é¢‘é¢˜è§£"><a href="#ğŸ“ºè§†é¢‘é¢˜è§£" class="headerlink" title="ğŸ“ºè§†é¢‘é¢˜è§£"></a>ğŸ“ºè§†é¢‘é¢˜è§£</h3><p> <a href="5f8f385b-1288-4c91-8a65-e7490a96764c">238.é™¤è‡ªèº«ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯.mp4</a></p><h3 id="ğŸ“–æ–‡å­—é¢˜è§£"><a href="#ğŸ“–æ–‡å­—é¢˜è§£" class="headerlink" title="ğŸ“–æ–‡å­—é¢˜è§£"></a>ğŸ“–æ–‡å­—é¢˜è§£</h3><h4 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h4><p>è¿™ä¼¼ä¹æ˜¯ä¸€ä¸ªç®€å•çš„é—®é¢˜ï¼Œå¯ä»¥åœ¨çº¿æ€§æ—¶é—´å’Œç©ºé—´å†…è§£å†³ã€‚å…ˆè®¡ç®—ç»™å®šæ•°ç»„æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯ï¼Œç„¶åå¯¹æ•°ç»„ä¸­çš„æ¯ä¸ªå…ƒç´  <em>x</em>ï¼Œå°†æ€»çš„ä¹˜ç§¯é™¤ä»¥ <em>x</em> æ¥æ±‚å¾—é™¤è‡ªèº«å€¼çš„ä»¥å¤–æ•°ç»„çš„ä¹˜ç§¯ã€‚</p><p>ç„¶è€Œè¿™æ ·çš„è§£å†³æ–¹æ³•æœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯å¦‚æœè¾“å…¥æ•°ç»„ä¸­å‡ºç° 0ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•å°±å¤±æ•ˆäº†ã€‚è€Œä¸”åœ¨é—®é¢˜ä¸­è¯´æ˜äº†ä¸å…è®¸ä½¿ç”¨é™¤æ³•è¿ç®—ã€‚è¿™å¢åŠ äº†è¿™ä¸ªé—®é¢˜çš„éš¾åº¦ã€‚</p><h4 id="æ–¹æ³•ä¸€ï¼šå·¦å³ä¹˜ç§¯åˆ—è¡¨"><a href="#æ–¹æ³•ä¸€ï¼šå·¦å³ä¹˜ç§¯åˆ—è¡¨" class="headerlink" title="æ–¹æ³•ä¸€ï¼šå·¦å³ä¹˜ç§¯åˆ—è¡¨"></a>æ–¹æ³•ä¸€ï¼šå·¦å³ä¹˜ç§¯åˆ—è¡¨</h4><p><strong>æ€è·¯</strong></p><p>æˆ‘ä»¬ä¸å¿…å°†æ‰€æœ‰æ•°å­—çš„ä¹˜ç§¯é™¤ä»¥ç»™å®šç´¢å¼•å¤„çš„æ•°å­—å¾—åˆ°ç›¸åº”çš„ç­”æ¡ˆï¼Œè€Œæ˜¯åˆ©ç”¨ç´¢å¼•å·¦ä¾§æ‰€æœ‰æ•°å­—çš„ä¹˜ç§¯å’Œå³ä¾§æ‰€æœ‰æ•°å­—çš„ä¹˜ç§¯ï¼ˆå³å‰ç¼€ä¸åç¼€ï¼‰ç›¸ä¹˜å¾—åˆ°ç­”æ¡ˆã€‚</p><p>å¯¹äºç»™å®šç´¢å¼• <em>i</em>ï¼Œæˆ‘ä»¬å°†ä½¿ç”¨å®ƒå·¦è¾¹æ‰€æœ‰æ•°å­—çš„ä¹˜ç§¯ä¹˜ä»¥å³è¾¹æ‰€æœ‰æ•°å­—çš„ä¹˜ç§¯ã€‚ä¸‹é¢è®©æˆ‘ä»¬æ›´åŠ å…·ä½“çš„æè¿°è¿™ä¸ªç®—æ³•ã€‚</p><p><strong>ç®—æ³•</strong></p><ol><li>åˆå§‹åŒ–ä¸¤ä¸ªç©ºæ•°ç»„ <code>L</code> å’Œ <code>R</code>ã€‚å¯¹äºç»™å®šç´¢å¼• <code>i</code>ï¼Œ<code>L[i]</code> ä»£è¡¨çš„æ˜¯ <code>i</code> å·¦ä¾§æ‰€æœ‰æ•°å­—çš„ä¹˜ç§¯ï¼Œ<code>R[i]</code> ä»£è¡¨çš„æ˜¯ <code>i</code> å³ä¾§æ‰€æœ‰æ•°å­—çš„ä¹˜ç§¯ã€‚</li><li>æˆ‘ä»¬éœ€è¦ç”¨ä¸¤ä¸ªå¾ªç¯æ¥å¡«å…… <code>L</code> å’Œ <code>R</code> æ•°ç»„çš„å€¼ã€‚å¯¹äºæ•°ç»„ <code>L</code>ï¼Œ<code>L[0]</code> åº”è¯¥æ˜¯ <code>1</code>ï¼Œå› ä¸ºç¬¬ä¸€ä¸ªå…ƒç´ çš„å·¦è¾¹æ²¡æœ‰å…ƒç´ ã€‚å¯¹äºå…¶ä»–å…ƒç´ ï¼š<code>L[i] = L[i-1] * nums[i-1]</code>ã€‚</li><li>åŒç†ï¼Œå¯¹äºæ•°ç»„ <code>R</code>ï¼Œ<code>R[length-1]</code> åº”ä¸º <code>1</code>ã€‚<code>length</code> æŒ‡çš„æ˜¯è¾“å…¥æ•°ç»„çš„å¤§å°ã€‚å…¶ä»–å…ƒç´ ï¼š<code>R[i] = R[i+1] * nums[i+1]</code>ã€‚</li><li>å½“ <code>R</code> å’Œ <code>L</code> æ•°ç»„å¡«å……å®Œæˆï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨è¾“å…¥æ•°ç»„ä¸Šè¿­ä»£ï¼Œä¸”ç´¢å¼• <code>i</code> å¤„çš„å€¼ä¸ºï¼š<code>L[i] * R[i]</code>ã€‚</li></ol><p>è®©æˆ‘ä»¬ç”¨ä»¥ä¸‹å›¾ç‰‡çœ‹çœ‹ç®—æ³•æ˜¯å¦‚ä½•å·¥ä½œçš„ï¼š</p><p>  <a href="https://assets.leetcode-cn.com/solution-static/238/1.PNG" target="_blank" rel="noopener">fig1</a>  <a href="https://assets.leetcode-cn.com/solution-static/238/2.PNG" target="_blank" rel="noopener">fig2</a>  <a href="https://assets.leetcode-cn.com/solution-static/238/3.PNG" target="_blank" rel="noopener">fig3</a>  <a href="https://assets.leetcode-cn.com/solution-static/238/4.PNG" target="_blank" rel="noopener">fig4</a>  <a href="https://assets.leetcode-cn.com/solution-static/238/5.PNG" target="_blank" rel="noopener">fig5</a>  <a href="https://assets.leetcode-cn.com/solution-static/238/6.PNG" target="_blank" rel="noopener">fig6</a>  <a href="https://assets.leetcode-cn.com/solution-static/238/7.PNG" target="_blank" rel="noopener">fig7</a>  <a href="https://assets.leetcode-cn.com/solution-static/238/8.PNG" target="_blank" rel="noopener">fig8</a>  <a href="https://assets.leetcode-cn.com/solution-static/238/9.PNG" target="_blank" rel="noopener">fig9</a>  <a href="https://assets.leetcode-cn.com/solution-static/238/10.PNG" target="_blank" rel="noopener">fig10</a> </p><figure class="highlight c++"><figcaption><span>[sol1-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; productExceptSelf(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums) &#123;</span><br><span class="line">        <span class="keyword">int</span> length = nums.size();</span><br><span class="line"></span><br><span class="line">        <span class="comment">// L å’Œ R åˆ†åˆ«è¡¨ç¤ºå·¦å³ä¸¤ä¾§çš„ä¹˜ç§¯åˆ—è¡¨</span></span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; L(length, <span class="number">0</span>), R(length, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; answer(length);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// L[i] ä¸ºç´¢å¼• i å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="comment">// å¯¹äºç´¢å¼•ä¸º '0' çš„å…ƒç´ ï¼Œå› ä¸ºå·¦ä¾§æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ L[0] = 1</span></span><br><span class="line">        L[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; length; i++) &#123;</span><br><span class="line">            L[i] = nums[i - <span class="number">1</span>] * L[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// R[i] ä¸ºç´¢å¼• i å³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="comment">// å¯¹äºç´¢å¼•ä¸º 'length-1' çš„å…ƒç´ ï¼Œå› ä¸ºå³ä¾§æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ R[length-1] = 1</span></span><br><span class="line">        R[length - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = length - <span class="number">2</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            R[i] = nums[i + <span class="number">1</span>] * R[i + <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯¹äºç´¢å¼• iï¼Œé™¤ nums[i] ä¹‹å¤–å…¶ä½™å„å…ƒç´ çš„ä¹˜ç§¯å°±æ˜¯å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯ä¹˜ä»¥å³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            answer[i] = L[i] * R[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> answer;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>[sol1-Python3]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">productExceptSelf</span><span class="params">(self, nums: List[int])</span> -&gt; List[int]:</span></span><br><span class="line">        length = len(nums)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># L å’Œ R åˆ†åˆ«è¡¨ç¤ºå·¦å³ä¸¤ä¾§çš„ä¹˜ç§¯åˆ—è¡¨</span></span><br><span class="line">        L, R, answer = [<span class="number">0</span>]*length, [<span class="number">0</span>]*length, [<span class="number">0</span>]*length</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># L[i] ä¸ºç´¢å¼• i å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="comment"># å¯¹äºç´¢å¼•ä¸º '0' çš„å…ƒç´ ï¼Œå› ä¸ºå·¦ä¾§æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ L[0] = 1</span></span><br><span class="line">        L[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, length):</span><br><span class="line">            L[i] = nums[i - <span class="number">1</span>] * L[i - <span class="number">1</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># R[i] ä¸ºç´¢å¼• i å³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="comment"># å¯¹äºç´¢å¼•ä¸º 'length-1' çš„å…ƒç´ ï¼Œå› ä¸ºå³ä¾§æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ R[length-1] = 1</span></span><br><span class="line">        R[length - <span class="number">1</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> reversed(range(length - <span class="number">1</span>)):</span><br><span class="line">            R[i] = nums[i + <span class="number">1</span>] * R[i + <span class="number">1</span>]</span><br><span class="line"></span><br><span class="line">        <span class="comment"># å¯¹äºç´¢å¼• iï¼Œé™¤ nums[i] ä¹‹å¤–å…¶ä½™å„å…ƒç´ çš„ä¹˜ç§¯å°±æ˜¯å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯ä¹˜ä»¥å³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(length):</span><br><span class="line">            answer[i] = L[i] * R[i]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> answer</span><br></pre></td></tr></table></figure><figure class="highlight java"><figcaption><span>[sol1-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] productExceptSelf(<span class="keyword">int</span>[] nums) &#123;</span><br><span class="line">        <span class="keyword">int</span> length = nums.length;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// L å’Œ R åˆ†åˆ«è¡¨ç¤ºå·¦å³ä¸¤ä¾§çš„ä¹˜ç§¯åˆ—è¡¨</span></span><br><span class="line">        <span class="keyword">int</span>[] L = <span class="keyword">new</span> <span class="keyword">int</span>[length];</span><br><span class="line">        <span class="keyword">int</span>[] R = <span class="keyword">new</span> <span class="keyword">int</span>[length];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] answer = <span class="keyword">new</span> <span class="keyword">int</span>[length];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// L[i] ä¸ºç´¢å¼• i å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="comment">// å¯¹äºç´¢å¼•ä¸º '0' çš„å…ƒç´ ï¼Œå› ä¸ºå·¦ä¾§æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ L[0] = 1</span></span><br><span class="line">        L[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; length; i++) &#123;</span><br><span class="line">            L[i] = nums[i - <span class="number">1</span>] * L[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// R[i] ä¸ºç´¢å¼• i å³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="comment">// å¯¹äºç´¢å¼•ä¸º 'length-1' çš„å…ƒç´ ï¼Œå› ä¸ºå³ä¾§æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ R[length-1] = 1</span></span><br><span class="line">        R[length - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = length - <span class="number">2</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            R[i] = nums[i + <span class="number">1</span>] * R[i + <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// å¯¹äºç´¢å¼• iï¼Œé™¤ nums[i] ä¹‹å¤–å…¶ä½™å„å…ƒç´ çš„ä¹˜ç§¯å°±æ˜¯å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯ä¹˜ä»¥å³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">            answer[i] = L[i] * R[i];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> answer;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight golang"><figcaption><span>[sol1-Golang]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">productExceptSelf</span><span class="params">(nums []<span class="keyword">int</span>)</span> []<span class="title">int</span></span> &#123;</span><br><span class="line">    length := <span class="built_in">len</span>(nums)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// L å’Œ R åˆ†åˆ«è¡¨ç¤ºå·¦å³ä¸¤ä¾§çš„ä¹˜ç§¯åˆ—è¡¨</span></span><br><span class="line">    L, R, answer := <span class="built_in">make</span>([]<span class="keyword">int</span>, length), <span class="built_in">make</span>([]<span class="keyword">int</span>, length), <span class="built_in">make</span>([]<span class="keyword">int</span>, length)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// L[i] ä¸ºç´¢å¼• i å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">    <span class="comment">// å¯¹äºç´¢å¼•ä¸º '0' çš„å…ƒç´ ï¼Œå› ä¸ºå·¦ä¾§æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ L[0] = 1</span></span><br><span class="line">    L[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">1</span>; i &lt; length; i++ &#123;</span><br><span class="line">        L[i] = nums[i<span class="number">-1</span>] * L[i<span class="number">-1</span>]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// R[i] ä¸ºç´¢å¼• i å³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">    <span class="comment">// å¯¹äºç´¢å¼•ä¸º 'length-1' çš„å…ƒç´ ï¼Œå› ä¸ºå³ä¾§æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ R[length-1] = 1</span></span><br><span class="line">    R[length<span class="number">-1</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i := length - <span class="number">2</span>; i &gt;= <span class="number">0</span>; i-- &#123;</span><br><span class="line">        R[i] = nums[i+<span class="number">1</span>] * R[i+<span class="number">1</span>]</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">// å¯¹äºç´¢å¼• iï¼Œé™¤ nums[i] ä¹‹å¤–å…¶ä½™å„å…ƒç´ çš„ä¹˜ç§¯å°±æ˜¯å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯ä¹˜ä»¥å³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">0</span>; i &lt; length; i++ &#123;</span><br><span class="line">        answer[i] = L[i] * R[i]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> answer</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight typescript"><figcaption><span>[sol1-TypeScript]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> productExceptSelf = <span class="function"><span class="keyword">function</span>(<span class="params">nums: <span class="built_in">number</span>[]</span>): <span class="title">number</span>[] </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> length = nums.length;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// L å’Œ R åˆ†åˆ«è¡¨ç¤ºå·¦å³ä¸¤ä¾§çš„ä¹˜ç§¯åˆ—è¡¨</span></span><br><span class="line">    <span class="keyword">const</span> L = <span class="keyword">new</span> <span class="built_in">Array</span>&lt;<span class="built_in">number</span>&gt;(length);</span><br><span class="line">    <span class="keyword">const</span> R = <span class="keyword">new</span> <span class="built_in">Array</span>&lt;<span class="built_in">number</span>&gt;(length);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> answer = <span class="keyword">new</span> <span class="built_in">Array</span>&lt;<span class="built_in">number</span>&gt;(length);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// L[i] ä¸ºç´¢å¼• i å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">    <span class="comment">// å¯¹äºç´¢å¼•ä¸º '0' çš„å…ƒç´ ï¼Œå› ä¸ºå·¦ä¾§æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ L[0] = 1</span></span><br><span class="line">    L[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; length; i++) &#123;</span><br><span class="line">        L[i] = nums[i - <span class="number">1</span>] * L[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// R[i] ä¸ºç´¢å¼• i å³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">    <span class="comment">// å¯¹äºç´¢å¼•ä¸º 'length-1' çš„å…ƒç´ ï¼Œå› ä¸ºå³ä¾§æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ R[length-1] = 1</span></span><br><span class="line">    R[length - <span class="number">1</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = length - <span class="number">2</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        R[i] = nums[i + <span class="number">1</span>] * R[i + <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// å¯¹äºç´¢å¼• iï¼Œé™¤ nums[i] ä¹‹å¤–å…¶ä½™å„å…ƒç´ çš„ä¹˜ç§¯å°±æ˜¯å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯ä¹˜ä»¥å³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; length; i++) &#123;</span><br><span class="line">        answer[i] = L[i] * R[i];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> answer;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(N)*ï¼Œå…¶ä¸­ *N</em> æŒ‡çš„æ˜¯æ•°ç»„ <code>nums</code> çš„å¤§å°ã€‚é¢„å¤„ç† <code>L</code> å’Œ <code>R</code> æ•°ç»„ä»¥åŠæœ€åçš„éå†è®¡ç®—éƒ½æ˜¯ <em>O(N)</em> çš„æ—¶é—´å¤æ‚åº¦ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(N)*ï¼Œå…¶ä¸­ *N</em> æŒ‡çš„æ˜¯æ•°ç»„ <code>nums</code> çš„å¤§å°ã€‚ä½¿ç”¨äº† <code>L</code> å’Œ <code>R</code> æ•°ç»„å»æ„é€ ç­”æ¡ˆï¼Œ<code>L</code> å’Œ <code>R</code> æ•°ç»„çš„é•¿åº¦ä¸ºæ•°ç»„ <code>nums</code> çš„å¤§å°ã€‚</li></ul><h4 id="æ–¹æ³•äºŒï¼šç©ºé—´å¤æ‚åº¦-O-1-çš„æ–¹æ³•"><a href="#æ–¹æ³•äºŒï¼šç©ºé—´å¤æ‚åº¦-O-1-çš„æ–¹æ³•" class="headerlink" title="æ–¹æ³•äºŒï¼šç©ºé—´å¤æ‚åº¦ O(1) çš„æ–¹æ³•"></a>æ–¹æ³•äºŒï¼šç©ºé—´å¤æ‚åº¦ <em>O(1)</em> çš„æ–¹æ³•</h4><p><strong>æ€è·¯</strong></p><p>å°½ç®¡ä¸Šé¢çš„æ–¹æ³•å·²ç»èƒ½å¤Ÿå¾ˆå¥½çš„è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½†æ˜¯ç©ºé—´å¤æ‚åº¦å¹¶ä¸ä¸ºå¸¸æ•°ã€‚</p><p>ç”±äºè¾“å‡ºæ•°ç»„ä¸ç®—åœ¨ç©ºé—´å¤æ‚åº¦å†…ï¼Œé‚£ä¹ˆæˆ‘ä»¬å¯ä»¥å°† <code>L</code> æˆ– <code>R</code> æ•°ç»„ç”¨è¾“å‡ºæ•°ç»„æ¥è®¡ç®—ã€‚å…ˆæŠŠè¾“å‡ºæ•°ç»„å½“ä½œ <code>L</code> æ•°ç»„æ¥è®¡ç®—ï¼Œç„¶åå†åŠ¨æ€æ„é€  <code>R</code> æ•°ç»„å¾—åˆ°ç»“æœã€‚è®©æˆ‘ä»¬æ¥çœ‹çœ‹åŸºäºè¿™ä¸ªæ€æƒ³çš„ç®—æ³•ã€‚</p><p><strong>ç®—æ³•</strong></p><ol><li>åˆå§‹åŒ– <code>answer</code> æ•°ç»„ï¼Œå¯¹äºç»™å®šç´¢å¼• <code>i</code>ï¼Œ<code>answer[i]</code> ä»£è¡¨çš„æ˜¯ <code>i</code> å·¦ä¾§æ‰€æœ‰æ•°å­—çš„ä¹˜ç§¯ã€‚</li><li>æ„é€ æ–¹å¼ä¸ä¹‹å‰ç›¸åŒï¼Œåªæ˜¯æˆ‘ä»¬è¯•å›¾èŠ‚çœç©ºé—´ï¼Œå…ˆæŠŠ <code>answer</code> ä½œä¸ºæ–¹æ³•ä¸€çš„ <code>L</code> æ•°ç»„ã€‚</li><li>è¿™ç§æ–¹æ³•çš„å”¯ä¸€å˜åŒ–å°±æ˜¯æˆ‘ä»¬æ²¡æœ‰æ„é€  <code>R</code> æ•°ç»„ã€‚è€Œæ˜¯ç”¨ä¸€ä¸ªéå†æ¥è·Ÿè¸ªå³è¾¹å…ƒç´ çš„ä¹˜ç§¯ã€‚å¹¶æ›´æ–°æ•°ç»„ <em>answer[i]=answer[i]<em>R</em>ã€‚ç„¶å *R</em> æ›´æ–°ä¸º <em>R=R<em>nums[i]</em>ï¼Œå…¶ä¸­å˜é‡ *R</em> è¡¨ç¤ºçš„å°±æ˜¯ç´¢å¼•å³ä¾§æ•°å­—çš„ä¹˜ç§¯ã€‚</li></ol><figure class="highlight cpp"><figcaption><span>[sol2-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; productExceptSelf(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums) &#123;</span><br><span class="line">        <span class="keyword">int</span> length = nums.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; answer(length);</span><br><span class="line"></span><br><span class="line">        <span class="comment">// answer[i] è¡¨ç¤ºç´¢å¼• i å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="comment">// å› ä¸ºç´¢å¼•ä¸º '0' çš„å…ƒç´ å·¦ä¾§æ²¡æœ‰å…ƒç´ ï¼Œ æ‰€ä»¥ answer[0] = 1</span></span><br><span class="line">        answer[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; length; i++) &#123;</span><br><span class="line">            answer[i] = nums[i - <span class="number">1</span>] * answer[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// R ä¸ºå³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="comment">// åˆšå¼€å§‹å³è¾¹æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ R = 1</span></span><br><span class="line">        <span class="keyword">int</span> R = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="comment">// å¯¹äºç´¢å¼• iï¼Œå·¦è¾¹çš„ä¹˜ç§¯ä¸º answer[i]ï¼Œå³è¾¹çš„ä¹˜ç§¯ä¸º R</span></span><br><span class="line">            answer[i] = answer[i] * R;</span><br><span class="line">            <span class="comment">// R éœ€è¦åŒ…å«å³è¾¹æ‰€æœ‰çš„ä¹˜ç§¯ï¼Œæ‰€ä»¥è®¡ç®—ä¸‹ä¸€ä¸ªç»“æœæ—¶éœ€è¦å°†å½“å‰å€¼ä¹˜åˆ° R ä¸Š</span></span><br><span class="line">            R *= nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> answer;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>[sol2-Python3]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">productExceptSelf</span><span class="params">(self, nums: List[int])</span> -&gt; List[int]:</span></span><br><span class="line">        length = len(nums)</span><br><span class="line">        answer = [<span class="number">0</span>]*length</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># answer[i] è¡¨ç¤ºç´¢å¼• i å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="comment"># å› ä¸ºç´¢å¼•ä¸º '0' çš„å…ƒç´ å·¦ä¾§æ²¡æœ‰å…ƒç´ ï¼Œ æ‰€ä»¥ answer[0] = 1</span></span><br><span class="line">        answer[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, length):</span><br><span class="line">            answer[i] = nums[i - <span class="number">1</span>] * answer[i - <span class="number">1</span>]</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># R ä¸ºå³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="comment"># åˆšå¼€å§‹å³è¾¹æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ R = 1</span></span><br><span class="line">        R = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> reversed(range(length)):</span><br><span class="line">            <span class="comment"># å¯¹äºç´¢å¼• iï¼Œå·¦è¾¹çš„ä¹˜ç§¯ä¸º answer[i]ï¼Œå³è¾¹çš„ä¹˜ç§¯ä¸º R</span></span><br><span class="line">            answer[i] = answer[i] * R</span><br><span class="line">            <span class="comment"># R éœ€è¦åŒ…å«å³è¾¹æ‰€æœ‰çš„ä¹˜ç§¯ï¼Œæ‰€ä»¥è®¡ç®—ä¸‹ä¸€ä¸ªç»“æœæ—¶éœ€è¦å°†å½“å‰å€¼ä¹˜åˆ° R ä¸Š</span></span><br><span class="line">            R *= nums[i]</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> answer</span><br></pre></td></tr></table></figure><figure class="highlight java"><figcaption><span>[sol2-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] productExceptSelf(<span class="keyword">int</span>[] nums) &#123;</span><br><span class="line">        <span class="keyword">int</span> length = nums.length;</span><br><span class="line">        <span class="keyword">int</span>[] answer = <span class="keyword">new</span> <span class="keyword">int</span>[length];</span><br><span class="line"></span><br><span class="line">        <span class="comment">// answer[i] è¡¨ç¤ºç´¢å¼• i å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="comment">// å› ä¸ºç´¢å¼•ä¸º '0' çš„å…ƒç´ å·¦ä¾§æ²¡æœ‰å…ƒç´ ï¼Œ æ‰€ä»¥ answer[0] = 1</span></span><br><span class="line">        answer[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; length; i++) &#123;</span><br><span class="line">            answer[i] = nums[i - <span class="number">1</span>] * answer[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// R ä¸ºå³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">        <span class="comment">// åˆšå¼€å§‹å³è¾¹æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ R = 1</span></span><br><span class="line">        <span class="keyword">int</span> R = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">            <span class="comment">// å¯¹äºç´¢å¼• iï¼Œå·¦è¾¹çš„ä¹˜ç§¯ä¸º answer[i]ï¼Œå³è¾¹çš„ä¹˜ç§¯ä¸º R</span></span><br><span class="line">            answer[i] = answer[i] * R;</span><br><span class="line">            <span class="comment">// R éœ€è¦åŒ…å«å³è¾¹æ‰€æœ‰çš„ä¹˜ç§¯ï¼Œæ‰€ä»¥è®¡ç®—ä¸‹ä¸€ä¸ªç»“æœæ—¶éœ€è¦å°†å½“å‰å€¼ä¹˜åˆ° R ä¸Š</span></span><br><span class="line">            R *= nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> answer;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight golang"><figcaption><span>[sol2-Golang]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">productExceptSelf</span><span class="params">(nums []<span class="keyword">int</span>)</span> []<span class="title">int</span></span> &#123;</span><br><span class="line">    length := <span class="built_in">len</span>(nums)</span><br><span class="line">    answer := <span class="built_in">make</span>([]<span class="keyword">int</span>, length)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// answer[i] è¡¨ç¤ºç´¢å¼• i å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">    <span class="comment">// å› ä¸ºç´¢å¼•ä¸º '0' çš„å…ƒç´ å·¦ä¾§æ²¡æœ‰å…ƒç´ ï¼Œ æ‰€ä»¥ answer[0] = 1</span></span><br><span class="line">    answer[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">1</span>; i &lt; length; i++ &#123;</span><br><span class="line">        answer[i] = nums[i<span class="number">-1</span>] * answer[i<span class="number">-1</span>]</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// R ä¸ºå³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">    <span class="comment">// åˆšå¼€å§‹å³è¾¹æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ R = 1</span></span><br><span class="line">    R := <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> i := length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i-- &#123;</span><br><span class="line">        <span class="comment">// å¯¹äºç´¢å¼• iï¼Œå·¦è¾¹çš„ä¹˜ç§¯ä¸º answer[i]ï¼Œå³è¾¹çš„ä¹˜ç§¯ä¸º R</span></span><br><span class="line">        answer[i] = answer[i] * R</span><br><span class="line">        <span class="comment">// R éœ€è¦åŒ…å«å³è¾¹æ‰€æœ‰çš„ä¹˜ç§¯ï¼Œæ‰€ä»¥è®¡ç®—ä¸‹ä¸€ä¸ªç»“æœæ—¶éœ€è¦å°†å½“å‰å€¼ä¹˜åˆ° R ä¸Š</span></span><br><span class="line">        R *= nums[i]</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> answer</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight typescript"><figcaption><span>[sol2-TypeScript]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> productExceptSelf = <span class="function"><span class="keyword">function</span>(<span class="params">nums: <span class="built_in">number</span>[]</span>): <span class="title">number</span>[] </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> length = nums.length;</span><br><span class="line">    <span class="keyword">const</span> answer = <span class="keyword">new</span> <span class="built_in">Array</span>&lt;<span class="built_in">number</span>&gt;(length);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// answer[i] è¡¨ç¤ºç´¢å¼• i å·¦ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">    <span class="comment">// å› ä¸ºç´¢å¼•ä¸º '0' çš„å…ƒç´ å·¦ä¾§æ²¡æœ‰å…ƒç´ ï¼Œ æ‰€ä»¥ answer[0] = 1</span></span><br><span class="line">    answer[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; length; i++) &#123;</span><br><span class="line">        answer[i] = nums[i - <span class="number">1</span>] * answer[i - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// R ä¸ºå³ä¾§æ‰€æœ‰å…ƒç´ çš„ä¹˜ç§¯</span></span><br><span class="line">    <span class="comment">// åˆšå¼€å§‹å³è¾¹æ²¡æœ‰å…ƒç´ ï¼Œæ‰€ä»¥ R = 1</span></span><br><span class="line">    <span class="keyword">let</span> R = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = length - <span class="number">1</span>; i &gt;= <span class="number">0</span>; i--) &#123;</span><br><span class="line">        <span class="comment">// å¯¹äºç´¢å¼• iï¼Œå·¦è¾¹çš„ä¹˜ç§¯ä¸º answer[i]ï¼Œå³è¾¹çš„ä¹˜ç§¯ä¸º R</span></span><br><span class="line">        answer[i] = answer[i] * R;</span><br><span class="line">        <span class="comment">// R éœ€è¦åŒ…å«å³è¾¹æ‰€æœ‰çš„ä¹˜ç§¯ï¼Œæ‰€ä»¥è®¡ç®—ä¸‹ä¸€ä¸ªç»“æœæ—¶éœ€è¦å°†å½“å‰å€¼ä¹˜åˆ° R ä¸Š</span></span><br><span class="line">        R *= nums[i];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> answer;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(N)*ï¼Œå…¶ä¸­ *N</em> æŒ‡çš„æ˜¯æ•°ç»„ <code>nums</code> çš„å¤§å°ã€‚åˆ†æä¸æ–¹æ³•ä¸€ç›¸åŒã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(1)</em>ï¼Œè¾“å‡ºæ•°ç»„ä¸ç®—è¿›ç©ºé—´å¤æ‚åº¦ä¸­ï¼Œå› æ­¤æˆ‘ä»¬åªéœ€è¦å¸¸æ•°çš„ç©ºé—´å­˜æ”¾å˜é‡ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º n çš„æ•´æ•°æ•°ç»„ numsï¼Œå…¶ä¸­ n &amp;gt; 1ï¼Œè¿”å›è¾“å‡ºæ•°ç»„ output ï¼Œå…¶ä¸­ output[i] ç­‰äº nums ä¸­é™¤ nums[i] ä¹‹å¤–å…¶ä½™å„å…ƒç´ çš„ä¹˜ç§¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´7æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B47%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
  </entry>
  
  <entry>
    <title>155. æœ€å°æ ˆ</title>
    <link href="http://yoursite.com/2020/07/02/155.%20%20%E6%9C%80%E5%B0%8F%E6%A0%88/"/>
    <id>http://yoursite.com/2020/07/02/155.  æœ€å°æ ˆ/</id>
    <published>2020-07-02T14:36:12.000Z</published>
    <updated>2020-07-06T01:04:42.706Z</updated>
    
    <content type="html"><![CDATA[<p>è®¾è®¡ä¸€ä¸ªæ”¯æŒ push ï¼Œpop ï¼Œtop æ“ä½œï¼Œå¹¶èƒ½åœ¨å¸¸æ•°æ—¶é—´å†…æ£€ç´¢åˆ°æœ€å°å…ƒç´ çš„æ ˆã€‚</p><a id="more"></a><h1 id="é¢˜ç›®æè¿°ï¼ˆç®€å•éš¾åº¦ï¼‰"><a href="#é¢˜ç›®æè¿°ï¼ˆç®€å•éš¾åº¦ï¼‰" class="headerlink" title="é¢˜ç›®æè¿°ï¼ˆç®€å•éš¾åº¦ï¼‰"></a>é¢˜ç›®æè¿°ï¼ˆç®€å•éš¾åº¦ï¼‰</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">push(x) â€”â€” å°†å…ƒç´  x æ¨å…¥æ ˆä¸­ã€‚</span><br><span class="line">pop() â€”â€” åˆ é™¤æ ˆé¡¶çš„å…ƒç´ ã€‚</span><br><span class="line">top() â€”â€” è·å–æ ˆé¡¶å…ƒç´ ã€‚</span><br><span class="line">getMin() â€”â€” æ£€ç´¢æ ˆä¸­çš„æœ€å°å…ƒç´ ã€‚</span><br></pre></td></tr></table></figure><p>ç¤ºä¾‹:</p><pre><code>è¾“å…¥ï¼š[&quot;MinStack&quot;,&quot;push&quot;,&quot;push&quot;,&quot;push&quot;,&quot;getMin&quot;,&quot;pop&quot;,&quot;top&quot;,&quot;getMin&quot;][[],[-2],[0],[-3],[],[],[],[]]è¾“å‡ºï¼š[null,null,null,null,-3,null,0,-2]è§£é‡Šï¼šMinStack minStack = new MinStack();minStack.push(-2);minStack.push(0);minStack.push(-3);minStack.getMin();   --&gt; è¿”å› -3.minStack.pop();minStack.top();      --&gt; è¿”å› 0.minStack.getMin();   --&gt; è¿”å› -2.</code></pre><p>æç¤ºï¼š</p><p>popã€top å’Œ getMin æ“ä½œæ€»æ˜¯åœ¨ éç©ºæ ˆ ä¸Šè°ƒç”¨ã€‚</p><p>æœ€åˆçš„æƒ³æ³•æ˜¯ç”¨ä¸¤ä¸ªæ ˆæ¥å®ç°ï¼Œpop,pushå’Œtopå¯ç”¨stackè‡ªå¸¦çš„pop,pushå’Œpeekå‡½æ•°æ¥å®ç°ï¼Œç„¶åæ¯æ¬¡æ‰¾æœ€å°å€¼æ—¶éƒ½å°†ä¸€ä¸ªæ ˆä¸­å…ƒç´ å€’è±†å­ä¸€æ ·å€’è¿›å¦ä¸€ä¸ªæ ˆä¸­ï¼Œæ­¤è¿‡ç¨‹ä¸­è·å¾—æœ€å°å€¼ï¼Œä¹‹åå†å€’å›å»ï¼Œä½†è¿™ç§æ–¹æ³•è¶…æ—¶äº†ã€‚</p><h1 id="è§£æ³•ä¸€-1"><a href="#è§£æ³•ä¸€-1" class="headerlink" title="è§£æ³•ä¸€^1"></a>è§£æ³•ä¸€<a href="https://leetcode.wang" target="_blank" rel="noopener">^1</a></h1><p>è¦å®ç°ä¸€ä¸ª <code>stack</code>ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿˜èƒ½ç”¨ <code>java</code> è‡ªå¸¦çš„ <code>stack</code> å—ï¼Ÿä¹Ÿä¸ç”¨çº ç»“ï¼Œè¿™é“é¢˜çš„å…³é”®å…¶å®æ˜¯å®ç°ã€Œå¾—åˆ°æœ€å°å€¼è¿™ä¸ªåŠŸèƒ½ã€ï¼Œæ‰€ä»¥ä¸ºäº†ä»£ç ç®€æ´äº›ï¼Œæˆ‘ä»¬å°±ç›´æ¥ä½¿ç”¨ç³»ç»Ÿè‡ªå¸¦çš„ <code>stack</code> äº†ã€‚</p><p>è¿™é“é¢˜æœ€ç›´æ¥çš„è§£æ³•å°±æ˜¯æˆ‘ä»¬å¯ä»¥ç”¨ä¸¤ä¸ªæ ˆï¼Œä¸€ä¸ªæ ˆå»ä¿å­˜æ­£å¸¸çš„å…¥æ ˆå‡ºæ ˆçš„å€¼ï¼Œå¦ä¸€ä¸ªæ ˆå»å­˜æœ€å°å€¼ï¼Œä¹Ÿå°±æ˜¯ç”¨æ ˆé¡¶ä¿å­˜å½“å‰æ‰€æœ‰å…ƒç´ çš„æœ€å°å€¼ã€‚å­˜æœ€å°å€¼çš„æ ˆçš„å…·ä½“æ“ä½œæµç¨‹å¦‚ä¸‹ï¼š</p><p>å°†ç¬¬ä¸€ä¸ªå…ƒç´ å…¥æ ˆã€‚</p><p>æ–°åŠ å…¥çš„å…ƒç´ å¦‚æœå¤§äºæ ˆé¡¶å…ƒç´ ï¼Œé‚£ä¹ˆæ–°åŠ å…¥çš„å…ƒç´ å°±ä¸å¤„ç†ã€‚</p><p>æ–°åŠ å…¥çš„å…ƒç´ å¦‚æœå°äºç­‰äºæ ˆé¡¶å…ƒç´ ï¼Œé‚£ä¹ˆå°±å°†æ–°å…ƒç´ å…¥æ ˆã€‚</p><p>å‡ºæ ˆå…ƒç´ ä¸ç­‰äºæ ˆé¡¶å…ƒç´ ï¼Œä¸æ“ä½œã€‚</p><p>å‡ºæ ˆå…ƒç´ ç­‰äºæ ˆé¡¶å…ƒç´ ï¼Œé‚£ä¹ˆå°±å°†æ ˆé¡¶å…ƒç´ å‡ºæ ˆã€‚</p><p>ä¸¾ä¸ªä¾‹å­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">å…¥æ ˆ <span class="number">3</span> </span><br><span class="line">|   |    |   |</span><br><span class="line">|   |    |   |</span><br><span class="line">|_3_|    |_3_|</span><br><span class="line">stack  minStack</span><br><span class="line"></span><br><span class="line">å…¥æ ˆ <span class="number">5</span> ï¼Œ <span class="number">5</span> å¤§äº minStack æ ˆé¡¶ï¼Œä¸å¤„ç†</span><br><span class="line">|   |    |   |</span><br><span class="line">| <span class="number">5</span> |    |   |</span><br><span class="line">|_3_|    |_3_|</span><br><span class="line">stack  minStack</span><br><span class="line"></span><br><span class="line">å…¥æ ˆ <span class="number">2</span> ï¼Œæ­¤æ—¶å³è¾¹çš„ minStack æ ˆé¡¶å°±ä¿å­˜äº†å½“å‰æœ€å°å€¼ <span class="number">2</span> </span><br><span class="line">| <span class="number">2</span> |    |   |</span><br><span class="line">| <span class="number">5</span> |    | <span class="number">2</span> |</span><br><span class="line">|_3_|    |_3_|</span><br><span class="line">stack  minStack</span><br><span class="line"></span><br><span class="line">å‡ºæ ˆ <span class="number">2</span>ï¼Œæ­¤æ—¶å³è¾¹çš„ minStack æ ˆé¡¶å°±ä¿å­˜äº†å½“å‰æœ€å°å€¼ <span class="number">3</span></span><br><span class="line">|   |    |   |</span><br><span class="line">| <span class="number">5</span> |    |   |</span><br><span class="line">|_3_|    |_3_|</span><br><span class="line">stack  minStack</span><br><span class="line"></span><br><span class="line">å‡ºæ ˆ <span class="number">5</span>ï¼Œå³è¾¹ minStack ä¸å¤„ç†</span><br><span class="line">|   |    |   |</span><br><span class="line">|   |    |   |</span><br><span class="line">|_3_|    |_3_|</span><br><span class="line">stack  minStack</span><br><span class="line"></span><br><span class="line">å‡ºæ ˆ <span class="number">3</span></span><br><span class="line">|   |    |   |</span><br><span class="line">|   |    |   |</span><br><span class="line">|_ _|    |_ _|</span><br><span class="line">stack  minStack</span><br></pre></td></tr></table></figure><p>ä»£ç çš„è¯å°±å¾ˆå¥½å†™äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinStack</span> </span>&#123;</span><br><span class="line">    <span class="comment">/** initialize your data structure here. */</span></span><br><span class="line">    <span class="keyword">private</span> Stack&lt;Integer&gt; stack;</span><br><span class="line">    <span class="keyword">private</span> Stack&lt;Integer&gt; minStack;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">MinStack</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        stack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">        minStack = <span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        stack.push(x);</span><br><span class="line">        <span class="keyword">if</span> (!minStack.isEmpty()) &#123;</span><br><span class="line">            <span class="keyword">int</span> top = minStack.peek();</span><br><span class="line">            <span class="comment">//å°äºçš„æ—¶å€™æ‰å…¥æ ˆ</span></span><br><span class="line">            <span class="keyword">if</span> (x &lt;= top) &#123;</span><br><span class="line">                minStack.push(x);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            minStack.push(x);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> pop = stack.pop();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> top = minStack.peek();</span><br><span class="line">        <span class="comment">//ç­‰äºçš„æ—¶å€™å†å‡ºæ ˆ</span></span><br><span class="line">        <span class="comment">//æ­¤å¤„ä¸èƒ½å†™ä½œif(minStack.peek() == stack.peek())å¦åˆ™åˆ¤æ–­ä¸ç”Ÿæ•ˆ</span></span><br><span class="line">        <span class="comment">//å› ä¸ºåŒ…è£…ç±»å‹é—´çš„ç›¸ç­‰åˆ¤æ–­åº”è¯¥ç”¨equalsè€Œé==</span></span><br><span class="line">        <span class="keyword">if</span> (pop == top) &#123;</span><br><span class="line">            minStack.pop();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">top</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> stack.peek();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> minStack.peek();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™é‡Œæˆ‘çŠ¯äº†ä¸€ä¸ªé”™è¯¯ </p><p>å‡ºæ ˆæ“ä½œåˆ¤æ–­æ—¶ä¸èƒ½å†™ä½œ<code>if(minStack.peek() == stack.peek())</code>å¦åˆ™åˆ¤æ–­ä¸ç”Ÿæ•ˆ,å› ä¸ºåŒ…è£…ç±»å‹é—´çš„ç›¸ç­‰åˆ¤æ–­åº”è¯¥ç”¨equalsè€Œé==</p><h1 id="è§£æ³•äºŒ"><a href="#è§£æ³•äºŒ" class="headerlink" title="è§£æ³•äºŒ"></a>è§£æ³•äºŒ</h1><p>è§£æ³•ä¸€ä¸­ç”¨äº†ä¸¤ä¸ªæ ˆå»å®ç°ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½ç”¨ä¸€ä¸ªæ ˆå»å®ç°å‘¢ï¼Ÿ</p><p>å‚è€ƒäº†  <a href="https://leetcode.com/problems/min-stack/discuss/49014/Java-accepted-solution-using-one-stack" target="_blank" rel="noopener">è¿™é‡Œ</a>ã€‚</p><p>è§£æ³•ä¸€ä¸­å•ç‹¬ç”¨äº†ä¸€ä¸ªæ ˆå»ä¿å­˜æ‰€æœ‰æœ€å°å€¼ï¼Œé‚£ä¹ˆæˆ‘ä»¬èƒ½ä¸èƒ½åªç”¨ä¸€ä¸ªå˜é‡å»ä¿å­˜æœ€å°å€¼å‘¢ï¼Ÿ</p><p>å†çœ‹ä¸€ä¸‹ä¸Šè¾¹çš„ä¾‹å­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">å…¥æ ˆ <span class="number">3</span> </span><br><span class="line">|   |   min = <span class="number">3</span></span><br><span class="line">|   |     </span><br><span class="line">|_3_|    </span><br><span class="line">stack   </span><br><span class="line"></span><br><span class="line">å…¥æ ˆ <span class="number">5</span> </span><br><span class="line">|   |   min = <span class="number">3</span></span><br><span class="line">| <span class="number">5</span> |     </span><br><span class="line">|_3_|    </span><br><span class="line">stack  </span><br><span class="line"></span><br><span class="line">å…¥æ ˆ <span class="number">2</span> </span><br><span class="line">| <span class="number">2</span> |   min = <span class="number">2</span>?</span><br><span class="line">| <span class="number">5</span> |     </span><br><span class="line">|_3_|    </span><br><span class="line">stack</span><br></pre></td></tr></table></figure><p>å¦‚æœåªç”¨ä¸€ä¸ªå˜é‡å°±ä¼šé‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œå¦‚æœæŠŠ <code>min</code> æ›´æ–°ä¸º <code>2</code>ï¼Œé‚£ä¹ˆä¹‹å‰çš„æœ€å°å€¼ <code>3</code> å°±ä¸¢å¤±äº†ã€‚</p><p>æ€ä¹ˆæŠŠ <code>3</code> ä¿å­˜èµ·æ¥å‘¢ï¼ŸæŠŠå®ƒåœ¨ <code>2</code> ä¹‹å‰å‹å…¥æ ˆä¸­å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">å…¥æ ˆ <span class="number">2</span> ï¼ŒåŒæ—¶å°†ä¹‹å‰çš„ min å€¼ <span class="number">3</span> å…¥æ ˆï¼Œå†æŠŠ <span class="number">2</span> å…¥æ ˆï¼ŒåŒæ—¶æ›´æ–° min = <span class="number">2</span></span><br><span class="line">| <span class="number">2</span> |   min = <span class="number">2</span></span><br><span class="line">| <span class="number">3</span> |  </span><br><span class="line">| <span class="number">5</span> |     </span><br><span class="line">|_3_|    </span><br><span class="line">stack  </span><br><span class="line"></span><br><span class="line">å…¥æ ˆ <span class="number">6</span> </span><br><span class="line">| <span class="number">6</span> |  min = <span class="number">2</span></span><br><span class="line">| <span class="number">2</span> |   </span><br><span class="line">| <span class="number">3</span> |  </span><br><span class="line">| <span class="number">5</span> |     </span><br><span class="line">|_3_|    </span><br><span class="line">stack  </span><br><span class="line"></span><br><span class="line">å‡ºæ ˆ <span class="number">6</span>     </span><br><span class="line">| <span class="number">2</span> |   min = <span class="number">2</span></span><br><span class="line">| <span class="number">3</span> |  </span><br><span class="line">| <span class="number">5</span> |     </span><br><span class="line">|_3_|    </span><br><span class="line">stack  </span><br><span class="line"></span><br><span class="line">å‡ºæ ˆ <span class="number">2</span>     </span><br><span class="line">| <span class="number">2</span> |   min = <span class="number">2</span></span><br><span class="line">| <span class="number">3</span> |  </span><br><span class="line">| <span class="number">5</span> |     </span><br><span class="line">|_3_|    </span><br><span class="line">stack</span><br></pre></td></tr></table></figure><p>ä¸Šè¾¹çš„æœ€åä¸€ä¸ªçŠ¶æ€ï¼Œå½“å‡ºæ ˆå…ƒç´ æ˜¯æœ€å°å…ƒç´ æˆ‘ä»¬è¯¥å¦‚ä½•å¤„ç†å‘¢ï¼Ÿ</p><p>æˆ‘ä»¬åªéœ€è¦æŠŠ <code>2</code> å‡ºæ ˆï¼Œç„¶åå†å‡ºæ ˆä¸€æ¬¡ï¼ŒæŠŠ <code>3</code> èµ‹å€¼ç»™ <code>min</code> å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å‡ºæ ˆ <span class="number">2</span>     </span><br><span class="line">|   |  min = <span class="number">3</span>   </span><br><span class="line">| <span class="number">5</span> |   </span><br><span class="line">|_3_|    </span><br><span class="line">stack</span><br></pre></td></tr></table></figure><p>é€šè¿‡ä¸Šè¾¹çš„æ–¹å¼ï¼Œæˆ‘ä»¬å°±åªéœ€è¦ä¸€ä¸ªæ ˆäº†ã€‚å½“æœ‰æ›´å°çš„å€¼æ¥çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªéœ€è¦æŠŠä¹‹å‰çš„æœ€å°å€¼å…¥æ ˆï¼Œå½“å‰æ›´å°çš„å€¼å†å…¥æ ˆå³å¯ã€‚å½“è¿™ä¸ªæœ€å°å€¼è¦å‡ºæ ˆçš„æ—¶å€™ï¼Œä¸‹ä¸€ä¸ªå€¼ä¾¿æ˜¯ä¹‹å‰çš„æœ€å°å€¼äº†ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinStack</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> min = Integer.MAX_VALUE;</span><br><span class="line">    Stack&lt;Integer&gt; stack = <span class="keyword">new</span> Stack&lt;Integer&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å½“å‰å€¼æ›´å°</span></span><br><span class="line">        <span class="keyword">if</span>(x &lt;= min)&#123;   </span><br><span class="line">            <span class="comment">//å°†ä¹‹å‰çš„æœ€å°å€¼ä¿å­˜</span></span><br><span class="line">            stack.push(min);</span><br><span class="line">            <span class="comment">//æ›´æ–°æœ€å°å€¼</span></span><br><span class="line">            min=x;</span><br><span class="line">        &#125;</span><br><span class="line">        stack.push(x);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">//å¦‚æœå¼¹å‡ºçš„å€¼æ˜¯æœ€å°å€¼ï¼Œé‚£ä¹ˆå°†ä¸‹ä¸€ä¸ªå…ƒç´ æ›´æ–°ä¸ºæœ€å°å€¼</span></span><br><span class="line">        <span class="keyword">if</span>(stack.pop() == min) &#123;</span><br><span class="line">            min=stack.pop();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">top</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> stack.peek();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> min;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="è§£æ³•ä¸‰"><a href="#è§£æ³•ä¸‰" class="headerlink" title="è§£æ³•ä¸‰"></a>è§£æ³•ä¸‰</h1><p>å‚è€ƒ <a href="https://leetcode.com/problems/min-stack/discuss/49031/Share-my-Java-solution-with-ONLY-ONE-stack" target="_blank" rel="noopener">è¿™é‡Œ</a>ï¼Œå†åˆ†äº«åˆ©ç”¨ä¸€ä¸ªæ ˆçš„å¦ä¸€ç§æ€è·¯ã€‚</p><p>é€šè¿‡è§£æ³•äºŒçš„åˆ†æï¼Œæˆ‘ä»¬å…³é”®è¦è§£å†³çš„é—®é¢˜å°±æ˜¯å½“æœ‰æ–°çš„æ›´å°å€¼çš„æ—¶å€™ï¼Œä¹‹å‰çš„æœ€å°å€¼è¯¥æ€ä¹ˆåŠï¼Ÿ</p><p>è§£æ³•äºŒä¸­é€šè¿‡æŠŠä¹‹å‰çš„æœ€å°å€¼å…¥æ ˆè§£å†³é—®é¢˜ã€‚</p><p>è¿™é‡Œçš„è¯ï¼Œç”¨äº†å¦ä¸€ç§æ€è·¯ã€‚åŒæ ·æ˜¯ç”¨ä¸€ä¸ª <code>min</code> å˜é‡ä¿å­˜æœ€å°å€¼ã€‚åªä¸è¿‡æ ˆé‡Œè¾¹æˆ‘ä»¬ä¸å»ä¿å­˜åŸæ¥çš„å€¼ï¼Œè€Œæ˜¯å»å­˜å‚¨å…¥æ ˆçš„å€¼å’Œæœ€å°å€¼çš„å·®å€¼ã€‚ç„¶åå¾—åˆ°ä¹‹å‰çš„æœ€å°å€¼çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ <code>min</code> å€¼å’Œæ ˆé¡¶å…ƒç´ å¾—åˆ°ï¼Œä¸¾ä¸ªä¾‹å­ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line">å…¥æ ˆ <span class="number">3</span>ï¼Œå­˜å…¥ <span class="number">3</span> - <span class="number">3</span> = <span class="number">0</span></span><br><span class="line">|   |   min = <span class="number">3</span></span><br><span class="line">|   |     </span><br><span class="line">|_0_|    </span><br><span class="line">stack   </span><br><span class="line"></span><br><span class="line">å…¥æ ˆ <span class="number">5</span>ï¼Œå­˜å…¥ <span class="number">5</span> - <span class="number">3</span> = <span class="number">2</span></span><br><span class="line">|   |   min = <span class="number">3</span></span><br><span class="line">| <span class="number">2</span> |     </span><br><span class="line">|_0_|    </span><br><span class="line">stack  </span><br><span class="line"></span><br><span class="line">å…¥æ ˆ <span class="number">2</span>ï¼Œå› ä¸ºå‡ºç°äº†æ›´å°çš„æ•°ï¼Œæ‰€ä»¥æˆ‘ä»¬ä¼šå­˜å…¥ä¸€ä¸ªè´Ÿæ•°ï¼Œè¿™é‡Œå¾ˆå…³é”®</span><br><span class="line">ä¹Ÿå°±æ˜¯å­˜å…¥  <span class="number">2</span> - <span class="number">3</span> = -<span class="number">1</span>, å¹¶ä¸”æ›´æ–° min = <span class="number">2</span> </span><br><span class="line">å¯¹äºä¹‹å‰çš„ min å€¼ <span class="number">3</span>, æˆ‘ä»¬åªéœ€è¦ç”¨æ›´æ–°åçš„ min - æ ˆé¡¶å…ƒç´  -<span class="number">1</span> å°±å¯ä»¥å¾—åˆ°    </span><br><span class="line">| -<span class="number">1</span>|   min = <span class="number">2</span></span><br><span class="line">| <span class="number">5</span> |     </span><br><span class="line">|_3_|    </span><br><span class="line">stack  </span><br><span class="line"></span><br><span class="line">å…¥æ ˆ <span class="number">6</span>ï¼Œå­˜å…¥  <span class="number">6</span> - <span class="number">2</span> = <span class="number">4</span></span><br><span class="line">| <span class="number">4</span> |   min = <span class="number">2</span></span><br><span class="line">| -<span class="number">1</span>| </span><br><span class="line">| <span class="number">5</span> |     </span><br><span class="line">|_3_|    </span><br><span class="line">stack  </span><br><span class="line"></span><br><span class="line">å‡ºæ ˆï¼Œè¿”å›çš„å€¼å°±æ˜¯æ ˆé¡¶å…ƒç´  <span class="number">4</span> åŠ ä¸Š minï¼Œå°±æ˜¯ <span class="number">6</span></span><br><span class="line">|   |   min = <span class="number">2</span></span><br><span class="line">| -<span class="number">1</span>| </span><br><span class="line">| <span class="number">5</span> |     </span><br><span class="line">|_3_|    </span><br><span class="line">stack  </span><br><span class="line"></span><br><span class="line">å‡ºæ ˆï¼Œæ­¤æ—¶æ ˆé¡¶å…ƒç´ æ˜¯è´Ÿæ•°ï¼Œè¯´æ˜ä¹‹å‰å¯¹ min å€¼è¿›è¡Œäº†æ›´æ–°ã€‚</span><br><span class="line">å…¥æ ˆå…ƒç´  - min = æ ˆé¡¶å…ƒç´ ï¼Œå…¥æ ˆå…ƒç´ å…¶å®å°±æ˜¯å½“å‰çš„ min å€¼ <span class="number">2</span></span><br><span class="line">æ‰€ä»¥æ›´æ–°å‰çš„ min å°±ç­‰äºå…¥æ ˆå…ƒç´  <span class="number">2</span> - æ ˆé¡¶å…ƒç´ (-<span class="number">1</span>) = <span class="number">3</span></span><br><span class="line">|   | min = <span class="number">3</span></span><br><span class="line">| <span class="number">5</span> |     </span><br><span class="line">|_3_|    </span><br><span class="line">stack</span><br></pre></td></tr></table></figure><p>å†ç†ä¸€ä¸‹ä¸Šè¾¹çš„æ€è·¯ï¼Œæˆ‘ä»¬æ¯æ¬¡å­˜å…¥çš„æ˜¯ <code>åŸæ¥å€¼ - å½“å‰æœ€å°å€¼</code>ã€‚</p><p>å½“åŸæ¥å€¼å¤§äºç­‰äºå½“å‰æœ€å°å€¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬å­˜å…¥çš„è‚¯å®šå°±æ˜¯éè´Ÿæ•°ï¼Œæ‰€ä»¥å‡ºæ ˆçš„æ—¶å€™å°±æ˜¯ <code>æ ˆä¸­çš„å€¼ + å½“å‰æœ€å°å€¼</code> ã€‚</p><p>å½“åŸæ¥å€¼å°äºå½“å‰æœ€å°å€¼çš„æ—¶å€™ï¼Œæˆ‘ä»¬å­˜å…¥çš„è‚¯å®šå°±æ˜¯è´Ÿå€¼ï¼Œæ­¤æ—¶çš„å€¼æˆ‘ä»¬ä¸å…¥æ ˆï¼Œç”¨ <code>min</code> ä¿å­˜èµ·æ¥ï¼ŒåŒæ—¶å°†å·®å€¼å…¥æ ˆã€‚</p><p>å½“åç»­å¦‚æœå‡ºæ ˆå…ƒç´ æ˜¯è´Ÿæ•°çš„æ—¶å€™ï¼Œé‚£ä¹ˆè¦å‡ºæ ˆçš„å…ƒç´ å…¶å®å°±æ˜¯ <code>min</code>ã€‚æ­¤å¤–ä¹‹å‰çš„ <code>min</code> å€¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡æ ˆé¡¶çš„å€¼å’Œå½“å‰ <code>min</code> å€¼è¿›è¡Œè¿˜åŸï¼Œå°±æ˜¯ç”¨ <code>min</code> å‡å»æ ˆé¡¶å…ƒç´ å³å¯ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">MinStack</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> min;</span><br><span class="line">Stack&lt;Long&gt; stack;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="title">MinStack</span><span class="params">()</span></span>&#123;</span><br><span class="line">        stack=<span class="keyword">new</span> Stack&lt;&gt;();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (stack.isEmpty()) &#123;</span><br><span class="line">min = x;</span><br><span class="line">stack.push(x - min);</span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line">stack.push(x - min);</span><br><span class="line"><span class="keyword">if</span> (x &lt; min)&#123;</span><br><span class="line">min = x; <span class="comment">// æ›´æ–°æœ€å°å€¼</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">if</span> (stack.isEmpty())</span><br><span class="line"><span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">long</span> pop = stack.pop();</span><br><span class="line"></span><br><span class="line"><span class="comment">//å¼¹å‡ºçš„æ˜¯è´Ÿå€¼ï¼Œè¦æ›´æ–° min</span></span><br><span class="line"><span class="keyword">if</span> (pop &lt; <span class="number">0</span>) &#123;</span><br><span class="line">min = min - pop;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">top</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">long</span> top = stack.peek();</span><br><span class="line"><span class="comment">//è´Ÿæ•°çš„è¯ï¼Œå‡ºæ ˆçš„å€¼ä¿å­˜åœ¨ min ä¸­</span></span><br><span class="line"><span class="keyword">if</span> (top &lt; <span class="number">0</span>) &#123;</span><br><span class="line"><span class="keyword">return</span> (<span class="keyword">int</span>) (min);</span><br><span class="line">        <span class="comment">//å‡ºæ ˆå…ƒç´ åŠ ä¸Šæœ€å°å€¼å³å¯</span></span><br><span class="line">&#125; <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="keyword">return</span> (<span class="keyword">int</span>) (top + min);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMin</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="keyword">return</span> (<span class="keyword">int</span>) min;</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸Šè¾¹çš„è§£æ³•çš„ä¸€ä¸ªç¼ºç‚¹å°±æ˜¯ç”±äºæˆ‘ä»¬ä¿å­˜çš„æ˜¯å·®å€¼ï¼Œæ‰€ä»¥å¯èƒ½é€ æˆæº¢å‡ºï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨äº†æ•°æ®èŒƒå›´æ›´å¤§çš„ <code>long</code> ç±»å‹ã€‚</p><p>æ­¤å¤–ç›¸å¯¹äºè§£æ³•äºŒï¼Œæœ€å°å€¼éœ€è¦æ›´æ–°çš„æ—¶å€™ï¼Œæˆ‘ä»¬å¹¶æ²¡æœ‰å°†ä¹‹å‰çš„æœ€å°å€¼å­˜èµ·æ¥ï¼Œæˆ‘ä»¬æ¯æ¬¡éƒ½æ˜¯é€šè¿‡å½“å‰æœ€å°å€¼å’Œæ ˆé¡¶å…ƒç´ æ¨å‡ºäº†ä¹‹å‰çš„æœ€å°å€¼ï¼Œæ‰€ä»¥ä¼šçœä¸€äº›ç©ºé—´ã€‚</p><h1 id="è§£æ³•å››"><a href="#è§£æ³•å››" class="headerlink" title="è§£æ³•å››"></a>è§£æ³•å››</h1><p>å†åˆ†äº«ä¸€ä¸ªæœ‰è¶£çš„è§£æ³•ï¼Œå‚è€ƒ <a href="https://leetcode.com/problems/min-stack/discuss/49217/6ms-Java-Solution-using-Linked-List.-Clean-self-explanatory-and-efficient." target="_blank" rel="noopener">è¿™é‡Œ</a> ã€‚</p><p>å›åˆ°æœ€åˆçš„ç–‘è™‘ï¼Œæˆ‘ä»¬è¦ä¸è¦ç”¨ <code>java</code> æä¾›çš„ <code>stack</code> ã€‚å¦‚æœä¸ç”¨çš„è¯ï¼Œå¯ä»¥æ€ä¹ˆåšçš„ï¼Ÿ</p><p>ç›´æ¥ç”¨ä¸€ä¸ªé“¾è¡¨å³å¯å®ç°æ ˆçš„åŸºæœ¬åŠŸèƒ½ï¼Œé‚£ä¹ˆæœ€å°å€¼è¯¥æ€ä¹ˆå¾—åˆ°å‘¢ï¼Ÿæˆ‘ä»¬å¯ä»¥åœ¨ <code>Node</code> èŠ‚ç‚¹ä¸­å¢åŠ ä¸€ä¸ª <code>min</code> å­—æ®µï¼Œè¿™æ ·çš„è¯æ¯æ¬¡åŠ å…¥ä¸€ä¸ªèŠ‚ç‚¹çš„æ—¶å€™ï¼Œæˆ‘ä»¬åŒæ—¶åªè¦ç¡®å®šå®ƒçš„ <code>min</code> å€¼å³å¯ã€‚</p><p>ä»£ç å¾ˆç®€æ´ï¼Œæˆ‘ç›´æ¥æŠŠä»£ç è´´è¿‡æ¥å§ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MinStack</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Node</span></span>&#123;</span><br><span class="line">        <span class="keyword">int</span> value;</span><br><span class="line">        <span class="keyword">int</span> min;</span><br><span class="line">        Node next;</span><br><span class="line"></span><br><span class="line">        Node(<span class="keyword">int</span> x, <span class="keyword">int</span> min)&#123;</span><br><span class="line">            <span class="keyword">this</span>.value=x;</span><br><span class="line">            <span class="keyword">this</span>.min=min;</span><br><span class="line">            next = <span class="keyword">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Node head;</span><br><span class="line">    <span class="comment">//æ¯æ¬¡åŠ å…¥çš„èŠ‚ç‚¹æ”¾åˆ°å¤´éƒ¨</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">null</span>==head)&#123;</span><br><span class="line">            head = <span class="keyword">new</span> Node(x,x);</span><br><span class="line">        &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="comment">//å½“å‰å€¼å’Œä¹‹å‰å¤´ç»“ç‚¹çš„æœ€å°å€¼è¾ƒå°çš„åšä¸ºå½“å‰çš„ min</span></span><br><span class="line">            Node n = <span class="keyword">new</span> Node(x, Math.min(x,head.min));</span><br><span class="line">            n.next=head;</span><br><span class="line">            head=n;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">pop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head!=<span class="keyword">null</span>)</span><br><span class="line">            head =head.next;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">top</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(head!=<span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> head.value;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getMin</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">null</span>!=head)</span><br><span class="line">            <span class="keyword">return</span> head.min;</span><br><span class="line">        <span class="keyword">return</span> -<span class="number">1</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h1><p>è™½ç„¶é¢˜ç›®æ¯”è¾ƒç®€å•ï¼Œä½†è§£æ³•äºŒå’Œè§£æ³•ä¸‰çœŸçš„è®©äººè€³ç›®ä¸€æ–°ï¼Œä¸€ä¸ªé€šè¿‡å­˜å‚¨ï¼Œä¸€ä¸ªé€šè¿‡å·®å€¼è§£å†³äº†ã€Œä¿å­˜ä¹‹å‰å€¼ã€çš„é—®é¢˜ï¼Œæ€è·¯å¾ˆå€¼å¾—å€Ÿé‰´ã€‚è§£æ³•å››æ›´åƒé™ç»´æ‰“å‡»ä¸€æ ·ï¼Œå›åˆ°æ”¹åº•å±‚æ•°æ®ç»“æ„ï¼Œä»è€Œæ›´åŠ ç®€æ´çš„è§£å†³äº†é—®é¢˜ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è®¾è®¡ä¸€ä¸ªæ”¯æŒ push ï¼Œpop ï¼Œtop æ“ä½œï¼Œå¹¶èƒ½åœ¨å¸¸æ•°æ—¶é—´å†…æ£€ç´¢åˆ°æœ€å°å…ƒç´ çš„æ ˆã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´7æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B47%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Stack" scheme="http://yoursite.com/tags/Stack/"/>
    
      <category term="Design" scheme="http://yoursite.com/tags/Design/"/>
    
  </entry>
  
  <entry>
    <title>240. æœç´¢äºŒç»´çŸ©é˜µII</title>
    <link href="http://yoursite.com/2020/06/30/240.%20%E6%90%9C%E7%B4%A2%E4%BA%8C%E7%BB%B4%E7%9F%A9%E9%98%B5II/"/>
    <id>http://yoursite.com/2020/06/30/240. æœç´¢äºŒç»´çŸ©é˜µII/</id>
    <published>2020-06-30T14:52:12.000Z</published>
    <updated>2020-06-30T16:10:49.197Z</updated>
    
    <content type="html"><![CDATA[<p>ç¼–å†™ä¸€ä¸ªé«˜æ•ˆçš„ç®—æ³•æ¥æœç´¢ m x n çŸ©é˜µ matrix ä¸­çš„ä¸€ä¸ªç›®æ ‡å€¼ targetã€‚</p><a id="more"></a><p>ç¼–å†™ä¸€ä¸ªé«˜æ•ˆçš„ç®—æ³•æ¥æœç´¢ m x n çŸ©é˜µ matrix ä¸­çš„ä¸€ä¸ªç›®æ ‡å€¼ targetã€‚è¯¥çŸ©é˜µå…·æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š</p><p>æ¯è¡Œçš„å…ƒç´ ä»å·¦åˆ°å³å‡åºæ’åˆ—ã€‚<br>æ¯åˆ—çš„å…ƒç´ ä»ä¸Šåˆ°ä¸‹å‡åºæ’åˆ—ã€‚<br>ç¤ºä¾‹:</p><pre><code>ç°æœ‰çŸ©é˜µ matrix å¦‚ä¸‹ï¼š[  [1,   4,  7, 11, 15],  [2,   5,  8, 12, 19],  [3,   6,  9, 16, 22],  [10, 13, 14, 17, 24],  [18, 21, 23, 26, 30]]ç»™å®š target = 5ï¼Œè¿”å› trueã€‚ç»™å®š target = 20ï¼Œè¿”å› falseã€‚</code></pre><p>è¿™é“é¢˜å‡ºçš„ä¸å¥½ï¼Œå› ä¸ºå¯ä»¥ç”¨74.æœç´¢äºŒç»´çŸ©é˜µé¢˜ä¸€æ ·çš„æ–¹æ³•ä»å·¦ä¸‹è§’æœç´¢æ¥è§£å†³ã€‚</p><h1 id="ä»å·¦ä¸‹è§’å¼€å§‹æœç´¢"><a href="#ä»å·¦ä¸‹è§’å¼€å§‹æœç´¢" class="headerlink" title="ä»å·¦ä¸‹è§’å¼€å§‹æœç´¢"></a>ä»å·¦ä¸‹è§’å¼€å§‹æœç´¢</h1><p>å› ä¸ºçŸ©é˜µçš„è¡Œå’Œåˆ—æ˜¯æ’åºçš„ï¼ˆåˆ†åˆ«ä»å·¦åˆ°å³å’Œä»ä¸Šåˆ°ä¸‹ï¼‰ï¼Œæ‰€ä»¥åœ¨æŸ¥çœ‹ä»»ä½•ç‰¹å®šå€¼æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä¿®å‰ªO(m)æˆ–O(n)å…ƒç´ ã€‚</p><p>ç®—æ³•ï¼š</p><p>é¦–å…ˆï¼Œæˆ‘ä»¬åˆå§‹åŒ–ä¸€ä¸ªæŒ‡å‘çŸ©é˜µå·¦ä¸‹è§’çš„ (rowï¼Œcol) æŒ‡é’ˆã€‚ç„¶åï¼Œç›´åˆ°æ‰¾åˆ°ç›®æ ‡å¹¶è¿”å› trueï¼ˆæˆ–è€…æŒ‡é’ˆæŒ‡å‘çŸ©é˜µç»´åº¦ä¹‹å¤–çš„ (rowï¼Œcol) ä¸ºæ­¢ï¼Œæˆ‘ä»¬æ‰§è¡Œä»¥ä¸‹æ“ä½œï¼š</p><p>å¦‚æœå½“å‰æŒ‡å‘çš„å€¼å¤§äºç›®æ ‡å€¼ï¼Œåˆ™å¯ä»¥ â€œå‘ä¸Šâ€ ç§»åŠ¨ä¸€è¡Œã€‚ </p><p>å¦åˆ™ï¼Œå¦‚æœå½“å‰æŒ‡å‘çš„å€¼å°äºç›®æ ‡å€¼ï¼Œåˆ™å¯ä»¥ç§»åŠ¨ä¸€åˆ—ã€‚ä¸éš¾ç†è§£ä¸ºä»€ä¹ˆè¿™æ ·åšæ°¸è¿œä¸ä¼šåˆ å‡æ­£ç¡®çš„ç­”æ¡ˆï¼›å› ä¸ºè¡Œæ˜¯ä»å·¦åˆ°å³æ’åºçš„ï¼Œæ‰€ä»¥æˆ‘ä»¬çŸ¥é“å½“å‰å€¼å³ä¾§çš„æ¯ä¸ªå€¼éƒ½è¾ƒå¤§ã€‚ </p><p>å› æ­¤ï¼Œå¦‚æœå½“å‰å€¼å·²ç»å¤§äºç›®æ ‡å€¼ï¼Œæˆ‘ä»¬çŸ¥é“å®ƒå³è¾¹çš„æ¯ä¸ªå€¼ä¼šæ¯”è¾ƒå¤§ã€‚ä¹Ÿå¯ä»¥å¯¹åˆ—è¿›è¡Œéå¸¸ç±»ä¼¼çš„è®ºè¯ï¼Œå› æ­¤è¿™ç§æœç´¢æ–¹å¼å°†å§‹ç»ˆåœ¨çŸ©é˜µä¸­æ‰¾åˆ°ç›®æ ‡ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public boolean searchMatrix(int[][] matrix, int target) &#123;</span><br><span class="line">//        äºŒç»´æ•°ç»„ä¸ºç©ºï¼Œè¦æ£€æŸ¥ä¸‰ä¸ªéƒ¨åˆ†:</span><br><span class="line">//        ä¸€æ˜¯æ•°ç»„é¦–åœ°å€æ˜¯å¦ä¸ºç©º</span><br><span class="line">//        äºŒæ˜¯æ˜¯å¦ä¸º&#123;&#125;ï¼Œä¹Ÿå°±æ˜¯array.length==0çš„æƒ…å†µ</span><br><span class="line">//        ä¸‰æ˜¯&#123;&#123;&#125;&#125;ï¼Œè¿™æ—¶array.length=1ï¼Œä½†æ˜¯array[0].length==0ã€‚æ»¡è¶³ä»»æ„ä¸€ä¸ªæ¡ä»¶å°±å¯ä»¥è¿”å›falseäº†ã€‚</span><br><span class="line">        if (matrix == null || matrix.length == 0 || matrix[0].length == 0) return false;</span><br><span class="line">        int row = matrix.length;</span><br><span class="line">        int col = matrix[0].length;</span><br><span class="line">        int rowindex = row - 1;</span><br><span class="line">        int colindex = 0;</span><br><span class="line"></span><br><span class="line">        while (colindex &lt; col &amp;&amp; rowindex &gt;= 0) &#123;</span><br><span class="line">            if (target == matrix[rowindex][colindex]) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125; else if (target &gt; matrix[rowindex][colindex]) &#123;</span><br><span class="line">                colindex++;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                rowindex--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>å…¶å®ƒæ–¹æ³•è§<a href="https://leetcode-cn.com/problems/search-a-2d-matrix-ii/solution/sou-suo-er-wei-ju-zhen-ii-by-leetcode-2/" target="_blank" rel="noopener">^1</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¼–å†™ä¸€ä¸ªé«˜æ•ˆçš„ç®—æ³•æ¥æœç´¢ m x n çŸ©é˜µ matrix ä¸­çš„ä¸€ä¸ªç›®æ ‡å€¼ targetã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Binary Search" scheme="http://yoursite.com/tags/Binary-Search/"/>
    
      <category term="Divide and Conquer" scheme="http://yoursite.com/tags/Divide-and-Conquer/"/>
    
  </entry>
  
  <entry>
    <title>74. æœç´¢äºŒç»´çŸ©é˜µ</title>
    <link href="http://yoursite.com/2020/06/30/74.%20%E6%90%9C%E7%B4%A2%E4%BA%8C%E7%BB%B4%E7%9F%A9%E9%98%B5/"/>
    <id>http://yoursite.com/2020/06/30/74. æœç´¢äºŒç»´çŸ©é˜µ/</id>
    <published>2020-06-30T14:52:12.000Z</published>
    <updated>2020-06-30T16:11:22.253Z</updated>
    
    <content type="html"><![CDATA[<p>ç¼–å†™ä¸€ä¸ªé«˜æ•ˆçš„ç®—æ³•æ¥åˆ¤æ–­ m x n çŸ©é˜µä¸­ï¼Œæ˜¯å¦å­˜åœ¨ä¸€ä¸ªç›®æ ‡å€¼ã€‚</p><a id="more"></a><p>è¯¥çŸ©é˜µå…·æœ‰å¦‚ä¸‹ç‰¹æ€§ï¼š</p><p>æ¯è¡Œä¸­çš„æ•´æ•°ä»å·¦åˆ°å³æŒ‰å‡åºæ’åˆ—ã€‚<br>æ¯è¡Œçš„ç¬¬ä¸€ä¸ªæ•´æ•°å¤§äºå‰ä¸€è¡Œçš„æœ€åä¸€ä¸ªæ•´æ•°ã€‚<br>ç¤ºä¾‹ 1:</p><pre><code>è¾“å…¥:matrix = [  [1,   3,  5,  7],  [10, 11, 16, 20],  [23, 30, 34, 50]]</code></pre><p>target = 3<br>è¾“å‡º: true<br>ç¤ºä¾‹ 2:</p><pre><code>è¾“å…¥:matrix = [  [1,   3,  5,  7],  [10, 11, 16, 20],  [23, 30, 34, 50]]target = 13è¾“å‡º: false</code></pre><h1 id="ä»å·¦ä¸‹è§’å¼€å§‹æœç´¢"><a href="#ä»å·¦ä¸‹è§’å¼€å§‹æœç´¢" class="headerlink" title="ä»å·¦ä¸‹è§’å¼€å§‹æœç´¢"></a>ä»å·¦ä¸‹è§’å¼€å§‹æœç´¢</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public boolean searchMatrix(int[][] matrix, int target) &#123;</span><br><span class="line">//        äºŒç»´æ•°ç»„ä¸ºç©ºï¼Œè¦æ£€æŸ¥ä¸‰ä¸ªéƒ¨åˆ†:</span><br><span class="line">//        ä¸€æ˜¯æ•°ç»„é¦–åœ°å€æ˜¯å¦ä¸ºç©º</span><br><span class="line">//        äºŒæ˜¯æ˜¯å¦ä¸º&#123;&#125;ï¼Œä¹Ÿå°±æ˜¯array.length==0çš„æƒ…å†µ</span><br><span class="line">//        ä¸‰æ˜¯&#123;&#123;&#125;&#125;ï¼Œè¿™æ—¶array.length=1ï¼Œä½†æ˜¯array[0].length==0ã€‚æ»¡è¶³ä»»æ„ä¸€ä¸ªæ¡ä»¶å°±å¯ä»¥è¿”å›falseäº†ã€‚</span><br><span class="line">        if (matrix == null || matrix.length == 0 || matrix[0].length == 0) return false;</span><br><span class="line">        int row = matrix.length;</span><br><span class="line">        int col = matrix[0].length;</span><br><span class="line">        int rowindex = row - 1;</span><br><span class="line">        int colindex = 0;</span><br><span class="line"></span><br><span class="line">        while (colindex &lt; col &amp;&amp; rowindex &gt;= 0) &#123;</span><br><span class="line">            if (target == matrix[rowindex][colindex]) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125; else if (target &gt; matrix[rowindex][colindex]) &#123;</span><br><span class="line">                colindex++;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                rowindex--;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ–¹æ³•ï¼šäºŒåˆ†æŸ¥æ‰¾"><a href="#æ–¹æ³•ï¼šäºŒåˆ†æŸ¥æ‰¾" class="headerlink" title="æ–¹æ³•ï¼šäºŒåˆ†æŸ¥æ‰¾"></a>æ–¹æ³•ï¼šäºŒåˆ†æŸ¥æ‰¾</h1><p><strong>ç›´è§‰</strong></p><p>æ³¨æ„åˆ°è¾“å…¥çš„ <code>m x n</code> çŸ©é˜µå¯ä»¥è§†ä¸ºé•¿åº¦ä¸º <code>m x n</code>çš„æœ‰åºæ•°ç»„ã€‚</p><p> <a href="https://pic.leetcode-cn.com/d9b47b40a4de17b0c56446b0a4935a5042490ea1d92a6f4c529c2aaa0095c189-287711dcb87bd4d4681fa117f792d1baaaa7ce3e2c65d6a4f6439c0cbbb0345e-image.png" target="_blank" rel="noopener">äºŒåˆ†æŸ¥æ‰¾</a></p><p>ç”±äºè¯¥ <em>è™š</em> æ•°ç»„çš„åºå·å¯ä»¥ç”±ä¸‹å¼æ–¹ä¾¿åœ°è½¬åŒ–ä¸ºåŸçŸ©é˜µä¸­çš„è¡Œå’Œåˆ— (<em>æˆ‘ä»¬å½“ç„¶ä¸ä¼šçœŸçš„åˆ›å»ºä¸€ä¸ªæ–°æ•°ç»„</em>) ï¼Œè¯¥æœ‰åºæ•°ç»„éå¸¸é€‚åˆäºŒåˆ†æŸ¥æ‰¾ã€‚</p><blockquote><p><code>row = idx // n</code> ï¼Œ <code>col = idx % n</code>ã€‚</p></blockquote><p><strong>ç®—æ³•</strong></p><p>è¿™æ˜¯ä¸€ä¸ªæ ‡å‡†äºŒåˆ†æŸ¥æ‰¾ç®—æ³• : </p><ul><li><p>åˆå§‹åŒ–å·¦å³åºå·<br><code>left = 0</code> å’Œ <code>right = m x n - 1</code>ã€‚</p></li><li><p>While <code>left &lt; right</code> :</p><ul><li><p>é€‰å–è™šæ•°ç»„æœ€ä¸­é—´çš„åºå·ä½œä¸ºä¸­é—´åºå·: <code>pivot_idx = (left + right) / 2</code>ã€‚</p></li><li><p>è¯¥åºå·å¯¹åº”äºåŸçŸ©é˜µä¸­çš„ <code>row = pivot_idx // n</code>è¡Œ <code>col = pivot_idx % n</code> åˆ—, ç”±æ­¤å¯ä»¥æ‹¿åˆ°ä¸­é—´å…ƒç´ <code>pivot_element</code>ã€‚è¯¥å…ƒç´ å°†è™šæ•°ç»„åˆ†ä¸ºä¸¤éƒ¨åˆ†ã€‚</p></li><li><p>æ¯”è¾ƒ <code>pivot_element</code> ä¸ <code>target</code> ä»¥ç¡®å®šåœ¨å“ªä¸€éƒ¨åˆ†è¿›è¡Œè¿›ä¸€æ­¥æŸ¥æ‰¾ã€‚</p></li></ul></li></ul><p><strong>å®ç°</strong></p><figure class="highlight java"><figcaption><span>[solution1]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">searchMatrix</span><span class="params">(<span class="keyword">int</span>[][] matrix, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m = matrix.length;</span><br><span class="line">    <span class="keyword">if</span> (m == <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">int</span> n = matrix[<span class="number">0</span>].length;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// äºŒåˆ†æŸ¥æ‰¾</span></span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = m * n - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> pivotIdx, pivotElement;</span><br><span class="line">    <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">      pivotIdx = (left + right) / <span class="number">2</span>;</span><br><span class="line">      pivotElement = matrix[pivotIdx / n][pivotIdx % n];</span><br><span class="line">      <span class="keyword">if</span> (target == pivotElement) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (target &lt; pivotElement) right = pivotIdx - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> left = pivotIdx + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>[solution1]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">searchMatrix</span><span class="params">(self, matrix: List[List[int]], target: int)</span> -&gt; bool:</span></span><br><span class="line">        m = len(matrix)</span><br><span class="line">        <span class="keyword">if</span> m == <span class="number">0</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        n = len(matrix[<span class="number">0</span>])</span><br><span class="line">        </span><br><span class="line">        <span class="comment">#äºŒåˆ†æŸ¥æ‰¾</span></span><br><span class="line">        left, right = <span class="number">0</span>, m * n - <span class="number">1</span></span><br><span class="line">        <span class="keyword">while</span> left &lt;= right:</span><br><span class="line">                pivot_idx = (left + right) // <span class="number">2</span></span><br><span class="line">                pivot_element = matrix[pivot_idx // n][pivot_idx % n]</span><br><span class="line">                <span class="keyword">if</span> target == pivot_element:</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="keyword">if</span> target &lt; pivot_element:</span><br><span class="line">                        right = pivot_idx - <span class="number">1</span></span><br><span class="line">                    <span class="keyword">else</span>:</span><br><span class="line">                        left = pivot_idx + <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">False</span></span><br></pre></td></tr></table></figure><figure class="highlight c++"><figcaption><span>[solution1]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line">  <span class="keyword">public</span>:</span><br><span class="line">  <span class="function"><span class="keyword">bool</span> <span class="title">searchMatrix</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt;&amp; matrix, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> m = matrix.size();</span><br><span class="line">    <span class="keyword">if</span> (m == <span class="number">0</span>) <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">int</span> n = matrix[<span class="number">0</span>].size();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// äºŒåˆ†æŸ¥æ‰¾</span></span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = m * n - <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">int</span> pivotIdx, pivotElement;</span><br><span class="line">    <span class="keyword">while</span> (left &lt;= right) &#123;</span><br><span class="line">      pivotIdx = (left + right) / <span class="number">2</span>;</span><br><span class="line">      pivotElement = matrix[pivotIdx / n][pivotIdx % n];</span><br><span class="line">      <span class="keyword">if</span> (target == pivotElement) <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">      <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (target &lt; pivotElement) right = pivotIdx - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">else</span> left = pivotIdx + <span class="number">1</span>;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ : ç”±äºæ˜¯æ ‡å‡†çš„äºŒåˆ†æŸ¥æ‰¾ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(log(mn)) ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ : <em>O(1)</em>ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç¼–å†™ä¸€ä¸ªé«˜æ•ˆçš„ç®—æ³•æ¥åˆ¤æ–­ m x n çŸ©é˜µä¸­ï¼Œæ˜¯å¦å­˜åœ¨ä¸€ä¸ªç›®æ ‡å€¼ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Binary Search" scheme="http://yoursite.com/tags/Binary-Search/"/>
    
  </entry>
  
  <entry>
    <title>334. é€’å¢çš„ä¸‰å…ƒå­åºåˆ—</title>
    <link href="http://yoursite.com/2020/06/30/334.%E9%80%92%E5%A2%9E%E7%9A%84%E4%B8%89%E5%85%83%E5%AD%90%E5%BA%8F%E5%88%97/"/>
    <id>http://yoursite.com/2020/06/30/334.é€’å¢çš„ä¸‰å…ƒå­åºåˆ—/</id>
    <published>2020-06-30T12:52:12.000Z</published>
    <updated>2020-06-30T13:09:57.486Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæœªæ’åºçš„æ•°ç»„ï¼Œåˆ¤æ–­è¿™ä¸ªæ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨é•¿åº¦ä¸º 3 çš„é€’å¢å­åºåˆ—ã€‚</p><a id="more"></a><p>æ•°å­¦è¡¨è¾¾å¼å¦‚ä¸‹:</p><p>å¦‚æœå­˜åœ¨è¿™æ ·çš„ i, j, k,  ä¸”æ»¡è¶³ 0 â‰¤ i &lt; j &lt; k â‰¤ n-1ï¼Œ<br>ä½¿å¾— arr[i] &lt; arr[j] &lt; arr[k] ï¼Œè¿”å› true ; å¦åˆ™è¿”å› false ã€‚<br>è¯´æ˜: è¦æ±‚ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼Œç©ºé—´å¤æ‚åº¦ä¸º O(1) ã€‚</p><p>ç¤ºä¾‹ 1:</p><pre><code>è¾“å…¥: [1,2,3,4,5]è¾“å‡º: true</code></pre><p>ç¤ºä¾‹ 2:</p><pre><code>è¾“å…¥: [5,4,3,2,1]è¾“å‡º: false</code></pre><h1 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h1><ol><li>ç¬¬ä¸€ç§æ–¹æ³•é‡‡ç”¨äº†åŒæŒ‡é’ˆçš„æ€æƒ³ï¼Œé’ˆå¯¹è¿™ä¸ªé¢˜çš„ä¸‰å…ƒå­åºåˆ—ï¼Œå¦‚æœæ˜¯å››å…ƒæˆ–æ›´é«˜å…ƒåˆ™ä¸é€šç”¨ã€‚ä¸»è¦æ€è·¯æ˜¯ç»´æŠ¤å½“å‰è®¿é—®æ•°ç»„çš„æœ€å°å€¼å’Œæœ€å°å€¼å³ä¾§å¤§äºæœ€å°å€¼çš„æœ€å°çš„ä¸€ä¸ªã€‚å…·ä½“æ­¥éª¤é¡ºåºéå†æ•°ç»„ï¼Œé¦–å…ˆç¡®å®šå½“å‰å·²è®¿é—®çš„æ•°ç»„çš„æœ€å°å€¼ï¼Œå³å¦‚æœå°äºç­‰äºminå€¼çš„è¯æ›´æ–°minå€¼ï¼Œå¦‚æœå¤§äºminï¼Œåˆ¤æ–­æ˜¯å¦å°äºç­‰äºmaxå€¼ï¼Œå¦‚æœæ˜¯ï¼Œæ›´æ–°maxå€¼ã€‚å¦‚æœå¤§äºmaxå€¼ï¼Œåˆ™è¯´æ˜æœ‰ä¸‰å…ƒå­åºåˆ—ã€‚</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">increasingTriplet</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> min = Integer.MAX_VALUE, max = Integer.MAX_VALUE;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> num: nums)&#123;</span><br><span class="line">            <span class="keyword">if</span>(num &lt;= min)&#123;</span><br><span class="line">                min = num;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span>(num &lt;= max)&#123;</span><br><span class="line">                max = num;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><ol start="2"><li>ç¬¬äºŒç§æ–¹æ³•æ˜¯åŠ¨æ€è§„åˆ’çš„æ€æƒ³ï¼Œä¸»è¦æ€è·¯æ˜¯ç»´æŠ¤å’Œæ›´æ–°ä»¥iä¸ºç»“å°¾çš„ä¸‰å…ƒå­åºåˆ—çš„æœ€é•¿é€’å¢é•¿åº¦ã€‚è½¬ç§»æ–¹ç¨‹ä¸ºdp[i] = max{dp[i], dp[j] + 1} (0&lt;=j&lt;i).</li></ol><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">increasingTriplet</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(nums == <span class="keyword">null</span> || nums.length == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++)&#123;</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; i; j++)&#123;</span><br><span class="line">                <span class="keyword">if</span>(nums[i] &gt; nums[j])&#123;</span><br><span class="line">                    dp[i] = Math.max(dp[i], dp[j] + <span class="number">1</span>);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(dp[i] &gt;= <span class="number">2</span>) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™å®šä¸€ä¸ªæœªæ’åºçš„æ•°ç»„ï¼Œåˆ¤æ–­è¿™ä¸ªæ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨é•¿åº¦ä¸º 3 çš„é€’å¢å­åºåˆ—ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
  </entry>
  
  <entry>
    <title>350. ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†II</title>
    <link href="http://yoursite.com/2020/06/29/350.%20%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%BB%84%E7%9A%84%E4%BA%A4%E9%9B%86II/"/>
    <id>http://yoursite.com/2020/06/29/350. ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†II/</id>
    <published>2020-06-29T15:52:12.000Z</published>
    <updated>2020-06-30T13:09:41.642Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™å®šä¸¤ä¸ªæ•°ç»„ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—å®ƒä»¬çš„äº¤é›†ã€‚</p><a id="more"></a><p>ç¤ºä¾‹ 1:</p><pre><code>è¾“å…¥: nums1 = [1,2,2,1], nums2 = [2,2]è¾“å‡º: [2,2]</code></pre><p>ç¤ºä¾‹ 2:</p><pre><code>è¾“å…¥: nums1 = [4,9,5], nums2 = [9,4,9,8,4]è¾“å‡º: [4,9]</code></pre><p>è¯´æ˜ï¼š</p><pre><code>è¾“å‡ºç»“æœä¸­æ¯ä¸ªå…ƒç´ å‡ºç°çš„æ¬¡æ•°ï¼Œåº”ä¸å…ƒç´ åœ¨ä¸¤ä¸ªæ•°ç»„ä¸­å‡ºç°çš„æ¬¡æ•°ä¸€è‡´ã€‚æˆ‘ä»¬å¯ä»¥ä¸è€ƒè™‘è¾“å‡ºç»“æœçš„é¡ºåºã€‚</code></pre><p>è¿›é˜¶:</p><pre><code>å¦‚æœç»™å®šçš„æ•°ç»„å·²ç»æ’å¥½åºå‘¢ï¼Ÿä½ å°†å¦‚ä½•ä¼˜åŒ–ä½ çš„ç®—æ³•ï¼Ÿå¦‚æœ nums1 çš„å¤§å°æ¯” nums2 å°å¾ˆå¤šï¼Œå“ªç§æ–¹æ³•æ›´ä¼˜ï¼Ÿå¦‚æœ nums2 çš„å…ƒç´ å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œç£ç›˜å†…å­˜æ˜¯æœ‰é™çš„ï¼Œå¹¶ä¸”ä½ ä¸èƒ½ä¸€æ¬¡åŠ è½½æ‰€æœ‰çš„å…ƒç´ åˆ°å†…å­˜ä¸­ï¼Œä½ è¯¥æ€ä¹ˆåŠï¼Ÿ</code></pre><h1 id="æ–¹æ³•ä¸€ï¼šå“ˆå¸Œæ˜ å°„"><a href="#æ–¹æ³•ä¸€ï¼šå“ˆå¸Œæ˜ å°„" class="headerlink" title="æ–¹æ³•ä¸€ï¼šå“ˆå¸Œæ˜ å°„"></a>æ–¹æ³•ä¸€ï¼šå“ˆå¸Œæ˜ å°„</h1><p>å‰é¢çš„é—®é¢˜ <a href="https://leetcode-cn.com/problems/intersection-of-two-arrays/" target="_blank" rel="noopener">349. ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†</a>ï¼Œæˆ‘ä»¬ä½¿ç”¨ <code>set</code> æ¥å®ç°çº¿æ€§æ—¶é—´å¤æ‚åº¦ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬éœ€è¦ä½¿ç”¨ <code>HashMap</code> æ¥è·Ÿè¸ªæ¯ä¸ªæ•°å­—å‡ºç°çš„æ¬¡æ•°ã€‚</p><p>æˆ‘ä»¬å…ˆåœ¨ <code>HashMap</code> è®°å½•ä¸€ä¸ªæ•°ç»„ä¸­çš„å­˜åœ¨çš„æ•°å­—å’Œå¯¹åº”å‡ºç°çš„æ¬¡æ•°ã€‚ç„¶åï¼Œæˆ‘ä»¬éå†ç¬¬äºŒä¸ªæ•°ç»„ï¼Œæ£€æŸ¥æ•°å­—åœ¨ <code>HashMap</code> ä¸­æ˜¯å¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨ä¸”è®¡æ•°ä¸ºæ­£ï¼Œåˆ™å°†è¯¥æ•°å­—æ·»åŠ åˆ°ç­”æ¡ˆå¹¶å‡å°‘ <code>HashMap</code> ä¸­çš„è®¡æ•°ã€‚<br> <a href="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMzUwLzM1MF9hcHByb2FjaDEtdjIucG5n?x-oss-process=image/format,png" target="_blank" rel="noopener">å“ˆå¸Œæ˜ å°„</a><br>æ£€æŸ¥æ•°ç»„çš„å¤§å°å¹¶å¯¹è¾ƒå°çš„æ•°ç»„è¿›è¡Œå“ˆå¸Œæ˜ å°„æ˜¯ä¸€ä¸ªå°ç»†èŠ‚ï¼Œå½“å…¶ä¸­ä¸€ä¸ªæ•°ç»„è¾ƒå¤§æ—¶ï¼Œä¼šå‡å°‘å†…å­˜çš„ä½¿ç”¨ã€‚</p><p><strong>ç®—æ³•ï¼š</strong></p><ul><li>å¦‚æœ <code>nums1</code> å…ƒç´ ä¸ªæ•°å¤§äº <code>nums2</code>ï¼Œåˆ™äº¤æ¢æ•°ç»„å…ƒç´ ã€‚</li><li>å¯¹äº <code>nums1</code> çš„æ¯ä¸ªå…ƒç´ ï¼Œæ·»åŠ åˆ° <code>HashMap m</code> ä¸­ï¼Œå¦‚æœå…ƒç´ å·²ç»å­˜åœ¨åˆ™å¢åŠ å¯¹åº”çš„è®¡æ•°ã€‚</li><li>åˆå§‹åŒ– <code>k = 0</code>ï¼Œè®°å½•å½“å‰äº¤é›†å…ƒç´ ä¸ªæ•°ã€‚</li><li>éå†æ•°ç»„ <code>nums2</code>ï¼š<ul><li>æ£€æŸ¥å…ƒç´ åœ¨ <code>m</code> æ˜¯å¦å­˜åœ¨ï¼Œè‹¥å­˜åœ¨ä¸”è®¡æ•°ä¸ºæ­£ï¼š<ul><li>å°†å…ƒç´ æ‹·è´åˆ° <code>nums1[k]</code>ï¼Œä¸” <code>k++</code>ã€‚</li><li>å‡å°‘ <code>m</code> ä¸­å¯¹åº”å…ƒç´ çš„è®¡æ•°ã€‚</li></ul></li></ul></li><li>è¿”å› <code>nums1</code> å‰ <code>k</code> ä¸ªå…ƒç´ ã€‚</li></ul><figure class="highlight c++"><figcaption><span>[solution1-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; intersect(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums2) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums1.size() &gt; nums2.size()) &#123;</span><br><span class="line">        <span class="keyword">return</span> intersect(nums2, nums1);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt; m;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> n : nums1) &#123;</span><br><span class="line">        ++m[n];</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">auto</span> n : nums2) &#123;</span><br><span class="line">        <span class="keyword">auto</span> it = m.find(n);</span><br><span class="line">        <span class="keyword">if</span> (it != end(m) &amp;&amp; --it-&gt;second &gt;= <span class="number">0</span>) &#123;</span><br><span class="line">            nums1[k++] = n;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">vector</span>(begin(nums1), begin(nums1) + k);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><figcaption><span>[solution1-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] intersect(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2) &#123;</span><br><span class="line">    <span class="keyword">if</span> (nums1.length &gt; nums2.length) &#123;</span><br><span class="line">        <span class="keyword">return</span> intersect(nums2, nums1);</span><br><span class="line">    &#125;</span><br><span class="line">    HashMap&lt;Integer, Integer&gt; m = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> n : nums1) &#123;</span><br><span class="line">        m.put(n, m.getOrDefault(n, <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">int</span> k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> n : nums2) &#123;</span><br><span class="line">        <span class="keyword">int</span> cnt = m.getOrDefault(n, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">if</span> (cnt &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            nums1[k++] = n;</span><br><span class="line">            m.put(n, cnt - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Arrays.copyOfRange(nums1, <span class="number">0</span>, k);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šO(n+m) ã€‚å…¶ä¸­ <em>n</em>ï¼Œ<em>m</em> åˆ†åˆ«ä»£è¡¨äº†æ•°ç»„çš„å¤§å°ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼šO(min(n,m)) ï¼Œæˆ‘ä»¬å¯¹è¾ƒå°çš„æ•°ç»„è¿›è¡Œå“ˆå¸Œæ˜ å°„ä½¿ç”¨çš„ç©ºé—´ã€‚</li></ul><h1 id="æ–¹æ³•äºŒï¼šæ’åº"><a href="#æ–¹æ³•äºŒï¼šæ’åº" class="headerlink" title="æ–¹æ³•äºŒï¼šæ’åº"></a>æ–¹æ³•äºŒï¼šæ’åº</h1><p>å½“è¾“å…¥æ•°æ®æ˜¯æœ‰åºçš„ï¼Œæ¨èä½¿ç”¨æ­¤æ–¹æ³•ã€‚åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬å¯¹ä¸¤ä¸ªæ•°ç»„è¿›è¡Œæ’åºï¼Œå¹¶ä¸”ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆåœ¨ä¸€æ¬¡æ‰«é¢æ‰¾å‡ºå…¬å…±çš„æ•°å­—ã€‚<br> <a href="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMzUwLzM1MF9hcHByb2FjaDItdjIucG5n?x-oss-process=image/format,png" target="_blank" rel="noopener">æ’åº</a></p><p><strong>ç®—æ³•ï¼š</strong></p><ul><li>å¯¹æ•°ç»„ <code>nums1</code> å’Œ <code>nums2</code> æ’åºã€‚</li><li>åˆå§‹åŒ–æŒ‡é’ˆ <code>i</code>ï¼Œ<code>j</code> å’Œ <code>k</code> ä¸º <code>0</code>ã€‚</li><li>æŒ‡é’ˆ <code>i</code> æŒ‡å‘ <code>nums1</code>ï¼ŒæŒ‡é’ˆ <code>j</code> æŒ‡å‘ <code>nums2</code>ï¼š<ul><li>å¦‚æœ <code>nums1[i] &lt; nums2[j]</code>ï¼Œåˆ™ <code>i++</code>ã€‚ </li><li>å¦‚æœ <code>nums1[i] &gt; nums2[j]</code>ï¼Œåˆ™ <code>j++</code>ã€‚ </li><li>å¦‚æœ <code>nums1[i] == nums2[j]</code>ï¼Œå°†å…ƒç´ æ‹·è´åˆ° <code>nums1[k]</code>ï¼Œä¸” <code>i++</code>ï¼Œ<code>j++</code>ï¼Œ<code>k++</code>ã€‚</li></ul></li><li>è¿”å›æ•°ç»„ <code>nums1</code> å‰ <code>k</code> ä¸ªå…ƒç´ ã€‚</li></ul><figure class="highlight c++"><figcaption><span>[solution2-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; intersect(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums2) &#123;</span><br><span class="line">    sort(begin(nums1), end(nums1));</span><br><span class="line">    sort(begin(nums2), end(nums2));</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; nums1.size() &amp;&amp; j &lt; nums2.size()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums1[i] &lt; nums2[j]) &#123;</span><br><span class="line">            ++i;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums1[i] &gt; nums2[j]) &#123;</span><br><span class="line">            ++j;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            nums1[k++] = nums1[i++];</span><br><span class="line">            ++j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(begin(nums1), begin(nums1) + k);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><figcaption><span>[solution2-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">int</span>[] intersect(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2) &#123;</span><br><span class="line">    Arrays.sort(nums1);</span><br><span class="line">    Arrays.sort(nums2);</span><br><span class="line">    <span class="keyword">int</span> i = <span class="number">0</span>, j = <span class="number">0</span>, k = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">while</span> (i &lt; nums1.length &amp;&amp; j &lt; nums2.length) &#123;</span><br><span class="line">        <span class="keyword">if</span> (nums1[i] &lt; nums2[j]) &#123;</span><br><span class="line">            ++i;</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span> (nums1[i] &gt; nums2[j]) &#123;</span><br><span class="line">            ++j;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            nums1[k++] = nums1[i++];</span><br><span class="line">            ++j;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> Arrays.copyOfRange(nums1, <span class="number">0</span>, k);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="public-static-int-copyOfRange-int-original-int-from-int-to"><a href="#public-static-int-copyOfRange-int-original-int-from-int-to" class="headerlink" title="public static int[] copyOfRange(int[] original, int from, int to)"></a>public static int[] copyOfRange(int[] original, int from, int to)</h2><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šO(nlogn+mlogm ã€‚å…¶ä¸­ <em>n</em>ï¼Œ<em>m</em> åˆ†åˆ«ä»£è¡¨äº†æ•°ç»„çš„å¤§å°ã€‚æˆ‘ä»¬å¯¹æ•°ç»„è¿›è¡Œäº†æ’åºç„¶åè¿›è¡Œäº†çº¿æ€§æ‰«æã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(1)</em>ï¼Œæˆ‘ä»¬å¿½ç•¥å­˜å‚¨ç­”æ¡ˆæ‰€ä½¿ç”¨çš„ç©ºé—´ï¼Œå› ä¸ºå®ƒå¯¹ç®—æ³•æœ¬èº«å¹¶ä¸é‡è¦ã€‚</li></ul><h1 id="æ–¹æ³•ä¸‰ï¼š"><a href="#æ–¹æ³•ä¸‰ï¼š" class="headerlink" title="æ–¹æ³•ä¸‰ï¼š"></a>æ–¹æ³•ä¸‰ï¼š</h1><p><strong>ç®—æ³•ï¼š</strong></p><p>è¿™ç±»ä¼¼äºæ–¹æ³• 2ã€‚æˆ‘ä»¬ä¸ä½¿ç”¨ä¸¤ä¸ªæŒ‡é’ˆè¿›è¡Œè¿­ä»£ï¼Œè€Œæ˜¯ä½¿ç”¨å†…ç½®å‡½æ•°æ¥æŸ¥æ‰¾å…¬å…±å…ƒç´ ã€‚åœ¨ C++ ä¸­ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨ <code>set_intersection</code> æ¥æ’åºæ•°ç»„ï¼ˆæˆ– <code>multisets</code>ï¼‰ã€‚</p><p>åœ¨ Java ä¸­çš„ <code>retainAll</code> æ–¹æ³•å¹¶ä¸å…³å¿ƒä¸€ä¸ªå…ƒç´ åœ¨å¦ä¸€ä¸ªé›†åˆä¸­å‡ºç°çš„æ¬¡æ•°ã€‚è¿™å°±æœ‰ç‚¹å°´å°¬äº†ï¼Œæˆ‘ä¸€å¼€å§‹æƒ³åˆ°çš„å°±æ˜¯ç”¨å†…ç½®å‡½æ•°ä½†é‡åˆ°ç”¨ä¾‹<code>[1,2]ï¼Œ[1,2]</code>å°±é”™äº†ï¼Œæ€ä¹ˆå†™ä¹Ÿæ²¡å¼„å‡ºæ¥ï¼Œæ‰€ä»¥Javaæ­¤æ³•æš‚ä¸å¯è¡Œã€‚</p><figure class="highlight c++"><figcaption><span>[solution3-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; intersect(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums1, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums2) &#123;</span><br><span class="line">    sort(begin(nums1), end(nums1));</span><br><span class="line">    sort(begin(nums2), end(nums2));</span><br><span class="line">    nums1.erase(set_intersection(begin(nums1), end(nums1), </span><br><span class="line">        begin(nums2), end(nums2), begin(nums1)), end(nums1));</span><br><span class="line">    <span class="keyword">return</span> nums1;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶ç©ºå¤æ‚åº¦ï¼šä¸æ–¹æ³•äºŒç›¸åŒã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™å®šä¸¤ä¸ªæ•°ç»„ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—å®ƒä»¬çš„äº¤é›†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Hash Table" scheme="http://yoursite.com/tags/Hash-Table/"/>
    
      <category term="Binary Search" scheme="http://yoursite.com/tags/Binary-Search/"/>
    
      <category term="Two Pointers" scheme="http://yoursite.com/tags/Two-Pointers/"/>
    
  </entry>
  
  <entry>
    <title>349. ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†</title>
    <link href="http://yoursite.com/2020/06/29/349.%20%E4%B8%A4%E4%B8%AA%E6%95%B0%E7%BB%84%E7%9A%84%E4%BA%A4%E9%9B%86/"/>
    <id>http://yoursite.com/2020/06/29/349. ä¸¤ä¸ªæ•°ç»„çš„äº¤é›†/</id>
    <published>2020-06-29T12:42:12.000Z</published>
    <updated>2020-06-29T15:51:47.249Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™å®šä¸¤ä¸ªæ•°ç»„ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—å®ƒä»¬çš„äº¤é›†ã€‚</p><a id="more"></a><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼šnums1 = [1,2,2,1], nums2 = [2,2]è¾“å‡ºï¼š[2]</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼šnums1 = [4,9,5], nums2 = [9,4,9,8,4]è¾“å‡ºï¼š[9,4]</code></pre><p>è¯´æ˜ï¼š</p><pre><code>è¾“å‡ºç»“æœä¸­çš„æ¯ä¸ªå…ƒç´ ä¸€å®šæ˜¯å”¯ä¸€çš„ã€‚æˆ‘ä»¬å¯ä»¥ä¸è€ƒè™‘è¾“å‡ºç»“æœçš„é¡ºåºã€‚</code></pre><h4 id="æ–¹æ³•ä¸€ï¼šä¸¤ä¸ªset"><a href="#æ–¹æ³•ä¸€ï¼šä¸¤ä¸ªset" class="headerlink" title="æ–¹æ³•ä¸€ï¼šä¸¤ä¸ªset"></a>æ–¹æ³•ä¸€ï¼šä¸¤ä¸ªset</h4><p>æœ€ç›´è§‚çš„æ–¹æ³•æ˜¯è¿­ä»£å¹¶æ£€æŸ¥ç¬¬ä¸€ä¸ªæ•°ç»„ <code>nums1</code> ä¸­çš„æ¯ä¸ªå€¼æ˜¯å¦ä¹Ÿå­˜åœ¨äº <code>nums2</code> ä¸­ã€‚å¦‚æœå­˜åœ¨ï¼Œåˆ™å°†å€¼æ·»åŠ åˆ°è¾“å‡ºã€‚è¿™ç§æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º O(n*m)  ï¼Œå…¶ä¸­ <code>n</code> å’Œ <code>m</code> åˆ†åˆ«ä¸ºæ•°ç»„ <code>nums1</code> å’Œ <code>nums2</code> çš„é•¿åº¦ã€‚ </p><p>ä¸ºäº†åœ¨çº¿æ€§æ—¶é—´å†…è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä½¿ç”¨é›†åˆ <code>set</code> è¿™ä¸€æ•°æ®ç»“æ„ï¼Œè¯¥ç»“æ„å¯ä»¥æä¾›å¹³å‡æ—¶é—´å¤æ‚åº¦ä¸º <em>O(1)</em> çš„ <code>in/contains</code> æ“ä½œï¼ˆç”¨äºæµ‹è¯•æŸä¸€å…ƒç´ æ˜¯å¦ä¸ºè¯¥é›†åˆçš„æˆå‘˜ï¼‰ã€‚</p><p>æœ¬è§£æ³•å…ˆå°†ä¸¤ä¸ªæ•°ç»„éƒ½è½¬æ¢ä¸ºé›†åˆï¼Œç„¶åè¿­ä»£è¾ƒå°çš„é›†åˆï¼Œæ£€æŸ¥å…¶ä¸­çš„æ¯ä¸ªå…ƒç´ æ˜¯å¦åŒæ ·å­˜åœ¨äºè¾ƒå¤§çš„é›†åˆä¸­ã€‚å¹³å‡æƒ…å†µä¸‹ï¼Œè¿™ç§æ–¹æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º <em>O(n+m)</em> ã€‚ </p><p><strong>å®ç°ï¼š</strong></p><figure class="highlight python"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">set_intersection</span><span class="params">(self, set1, set2)</span>:</span></span><br><span class="line">        <span class="keyword">return</span> [x <span class="keyword">for</span> x <span class="keyword">in</span> set1 <span class="keyword">if</span> x <span class="keyword">in</span> set2]</span><br><span class="line">        </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">intersection</span><span class="params">(self, nums1, nums2)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type nums1: List[int]</span></span><br><span class="line"><span class="string">        :type nums2: List[int]</span></span><br><span class="line"><span class="string">        :rtype: List[int]</span></span><br><span class="line"><span class="string">        """</span>  </span><br><span class="line">        set1 = set(nums1)</span><br><span class="line">        set2 = set(nums2)</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span> len(set1) &lt; len(set2):</span><br><span class="line">            <span class="keyword">return</span> self.set_intersection(set1, set2)</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.set_intersection(set2, set1)</span><br></pre></td></tr></table></figure><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span>[] set_intersection(HashSet&lt;Integer&gt; set1, HashSet&lt;Integer&gt; set2) &#123;</span><br><span class="line">    <span class="keyword">int</span> [] output = <span class="keyword">new</span> <span class="keyword">int</span>[set1.size()];</span><br><span class="line">    <span class="keyword">int</span> idx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (Integer s : set1)</span><br><span class="line">      <span class="keyword">if</span> (set2.contains(s)) output[idx++] = s;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> Arrays.copyOf(output, idx);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span>[] intersection(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2) &#123;</span><br><span class="line">    HashSet&lt;Integer&gt; set1 = <span class="keyword">new</span> HashSet&lt;Integer&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Integer n : nums1) set1.add(n);</span><br><span class="line">    HashSet&lt;Integer&gt; set2 = <span class="keyword">new</span> HashSet&lt;Integer&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Integer n : nums2) set2.add(n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (set1.size() &lt; set2.size()) <span class="keyword">return</span> set_intersection(set1, set2);</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">return</span> set_intersection(set2, set1);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(m+n)*ï¼Œå…¶ä¸­ <code>n</code> å’Œ <code>m</code> æ˜¯æ•°ç»„çš„é•¿åº¦ã€‚å°† <code>nums1</code> è½¬æ¢ä¸ºé›†åˆéœ€è¦ *O(n)</em> çš„æ—¶é—´ï¼Œç±»ä¼¼åœ°ï¼Œå°† <code>nums2</code> è½¬æ¢ä¸ºé›†åˆéœ€è¦ <em>O(m)</em> çš„æ—¶é—´ã€‚è€Œåœ¨å¹³å‡æƒ…å†µä¸‹ï¼Œé›†åˆçš„ <code>in/contains</code> æ“ä½œåªéœ€è¦ <em>O(1)</em> çš„æ—¶é—´ã€‚ </li><li>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(m+n)</em>ï¼Œæœ€åçš„æƒ…å†µæ˜¯æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½ä¸åŒã€‚ </li></ul><h3 id="Arrays-copyOf"><a href="#Arrays-copyOf" class="headerlink" title="Arrays.copyOf()"></a>Arrays.copyOf()</h3><p>original - è¦å¤åˆ¶çš„æ•°ç»„ </p><p>newLength - è¦è¿”å›çš„å‰¯æœ¬çš„é•¿åº¦</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line">*original - è¦å¤åˆ¶çš„æ•°ç»„ </span><br><span class="line">*newLength - è¦è¿”å›çš„å‰¯æœ¬çš„é•¿åº¦</span><br><span class="line">*/</span><br><span class="line">public static int[] copyOf(int[] original, int newLength) &#123;</span><br><span class="line">        int[] copy = new int[newLength];</span><br><span class="line">        System.arraycopy(original, 0, copy, 0,</span><br><span class="line">                         Math.min(original.length, newLength));</span><br><span class="line">        return copy;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h4 id="æ–¹æ³•äºŒï¼šå†…ç½®å‡½æ•°"><a href="#æ–¹æ³•äºŒï¼šå†…ç½®å‡½æ•°" class="headerlink" title="æ–¹æ³•äºŒï¼šå†…ç½®å‡½æ•°"></a>æ–¹æ³•äºŒï¼šå†…ç½®å‡½æ•°</h4><p>å¦‚æœä½¿ç”¨å†…ç½®å‡½æ•°ï¼šé‚£ä¹ˆå¹³å‡æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º <em>O(n+m)</em> ï¼›è€Œæœ€åçš„æƒ…å†µä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(n*m)  ã€‚</p><p>Python æä¾›äº†å¯ç”¨äºæ±‚äº¤é›†çš„ <code>&amp;</code> è¿ç®—ç¬¦ï¼Œè€Œ Java æä¾›äº† <code>retainAll()</code>  å‡½æ•°ã€‚</p><p><strong>å®ç°:</strong></p><figure class="highlight python"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">intersection</span><span class="params">(self, nums1, nums2)</span>:</span></span><br><span class="line">        <span class="string">"""</span></span><br><span class="line"><span class="string">        :type nums1: List[int]</span></span><br><span class="line"><span class="string">        :type nums2: List[int]</span></span><br><span class="line"><span class="string">        :rtype: List[int]</span></span><br><span class="line"><span class="string">        """</span>  </span><br><span class="line">        set1 = set(nums1)</span><br><span class="line">        set2 = set(nums2)</span><br><span class="line">        <span class="keyword">return</span> list(set2 &amp; set1)</span><br></pre></td></tr></table></figure><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="keyword">int</span>[] intersection(<span class="keyword">int</span>[] nums1, <span class="keyword">int</span>[] nums2) &#123;</span><br><span class="line">    HashSet&lt;Integer&gt; set1 = <span class="keyword">new</span> HashSet&lt;Integer&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Integer n : nums1) set1.add(n);</span><br><span class="line">    HashSet&lt;Integer&gt; set2 = <span class="keyword">new</span> HashSet&lt;Integer&gt;();</span><br><span class="line">    <span class="keyword">for</span> (Integer n : nums2) set2.add(n);</span><br><span class="line"></span><br><span class="line">    set1.retainAll(set2);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">int</span> [] output = <span class="keyword">new</span> <span class="keyword">int</span>[set1.size()];</span><br><span class="line">    <span class="keyword">int</span> idx = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> s : set1) output[idx++] = s;</span><br><span class="line">    <span class="keyword">return</span> output;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼šä¸€èˆ¬æƒ…å†µä¸‹æ˜¯ <em>O(m+n)</em>ï¼Œæœ€åæƒ…å†µä¸‹æ˜¯ O(m*n)</li><li>ç©ºé—´å¤æ‚åº¦ï¼šæœ€åçš„æƒ…å†µæ˜¯ <em>O(m+n)</em>ï¼Œæ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ éƒ½ä¸åŒã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™å®šä¸¤ä¸ªæ•°ç»„ï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°æ¥è®¡ç®—å®ƒä»¬çš„äº¤é›†ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Hash Table" scheme="http://yoursite.com/tags/Hash-Table/"/>
    
      <category term="Binary Search" scheme="http://yoursite.com/tags/Binary-Search/"/>
    
      <category term="Two Pointers" scheme="http://yoursite.com/tags/Two-Pointers/"/>
    
  </entry>
  
  <entry>
    <title>384. æ‰“ä¹±æ•°ç»„</title>
    <link href="http://yoursite.com/2020/06/29/384.%20%E6%89%93%E4%B9%B1%E6%95%B0%E7%BB%84/"/>
    <id>http://yoursite.com/2020/06/29/384. æ‰“ä¹±æ•°ç»„/</id>
    <published>2020-06-29T10:02:12.000Z</published>
    <updated>2020-06-29T12:41:22.009Z</updated>
    
    <content type="html"><![CDATA[<p>æ‰“ä¹±ä¸€ä¸ªæ²¡æœ‰é‡å¤å…ƒç´ çš„æ•°ç»„ã€‚</p><a id="more"></a><p>ç¤ºä¾‹:</p><pre><code>// ä»¥æ•°å­—é›†åˆ 1, 2 å’Œ 3 åˆå§‹åŒ–æ•°ç»„ã€‚int[] nums = {1,2,3};Solution solution = new Solution(nums);// æ‰“ä¹±æ•°ç»„ [1,2,3] å¹¶è¿”å›ç»“æœã€‚ä»»ä½• [1,2,3]çš„æ’åˆ—è¿”å›çš„æ¦‚ç‡åº”è¯¥ç›¸åŒã€‚solution.shuffle();// é‡è®¾æ•°ç»„åˆ°å®ƒçš„åˆå§‹çŠ¶æ€[1,2,3]ã€‚solution.reset();// éšæœºè¿”å›æ•°ç»„[1,2,3]æ‰“ä¹±åçš„ç»“æœã€‚solution.shuffle();</code></pre><h1 id="ç»ªç« -1"><a href="#ç»ªç« -1" class="headerlink" title="ç»ªç« ^1"></a>ç»ªç« <a href="https://leetcode-cn.com/problems/shuffle-an-array/solution/da-luan-shu-zu-by-leetcode/" target="_blank" rel="noopener">^1</a></h1><p>å¯¹äºæ´—ç‰Œé—®é¢˜ï¼ŒFisher-Yates æ´—ç‰Œç®—æ³•å³æ˜¯é€šä¿—è§£æ³•ï¼ŒåŒæ—¶ä¹Ÿæ˜¯æ¸è¿›æœ€ä¼˜çš„è§£æ³•ã€‚</p><p>åœ¨æˆ‘ä»¬å¼€å§‹ä¹‹å‰éœ€è¦äº†è§£ä¸€äº›å…³äºéšæœºåŒ–çš„çŸ¥è¯† - ä¸‹é¢ä»‹ç»çš„ä¸¤ä¸ªæ–¹æ³•éƒ½å‡è®¾ç¼–ç¨‹è¯­è¨€ä¸­æä¾›çš„ä¼ªéšæœºæ•°ç”Ÿæˆå™¨æ˜¯è¶³å¤Ÿéšæœºçš„ã€‚æˆ‘ä»¬ç»™å‡ºçš„ç¤ºä¾‹ä»£ç ä¹Ÿéƒ½é‡‡ç”¨äº†æœ€ç®€å•çš„æ–¹æ³•æ¥å¾—åˆ°ä¼ªéšæœºæ•°ï¼Œä½†ä¸ºäº†è®©æ•°ç»„çš„æ¯ä¸ªæ’åˆ—å‡ºç°çš„å¯èƒ½æ€§å°½å¯èƒ½ç›¸ç­‰ï¼Œè¿˜æ˜¯æœ‰ä¸€äº›å…¶ä»–ä¸œè¥¿éœ€è¦æ³¨æ„çš„ã€‚ä¾‹å¦‚ï¼Œä¸€ä¸ªé•¿åº¦ä¸º <em>n</em> çš„æ•°ç»„æœ‰ <em>n!</em> ä¸ªä¸åŒçš„æ’åˆ—ç»„åˆã€‚å› æ­¤ï¼Œä¸ºäº†èƒ½å°†æ‰€æœ‰çš„æ’åˆ—åœ¨æ•´æ•°ç©ºé—´ç¼–ç ï¼Œæˆ‘ä»¬éœ€è¦lg(n!) æ¯”ç‰¹ï¼Œè¿™æ˜¯é»˜è®¤çš„ä¼ªéšæœºæ•°ä¸èƒ½ä¿è¯çš„ã€‚</p><h1 id="æ–¹æ³•ä¸€ï¼š-æš´åŠ›-ã€é€šè¿‡ã€‘"><a href="#æ–¹æ³•ä¸€ï¼š-æš´åŠ›-ã€é€šè¿‡ã€‘" class="headerlink" title="æ–¹æ³•ä¸€ï¼š æš´åŠ› ã€é€šè¿‡ã€‘"></a>æ–¹æ³•ä¸€ï¼š æš´åŠ› ã€é€šè¿‡ã€‘</h1><p><strong>æ€è·¯</strong></p><p>å‡è®¾æˆ‘ä»¬æŠŠæ¯ä¸ªæ•°éƒ½æ”¾åœ¨ä¸€ä¸ª â€å¸½å­â€œ é‡Œé¢ï¼Œç„¶åæˆ‘ä»¬ä»å¸½å­é‡Œé¢æŠŠå®ƒä»¬ä¸€ä¸ªä¸ªæ‘¸å‡ºæ¥ï¼Œæ‘¸å‡ºæ¥çš„æ•°æŒ‰é¡ºåºæ”¾å…¥æ•°ç»„ï¼Œè¿™ä¸ªæ•°ç»„æ­£å¥½å°±æ˜¯æˆ‘ä»¬è¦çš„æ´—ç‰Œåçš„æ•°ç»„ã€‚</p><p><strong>ç®—æ³•</strong></p><p>æš´åŠ›ç®—æ³•ç®€å•çš„æ¥è¯´å°±æ˜¯æŠŠæ¯ä¸ªæ•°æ”¾åœ¨ä¸€ä¸ª â€å¸½å­â€œ é‡Œé¢ï¼Œæ¯æ¬¡ä» â€å¸½å­â€œ é‡Œé¢éšæœºæ‘¸ä¸€ä¸ªæ•°å‡ºæ¥ï¼Œç›´åˆ° â€œå¸½å­â€ ä¸ºç©ºã€‚ä¸‹é¢æ˜¯å…·ä½“æ“ä½œï¼Œé¦–å…ˆæˆ‘ä»¬æŠŠæ•°ç»„ <code>array</code> å¤åˆ¶ä¸€ä»½ç»™æ•°ç»„ <code>aux</code>ï¼Œä¹‹åæ¯æ¬¡éšæœºä» <code>aux</code> ä¸­å–ä¸€ä¸ªæ•°ï¼Œä¸ºäº†é˜²æ­¢æ•°è¢«é‡å¤å–å‡ºï¼Œæ¯æ¬¡å–å®Œå°±æŠŠè¿™ä¸ªæ•°ä» <code>aux</code> ä¸­ç§»é™¤ã€‚<code>é‡ç½®</code> çš„å®ç°æ–¹å¼å¾ˆç®€å•ï¼Œåªéœ€æŠŠ <code>array</code> æ¢å¤ç§°æœ€å¼€å§‹çš„çŠ¶æ€å°±å¯ä»¥äº†ã€‚ </p><p>è¿™ä¸ªç®—æ³•çš„æ­£ç¡®æ€§åœ¨äºï¼Œæ¯æ¬¡ <code>for</code> å¾ªç¯ä¸­ï¼Œä»»ä½•ä¸€ä¸ªå…ƒç´ éƒ½ä¼šä»¥ç­‰å¯èƒ½çš„æ¦‚ç‡è¢«é€‰ä¸­ã€‚ä¸ºäº†è¯æ˜è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç®—å‡ºæ¥ï¼Œä¸€ä¸ªç‰¹å®šçš„å…ƒç´  <em>e</em> åœ¨ç¬¬ <em>k</em> è½®è¢«é€‰ä¸­çš„æ¦‚ç‡ä¸º</p><p><em>P</em>(<em>e</em> åœ¨ç¬¬ <em>k</em> è½®è¢«é€‰ä¸­) Â·  <em>P</em>(<em>e</em> åœ¨å‰ <em>k</em> è½®ä¸è¢«é€‰ä¸­)ã€‚</p><p>å‡è®¾æ´—ç‰Œçš„æ•°ç»„æœ‰ <em>n</em> ä¸ªå…ƒç´ ï¼Œè¿™ä¸ªæ¦‚ç‡å…¬å¼è§<a href="https://leetcode-cn.com/problems/shuffle-an-array/solution/da-luan-shu-zu-by-leetcode/" target="_blank" rel="noopener">^1</a></p><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] array;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] original;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">private</span> Random rand = <span class="keyword">new</span> Random();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> List&lt;Integer&gt; <span class="title">getArrayCopy</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Integer&gt; asList = <span class="keyword">new</span> ArrayList&lt;Integer&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">            asList.add(array[i]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> asList;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Solution</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        array = nums;</span><br><span class="line">        original = nums.clone();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] reset() &#123;</span><br><span class="line">        array = original;</span><br><span class="line">        original = original.clone();</span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] shuffle() &#123;</span><br><span class="line">        List&lt;Integer&gt; aux = getArrayCopy();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> removeIdx = rand.nextInt(aux.size());</span><br><span class="line">            array[i] = aux.get(removeIdx);</span><br><span class="line">            aux.remove(removeIdx);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li><p>æ—¶é—´å¤æ‚åº¦ï¼š <em>O(n^2)</em><br>ä¹˜æ–¹æ—¶é—´å¤æ‚åº¦æ¥è‡ªäº <code>list.remove</code>ï¼ˆ<code>list.pop</code>ï¼‰ã€‚æ¯æ¬¡æ“ä½œéƒ½æ˜¯çº¿æ€§æ—¶é—´çš„ï¼Œæ€»å…±å‘ç”Ÿ <em>n</em> æ¬¡ã€‚</p></li><li><p>ç©ºé—´å¤æ‚åº¦ï¼š <em>O(n)</em><br>å› ä¸ºéœ€è¦å®ç° <code>é‡ç½®</code> æ–¹æ³•ï¼Œéœ€è¦é¢å¤–çš„ç©ºé—´æŠŠåŸå§‹æ•°ç»„å¦å­˜ä¸€ä»½ï¼Œåœ¨é‡ç½®çš„æ—¶å€™ç”¨æ¥æ¢å¤åŸå§‹çŠ¶æ€ã€‚</p></li></ul><h4 id="æ–¹æ³•äºŒï¼š-Fisher-Yates-æ´—ç‰Œç®—æ³•-ã€é€šè¿‡ã€‘"><a href="#æ–¹æ³•äºŒï¼š-Fisher-Yates-æ´—ç‰Œç®—æ³•-ã€é€šè¿‡ã€‘" class="headerlink" title="æ–¹æ³•äºŒï¼š Fisher-Yates æ´—ç‰Œç®—æ³• ã€é€šè¿‡ã€‘"></a>æ–¹æ³•äºŒï¼š Fisher-Yates æ´—ç‰Œç®—æ³• ã€é€šè¿‡ã€‘</h4><p><strong>æ€è·¯</strong></p><p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªç®€å•çš„æŠ€å·§æ¥é™ä½ä¹‹å‰ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦ï¼Œé‚£å°±æ˜¯è®©æ•°ç»„ä¸­çš„å…ƒç´ äº’ç›¸äº¤æ¢ï¼Œè¿™æ ·å°±å¯ä»¥é¿å…æ‰æ¯æ¬¡è¿­ä»£ä¸­ç”¨äºä¿®æ”¹åˆ—è¡¨çš„æ—¶é—´äº†ã€‚</p><p><strong>ç®—æ³•</strong></p><p>Fisher-Yates æ´—ç‰Œç®—æ³•è·Ÿæš´åŠ›ç®—æ³•å¾ˆåƒã€‚åœ¨æ¯æ¬¡è¿­ä»£ä¸­ï¼Œç”Ÿæˆä¸€ä¸ªèŒƒå›´åœ¨å½“å‰ä¸‹æ ‡åˆ°æ•°ç»„æœ«å°¾å…ƒç´ ä¸‹æ ‡ä¹‹é—´çš„éšæœºæ•´æ•°ã€‚æ¥ä¸‹æ¥ï¼Œå°†å½“å‰å…ƒç´ å’Œéšæœºé€‰å‡ºçš„ä¸‹æ ‡æ‰€æŒ‡çš„å…ƒç´ äº’ç›¸äº¤æ¢ - è¿™ä¸€æ­¥æ¨¡æ‹Ÿäº†æ¯æ¬¡ä» â€œå¸½å­â€ é‡Œé¢æ‘¸ä¸€ä¸ªå…ƒç´ çš„è¿‡ç¨‹ï¼Œå…¶ä¸­é€‰å–ä¸‹æ ‡èŒƒå›´çš„ä¾æ®åœ¨äºæ¯ä¸ªè¢«æ‘¸å‡ºçš„å…ƒç´ éƒ½ä¸å¯èƒ½å†è¢«æ‘¸å‡ºæ¥äº†ã€‚æ­¤å¤–è¿˜æœ‰ä¸€ä¸ªéœ€è¦æ³¨æ„çš„ç»†èŠ‚ï¼Œå½“å‰å…ƒç´ æ˜¯å¯ä»¥å’Œå®ƒæœ¬èº«äº’ç›¸äº¤æ¢çš„ - å¦åˆ™ç”Ÿæˆæœ€åçš„æ’åˆ—ç»„åˆçš„æ¦‚ç‡å°±ä¸å¯¹äº†ã€‚ä¸ºäº†æ›´æ¸…æ¥šåœ°ç†è§£è¿™ä¸€è¿‡ç¨‹ï¼Œå¯ä»¥çœ‹ä¸‹é¢è¿™äº›åŠ¨ç”»ï¼š</p><p>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates1.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates2.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates3.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates4.png" target="_blank" rel="noopener">1000</a></p><p>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates5.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates6.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates7.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates8.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates9.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates10.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates11.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates12.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates13.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates14.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates15.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates16.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates17.png" target="_blank" rel="noopener">1000</a><br>  <a href="https://pic.leetcode-cn.com/Figures/384/384_fisher_yates18.png" target="_blank" rel="noopener">1000</a> </p><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] array;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span>[] original;</span><br><span class="line"></span><br><span class="line">    Random rand = <span class="keyword">new</span> Random();</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">randRange</span><span class="params">(<span class="keyword">int</span> min, <span class="keyword">int</span> max)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> rand.nextInt(max - min) + min;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">swapAt</span><span class="params">(<span class="keyword">int</span> i, <span class="keyword">int</span> j)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> temp = array[i];</span><br><span class="line">        array[i] = array[j];</span><br><span class="line">        array[j] = temp;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">Solution</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">        array = nums;</span><br><span class="line">        original = nums.clone();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] reset() &#123;</span><br><span class="line">        array = original;</span><br><span class="line">        original = original.clone();</span><br><span class="line">        <span class="keyword">return</span> original;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] shuffle() &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; array.length; i++) &#123;</span><br><span class="line">            swapAt(i, randRange(i, array.length));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> array;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li><p>æ—¶é—´å¤æ‚åº¦ ï¼š <em>O(n)</em><br>Fisher-Yates æ´—ç‰Œç®—æ³•æ—¶é—´å¤æ‚åº¦æ˜¯çº¿æ€§çš„ï¼Œå› ä¸ºç®—æ³•ä¸­ç”Ÿæˆéšæœºåºåˆ—ï¼Œäº¤æ¢ä¸¤ä¸ªå…ƒç´ è¿™ä¸¤ç§æ“ä½œéƒ½æ˜¯å¸¸æ•°æ—¶é—´å¤æ‚åº¦çš„ã€‚</p></li><li><p>ç©ºé—´å¤æ‚åº¦ï¼š <em>O(n)</em><br>å› ä¸ºè¦å®ç° <code>é‡ç½®</code> åŠŸèƒ½ï¼ŒåŸå§‹æ•°ç»„å¿…é¡»å¾—ä¿å­˜ä¸€ä»½ï¼Œå› æ­¤ç©ºé—´å¤æ‚åº¦å¹¶æ²¡æœ‰ä¼˜åŒ–ã€‚</p></li></ul><h2 id="Random-nextInt-æ–¹æ³•ï¼Œéšæœºäº§ç”ŸæŸä¸ªèŒƒå›´å†…çš„æ•´æ•°"><a href="#Random-nextInt-æ–¹æ³•ï¼Œéšæœºäº§ç”ŸæŸä¸ªèŒƒå›´å†…çš„æ•´æ•°" class="headerlink" title="Random.nextInt()æ–¹æ³•ï¼Œéšæœºäº§ç”ŸæŸä¸ªèŒƒå›´å†…çš„æ•´æ•°"></a>Random.nextInt()æ–¹æ³•ï¼Œéšæœºäº§ç”ŸæŸä¸ªèŒƒå›´å†…çš„æ•´æ•°</h2><pre><code>int nextInt()            //éšæœºè¿”å›ä¸€ä¸ªintå‹æ•´æ•°int nextInt(int num)         //éšæœºè¿”å›ä¸€ä¸ªå€¼åœ¨[0,num)çš„intç±»å‹çš„æ•´æ•°,åŒ…æ‹¬0ä¸åŒ…æ‹¬num</code></pre><p>nextIntèƒ½æ¥å—ä¸€ä¸ªæ•´æ•°ä½œä¸ºå®ƒæ‰€äº§ç”Ÿçš„éšæœºæ•´æ•°çš„ä¸Šé™,ä¸‹é™ä¸ºé›¶ï¼Œè‹¥è¦è¾¾åˆ°éé›¶ä¸‹é™çš„æ•ˆæœï¼Œå¿…é¡»æŠŠä¸Šé™å‡å»ä¸‹é™çš„ç»“æœä¼ ç»™ nextInt( )ï¼Œç„¶åæŠŠä¸‹é™åŠ å…¥ nextInt( ) è¿”å›çš„æ•´æ•°ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‰“ä¹±ä¸€ä¸ªæ²¡æœ‰é‡å¤å…ƒç´ çš„æ•°ç»„ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
  </entry>
  
  <entry>
    <title>283. ç§»åŠ¨é›¶</title>
    <link href="http://yoursite.com/2020/06/29/283.%20%E7%A7%BB%E5%8A%A8%E9%9B%B6/"/>
    <id>http://yoursite.com/2020/06/29/283. ç§»åŠ¨é›¶/</id>
    <published>2020-06-29T09:49:12.000Z</published>
    <updated>2020-06-29T10:00:39.219Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæ•°ç»„ numsï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°å°†æ‰€æœ‰ 0 ç§»åŠ¨åˆ°æ•°ç»„çš„æœ«å°¾ï¼ŒåŒæ—¶ä¿æŒéé›¶å…ƒç´ çš„ç›¸å¯¹é¡ºåºã€‚</p><a id="more"></a><p>ç¤ºä¾‹:</p><pre><code>è¾“å…¥: [0,1,0,3,12]è¾“å‡º: [1,3,12,0,0]</code></pre><p>è¯´æ˜:</p><p>å¿…é¡»åœ¨åŸæ•°ç»„ä¸Šæ“ä½œï¼Œä¸èƒ½æ‹·è´é¢å¤–çš„æ•°ç»„ã€‚<br>å°½é‡å‡å°‘æ“ä½œæ¬¡æ•°ã€‚</p><p>æˆ‘é¦–å…ˆæƒ³åˆ°çš„è§£æ³•ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public void moveZeroes(int[] nums) &#123;</span><br><span class="line">        for (int i = 0; i &lt; nums.length; i++) &#123;</span><br><span class="line">            if (nums[i] == 0) &#123;</span><br><span class="line">                swap(nums,i);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void swap(int[] nums, int zeroindex) &#123;</span><br><span class="line">        int i=zeroindex;</span><br><span class="line">        while (i &lt; nums.length) &#123;</span><br><span class="line">            if (nums[i] == 0) &#123;</span><br><span class="line">                i++;</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                nums[zeroindex] = nums[i];</span><br><span class="line">                nums[i]=0;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">è§£ç­”æˆåŠŸ:</span><br><span class="line">æ‰§è¡Œè€—æ—¶:5 ms,å‡»è´¥äº†12.67% çš„Javaç”¨æˆ·</span><br><span class="line">å†…å­˜æ¶ˆè€—:40.4 MB,å‡»è´¥äº†5.62% çš„Javaç”¨æˆ·</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•æ•ˆç‡è¾ƒä½ï¼Œæœ‰æ²¡æœ‰æ›´é«˜æ•ˆçš„æ–¹æ³•å‘¢ï¼Ÿ</p><h1 id="åŒæŒ‡é’ˆæ³•"><a href="#åŒæŒ‡é’ˆæ³•" class="headerlink" title="åŒæŒ‡é’ˆæ³•"></a>åŒæŒ‡é’ˆæ³•</h1><ol><li>å®šä¹‰ä¸€ä¸ªéé›¶çš„æŒ‡é’ˆ <code>j=0</code>ï¼Œå¾ªç¯éå†æ•°ç»„ç”¨æŒ‡é’ˆ<code>j</code>è®°å½•éé›¶å€¼<code>nums[j] = num[i]</code>;</li><li>åˆ¤æ–­ä¸¤ä¸ªæŒ‡é’ˆ<code>i</code>ä¸<code>j</code>æ˜¯å¦ç›¸ç­‰ï¼Œè¿™é‡Œä¸¤ä¸ªæŒ‡é’ˆåˆå§‹å€¼éƒ½ä¸º0ï¼Œ<code>j</code>æŒ‡é’ˆåªæœ‰åœ¨éé›¶çš„æƒ…å†µä¸‹ä¼š<code>j++</code>ï¼›</li><li>å› æ­¤å¯ä»¥åˆ¤æ–­<code>j</code>æŒ‡é’ˆå¯¹åº”çš„å€¼éƒ½ä¸ºéé›¶çš„æ•°æ®ï¼Œä¸”ä¿å­˜åŸæœ‰é¡ºåºï¼›</li><li>æ‰€ä»¥ï¼ŒåŸæœ‰æ•°ç»„ç»§ç»­éå†æƒ…å†µä¸‹ï¼Œ<code>nums[i]</code>éƒ½ä¸º0ã€‚</li></ol><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public void moveZeroes(int[] nums) &#123;</span><br><span class="line">        int j = 0;</span><br><span class="line">        for (int i = 0; i &lt; nums.length; i++) &#123;</span><br><span class="line">            if (nums[i] != 0) &#123;</span><br><span class="line">                nums[j] = nums[i];</span><br><span class="line">                if( i != j)&#123;</span><br><span class="line">                    nums[i] = 0;</span><br><span class="line">                &#125;</span><br><span class="line">                j++;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">            è§£ç­”æˆåŠŸ:</span><br><span class="line">æ‰§è¡Œè€—æ—¶:0 ms,å‡»è´¥äº†100.00% çš„Javaç”¨æˆ·</span><br><span class="line">å†…å­˜æ¶ˆè€—:39.6 MB,å‡»è´¥äº†5.62% çš„Javaç”¨æˆ·</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™å®šä¸€ä¸ªæ•°ç»„ numsï¼Œç¼–å†™ä¸€ä¸ªå‡½æ•°å°†æ‰€æœ‰ 0 ç§»åŠ¨åˆ°æ•°ç»„çš„æœ«å°¾ï¼ŒåŒæ—¶ä¿æŒéé›¶å…ƒç´ çš„ç›¸å¯¹é¡ºåºã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Two Pointers" scheme="http://yoursite.com/tags/Two-Pointers/"/>
    
  </entry>
  
  <entry>
    <title>Javaä¹‹TreeSetç±»</title>
    <link href="http://yoursite.com/2020/06/29/Java%E4%B9%8BTreeSet%E7%B1%BB/"/>
    <id>http://yoursite.com/2020/06/29/Javaä¹‹TreeSetç±»/</id>
    <published>2020-06-29T08:21:12.000Z</published>
    <updated>2020-06-29T09:09:17.746Z</updated>
    
    <content type="html"><![CDATA[<p>java.util.TreeSet ç±»å®ç°Setæ¥å£ã€‚</p><a id="more"></a><p>ä»¥ä¸‹æ˜¯å…³äºTreeSetçš„è¦ç‚¹<a href="http://gitbook.net/java/util/java_util_treeset.html" target="_blank" rel="noopener">^1</a>ï¼š</p><ul><li>TreeSetç±»ä¿è¯è¯¥æ˜ å°„å°†åœ¨å‡åºé”®é¡ºåºï¼Œç”±TreeMapæ”¯æŒã€‚</li><li>è¯¥æ˜ å°„æ˜¯æŒ‰ç…§è‡ªç„¶æ’åºæ–¹æ³•è¯¥é”®ç±»ï¼Œæˆ–åœ¨é›†åˆ›å»ºæ—¶æä¾›çš„æ¯”è¾ƒå™¨ï¼Œè¿™å°†å–å†³äºå…¶æ„é€ å‡½æ•°ä¸­ä½¿ç”¨æ’åºã€‚</li><li>é¡ºåºå¿…é¡»æ˜¯æ€»ä¸ºäº†ä½¿æ ‘åˆ°åŠŸèƒ½å±æ€§ã€‚</li></ul><p>è¿™é‡Œä»…åˆ—å‡ºå‡ ä¸ªå¸¸ç”¨çš„æ–¹æ³•ï¼Œæ›´å¤šè¯¦è§<a href="http://gitbook.net/java/util/java_util_treeset.html" target="_blank" rel="noopener">^1</a></p><h1 id="ç±»æ–¹æ³•"><a href="#ç±»æ–¹æ³•" class="headerlink" title="ç±»æ–¹æ³•"></a>ç±»æ–¹æ³•</h1><h2 id="E-ceiling-E-e-æ–¹æ³•"><a href="#E-ceiling-E-e-æ–¹æ³•" class="headerlink" title="E ceiling(E e) æ–¹æ³•"></a>E ceiling(E e) æ–¹æ³•</h2><p>ç”¨æ¥è¿”å›å¤§äºæˆ–ç­‰äºç»™å®šçš„å…ƒç´ çš„æœ€å°å…ƒç´ ï¼Œå¦‚æœä¸å­˜åœ¨è¿™æ ·çš„å…ƒç´ è¿”å›nullã€‚</p><h2 id="E-floor-E-e-æ–¹æ³•"><a href="#E-floor-E-e-æ–¹æ³•" class="headerlink" title="E floor(E e) æ–¹æ³•"></a>E floor(E e) æ–¹æ³•</h2><p>æ­¤æ–¹æ³•è¿”å›å°äºæˆ–ç­‰äºç»™å®šçš„å…ƒç´ çš„æœ€å¤§å…ƒç´ ï¼Œå¦‚æœä¸å­˜åœ¨è¿™æ ·çš„å…ƒç´ è¿”å›nullã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;java.util.TreeSet ç±»å®ç°Setæ¥å£ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="TreeSet" scheme="http://yoursite.com/tags/TreeSet/"/>
    
  </entry>
  
  <entry>
    <title>220. å­˜åœ¨é‡å¤å…ƒç´ III</title>
    <link href="http://yoursite.com/2020/06/29/220.%20%E5%AD%98%E5%9C%A8%E9%87%8D%E5%A4%8D%E5%85%83%E7%B4%A0III/"/>
    <id>http://yoursite.com/2020/06/29/220. å­˜åœ¨é‡å¤å…ƒç´ III/</id>
    <published>2020-06-29T06:59:12.000Z</published>
    <updated>2020-06-29T09:31:29.444Z</updated>
    
    <content type="html"><![CDATA[<p>åœ¨æ•´æ•°æ•°ç»„ nums ä¸­ï¼Œæ˜¯å¦å­˜åœ¨ä¸¤ä¸ªä¸‹æ ‡ i å’Œ jï¼Œä½¿å¾— nums [i] å’Œ nums [j] çš„å·®çš„ç»å¯¹å€¼å°äºç­‰äº t ï¼Œä¸”æ»¡è¶³ i å’Œ j çš„å·®çš„ç»å¯¹å€¼ä¹Ÿå°äºç­‰äº Ä· ã€‚</p><a id="more"></a><p>å¦‚æœå­˜åœ¨åˆ™è¿”å› trueï¼Œä¸å­˜åœ¨è¿”å› falseã€‚</p><p>ç¤ºä¾‹ 1:</p><pre><code>è¾“å…¥: nums = [1,2,3,1], k = 3, t = 0è¾“å‡º: true</code></pre><p>ç¤ºä¾‹ 2:</p><pre><code>è¾“å…¥: nums = [1,0,1,1], k = 1, t = 2è¾“å‡º: true</code></pre><p>ç¤ºä¾‹ 3:</p><pre><code>è¾“å…¥: nums = [1,5,9,1,5,9], k = 2, t = 3è¾“å‡º: false</code></pre><h1 id="HashSet"><a href="#HashSet" class="headerlink" title="HashSet"></a>HashSet</h1><p>é¦–å…ˆæƒ³åˆ°ç”¨HashSetæ¥è§£å†³ä½†è¶…æ—¶äº†ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public boolean containsNearbyAlmostDuplicate(int[] nums, int k, int t) &#123;</span><br><span class="line">        Set&lt;Integer&gt; set = new HashSet&lt;&gt;();</span><br><span class="line">        for (int i = 0; i &lt; nums.length; i++) &#123;</span><br><span class="line">            for (int j = nums[i] - t; j &lt;= nums[i] + t; j++) &#123;</span><br><span class="line">                if (set.contains(j)) &#123;</span><br><span class="line">//                    System.out.println(&quot;i=&quot;+i+&quot;, j=&quot;+j);</span><br><span class="line">                    return true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            set.add(nums[i]);</span><br><span class="line">            if (set.size() &gt; k) &#123;</span><br><span class="line">                set.remove(nums[i - k]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ¥çœ‹ä¸€ä¸‹å®˜æ–¹é¢˜è§£<a href="https://leetcode-cn.com/problems/contains-duplicate-iii/solution/cun-zai-zhong-fu-yuan-su-iii-by-leetcode/" target="_blank" rel="noopener">^1</a></p><h1 id="äºŒå‰æœç´¢æ ‘-ã€é€šè¿‡ã€‘"><a href="#äºŒå‰æœç´¢æ ‘-ã€é€šè¿‡ã€‘" class="headerlink" title="äºŒå‰æœç´¢æ ‘ ã€é€šè¿‡ã€‘"></a>äºŒå‰æœç´¢æ ‘ ã€é€šè¿‡ã€‘</h1><p>æ€»ç»“ä¸€ä¸‹è¯¥æ–¹æ³•å¼•å…¥è‡ªå¹³è¡¡äºŒå‰æœç´¢æ ‘ï¼Œæ¥ä¿è¯èƒ½åœ¨O(logn) æ—¶é—´å†…å®Œæˆ æ’å…¥ï¼Œæœç´¢ï¼Œåˆ é™¤ æ“ä½œã€‚å‡å°‘å¯¹æ»‘åŠ¨çª—å£ä¸­ç¬¦åˆæ¡ä»¶çš„å…ƒç´ æ“ä½œæ‰€éœ€çš„æ—¶é—´ã€‚</p><p>ä¸‹é¢ç»™å‡ºæ•´ä¸ªç®—æ³•çš„ä¼ªä»£ç ï¼š</p><pre><code>åˆå§‹åŒ–ä¸€é¢—ç©ºçš„äºŒå‰æœç´¢æ ‘ setå¯¹äºæ¯ä¸ªå…ƒç´ xxï¼Œéå†æ•´ä¸ªæ•°ç»„    åœ¨ set ä¸ŠæŸ¥æ‰¾å¤§äºç­‰äºxxçš„æœ€å°çš„æ•°ï¼Œå¦‚æœs - x \leq tsâˆ’xâ‰¤tåˆ™è¿”å› true    åœ¨ set ä¸ŠæŸ¥æ‰¾å°äºç­‰äºxxçš„æœ€å¤§çš„æ•°ï¼Œå¦‚æœx - g \leq txâˆ’gâ‰¤tåˆ™è¿”å› true    åœ¨ set ä¸­æ’å…¥xx    å¦‚æœæ ‘çš„å¤§å°è¶…è¿‡äº†kk, åˆ™ç§»é™¤æœ€æ—©åŠ å…¥æ ‘çš„é‚£ä¸ªæ•°ã€‚è¿”å› false</code></pre><p>æˆ‘ä»¬æŠŠå¤§äºç­‰äº <em>x</em> çš„æœ€å°çš„æ•° <em>s</em> å½“åš <em>x</em> åœ¨ BST ä¸­çš„åç»§èŠ‚ç‚¹ã€‚åŒæ ·çš„ï¼Œæˆ‘ä»¬èƒ½æŠŠå°äºç­‰äº <em>x</em> æœ€å¤§çš„æ•° <em>g</em> å½“åš <em>x</em> åœ¨ BST ä¸­çš„å‰ç»§èŠ‚ç‚¹ã€‚<em>s</em> å’Œ <em>g</em> è¿™ä¸¤ä¸ªæ•°æ˜¯è·ç¦» <em>x</em> æœ€è¿‘çš„æ•°ã€‚å› æ­¤åªéœ€è¦æ£€æŸ¥å®ƒä»¬å’Œ <em>x</em> çš„è·ç¦»å°±èƒ½çŸ¥é“æ¡ä»¶äºŒæ˜¯å¦æ»¡è¶³äº†ã€‚</p><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsNearbyAlmostDuplicate</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">    TreeSet&lt;Integer&gt; set = <span class="keyword">new</span> TreeSet&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i) &#123;</span><br><span class="line">        <span class="comment">// Find the successor of current element</span></span><br><span class="line">        Integer s = set.ceiling(nums[i]);</span><br><span class="line">        <span class="keyword">if</span> (s != <span class="keyword">null</span> &amp;&amp; s &lt;= nums[i] + t) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Find the predecessor of current element</span></span><br><span class="line">        Integer g = set.floor(nums[i]);</span><br><span class="line">        <span class="keyword">if</span> (g != <span class="keyword">null</span> &amp;&amp; nums[i] &lt;= g + t) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line"></span><br><span class="line">        set.add(nums[i]);</span><br><span class="line">        <span class="keyword">if</span> (set.size() &gt; k) &#123;</span><br><span class="line">            set.remove(nums[i - k]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="E-ceiling-E-e-æ–¹æ³•-2"><a href="#E-ceiling-E-e-æ–¹æ³•-2" class="headerlink" title="E ceiling(E e) æ–¹æ³•^2"></a>E ceiling(E e) æ–¹æ³•<a href="http://gitbook.net/java/util/java_util_treeset.html" target="_blank" rel="noopener">^2</a></h2><p>ç”¨æ¥è¿”å›å¤§äºæˆ–ç­‰äºç»™å®šçš„å…ƒç´ çš„æœ€å°å…ƒç´ ï¼Œå¦‚æœä¸å­˜åœ¨è¿™æ ·çš„å…ƒç´ è¿”å›nullã€‚</p><h2 id="E-floor-E-e-æ–¹æ³•"><a href="#E-floor-E-e-æ–¹æ³•" class="headerlink" title="E floor(E e) æ–¹æ³•"></a>E floor(E e) æ–¹æ³•</h2><p>æ­¤æ–¹æ³•è¿”å›å°äºæˆ–ç­‰äºç»™å®šçš„å…ƒç´ çš„æœ€å¤§å…ƒç´ ï¼Œå¦‚æœä¸å­˜åœ¨è¿™æ ·çš„å…ƒç´ è¿”å›nullã€‚</p><h2 id="å¤æ‚åº¦åˆ†æ"><a href="#å¤æ‚åº¦åˆ†æ" class="headerlink" title="å¤æ‚åº¦åˆ†æ"></a>å¤æ‚åº¦åˆ†æ</h2><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n log (min(n,k)))<br>æˆ‘ä»¬éœ€è¦éå†è¿™ä¸ª n é•¿åº¦çš„æ•°ç»„ã€‚å¯¹äºæ¯æ¬¡éå†ï¼Œåœ¨ BST ä¸­ æœç´¢ï¼Œæ’å…¥ æˆ–è€… åˆ é™¤ éƒ½éœ€è¦èŠ±è´¹ O(logmin(k, n))çš„æ—¶é—´ã€‚</p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(min(n,k))<br>ç©ºé—´å¤æ‚åº¦ç”± BST çš„å¤§å°å†³å®šï¼Œå…¶å¤§å°çš„ä¸Šé™ç”± k å’Œ n å…±åŒå†³å®šã€‚</p><h2 id="æº¢å‡ºé”™è¯¯"><a href="#æº¢å‡ºé”™è¯¯" class="headerlink" title="æº¢å‡ºé”™è¯¯"></a>æº¢å‡ºé”™è¯¯</h2><p>å½“æ•°ç»„ä¸­çš„å…ƒç´ éå¸¸å¤§çš„æ—¶å€™ï¼Œè¿›è¡Œæ•°å­¦è¿ç®—å¯èƒ½é€ æˆæº¢å‡ºã€‚æ‰€ä»¥å¯ä»¥è€ƒè™‘ä½¿ç”¨æ”¯æŒå¤§æ•°çš„æ•°æ®ç±»å‹ï¼Œä¾‹å¦‚ longã€‚</p><p>C++ ä¸­çš„ std::setï¼Œstd::set::upper_bound å’Œ std::set::lower_bound åˆ†åˆ«ç­‰ä»·äº Java ä¸­çš„ TreeSetï¼ŒTreeSet::ceiling å’Œ TreeSet::floorã€‚Python æ ‡å‡†åº“ä¸æä¾›è‡ªå¹³è¡¡ BSTã€‚</p><p>å½“æµ‹è¯•ç”¨ä¾‹ä¸º</p><pre><code>[-2147483648,-2147483647]33</code></pre><p>æ—¶ä¼šæº¢å‡ºï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œä½¿ç”¨longç±»å‹ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public boolean containsNearbyAlmostDuplicate(int[] nums, int k, int t) &#123;</span><br><span class="line">        TreeSet&lt;Long&gt; set = new TreeSet&lt;&gt;();</span><br><span class="line">        for (int i = 0; i &lt; nums.length; i++) &#123;</span><br><span class="line">            // Find the successor of current element</span><br><span class="line">            Long s = set.ceiling((long) nums[i]);</span><br><span class="line">            if (s != null &amp;&amp; s &lt;= (long) nums[i] + t) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            // Find the predecessor of current element</span><br><span class="line">            Long g = set.floor((long) nums[i]);</span><br><span class="line">            if (g != null &amp;&amp; g &gt;= (long) nums[i] - t) &#123;</span><br><span class="line">                return true;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            set.add((long) nums[i]);</span><br><span class="line">            if (set.size() &gt; k) &#123;</span><br><span class="line">                set.remove((long) nums[i - k]);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ–¹æ³•ä¸‰-ï¼ˆæ¡¶ï¼‰-ã€é€šè¿‡ã€‘"><a href="#æ–¹æ³•ä¸‰-ï¼ˆæ¡¶ï¼‰-ã€é€šè¿‡ã€‘" class="headerlink" title="æ–¹æ³•ä¸‰ ï¼ˆæ¡¶ï¼‰ ã€é€šè¿‡ã€‘"></a>æ–¹æ³•ä¸‰ ï¼ˆæ¡¶ï¼‰ ã€é€šè¿‡ã€‘</h1><p><strong>æ€è·¯</strong></p><p>å— <code>æ¡¶æ’åº</code> çš„å¯å‘ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠ <em>æ¡¶</em> å½“åšçª—å£æ¥å®ç°ä¸€ä¸ªçº¿æ€§å¤æ‚åº¦çš„è§£æ³•ã€‚</p><p><strong>ç®—æ³•</strong></p><p>æ¡¶æ’åºæ˜¯ä¸€ç§æŠŠå…ƒç´ åˆ†æ•£åˆ°ä¸åŒæ¡¶ä¸­çš„æ’åºç®—æ³•ã€‚æ¥ç€æŠŠæ¯ä¸ªæ¡¶å†ç‹¬ç«‹åœ°ç”¨ä¸åŒçš„æ’åºç®—æ³•è¿›è¡Œæ’åºã€‚æ¡¶æ’åºçš„æ¦‚è§ˆå¦‚ä¸‹æ‰€ç¤ºï¼š</p><p>åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬æœ‰ 8 ä¸ªæœªæ’åºçš„æ•´æ•°ã€‚æˆ‘ä»¬é¦–å…ˆæ¥åˆ›å»ºäº”ä¸ªæ¡¶ï¼Œè¿™äº”ä¸ªæ¡¶åˆ†åˆ«åŒ…å« <em>[0,9], [10,19], [20, 29], [30, 39], [40, 49]</em> è¿™å‡ ä¸ªåŒºé—´ã€‚è¿™ 8 ä¸ªå…ƒç´ ä¸­çš„ä»»ä½•ä¸€ä¸ªå…ƒç´ éƒ½åœ¨ä¸€ä¸ªæ¡¶é‡Œé¢ã€‚å¯¹äºå€¼ä¸º <em>x</em> çš„å…ƒç´ æ¥è¯´ï¼Œå®ƒæ‰€å±æ¡¶çš„æ ‡ç­¾ä¸º <em>x/w</em>ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬è®© <em>w = 10</em>ã€‚å¯¹äºæ¯ä¸ªæ¡¶æˆ‘ä»¬å•ç‹¬ç”¨å…¶ä»–æ’åºç®—æ³•è¿›è¡Œæ’åºï¼Œæœ€åæŒ‰ç…§æ¡¶çš„é¡ºåºæ”¶é›†æ‰€æœ‰çš„å…ƒç´ å°±å¯ä»¥å¾—åˆ°ä¸€ä¸ªæœ‰åºçš„æ•°ç»„äº†ã€‚</p><p>å›åˆ°è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬å°è¯•å»è§£å†³çš„æœ€å¤§çš„é—®é¢˜åœ¨äºï¼š</p><blockquote><ol><li>å¯¹äºç»™å®šçš„å…ƒç´  <em>x</em>, åœ¨çª—å£ä¸­æ˜¯å¦æœ‰å­˜åœ¨åŒºé—´ <em>[x-t, x+t]</em> å†…çš„å…ƒç´ ï¼Ÿ  </li><li>æˆ‘ä»¬èƒ½åœ¨å¸¸é‡æ—¶é—´å†…å®Œæˆä»¥ä¸Šåˆ¤æ–­å˜›ï¼Ÿ</li></ol></blockquote><p>æˆ‘ä»¬ä¸å¦¨æŠŠæŠŠæ¯ä¸ªå…ƒç´ å½“åšä¸€ä¸ªäººçš„ç”Ÿæ—¥æ¥è€ƒè™‘ä¸€ä¸‹å§ã€‚å‡è®¾ä½ æ˜¯ç­ä¸Šæ–°æ¥çš„ä¸€ä½å­¦ç”Ÿï¼Œä½ çš„ç”Ÿæ—¥åœ¨ <em>ä¸‰æœˆ</em> çš„æŸä¸€å¤©ï¼Œä½ æƒ³çŸ¥é“ç­ä¸Šæ˜¯å¦æœ‰äººç”Ÿæ—¥è·Ÿä½ ç”Ÿæ—¥åœ¨ <em>t=30</em> å¤©ä»¥å†…ã€‚åœ¨è¿™é‡Œæˆ‘ä»¬å…ˆå‡è®¾æ¯ä¸ªæœˆéƒ½æ˜¯<em>30<em>å¤©ï¼Œå¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬åªéœ€è¦æ£€æŸ¥æ‰€æœ‰ç”Ÿæ—¥åœ¨ *äºŒæœˆ</em>ï¼Œ<em>ä¸‰æœˆ</em>ï¼Œ*å››æœˆ</em> çš„åŒå­¦å°±å¯ä»¥äº†ã€‚</p><p>ä¹‹æ‰€ä»¥èƒ½è¿™ä¹ˆåšçš„åŸå› åœ¨äºï¼Œæˆ‘ä»¬çŸ¥é“æ¯ä¸ªäººçš„ç”Ÿæ—¥éƒ½å±äºä¸€ä¸ªæ¡¶ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªæ¡¶ç§°ä½œæœˆä»½ï¼æ¯ä¸ªæ¡¶æ‰€åŒ…å«çš„åŒºé—´èŒƒå›´éƒ½æ˜¯ <em>t</em>ï¼Œè¿™èƒ½æå¤§çš„ç®€åŒ–æˆ‘ä»¬çš„é—®é¢˜ã€‚å¾ˆæ˜¾ç„¶ï¼Œä»»ä½•ä¸åœ¨åŒä¸€ä¸ªæ¡¶æˆ–ç›¸é‚»æ¡¶çš„ä¸¤ä¸ªå…ƒç´ ä¹‹é—´çš„è·ç¦»ä¸€å®šæ˜¯å¤§äº <em>t</em> çš„ã€‚</p><p>æˆ‘ä»¬æŠŠä¸Šé¢æåˆ°çš„æ¡¶çš„æ€æƒ³åº”ç”¨åˆ°è¿™ä¸ªé—®é¢˜é‡Œé¢æ¥ï¼Œæˆ‘ä»¬è®¾è®¡ä¸€äº›æ¡¶ï¼Œè®©ä»–ä»¬åˆ†åˆ«åŒ…å«åŒºé—´ <em>â€¦, [0,t], [t+1, 2t+1], â€¦*ã€‚æˆ‘ä»¬æŠŠæ¡¶æ¥å½“åšçª—å£ï¼Œäºæ˜¯æ¯æ¬¡æˆ‘ä»¬åªéœ€è¦æ£€æŸ¥ *x</em> æ‰€å±çš„é‚£ä¸ªæ¡¶å’Œç›¸é‚»æ¡¶ä¸­çš„å…ƒç´ å°±å¯ä»¥äº†ã€‚ç»ˆäºï¼Œæˆ‘ä»¬å¯ä»¥åœ¨å¸¸é‡æ—¶é—´è§£å†³åœ¨çª—å£ä¸­æœç´¢çš„é—®é¢˜äº†ã€‚</p><p>è¿˜æœ‰ä¸€ä»¶å€¼å¾—æ³¨æ„çš„äº‹ï¼</p><p>è¿™ä¸ªé—®é¢˜å’Œæ¡¶æ’åºçš„ä¸åŒä¹‹å¤„åœ¨äºæ¯æ¬¡æˆ‘ä»¬çš„æ¡¶é‡Œåªéœ€è¦åŒ…å«æœ€å¤šä¸€ä¸ªå…ƒç´ å°±å¯ä»¥äº†ï¼Œå› ä¸ºå¦‚æœä»»æ„ä¸€ä¸ªæ¡¶ä¸­åŒ…å«äº†ä¸¤ä¸ªå…ƒç´ ï¼Œé‚£ä¹ˆè¿™ä¹Ÿå°±æ˜¯æ„å‘³ç€è¿™ä¸¤ä¸ªå…ƒç´ æ˜¯ <em>è¶³å¤Ÿæ¥è¿‘çš„</em> äº†ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±ç›´æ¥å¾—åˆ°ç­”æ¡ˆäº†ã€‚å› æ­¤ï¼Œæˆ‘ä»¬åªéœ€ä½¿ç”¨ä¸€ä¸ªæ ‡ç­¾ä¸ºæ¡¶åºå·çš„æ•£åˆ—è¡¨å°±å¯ä»¥äº†ã€‚ </p><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="comment">// Get the ID of the bucket from element value x and bucket width w</span></span><br><span class="line">    <span class="comment">// In Java, `-3 / 5 = 0` and but we need `-3 / 5 = -1`.</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">getID</span><span class="params">(<span class="keyword">long</span> x, <span class="keyword">long</span> w)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x &lt; <span class="number">0</span> ? (x + <span class="number">1</span>) / w - <span class="number">1</span> : x / w;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsNearbyAlmostDuplicate</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k, <span class="keyword">int</span> t)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (t &lt; <span class="number">0</span>) <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">        <span class="comment">// Key: ID of the bucket   Value: bucket  value</span></span><br><span class="line">        Map&lt;Long, Long&gt; d = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">long</span> w = (<span class="keyword">long</span>)t + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i) &#123;</span><br><span class="line">            <span class="keyword">long</span> m = getID(nums[i], w);</span><br><span class="line">            <span class="comment">// check if bucket m is empty, each bucket may contain at most one element</span></span><br><span class="line">            <span class="keyword">if</span> (d.containsKey(m))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            <span class="comment">// check the neighbor buckets for almost duplicate</span></span><br><span class="line">            <span class="keyword">if</span> (d.containsKey(m - <span class="number">1</span>) &amp;&amp; Math.abs(nums[i] - d.get(m - <span class="number">1</span>)) &lt; w)</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            <span class="keyword">if</span> (d.containsKey(m + <span class="number">1</span>) &amp;&amp; Math.abs(nums[i] - d.get(m + <span class="number">1</span>)) &lt; w)</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            <span class="comment">// now bucket m is empty and no almost duplicate in nei***or buckets</span></span><br><span class="line">            d.put(m, (<span class="keyword">long</span>)nums[i]);</span><br><span class="line">            <span class="keyword">if</span> (i &gt;= k) d.remove(getID(nums[i - k], w));</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(n)</em></li></ul><p>å¯¹äºè¿™ <em>n</em> ä¸ªå…ƒç´ ä¸­çš„ä»»æ„ä¸€ä¸ªå…ƒç´ æ¥è¯´ï¼Œæˆ‘ä»¬æœ€å¤šåªéœ€è¦åœ¨æ•£åˆ—è¡¨ä¸­åšä¸‰æ¬¡ <code>æœç´¢</code>ï¼Œä¸€æ¬¡ <code>æ’å…¥</code> å’Œä¸€æ¬¡ <code>åˆ é™¤</code>ã€‚è¿™äº›æ“ä½œæ˜¯å¸¸é‡æ—¶é—´å¤æ‚åº¦çš„ã€‚å› æ­¤ï¼Œæ•´ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦ä¸º <em>O(n)</em>ã€‚</p><ul><li>ç©ºé—´å¤æ‚åº¦ï¼šO(min(n,k))<br>éœ€è¦å¼€è¾Ÿçš„é¢å¤–ç©ºé—´å–å†³äº†æ•£åˆ—è¡¨çš„å¤§å°ï¼Œå…¶å¤§å°è·Ÿå®ƒæ‰€åŒ…å«çš„å…ƒç´ æ•°é‡æˆçº¿æ€§å…³ç³»ã€‚æ•£åˆ—è¡¨çš„å¤§å°çš„ä¸Šé™åŒæ—¶ç”± <em>n</em> å’Œ <em>k</em> å†³å®šã€‚å› æ­¤ï¼Œç©ºé—´å¤æ‚åº¦ä¸ºO(min(n,k))  ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;åœ¨æ•´æ•°æ•°ç»„ nums ä¸­ï¼Œæ˜¯å¦å­˜åœ¨ä¸¤ä¸ªä¸‹æ ‡ i å’Œ jï¼Œä½¿å¾— nums [i] å’Œ nums [j] çš„å·®çš„ç»å¯¹å€¼å°äºç­‰äº t ï¼Œä¸”æ»¡è¶³ i å’Œ j çš„å·®çš„ç»å¯¹å€¼ä¹Ÿå°äºç­‰äº Ä· ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Sort" scheme="http://yoursite.com/tags/Sort/"/>
    
      <category term="Ordered Map" scheme="http://yoursite.com/tags/Ordered-Map/"/>
    
  </entry>
  
  <entry>
    <title>219. å­˜åœ¨é‡å¤å…ƒç´ II</title>
    <link href="http://yoursite.com/2020/06/29/219.%20%E5%AD%98%E5%9C%A8%E9%87%8D%E5%A4%8D%E5%85%83%E7%B4%A0II/"/>
    <id>http://yoursite.com/2020/06/29/219. å­˜åœ¨é‡å¤å…ƒç´ II/</id>
    <published>2020-06-29T06:33:12.000Z</published>
    <updated>2020-06-29T06:55:28.045Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„å’Œä¸€ä¸ªæ•´æ•° kï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨ä¸¤ä¸ªä¸åŒçš„ç´¢å¼• i å’Œ jï¼Œä½¿å¾— nums [i] = nums [j]ï¼Œå¹¶ä¸” i å’Œ j çš„å·®çš„ ç»å¯¹å€¼ è‡³å¤šä¸º kã€‚</p><a id="more"></a><p>ç¤ºä¾‹ 1:</p><pre><code>è¾“å…¥: nums = [1,2,3,1], k = 3è¾“å‡º: true</code></pre><p>ç¤ºä¾‹ 2:</p><pre><code>è¾“å…¥: nums = [1,0,1,1], k = 1è¾“å‡º: true</code></pre><p>ç¤ºä¾‹ 3:</p><pre><code>è¾“å…¥: nums = [1,2,3,1,2,3], k = 2è¾“å‡º: false</code></pre><h1 id="è§£æ³•ä¸€ï¼šHashMap"><a href="#è§£æ³•ä¸€ï¼šHashMap" class="headerlink" title="è§£æ³•ä¸€ï¼šHashMap"></a>è§£æ³•ä¸€ï¼šHashMap</h1><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public boolean containsNearbyDuplicate(int[] nums, int k) &#123;</span><br><span class="line">        //Key-&gt;nums[i] , Value-&gt;i</span><br><span class="line">        HashMap&lt;Integer,Integer&gt; hashMap=new HashMap&lt;&gt;();</span><br><span class="line">        for (int i = 0; i &lt; nums.length; i++) &#123;</span><br><span class="line">            if (hashMap.containsKey(nums[i])) &#123;</span><br><span class="line">                if (Math.abs(i - hashMap.get(nums[i])) &lt;= k) &#123;</span><br><span class="line">                    return true;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            hashMap.put(nums[i], i);</span><br><span class="line">        &#125;</span><br><span class="line">        return false;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h1 id="æ–¹æ³•äºŒ-ï¼ˆæ•£åˆ—è¡¨ï¼‰"><a href="#æ–¹æ³•äºŒ-ï¼ˆæ•£åˆ—è¡¨ï¼‰" class="headerlink" title="æ–¹æ³•äºŒ ï¼ˆæ•£åˆ—è¡¨ï¼‰"></a>æ–¹æ³•äºŒ ï¼ˆæ•£åˆ—è¡¨ï¼‰</h1><p><strong>æ€è·¯</strong></p><p>ç”¨æ•£åˆ—è¡¨æ¥ç»´æŠ¤è¿™ä¸ª<em>k</em>å¤§å°çš„æ»‘åŠ¨çª—å£ã€‚<a href="https://leetcode-cn.com/problems/contains-duplicate-ii/solution/cun-zai-zhong-fu-yuan-su-ii-by-leetcode/" target="_blank" rel="noopener">^1</a></p><p><strong>ç®—æ³•</strong></p><p>åœ¨ä¹‹å‰çš„æ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬çŸ¥é“äº†å¯¹æ•°æ—¶é—´å¤æ‚åº¦çš„ <code>æœç´¢</code> æ“ä½œæ˜¯ä¸å¤Ÿçš„ã€‚åœ¨è¿™ä¸ªæ–¹æ³•é‡Œé¢ï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ”¯æŒåœ¨å¸¸é‡æ—¶é—´å†…å®Œæˆ <code>æœç´¢</code>ï¼Œ<code>åˆ é™¤</code>ï¼Œ<code>æ’å…¥</code> æ“ä½œçš„æ•°æ®ç»“æ„ï¼Œé‚£å°±æ˜¯æ•£åˆ—è¡¨ã€‚è¿™ä¸ªç®—æ³•çš„å®ç°è·Ÿæ–¹æ³•äºŒå‡ ä¹æ˜¯ä¸€æ ·çš„ã€‚</p><ul><li>éå†æ•°ç»„ï¼Œå¯¹äºæ¯ä¸ªå…ƒç´ åšä»¥ä¸‹æ“ä½œï¼š<ul><li>åœ¨æ•£åˆ—è¡¨ä¸­æœç´¢å½“å‰å…ƒç´ ï¼Œå¦‚æœæ‰¾åˆ°äº†å°±è¿”å› <code>true</code>ã€‚</li><li>åœ¨æ•£åˆ—è¡¨ä¸­æ’å…¥å½“å‰å…ƒç´ ã€‚</li><li>å¦‚æœå½“å‰æ•£åˆ—è¡¨çš„å¤§å°è¶…è¿‡äº† <em>k</em>ï¼Œ åˆ é™¤æ•£åˆ—è¡¨ä¸­æœ€æ—§çš„å…ƒç´ ã€‚</li></ul></li><li>è¿”å› <code>false</code>ã€‚</li></ul><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsNearbyDuplicate</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">    Set&lt;Integer&gt; set = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (set.contains(nums[i])) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        set.add(nums[i]);</span><br><span class="line">        <span class="keyword">if</span> (set.size() &gt; k) &#123;</span><br><span class="line">            set.remove(nums[i - k]);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li><p>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(n)</em><br>æˆ‘ä»¬ä¼šåš <em>n</em> æ¬¡ <code>æœç´¢</code>ï¼Œ<code>åˆ é™¤</code>ï¼Œ<code>æ’å…¥</code> æ“ä½œï¼Œæ¯æ¬¡æ“ä½œéƒ½è€—è´¹å¸¸æ•°æ—¶é—´ã€‚</p></li><li><p>ç©ºé—´å¤æ‚åº¦ï¼šO(min(n,k)) </p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„å’Œä¸€ä¸ªæ•´æ•° kï¼Œåˆ¤æ–­æ•°ç»„ä¸­æ˜¯å¦å­˜åœ¨ä¸¤ä¸ªä¸åŒçš„ç´¢å¼• i å’Œ jï¼Œä½¿å¾— nums [i] = nums [j]ï¼Œå¹¶ä¸” i å’Œ j çš„å·®çš„ ç»å¯¹å€¼ è‡³å¤šä¸º kã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Hash Table" scheme="http://yoursite.com/tags/Hash-Table/"/>
    
  </entry>
  
  <entry>
    <title>217. å­˜åœ¨é‡å¤å…ƒç´ </title>
    <link href="http://yoursite.com/2020/06/29/217.%20%E5%AD%98%E5%9C%A8%E9%87%8D%E5%A4%8D%E5%85%83%E7%B4%A0/"/>
    <id>http://yoursite.com/2020/06/29/217. å­˜åœ¨é‡å¤å…ƒç´ /</id>
    <published>2020-06-29T06:33:12.000Z</published>
    <updated>2020-06-29T06:41:10.110Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨é‡å¤å…ƒç´ ã€‚å¦‚æœä»»æ„ä¸€å€¼åœ¨æ•°ç»„ä¸­å‡ºç°è‡³å°‘ä¸¤æ¬¡ï¼Œå‡½æ•°è¿”å› true ã€‚å¦‚æœæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½ä¸ç›¸åŒï¼Œåˆ™è¿”å› false ã€‚</p><a id="more"></a><h1 id="å“ˆå¸Œè¡¨è§£å†³"><a href="#å“ˆå¸Œè¡¨è§£å†³" class="headerlink" title="å“ˆå¸Œè¡¨è§£å†³"></a>å“ˆå¸Œè¡¨è§£å†³</h1><p>å¯ä»¥ç”¨Setæˆ–HashMapæ¥è§£å†³</p><figure class="highlight java"><figcaption><span>[solution 3]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">containsDuplicate</span><span class="params">(<span class="keyword">int</span>[] nums)</span> </span>&#123;</span><br><span class="line">    Set&lt;Integer&gt; set = <span class="keyword">new</span> HashSet&lt;&gt;(nums.length);</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> x: nums) &#123;</span><br><span class="line">        <span class="keyword">if</span> (set.contains(x)) <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        set.add(x);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ›´å¤šè¯¦ç»†åˆ†æè§<a href="https://leetcode-cn.com/problems/contains-duplicate/solution/cun-zai-zhong-fu-yuan-su-by-leetcode/" target="_blank" rel="noopener">^1</a></p><h1 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h1><ul><li><a href="https://leetcode-cn.com/problems/contains-duplicate-ii/" target="_blank" rel="noopener">219 å­˜åœ¨é‡å¤å…ƒç´  II</a></li><li><a href="https://leetcode-cn.com/problems/contains-duplicate-iii/" target="_blank" rel="noopener">220 å­˜åœ¨é‡å¤å…ƒç´  III</a></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™å®šä¸€ä¸ªæ•´æ•°æ•°ç»„ï¼Œåˆ¤æ–­æ˜¯å¦å­˜åœ¨é‡å¤å…ƒç´ ã€‚å¦‚æœä»»æ„ä¸€å€¼åœ¨æ•°ç»„ä¸­å‡ºç°è‡³å°‘ä¸¤æ¬¡ï¼Œå‡½æ•°è¿”å› true ã€‚å¦‚æœæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ éƒ½ä¸ç›¸åŒï¼Œåˆ™è¿”å› false ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Hash Table" scheme="http://yoursite.com/tags/Hash-Table/"/>
    
  </entry>
  
  <entry>
    <title>152. ä¹˜ç§¯æœ€å¤§å­æ•°ç»„</title>
    <link href="http://yoursite.com/2020/06/29/152.%20%E4%B9%98%E7%A7%AF%E6%9C%80%E5%A4%A7%E5%AD%90%E6%95%B0%E7%BB%84/"/>
    <id>http://yoursite.com/2020/06/29/152. ä¹˜ç§¯æœ€å¤§å­æ•°ç»„/</id>
    <published>2020-06-29T06:06:12.000Z</published>
    <updated>2020-06-29T06:23:19.793Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums ï¼Œè¯·ä½ æ‰¾å‡ºæ•°ç»„ä¸­ä¹˜ç§¯æœ€å¤§çš„è¿ç»­å­æ•°ç»„ï¼ˆè¯¥å­æ•°ç»„ä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªæ•°å­—ï¼‰ï¼Œå¹¶è¿”å›è¯¥å­æ•°ç»„æ‰€å¯¹åº”çš„ä¹˜ç§¯ã€‚</p><a id="more"></a><p>ç¤ºä¾‹ 1:</p><pre><code>è¾“å…¥: [2,3,-2,4]è¾“å‡º: 6è§£é‡Š: å­æ•°ç»„ [2,3] æœ‰æœ€å¤§ä¹˜ç§¯ 6ã€‚</code></pre><p>ç¤ºä¾‹ 2:</p><pre><code>è¾“å…¥: [-2,0,-1]è¾“å‡º: 0è§£é‡Š: ç»“æœä¸èƒ½ä¸º 2, å› ä¸º [-2,-1] ä¸æ˜¯å­æ•°ç»„ã€‚</code></pre><h1 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h1><p>è¿™é“é¢˜æ¯”è¾ƒç»å…¸ï¼Œå®˜æ–¹è§£æ³•å¯ä»¥è§<a href="https://leetcode-cn.com/problems/maximum-product-subarray/solution/cheng-ji-zui-da-zi-shu-zu-by-leetcode-solution/" target="_blank" rel="noopener">^1</a>,æˆ‘é¦–å…ˆæƒ³åˆ°ç”¨å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡çš„æ–¹æ³•æ¥è§£å†³ï¼Œä½†æ˜¯è¦æ³¨æ„ä¸¤ä¸ªæµ‹è¯•æ ·ä¾‹[-2]å’Œ[0,2]ï¼Œéœ€è¦å¯¹å…¨å±€å’Œå±€éƒ¨æœ€å¤§å˜é‡åšç›¸åº”å¤„ç†ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public int maxProduct(int[] nums) &#123;</span><br><span class="line">        int maxpro=nums[0];</span><br><span class="line">        for (int i = 0; i &lt; nums.length; i++) &#123;</span><br><span class="line">            int localpro=nums[i];</span><br><span class="line">            maxpro = Math.max(maxpro, localpro);</span><br><span class="line">            for (int j = i+1; j &lt; nums.length; j++) &#123;</span><br><span class="line">                localpro *= nums[j];</span><br><span class="line">                maxpro = Math.max(maxpro, localpro);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return maxpro;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums ï¼Œè¯·ä½ æ‰¾å‡ºæ•°ç»„ä¸­ä¹˜ç§¯æœ€å¤§çš„è¿ç»­å­æ•°ç»„ï¼ˆè¯¥å­æ•°ç»„ä¸­è‡³å°‘åŒ…å«ä¸€ä¸ªæ•°å­—ï¼‰ï¼Œå¹¶è¿”å›è¯¥å­æ•°ç»„æ‰€å¯¹åº”çš„ä¹˜ç§¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
  </entry>
  
  <entry>
    <title>189. æ—‹è½¬æ•°ç»„</title>
    <link href="http://yoursite.com/2020/06/29/189.%20%E6%97%8B%E8%BD%AC%E6%95%B0%E7%BB%84/"/>
    <id>http://yoursite.com/2020/06/29/189. æ—‹è½¬æ•°ç»„/</id>
    <published>2020-06-29T06:06:12.000Z</published>
    <updated>2020-06-29T06:23:14.982Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå°†æ•°ç»„ä¸­çš„å…ƒç´ å‘å³ç§»åŠ¨ k ä¸ªä½ç½®ï¼Œå…¶ä¸­ k æ˜¯éè´Ÿæ•°ã€‚</p><a id="more"></a><p>ç¤ºä¾‹ 1:</p><pre><code>è¾“å…¥: [1,2,3,4,5,6,7] å’Œ k = 3è¾“å‡º: [5,6,7,1,2,3,4]è§£é‡Š:å‘å³æ—‹è½¬ 1 æ­¥: [7,1,2,3,4,5,6]å‘å³æ—‹è½¬ 2 æ­¥: [6,7,1,2,3,4,5]å‘å³æ—‹è½¬ 3 æ­¥: [5,6,7,1,2,3,4]</code></pre><p>ç¤ºä¾‹ 2:</p><pre><code>è¾“å…¥: [-1,-100,3,99] å’Œ k = 2è¾“å‡º: [3,99,-1,-100]è§£é‡Š: å‘å³æ—‹è½¬ 1 æ­¥: [99,-1,-100,3]å‘å³æ—‹è½¬ 2 æ­¥: [3,99,-1,-100]</code></pre><p>è¯´æ˜:</p><pre><code>å°½å¯èƒ½æƒ³å‡ºæ›´å¤šçš„è§£å†³æ–¹æ¡ˆï¼Œè‡³å°‘æœ‰ä¸‰ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚è¦æ±‚ä½¿ç”¨ç©ºé—´å¤æ‚åº¦ä¸º O(1) çš„ åŸåœ° ç®—æ³•ã€‚</code></pre><h2 id="æ–¹æ³•-1ï¼šæš´åŠ›"><a href="#æ–¹æ³•-1ï¼šæš´åŠ›" class="headerlink" title="æ–¹æ³• 1ï¼šæš´åŠ›"></a>æ–¹æ³• 1ï¼šæš´åŠ›</h2><p>æœ€ç®€å•çš„æ–¹æ³•æ˜¯æ—‹è½¬ k æ¬¡ï¼Œæ¯æ¬¡å°†æ•°ç»„æ—‹è½¬ 1 ä¸ªå…ƒç´ ã€‚</p><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> temp, previous;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; k; i++) &#123;</span><br><span class="line">            previous = nums[nums.length - <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; nums.length; j++) &#123;</span><br><span class="line">                temp = nums[j];</span><br><span class="line">                nums[j] = previous;</span><br><span class="line">                previous = temp;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(n*k)</em> ã€‚æ¯ä¸ªå…ƒç´ éƒ½è¢«ç§»åŠ¨ 1 æ­¥ï¼ˆ<em>O(n)</em>ï¼‰ kæ¬¡ï¼ˆ<em>O(k)</em>ï¼‰ ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(1)</em> ã€‚æ²¡æœ‰é¢å¤–ç©ºé—´è¢«ä½¿ç”¨ã€‚</li></ul><h2 id="æ–¹æ³•-2ï¼šä½¿ç”¨é¢å¤–çš„æ•°ç»„"><a href="#æ–¹æ³•-2ï¼šä½¿ç”¨é¢å¤–çš„æ•°ç»„" class="headerlink" title="æ–¹æ³• 2ï¼šä½¿ç”¨é¢å¤–çš„æ•°ç»„"></a>æ–¹æ³• 2ï¼šä½¿ç”¨é¢å¤–çš„æ•°ç»„</h2><p><strong>ç®—æ³•</strong></p><p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªé¢å¤–çš„æ•°ç»„æ¥å°†æ¯ä¸ªå…ƒç´ æ”¾åˆ°æ­£ç¡®çš„ä½ç½®ä¸Šï¼Œä¹Ÿå°±æ˜¯åŸæœ¬æ•°ç»„é‡Œä¸‹æ ‡ä¸º <em>i</em> çš„æˆ‘ä»¬æŠŠå®ƒæ”¾åˆ° <img src="./p___i+k_%%E6%95%B0%E7%BB%84%E9%95%BF%E5%BA%A6_.png" alt="(i+k)\%æ•°ç»„é•¿åº¦ ">  çš„ä½ç½®ã€‚ç„¶åæŠŠæ–°çš„æ•°ç»„æ‹·è´åˆ°åŸæ•°ç»„ä¸­ã€‚</p><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] a = <span class="keyword">new</span> <span class="keyword">int</span>[nums.length];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            a[(i + k) % nums.length] = nums[i];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; nums.length; i++) &#123;</span><br><span class="line">            nums[i] = a[i];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š <em>O(n)</em> ã€‚å°†æ•°å­—æ”¾åˆ°æ–°çš„æ•°ç»„ä¸­éœ€è¦ä¸€ééå†ï¼Œå¦ä¸€è¾¹æ¥æŠŠæ–°æ•°ç»„çš„å…ƒç´ æ‹·è´å›åŸæ•°ç»„ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼š <em>O(n)</em>ã€‚å¦ä¸€ä¸ªæ•°ç»„éœ€è¦åŸæ•°ç»„é•¿åº¦çš„ç©ºé—´ã€‚</li></ul><h2 id="æ–¹æ³•-3ï¼šä½¿ç”¨ç¯çŠ¶æ›¿æ¢"><a href="#æ–¹æ³•-3ï¼šä½¿ç”¨ç¯çŠ¶æ›¿æ¢" class="headerlink" title="æ–¹æ³• 3ï¼šä½¿ç”¨ç¯çŠ¶æ›¿æ¢"></a>æ–¹æ³• 3ï¼šä½¿ç”¨ç¯çŠ¶æ›¿æ¢</h2><p><strong>ç®—æ³•</strong></p><p>å¦‚æœæˆ‘ä»¬ç›´æ¥æŠŠæ¯ä¸€ä¸ªæ•°å­—æ”¾åˆ°å®ƒæœ€åçš„ä½ç½®ï¼Œä½†è¿™æ ·çš„åæœæ˜¯é—å¤±åŸæ¥çš„å…ƒç´ ã€‚å› æ­¤ï¼Œæˆ‘ä»¬éœ€è¦æŠŠè¢«æ›¿æ¢çš„æ•°å­—ä¿å­˜åœ¨å˜é‡ <em>temp</em> é‡Œé¢ã€‚ç„¶åï¼Œæˆ‘ä»¬å°†è¢«æ›¿æ¢æ•°å­—ï¼ˆ<em>temp*ï¼‰æ”¾åˆ°å®ƒæ­£ç¡®çš„ä½ç½®ï¼Œå¹¶ç»§ç»­è¿™ä¸ªè¿‡ç¨‹ *n</em> æ¬¡ï¼Œ <em>n</em> æ˜¯æ•°ç»„çš„é•¿åº¦ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬éœ€è¦å°†æ•°ç»„é‡Œæ‰€æœ‰çš„å…ƒç´ éƒ½ç§»åŠ¨ã€‚ä½†æ˜¯ï¼Œè¿™ç§æ–¹æ³•å¯èƒ½ä¼šæœ‰ä¸ªé—®é¢˜ï¼Œå¦‚æœ <img src="./p__n%k==0_.png" alt="n\%k==0 "> ï¼Œå…¶ä¸­ <img src="./p__k=k%n_.png" alt="k=k\%n ">  ï¼ˆå› ä¸ºå¦‚æœ <em>k</em> å¤§äº <em>n</em> ï¼Œç§»åŠ¨ <em>k</em> æ¬¡å®é™…ä¸Šç›¸å½“äºç§»åŠ¨ <img src="./p__k%n_.png" alt="k\%n ">  æ¬¡ï¼‰ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬ä¼šå‘ç°åœ¨æ²¡æœ‰éå†æ‰€æœ‰æ•°å­—çš„æƒ…å†µä¸‹å›åˆ°å‡ºå‘æ•°å­—ã€‚æ­¤æ—¶ï¼Œæˆ‘ä»¬åº”è¯¥ä»ä¸‹ä¸€ä¸ªæ•°å­—å¼€å§‹å†é‡å¤ç›¸åŒçš„è¿‡ç¨‹ã€‚</p><p>ç°åœ¨ï¼Œæˆ‘ä»¬çœ‹çœ‹ä¸Šé¢æ–¹æ³•çš„è¯æ˜ã€‚å‡è®¾ï¼Œæ•°ç»„é‡Œæˆ‘ä»¬æœ‰ <em>n</em> ä¸ªå…ƒç´ å¹¶ä¸” <em>k</em> æ˜¯è¦æ±‚ç§»åŠ¨çš„æ¬¡æ•°ã€‚æ›´è¿›ä¸€æ­¥ï¼Œå‡è®¾ <img src="./p__n%k=0_.png" alt="n\%k=0 ">  ã€‚ç¬¬ä¸€è½®ä¸­ï¼Œæ‰€æœ‰ç§»åŠ¨æ•°å­—çš„ä¸‹æ ‡ <em>i</em> æ»¡è¶³ <img src="./p__i%k==0_.png" alt="i\%k==0 ">  ã€‚è¿™æ˜¯å› ä¸ºæˆ‘ä»¬æ¯è·³ <em>k</em> æ­¥ï¼Œæˆ‘ä»¬åªä¼šåˆ°è¾¾ç›¸è·ä¸º <em>k</em> ä¸ªä½ç½®ä¸‹æ ‡çš„æ•°ã€‚æ¯ä¸€è½®ï¼Œæˆ‘ä»¬éƒ½ä¼šç§»åŠ¨ <img src="./p__frac%7Bn%7D%7Bk%7D_.png" alt="\frac{n}{k} ">  ä¸ªå…ƒç´ ã€‚ä¸‹ä¸€è½®ä¸­ï¼Œæˆ‘ä»¬ä¼šç§»åŠ¨æ»¡è¶³ <img src="./p__i%k==1_.png" alt="i\%k==1 ">  çš„ä½ç½®çš„æ•°ã€‚è¿™æ ·çš„è½®æ¬¡ä¼šä¸€ç›´æŒç»­åˆ°æˆ‘ä»¬å†æ¬¡é‡åˆ° <img src="./p__i%k==0_.png" alt="i\%k==0 ">  çš„åœ°æ–¹ä¸ºæ­¢ï¼Œæ­¤æ—¶ <em>i=k</em> ã€‚æ­¤æ—¶åœ¨æ­£ç¡®ä½ç½®ä¸Šçš„æ•°å­—å…±æœ‰ <img src="./p__k_times_frac%7Bn%7D%7Bk%7D=n_.png" alt="k\times\frac{n}{k}=n ">  ä¸ªã€‚å› æ­¤æ‰€æœ‰æ•°å­—éƒ½åœ¨æ­£ç¡®ä½ç½®ä¸Šã€‚</p><p>è®©æˆ‘ä»¬çœ‹ä¸€ä¸‹æ¥ä¸‹æ¥çš„ä¾‹å­ï¼Œä»¥æ›´å¥½åœ°è¯´æ˜è¿™ä¸ªè¿‡ç¨‹ï¼š<br> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nums: [1, 2, 3, 4, 5, 6]</span><br><span class="line">k: 2</span><br></pre></td></tr></table></figure></p><p> <a href="https://pic.leetcode-cn.com/f0493a97cdb7bc46b37306ca14e555451496f9f9c21effcad8517a81a26f30d6-image.png" target="_blank" rel="noopener">ä¾‹å­</a></p><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        k = k % nums.length;</span><br><span class="line">        <span class="keyword">int</span> count = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> start = <span class="number">0</span>; count &lt; nums.length; start++) &#123;</span><br><span class="line">            <span class="keyword">int</span> current = start;</span><br><span class="line">            <span class="keyword">int</span> prev = nums[start];</span><br><span class="line">            <span class="keyword">do</span> &#123;</span><br><span class="line">                <span class="keyword">int</span> next = (current + k) % nums.length;</span><br><span class="line">                <span class="keyword">int</span> temp = nums[next];</span><br><span class="line">                nums[next] = prev;</span><br><span class="line">                prev = temp;</span><br><span class="line">                current = next;</span><br><span class="line">                count++;</span><br><span class="line">            &#125; <span class="keyword">while</span> (start != current);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(n)</em> ã€‚åªéå†äº†æ¯ä¸ªå…ƒç´ ä¸€æ¬¡ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(1)</em> ã€‚ä½¿ç”¨äº†å¸¸æ•°ä¸ªé¢å¤–ç©ºé—´ã€‚</li></ul><h2 id="æ–¹æ³•-4ï¼šä½¿ç”¨åè½¬"><a href="#æ–¹æ³•-4ï¼šä½¿ç”¨åè½¬" class="headerlink" title="æ–¹æ³• 4ï¼šä½¿ç”¨åè½¬"></a>æ–¹æ³• 4ï¼šä½¿ç”¨åè½¬</h2><p><strong>ç®—æ³•</strong></p><p>è¿™ä¸ªæ–¹æ³•åŸºäºè¿™ä¸ªäº‹å®ï¼šå½“æˆ‘ä»¬æ—‹è½¬æ•°ç»„ k æ¬¡ï¼Œ <img src="./p__k%n_.png" alt="k\%n ">  ä¸ªå°¾éƒ¨å…ƒç´ ä¼šè¢«ç§»åŠ¨åˆ°å¤´éƒ¨ï¼Œå‰©ä¸‹çš„å…ƒç´ ä¼šè¢«å‘åç§»åŠ¨ã€‚</p><p>åœ¨è¿™ä¸ªæ–¹æ³•ä¸­ï¼Œæˆ‘ä»¬é¦–å…ˆå°†æ‰€æœ‰å…ƒç´ åè½¬ã€‚ç„¶ååè½¬å‰ k ä¸ªå…ƒç´ ï¼Œå†åè½¬åé¢ <em>n-k</em> ä¸ªå…ƒç´ ï¼Œå°±èƒ½å¾—åˆ°æƒ³è¦çš„ç»“æœã€‚</p><p>æˆ‘ç”¨è¿™ç§æ–¹æ³•æ¥è§£å†³æ—¶é‡åˆ°æ•°ç»„è¶Šç•Œé”™è¯¯ï¼Œæ˜¯å› ä¸ºæ²¡æœ‰æŠŠkå–æ¨¡ï¼Œå› ä¸ºæœ‰äº›æƒ…å†µä¸‹kå¯èƒ½å¤§äºæ•°ç»„é•¿åº¦ã€‚è¿™ä¸ªæ˜“é”™ç‚¹éœ€è¦æ³¨æ„ã€‚</p><p>å‡è®¾ <em>n=7</em> ä¸” <em>k=3</em> ã€‚</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">åŸå§‹æ•°ç»„                  : 1 2 3 4 5 6 7</span><br><span class="line">åè½¬æ‰€æœ‰æ•°å­—å             : 7 6 5 4 3 2 1</span><br><span class="line">åè½¬å‰ k ä¸ªæ•°å­—å          : 5 6 7 4 3 2 1</span><br><span class="line">åè½¬å n-k ä¸ªæ•°å­—å        : 5 6 7 1 2 3 4 --&gt; ç»“æœ</span><br></pre></td></tr></table></figure><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">rotate</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> k)</span> </span>&#123;</span><br><span class="line">        k %= nums.length;</span><br><span class="line">        reverse(nums, <span class="number">0</span>, nums.length - <span class="number">1</span>);</span><br><span class="line">        reverse(nums, <span class="number">0</span>, k - <span class="number">1</span>);</span><br><span class="line">        reverse(nums, k, nums.length - <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">reverse</span><span class="params">(<span class="keyword">int</span>[] nums, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">while</span> (start &lt; end) &#123;</span><br><span class="line">            <span class="keyword">int</span> temp = nums[start];</span><br><span class="line">            nums[start] = nums[end];</span><br><span class="line">            nums[end] = temp;</span><br><span class="line">            start++;</span><br><span class="line">            end--;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(n)</em> ã€‚ <em>n</em> ä¸ªå…ƒç´ è¢«åè½¬äº†æ€»å…± 3 æ¬¡ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(1)</em> ã€‚ æ²¡æœ‰ä½¿ç”¨é¢å¤–çš„ç©ºé—´ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™å®šä¸€ä¸ªæ•°ç»„ï¼Œå°†æ•°ç»„ä¸­çš„å…ƒç´ å‘å³ç§»åŠ¨ k ä¸ªä½ç½®ï¼Œå…¶ä¸­ k æ˜¯éè´Ÿæ•°ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
  </entry>
  
  <entry>
    <title>63. ä¸åŒè·¯å¾„II</title>
    <link href="http://yoursite.com/2020/06/28/63.%20%E4%B8%8D%E5%90%8C%E8%B7%AF%E5%BE%84II/"/>
    <id>http://yoursite.com/2020/06/28/63. ä¸åŒè·¯å¾„II/</id>
    <published>2020-06-28T12:50:12.000Z</published>
    <updated>2020-06-29T06:22:31.214Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€ä¸ªæœºå™¨äººä½äºä¸€ä¸ª m x n ç½‘æ ¼çš„å·¦ä¸Šè§’ ï¼ˆèµ·å§‹ç‚¹åœ¨ä¸‹å›¾ä¸­æ ‡è®°ä¸ºâ€œStartâ€ ï¼‰ã€‚æœºå™¨äººæ¯æ¬¡åªèƒ½å‘ä¸‹æˆ–è€…å‘å³ç§»åŠ¨ä¸€æ­¥ã€‚æœºå™¨äººè¯•å›¾è¾¾åˆ°ç½‘æ ¼çš„å³ä¸‹è§’ï¼ˆåœ¨ä¸‹å›¾ä¸­æ ‡è®°ä¸ºâ€œFinishâ€ï¼‰ã€‚ç°åœ¨è€ƒè™‘ç½‘æ ¼ä¸­æœ‰éšœç¢ç‰©ã€‚é‚£ä¹ˆä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’å°†ä¼šæœ‰å¤šå°‘æ¡ä¸åŒçš„è·¯å¾„ï¼Ÿ</p><a id="more"></a><p>ç½‘æ ¼ä¸­çš„éšœç¢ç‰©å’Œç©ºä½ç½®åˆ†åˆ«ç”¨ 1 å’Œ 0 æ¥è¡¨ç¤ºã€‚</p><p>è¯´æ˜ï¼šm å’Œ n çš„å€¼å‡ä¸è¶…è¿‡ 100ã€‚</p><p>ç¤ºä¾‹1:</p><pre><code>è¾“å…¥:[  [0,0,0],  [0,1,0],  [0,0,0]]è¾“å‡º: 2è§£é‡Š:3x3 ç½‘æ ¼çš„æ­£ä¸­é—´æœ‰ä¸€ä¸ªéšœç¢ç‰©ã€‚ä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’ä¸€å…±æœ‰ 2 æ¡ä¸åŒçš„è·¯å¾„ï¼š1. å‘å³ -&gt; å‘å³ -&gt; å‘ä¸‹ -&gt; å‘ä¸‹2. å‘ä¸‹ -&gt; å‘ä¸‹ -&gt; å‘å³ -&gt; å‘å³</code></pre><h2 id="æ–¹æ³•-1ï¼šåŠ¨æ€è§„åˆ’-1"><a href="#æ–¹æ³•-1ï¼šåŠ¨æ€è§„åˆ’-1" class="headerlink" title="æ–¹æ³• 1ï¼šåŠ¨æ€è§„åˆ’^1"></a>æ–¹æ³• 1ï¼šåŠ¨æ€è§„åˆ’<a href="https://leetcode-cn.com/problems/unique-paths-ii/solution/bu-tong-lu-jing-ii-by-leetcode/" target="_blank" rel="noopener">^1</a></h2><p><strong>ç›´è§‰</strong></p><p>æœºå™¨äººåªå¯ä»¥å‘ä¸‹å’Œå‘å³ç§»åŠ¨ï¼Œå› æ­¤ç¬¬ä¸€è¡Œçš„æ ¼å­åªèƒ½ä»å·¦è¾¹çš„æ ¼å­ç§»åŠ¨åˆ°ï¼Œç¬¬ä¸€åˆ—çš„æ ¼å­åªèƒ½ä»ä¸Šæ–¹çš„æ ¼å­ç§»åŠ¨åˆ°ã€‚</p><p>å¦‚æœæ ¼å­ä¸Šæœ‰éšœç¢ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¸è€ƒè™‘åŒ…å«è¿™ä¸ªæ ¼å­çš„ä»»ä½•è·¯å¾„ã€‚æˆ‘ä»¬ä»å·¦è‡³å³ã€ä»ä¸Šè‡³ä¸‹çš„éå†æ•´ä¸ªæ•°ç»„ï¼Œé‚£ä¹ˆåœ¨åˆ°è¾¾æŸä¸ªé¡¶ç‚¹ä¹‹å‰æˆ‘ä»¬å°±å·²ç»è·å¾—äº†åˆ°è¾¾å‰é©±èŠ‚ç‚¹çš„æ–¹æ¡ˆæ•°ï¼Œè¿™å°±å˜æˆäº†ä¸€ä¸ª<code>åŠ¨æ€è§„åˆ’</code>é—®é¢˜ã€‚æˆ‘ä»¬åªéœ€è¦ä¸€ä¸ª <code>obstacleGrid</code> æ•°ç»„ä½œä¸º DP æ•°ç»„ã€‚</p><p><code>æ³¨æ„ï¼š</code> æ ¹æ®é¢˜ç›®æè¿°ï¼ŒåŒ…å«éšœç¢ç‰©çš„æ ¼ç‚¹æœ‰æƒå€¼ <code>1</code>ï¼Œæˆ‘ä»¬ä¾æ­¤æ¥åˆ¤æ–­æ˜¯å¦åŒ…å«åœ¨è·¯å¾„ä¸­ï¼Œç„¶åæˆ‘ä»¬å¯ä»¥ç”¨è¿™ä¸ªç©ºé—´æ¥å­˜å‚¨åˆ°è¾¾è¿™ä¸ªæ ¼ç‚¹çš„æ–¹æ¡ˆæ•°ã€‚</p><p><strong>ç®—æ³•</strong></p><ol><li>å¦‚æœç¬¬ä¸€ä¸ªæ ¼ç‚¹ <code>obstacleGrid[0,0]</code> æ˜¯ <code>1</code>ï¼Œè¯´æ˜æœ‰éšœç¢ç‰©ï¼Œé‚£ä¹ˆæœºå™¨äººä¸èƒ½åšä»»ä½•ç§»åŠ¨ï¼Œæˆ‘ä»¬è¿”å›ç»“æœ <code>0</code>ã€‚</li><li>å¦åˆ™ï¼Œå¦‚æœ <code>obstacleGrid[0,0]</code> æ˜¯ <code>0</code>ï¼Œæˆ‘ä»¬åˆå§‹åŒ–è¿™ä¸ªå€¼ä¸º <code>1</code> ç„¶åç»§ç»­ç®—æ³•ã€‚</li><li>éå†ç¬¬ä¸€è¡Œï¼Œå¦‚æœæœ‰ä¸€ä¸ªæ ¼ç‚¹åˆå§‹å€¼ä¸º <code>1</code> ï¼Œè¯´æ˜å½“å‰èŠ‚ç‚¹æœ‰éšœç¢ç‰©ï¼Œæ²¡æœ‰è·¯å¾„å¯ä»¥é€šè¿‡ï¼Œè®¾å€¼ä¸º <code>0</code> ï¼›å¦åˆ™è®¾è¿™ä¸ªå€¼æ˜¯å‰ä¸€ä¸ªèŠ‚ç‚¹çš„å€¼ <code>obstacleGrid[i,j] = obstacleGrid[i,j-1]</code>ã€‚</li><li>éå†ç¬¬ä¸€åˆ—ï¼Œå¦‚æœæœ‰ä¸€ä¸ªæ ¼ç‚¹åˆå§‹å€¼ä¸º <code>1</code> ï¼Œè¯´æ˜å½“å‰èŠ‚ç‚¹æœ‰éšœç¢ç‰©ï¼Œæ²¡æœ‰è·¯å¾„å¯ä»¥é€šè¿‡ï¼Œè®¾å€¼ä¸º <code>0</code> ï¼›å¦åˆ™è®¾è¿™ä¸ªå€¼æ˜¯å‰ä¸€ä¸ªèŠ‚ç‚¹çš„å€¼ <code>obstacleGrid[i,j] = obstacleGrid[i-1,j]</code>ã€‚</li><li>ç°åœ¨ï¼Œä» <code>obstacleGrid[1,1]</code> å¼€å§‹éå†æ•´ä¸ªæ•°ç»„ï¼Œå¦‚æœæŸä¸ªæ ¼ç‚¹åˆå§‹ä¸åŒ…å«ä»»ä½•éšœç¢ç‰©ï¼Œå°±æŠŠå€¼èµ‹ä¸ºä¸Šæ–¹å’Œå·¦ä¾§ä¸¤ä¸ªæ ¼ç‚¹æ–¹æ¡ˆæ•°ä¹‹å’Œ <code>obstacleGrid[i,j] = obstacleGrid[i-1,j] + obstacleGrid[i,j-1]</code>ã€‚</li><li>å¦‚æœè¿™ä¸ªç‚¹æœ‰éšœç¢ç‰©ï¼Œè®¾å€¼ä¸º <code>0</code> ï¼Œè¿™å¯ä»¥ä¿è¯ä¸ä¼šå¯¹åé¢çš„è·¯å¾„äº§ç”Ÿè´¡çŒ®ã€‚</li></ol><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">uniquePathsWithObstacles</span><span class="params">(<span class="keyword">int</span>[][] obstacleGrid)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> R = obstacleGrid.length;</span><br><span class="line">        <span class="keyword">int</span> C = obstacleGrid[<span class="number">0</span>].length;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// If the starting cell has an obstacle, then simply return as there would be</span></span><br><span class="line">        <span class="comment">// no paths to the destination.</span></span><br><span class="line">        <span class="keyword">if</span> (obstacleGrid[<span class="number">0</span>][<span class="number">0</span>] == <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Number of ways of reaching the starting cell = 1.</span></span><br><span class="line">        obstacleGrid[<span class="number">0</span>][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Filling the values for the first column</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; R; i++) &#123;</span><br><span class="line">            obstacleGrid[i][<span class="number">0</span>] = (obstacleGrid[i][<span class="number">0</span>] == <span class="number">0</span> &amp;&amp; obstacleGrid[i - <span class="number">1</span>][<span class="number">0</span>] == <span class="number">1</span>) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Filling the values for the first row</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; C; i++) &#123;</span><br><span class="line">            obstacleGrid[<span class="number">0</span>][i] = (obstacleGrid[<span class="number">0</span>][i] == <span class="number">0</span> &amp;&amp; obstacleGrid[<span class="number">0</span>][i - <span class="number">1</span>] == <span class="number">1</span>) ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Starting from cell(1,1) fill up the values</span></span><br><span class="line">        <span class="comment">// No. of ways of reaching cell[i][j] = cell[i - 1][j] + cell[i][j - 1]</span></span><br><span class="line">        <span class="comment">// i.e. From above and left.</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; R; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; C; j++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (obstacleGrid[i][j] == <span class="number">0</span>) &#123;</span><br><span class="line">                    obstacleGrid[i][j] = obstacleGrid[i - <span class="number">1</span>][j] + obstacleGrid[i][j - <span class="number">1</span>];</span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">                    obstacleGrid[i][j] = <span class="number">0</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Return value stored in rightmost bottommost cell. That is the destination.</span></span><br><span class="line">        <span class="keyword">return</span> obstacleGrid[R - <span class="number">1</span>][C - <span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ ï¼š O(M\timesN)   ã€‚é•¿æ–¹å½¢ç½‘æ ¼çš„å¤§å°æ˜¯ M\timesN ï¼Œè€Œè®¿é—®æ¯ä¸ªæ ¼ç‚¹æ°å¥½ä¸€æ¬¡ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ ï¼š <em>O(1)</em>ã€‚æˆ‘ä»¬åˆ©ç”¨ <code>obstacleGrid</code> ä½œä¸º DP æ•°ç»„ï¼Œå› æ­¤ä¸éœ€è¦é¢å¤–çš„ç©ºé—´ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸€ä¸ªæœºå™¨äººä½äºä¸€ä¸ª m x n ç½‘æ ¼çš„å·¦ä¸Šè§’ ï¼ˆèµ·å§‹ç‚¹åœ¨ä¸‹å›¾ä¸­æ ‡è®°ä¸ºâ€œStartâ€ ï¼‰ã€‚æœºå™¨äººæ¯æ¬¡åªèƒ½å‘ä¸‹æˆ–è€…å‘å³ç§»åŠ¨ä¸€æ­¥ã€‚æœºå™¨äººè¯•å›¾è¾¾åˆ°ç½‘æ ¼çš„å³ä¸‹è§’ï¼ˆåœ¨ä¸‹å›¾ä¸­æ ‡è®°ä¸ºâ€œFinishâ€ï¼‰ã€‚ç°åœ¨è€ƒè™‘ç½‘æ ¼ä¸­æœ‰éšœç¢ç‰©ã€‚é‚£ä¹ˆä»å·¦ä¸Šè§’åˆ°å³ä¸‹è§’å°†ä¼šæœ‰å¤šå°‘æ¡ä¸åŒçš„è·¯å¾„ï¼Ÿ&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
  </entry>
  
  <entry>
    <title>980. ä¸åŒè·¯å¾„ III</title>
    <link href="http://yoursite.com/2020/06/28/980.%20%E4%B8%8D%E5%90%8C%E8%B7%AF%E5%BE%84%20III/"/>
    <id>http://yoursite.com/2020/06/28/980. ä¸åŒè·¯å¾„ III/</id>
    <published>2020-06-28T12:50:12.000Z</published>
    <updated>2020-06-29T10:06:02.298Z</updated>
    
    <content type="html"><![CDATA[<p>è¿”å›åœ¨å››ä¸ªæ–¹å‘ï¼ˆä¸Šã€ä¸‹ã€å·¦ã€å³ï¼‰ä¸Šè¡Œèµ°æ—¶ï¼Œä»èµ·å§‹æ–¹æ ¼åˆ°ç»“æŸæ–¹æ ¼çš„ä¸åŒè·¯å¾„çš„æ•°ç›®ï¼Œæ¯ä¸€ä¸ªæ— éšœç¢æ–¹æ ¼éƒ½è¦é€šè¿‡ä¸€æ¬¡ã€‚</p><a id="more"></a><h1 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h1><p>åœ¨äºŒç»´ç½‘æ ¼ grid ä¸Šï¼Œæœ‰ 4 ç§ç±»å‹çš„æ–¹æ ¼ï¼š</p><pre><code>1 è¡¨ç¤ºèµ·å§‹æ–¹æ ¼ã€‚ä¸”åªæœ‰ä¸€ä¸ªèµ·å§‹æ–¹æ ¼ã€‚2 è¡¨ç¤ºç»“æŸæ–¹æ ¼ï¼Œä¸”åªæœ‰ä¸€ä¸ªç»“æŸæ–¹æ ¼ã€‚0 è¡¨ç¤ºæˆ‘ä»¬å¯ä»¥èµ°è¿‡çš„ç©ºæ–¹æ ¼ã€‚-1 è¡¨ç¤ºæˆ‘ä»¬æ— æ³•è·¨è¶Šçš„éšœç¢ã€‚</code></pre><p>è¿”å›åœ¨å››ä¸ªæ–¹å‘ï¼ˆä¸Šã€ä¸‹ã€å·¦ã€å³ï¼‰ä¸Šè¡Œèµ°æ—¶ï¼Œä»èµ·å§‹æ–¹æ ¼åˆ°ç»“æŸæ–¹æ ¼çš„ä¸åŒè·¯å¾„çš„æ•°ç›®ï¼Œæ¯ä¸€ä¸ªæ— éšœç¢æ–¹æ ¼éƒ½è¦é€šè¿‡ä¸€æ¬¡ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼š[[1,0,0,0],[0,0,0,0],[0,0,2,-1]]è¾“å‡ºï¼š2è§£é‡Šï¼šæˆ‘ä»¬æœ‰ä»¥ä¸‹ä¸¤æ¡è·¯å¾„ï¼š1. (0,0),(0,1),(0,2),(0,3),(1,3),(1,2),(1,1),(1,0),(2,0),(2,1),(2,2)2. (0,0),(1,0),(2,0),(2,1),(1,1),(0,1),(0,2),(0,3),(1,3),(1,2),(2,2)</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼š[[1,0,0,0],[0,0,0,0],[0,0,0,2]]è¾“å‡ºï¼š4è§£é‡Šï¼šæˆ‘ä»¬æœ‰ä»¥ä¸‹å››æ¡è·¯å¾„ï¼š 1. (0,0),(0,1),(0,2),(0,3),(1,3),(1,2),(1,1),(1,0),(2,0),(2,1),(2,2),(2,3)2. (0,0),(0,1),(1,1),(1,0),(2,0),(2,1),(2,2),(1,2),(0,2),(0,3),(1,3),(2,3)3. (0,0),(1,0),(2,0),(2,1),(2,2),(1,2),(1,1),(0,1),(0,2),(0,3),(1,3),(2,3)4. (0,0),(1,0),(2,0),(2,1),(1,1),(0,1),(0,2),(0,3),(1,3),(1,2),(2,2),(2,3)</code></pre><p>ç¤ºä¾‹ 3ï¼š</p><pre><code>è¾“å…¥ï¼š[[0,1],[2,0]]è¾“å‡ºï¼š0è§£é‡Šï¼šæ²¡æœ‰ä¸€æ¡è·¯èƒ½å®Œå…¨ç©¿è¿‡æ¯ä¸€ä¸ªç©ºçš„æ–¹æ ¼ä¸€æ¬¡ã€‚è¯·æ³¨æ„ï¼Œèµ·å§‹å’Œç»“æŸæ–¹æ ¼å¯ä»¥ä½äºç½‘æ ¼ä¸­çš„ä»»æ„ä½ç½®ã€‚</code></pre><p>æç¤ºï¼š</p><p>1 &lt;= grid.length * grid[0].length &lt;= 20</p><h4 id="æ–¹æ³•ä¸€ï¼šå›æº¯æ·±åº¦ä¼˜å…ˆæœç´¢"><a href="#æ–¹æ³•ä¸€ï¼šå›æº¯æ·±åº¦ä¼˜å…ˆæœç´¢" class="headerlink" title="æ–¹æ³•ä¸€ï¼šå›æº¯æ·±åº¦ä¼˜å…ˆæœç´¢"></a>æ–¹æ³•ä¸€ï¼šå›æº¯æ·±åº¦ä¼˜å…ˆæœç´¢</h4><p><strong>æ€è·¯ä¸ç®—æ³•</strong><a href="https://leetcode-cn.com/problems/unique-paths-iii/solution/bu-tong-lu-jing-iii-by-leetcode/" target="_blank" rel="noopener">^1</a></p><p>è®©æˆ‘ä»¬å°è¯•éå†æ¯ä¸€ä¸ª <code>0</code> æ–¹æ ¼ï¼Œå¹¶åœ¨èµ°è¿‡çš„æ–¹æ ¼é‡Œç•™ä¸‹ä¸€ä¸ªéšœç¢ã€‚å›æº¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦åˆ é™¤é‚£äº›è‡ªå·±ç•™ä¸‹çš„éšœç¢ã€‚</p><p>ä»‹äºè¾“å…¥æ•°æ®çš„é™åˆ¶ï¼Œè¿™ä¸ªæ–¹æ³•æ˜¯å¯ä»¥é€šè¿‡çš„ï¼Œå› ä¸ºä¸€ä¸ªä¸å¥½çš„è·¯å¾„å¾ˆå¿«å°±ä¼šå› æ²¡æœ‰æ— éšœç¢çš„æ–¹æ ¼å¯ä»¥èµ°è€Œè¢«å¡ä½ã€‚ </p><figure class="highlight java"><figcaption><span>[2RULHstn-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans;</span><br><span class="line">    <span class="keyword">int</span>[][] grid;</span><br><span class="line">    <span class="keyword">int</span> targetR, targetC;</span><br><span class="line">    <span class="keyword">int</span> R, C;</span><br><span class="line">    <span class="keyword">int</span>[] dr = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span>[] dc = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">uniquePathsIII</span><span class="params">(<span class="keyword">int</span>[][] grid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.grid = grid;</span><br><span class="line">        R = grid.length;</span><br><span class="line">        C = grid[<span class="number">0</span>].length;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> todo = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">int</span> sourceR = <span class="number">0</span>, sourceC = <span class="number">0</span>;</span><br><span class="line">        <span class="comment">//è·å–æ— éšœç¢æ–¹æ ¼æ•°é‡å’Œå‡ºå‘ç»ˆæ­¢ä½ç½®</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">0</span>; r &lt; R; r++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">0</span>; c &lt; C; c++) &#123;</span><br><span class="line">                <span class="keyword">if</span> (grid[r][c] != -<span class="number">1</span>) &#123;</span><br><span class="line">                    todo++;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (grid[r][c] == <span class="number">1</span>) &#123;</span><br><span class="line">                    sourceR = r;</span><br><span class="line">                    sourceC = c;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (grid[r][c] == <span class="number">2</span>) &#123;</span><br><span class="line">                    targetR = r;</span><br><span class="line">                    targetC = c;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        ans = <span class="number">0</span>;</span><br><span class="line">        dfs(sourceR, sourceC, todo);</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> r, <span class="keyword">int</span> c, <span class="keyword">int</span> todo)</span> </span>&#123;</span><br><span class="line">        <span class="comment">//æ¯ä¸€ä¸ªæ— éšœç¢æ–¹æ ¼éƒ½è¦é€šè¿‡ä¸€æ¬¡</span></span><br><span class="line">        todo--;</span><br><span class="line">        <span class="keyword">if</span> (todo &lt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//åˆ°è¾¾ç»ˆç‚¹</span></span><br><span class="line">        <span class="keyword">if</span> (r == targetR &amp;&amp; c == targetC) &#123;</span><br><span class="line">            <span class="keyword">if</span> (todo == <span class="number">0</span>) &#123;</span><br><span class="line">                ans++;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//åœ¨èµ°è¿‡çš„æ–¹æ ¼é‡Œç•™ä¸‹ä¸€ä¸ªéšœç¢</span></span><br><span class="line">        grid[r][c] = <span class="number">3</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; k++) &#123;</span><br><span class="line">            <span class="keyword">int</span> nr = r + dr[k];</span><br><span class="line">            <span class="keyword">int</span> nc = c + dc[k];</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">0</span> &lt;= nr &amp;&amp; nr &lt; R &amp;&amp; <span class="number">0</span> &lt;= nc &amp;&amp; nc &lt; C) &#123;</span><br><span class="line">                <span class="comment">//å°è¯•éå†æ¯ä¸€ä¸ª `0` æ–¹æ ¼</span></span><br><span class="line">                <span class="keyword">if</span> (grid[nr][nc] % <span class="number">2</span> == <span class="number">0</span>) &#123;</span><br><span class="line">                    dfs(nr, nc, todo);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//å›æº¯çš„æ—¶å€™ï¼Œæˆ‘ä»¬è¦åˆ é™¤é‚£äº›è‡ªå·±ç•™ä¸‹çš„éšœç¢ã€‚</span></span><br><span class="line">        grid[r][c] = <span class="number">0</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>[2RULHstn-Python]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">uniquePathsIII</span><span class="params">(self, grid)</span>:</span></span><br><span class="line">        R, C = len(grid), len(grid[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">nei</span>***<span class="title">ors</span><span class="params">(r, c)</span>:</span></span><br><span class="line">            <span class="keyword">for</span> nr, nc <span class="keyword">in</span> ((r<span class="number">-1</span>, c), (r, c<span class="number">-1</span>), (r+<span class="number">1</span>, c), (r, c+<span class="number">1</span>)):</span><br><span class="line">                <span class="keyword">if</span> <span class="number">0</span> &lt;= nr &lt; R <span class="keyword">and</span> <span class="number">0</span> &lt;= nc &lt; C <span class="keyword">and</span> grid[nr][nc] % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">yield</span> nr, nc</span><br><span class="line"></span><br><span class="line">        todo = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> r, row <span class="keyword">in</span> enumerate(grid):</span><br><span class="line">            <span class="keyword">for</span> c, val <span class="keyword">in</span> enumerate(row):</span><br><span class="line">                <span class="keyword">if</span> val != <span class="number">-1</span>: todo += <span class="number">1</span></span><br><span class="line">                <span class="keyword">if</span> val == <span class="number">1</span>: sr, sc = r, c</span><br><span class="line">                <span class="keyword">if</span> val == <span class="number">2</span>: tr, tc = r, c</span><br><span class="line"></span><br><span class="line">        self.ans = <span class="number">0</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(r, c, todo)</span>:</span></span><br><span class="line">            todo -= <span class="number">1</span></span><br><span class="line">            <span class="keyword">if</span> todo &lt; <span class="number">0</span>: <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">if</span> r == tr <span class="keyword">and</span> c == tc:</span><br><span class="line">                <span class="keyword">if</span> todo == <span class="number">0</span>:</span><br><span class="line">                    self.ans += <span class="number">1</span></span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line"></span><br><span class="line">            grid[r][c] = <span class="number">-1</span></span><br><span class="line">            <span class="keyword">for</span> nr, nc <span class="keyword">in</span> nei***ors(r, c):</span><br><span class="line">                dfs(nr, nc, todo)</span><br><span class="line">            grid[r][c] = <span class="number">0</span></span><br><span class="line"></span><br><span class="line">        dfs(sr, sc, todo)</span><br><span class="line">        <span class="keyword">return</span> self.ans</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li><p>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(4^{R<em>C})</em>ï¼Œå…¶ä¸­ *R, C</em> æ˜¯è¿™ä¸ªäºŒç»´ç½‘æ ¼è¡Œä¸åˆ—çš„å¤§å°ã€‚ï¼ˆæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªæ›´åŠ ç²¾ç¡®çš„ç•Œé™ï¼Œä½†æ˜¯è¿™ä¸ªç•Œé™å·²ç»è¶…è¶Šäº†æœ¬æ–‡çš„èŒƒå›´ï¼‰</p></li><li><p>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(R</em>C)*ã€‚</p></li></ul><hr><h4 id="æ–¹æ³•äºŒï¼šåŠ¨æ€è§„åˆ’"><a href="#æ–¹æ³•äºŒï¼šåŠ¨æ€è§„åˆ’" class="headerlink" title="æ–¹æ³•äºŒï¼šåŠ¨æ€è§„åˆ’"></a>æ–¹æ³•äºŒï¼šåŠ¨æ€è§„åˆ’</h4><p><strong>æ€è·¯ä¸ç®—æ³•</strong></p><p>è®©æˆ‘ä»¬å®šä¹‰ <code>dp(r, c, todo)</code> ä¸ºä»  <code>(r, c)</code> å¼€å§‹è¡Œèµ°ï¼Œè¿˜æ²¡æœ‰éå†çš„æ— éšœç¢æ–¹æ ¼é›†åˆä¸º <code>todo</code> çš„å¥½è·¯å¾„çš„æ•°é‡ã€‚</p><p>æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªä¸ <em>æ–¹æ³•ä¸€</em> ç±»ä¼¼çš„æ–¹æ³•ï¼Œå¹¶é€šè¿‡è®°å¿†åŒ–çŠ¶æ€ <code>(r, c, todo)</code> çš„ç­”æ¡ˆæ¥é¿å…é‡å¤æœç´¢ã€‚</p><figure class="highlight java"><figcaption><span>[pRtnUqNa-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> ans;</span><br><span class="line">    <span class="keyword">int</span>[][] grid;</span><br><span class="line">    <span class="keyword">int</span> R, C;</span><br><span class="line">    <span class="keyword">int</span> tr, tc, target;</span><br><span class="line">    <span class="keyword">int</span>[] dr = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span>[] dc = <span class="keyword">new</span> <span class="keyword">int</span>[]&#123;<span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    Integer[][][] memo;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">uniquePathsIII</span><span class="params">(<span class="keyword">int</span>[][] grid)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.grid = grid;</span><br><span class="line">        R = grid.length;</span><br><span class="line">        C = grid[<span class="number">0</span>].length;</span><br><span class="line">        target = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> sr = <span class="number">0</span>, sc = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> r = <span class="number">0</span>; r &lt; R; ++r)</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> c = <span class="number">0</span>; c &lt; C; ++c) &#123;</span><br><span class="line">                <span class="keyword">if</span> (grid[r][c] % <span class="number">2</span> == <span class="number">0</span>)</span><br><span class="line">                    target |= code(r, c);</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> (grid[r][c] == <span class="number">1</span>) &#123;</span><br><span class="line">                    sr = r;</span><br><span class="line">                    sc = c;</span><br><span class="line">                &#125; <span class="keyword">else</span> <span class="keyword">if</span> (grid[r][c] == <span class="number">2</span>) &#123;</span><br><span class="line">                    tr = r;</span><br><span class="line">                    tc = c;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">        memo = <span class="keyword">new</span> Integer[R][C][<span class="number">1</span> &lt;&lt; R*C];</span><br><span class="line">        <span class="keyword">return</span> dp(sr, sc, target);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">code</span><span class="params">(<span class="keyword">int</span> r, <span class="keyword">int</span> c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span> &lt;&lt; (r * C + c);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">dp</span><span class="params">(<span class="keyword">int</span> r, <span class="keyword">int</span> c, <span class="keyword">int</span> todo)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (memo[r][c][todo] != <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> memo[r][c][todo];</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (r == tr &amp;&amp; c == tc) &#123;</span><br><span class="line">            <span class="keyword">return</span> todo == <span class="number">0</span> ? <span class="number">1</span> : <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> ans = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; <span class="number">4</span>; ++k) &#123;</span><br><span class="line">            <span class="keyword">int</span> nr = r + dr[k];</span><br><span class="line">            <span class="keyword">int</span> nc = c + dc[k];</span><br><span class="line">            <span class="keyword">if</span> (<span class="number">0</span> &lt;= nr &amp;&amp; nr &lt; R &amp;&amp; <span class="number">0</span> &lt;= nc &amp;&amp; nc &lt; C) &#123;</span><br><span class="line">                <span class="keyword">if</span> ((todo &amp; code(nr, nc)) != <span class="number">0</span>)</span><br><span class="line">                    ans += dp(nr, nc, todo ^ code(nr, nc));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        memo[r][c][todo] = ans;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight python"><figcaption><span>[pRtnUqNa-Python]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> lru_cache</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">uniquePathsIII</span><span class="params">(self, grid)</span>:</span></span><br><span class="line">        R, C = len(grid), len(grid[<span class="number">0</span>])</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">code</span><span class="params">(r, c)</span>:</span></span><br><span class="line">            <span class="keyword">return</span> <span class="number">1</span> &lt;&lt; (r * C + c)</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">nei</span>***<span class="title">ors</span><span class="params">(r, c)</span>:</span></span><br><span class="line">            <span class="keyword">for</span> nr, nc <span class="keyword">in</span> ((r<span class="number">-1</span>, c), (r, c<span class="number">-1</span>), (r+<span class="number">1</span>, c), (r, c+<span class="number">1</span>)):</span><br><span class="line">                <span class="keyword">if</span> <span class="number">0</span> &lt;= nr &lt; R <span class="keyword">and</span> <span class="number">0</span> &lt;= nc &lt; C <span class="keyword">and</span> grid[nr][nc] % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    <span class="keyword">yield</span> nr, nc</span><br><span class="line"></span><br><span class="line">        target = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> r, row <span class="keyword">in</span> enumerate(grid):</span><br><span class="line">            <span class="keyword">for</span> c, val <span class="keyword">in</span> enumerate(row):</span><br><span class="line">                <span class="keyword">if</span> val % <span class="number">2</span> == <span class="number">0</span>:</span><br><span class="line">                    target |= code(r, c)</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> val == <span class="number">1</span>:</span><br><span class="line">                    sr, sc = r, c</span><br><span class="line">                <span class="keyword">if</span> val == <span class="number">2</span>:</span><br><span class="line">                    tr, tc = r, c</span><br><span class="line"></span><br><span class="line"><span class="meta">        @lru_cache(None)</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dp</span><span class="params">(r, c, todo)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> r == tr <span class="keyword">and</span> c == tc:</span><br><span class="line">                <span class="keyword">return</span> +(todo == <span class="number">0</span>)</span><br><span class="line"></span><br><span class="line">            ans = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> nr, nc <span class="keyword">in</span> nei***ors(r, c):</span><br><span class="line">                <span class="keyword">if</span> todo &amp; code(nr, nc):</span><br><span class="line">                    ans += dp(nr, nc, todo ^ code(nr, nc))</span><br><span class="line">            <span class="keyword">return</span> ans</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> dp(sr, sc, target)</span><br></pre></td></tr></table></figure><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(R * C * 2^{R<em>C})</em>ï¼Œå…¶ä¸­ *R, C</em> æ˜¯ç»™å®šäºŒç»´ç½‘æ ¼è¡Œä¸åˆ—çš„å¤§å°ã€‚</li><li>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(R * C * 2^{R</em>C})*ã€‚</li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿”å›åœ¨å››ä¸ªæ–¹å‘ï¼ˆä¸Šã€ä¸‹ã€å·¦ã€å³ï¼‰ä¸Šè¡Œèµ°æ—¶ï¼Œä»èµ·å§‹æ–¹æ ¼åˆ°ç»“æŸæ–¹æ ¼çš„ä¸åŒè·¯å¾„çš„æ•°ç›®ï¼Œæ¯ä¸€ä¸ªæ— éšœç¢æ–¹æ ¼éƒ½è¦é€šè¿‡ä¸€æ¬¡ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Depth-first Search" scheme="http://yoursite.com/tags/Depth-first-Search/"/>
    
      <category term="Backtracking" scheme="http://yoursite.com/tags/Backtracking/"/>
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
  </entry>
  
  <entry>
    <title>62. ä¸åŒè·¯å¾„</title>
    <link href="http://yoursite.com/2020/06/28/62.%20%E4%B8%8D%E5%90%8C%E8%B7%AF%E5%BE%84/"/>
    <id>http://yoursite.com/2020/06/28/62. ä¸åŒè·¯å¾„/</id>
    <published>2020-06-28T12:12:12.000Z</published>
    <updated>2020-06-28T14:32:49.381Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€ä¸ªæœºå™¨äººä½äºä¸€ä¸ª m x n ç½‘æ ¼çš„å·¦ä¸Šè§’ ï¼ˆèµ·å§‹ç‚¹åœ¨ä¸‹å›¾ä¸­æ ‡è®°ä¸ºâ€œStartâ€ ï¼‰ã€‚æœºå™¨äººæ¯æ¬¡åªèƒ½å‘ä¸‹æˆ–è€…å‘å³ç§»åŠ¨ä¸€æ­¥ã€‚æœºå™¨äººè¯•å›¾è¾¾åˆ°ç½‘æ ¼çš„å³ä¸‹è§’ï¼ˆåœ¨ä¸‹å›¾ä¸­æ ‡è®°ä¸ºâ€œFinishâ€ï¼‰ã€‚é—®æ€»å…±æœ‰å¤šå°‘æ¡ä¸åŒçš„è·¯å¾„ï¼Ÿ</p><a id="more"></a><h1 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h1><p>ä¾‹å¦‚ï¼Œä¸Šå›¾æ˜¯ä¸€ä¸ª7 x 3 çš„ç½‘æ ¼ã€‚æœ‰å¤šå°‘å¯èƒ½çš„è·¯å¾„ï¼Ÿ</p><p>ç¤ºä¾‹ 1:</p><pre><code>è¾“å…¥: m = 3, n = 2è¾“å‡º: 3è§£é‡Š:ä»å·¦ä¸Šè§’å¼€å§‹ï¼Œæ€»å…±æœ‰ 3 æ¡è·¯å¾„å¯ä»¥åˆ°è¾¾å³ä¸‹è§’ã€‚1. å‘å³ -&gt; å‘å³ -&gt; å‘ä¸‹2. å‘å³ -&gt; å‘ä¸‹ -&gt; å‘å³3. å‘ä¸‹ -&gt; å‘å³ -&gt; å‘å³</code></pre><p>ç¤ºä¾‹ 2:</p><pre><code>è¾“å…¥: m = 7, n = 3è¾“å‡º: 28</code></pre><p>æç¤ºï¼š</p><pre><code>1 &lt;= m, n &lt;= 100</code></pre><p>é¢˜ç›®æ•°æ®ä¿è¯ç­”æ¡ˆå°äºç­‰äº 2 * 10 ^ 9</p><h1 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h1><h2 id="æ€è·¯ä¸€ï¼šæ’åˆ—ç»„åˆ"><a href="#æ€è·¯ä¸€ï¼šæ’åˆ—ç»„åˆ" class="headerlink" title="æ€è·¯ä¸€ï¼šæ’åˆ—ç»„åˆ"></a><strong>æ€è·¯ä¸€ï¼šæ’åˆ—ç»„åˆ</strong></h2><p>å› ä¸ºæœºå™¨åˆ°åº•å³ä¸‹è§’ï¼Œå‘ä¸‹å‡ æ­¥ï¼Œå‘å³å‡ æ­¥éƒ½æ˜¯å›ºå®šçš„ï¼Œ</p><p>æ¯”å¦‚ï¼Œ<code>m=3, n=2</code>ï¼Œæˆ‘ä»¬åªè¦å‘ä¸‹ 1 æ­¥ï¼Œå‘å³ 2 æ­¥å°±ä¸€å®šèƒ½åˆ°è¾¾ç»ˆç‚¹ã€‚</p><p>æ‰€ä»¥æœ‰ <em>C_{m+n-2}^{m-1}</em></p><figure class="highlight python"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">uniquePaths</span><span class="params">(self, m: int, n: int)</span> -&gt; int:</span></span><br><span class="line">        <span class="keyword">return</span> int(math.factorial(m+n<span class="number">-2</span>)/math.factorial(m<span class="number">-1</span>)/math.factorial(n<span class="number">-1</span>))</span><br></pre></td></tr></table></figure><h2 id="æ€è·¯äºŒï¼šåŠ¨æ€è§„åˆ’"><a href="#æ€è·¯äºŒï¼šåŠ¨æ€è§„åˆ’" class="headerlink" title="æ€è·¯äºŒï¼šåŠ¨æ€è§„åˆ’"></a><strong>æ€è·¯äºŒï¼šåŠ¨æ€è§„åˆ’</strong></h2><p>æˆ‘ä»¬ä»¤ <code>dp[i][j]</code> æ˜¯åˆ°è¾¾ <code>i, j</code> æœ€å¤šè·¯å¾„</p><p>åŠ¨æ€æ–¹ç¨‹ï¼š<code>dp[i][j] = dp[i-1][j] + dp[i][j-1]</code></p><p>æ³¨æ„ï¼Œå¯¹äºç¬¬ä¸€è¡Œ <code>dp[0][j]</code>ï¼Œæˆ–è€…ç¬¬ä¸€åˆ— <code>dp[i][0]</code>ï¼Œç”±äºéƒ½æ˜¯åœ¨è¾¹ç•Œï¼Œæ‰€ä»¥åªèƒ½ä¸º <code>1</code></p><p>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(m*n)</em></p><p>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(m * n)</em></p><h2 id="ä¼˜åŒ–ï¼šå› ä¸ºæˆ‘ä»¬æ¯æ¬¡åªéœ€è¦-dp-i-1-j-dp-i-j-1"><a href="#ä¼˜åŒ–ï¼šå› ä¸ºæˆ‘ä»¬æ¯æ¬¡åªéœ€è¦-dp-i-1-j-dp-i-j-1" class="headerlink" title="ä¼˜åŒ–ï¼šå› ä¸ºæˆ‘ä»¬æ¯æ¬¡åªéœ€è¦ dp[i-1][j],dp[i][j-1]"></a>ä¼˜åŒ–ï¼šå› ä¸ºæˆ‘ä»¬æ¯æ¬¡åªéœ€è¦ <code>dp[i-1][j],dp[i][j-1]</code></h2><p>æ‰€ä»¥æˆ‘ä»¬åªè¦è®°å½•è¿™ä¸¤ä¸ªæ•°ï¼Œç›´æ¥çœ‹ä»£ç å§ï¼</p><h3 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h3><p>æ€è·¯äºŒï¼š</p><figure class="highlight java"><figcaption><span>[1]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">uniquePaths</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[][] dp = <span class="keyword">new</span> <span class="keyword">int</span>[m][n];</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i++) dp[<span class="number">0</span>][i] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; m; i++) dp[i][<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; m; i++) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; n; j++) &#123;</span><br><span class="line">                dp[i][j] = dp[i - <span class="number">1</span>][j] + dp[i][j - <span class="number">1</span>];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[m - <span class="number">1</span>][n - <span class="number">1</span>];  </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼˜åŒ–1ï¼šç©ºé—´å¤æ‚åº¦ <em>O(2n)</em></p><figure class="highlight java"><figcaption><span>[2]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">uniquePaths</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] pre = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        <span class="keyword">int</span>[] cur = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        Arrays.fill(pre, <span class="number">1</span>);</span><br><span class="line">        Arrays.fill(cur,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; n; j++)&#123;</span><br><span class="line">                cur[j] = cur[j-<span class="number">1</span>] + pre[j];</span><br><span class="line">            &#125;</span><br><span class="line">            pre = cur.clone();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> pre[n-<span class="number">1</span>]; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¼˜åŒ–2ï¼šç©ºé—´å¤æ‚åº¦ <em>O(n)</em></p><figure class="highlight java"><figcaption><span>[3]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">uniquePaths</span><span class="params">(<span class="keyword">int</span> m, <span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] cur = <span class="keyword">new</span> <span class="keyword">int</span>[n];</span><br><span class="line">        Arrays.fill(cur,<span class="number">1</span>);</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; m;i++)&#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">1</span>; j &lt; n; j++)&#123;</span><br><span class="line">                cur[j] += cur[j-<span class="number">1</span>] ;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> cur[n-<span class="number">1</span>];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸€ä¸ªæœºå™¨äººä½äºä¸€ä¸ª m x n ç½‘æ ¼çš„å·¦ä¸Šè§’ ï¼ˆèµ·å§‹ç‚¹åœ¨ä¸‹å›¾ä¸­æ ‡è®°ä¸ºâ€œStartâ€ ï¼‰ã€‚æœºå™¨äººæ¯æ¬¡åªèƒ½å‘ä¸‹æˆ–è€…å‘å³ç§»åŠ¨ä¸€æ­¥ã€‚æœºå™¨äººè¯•å›¾è¾¾åˆ°ç½‘æ ¼çš„å³ä¸‹è§’ï¼ˆåœ¨ä¸‹å›¾ä¸­æ ‡è®°ä¸ºâ€œFinishâ€ï¼‰ã€‚é—®æ€»å…±æœ‰å¤šå°‘æ¡ä¸åŒçš„è·¯å¾„ï¼Ÿ&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
  </entry>
  
  <entry>
    <title>212. å•è¯æœç´¢II</title>
    <link href="http://yoursite.com/2020/06/28/212.%20%E5%8D%95%E8%AF%8D%E6%90%9C%E7%B4%A2II/"/>
    <id>http://yoursite.com/2020/06/28/212. å•è¯æœç´¢II/</id>
    <published>2020-06-28T10:12:12.000Z</published>
    <updated>2020-06-28T12:02:17.704Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™å®šä¸€ä¸ªäºŒç»´ç½‘æ ¼boardå’Œä¸€ä¸ªå­—å…¸ä¸­çš„å•è¯åˆ—è¡¨ wordsï¼Œæ‰¾å‡ºæ‰€æœ‰åŒæ—¶åœ¨äºŒç»´ç½‘æ ¼å’Œå­—å…¸ä¸­å‡ºç°çš„å•è¯ã€‚</p><a id="more"></a><h1 id="é¢˜ç›®æè¿°"><a href="#é¢˜ç›®æè¿°" class="headerlink" title="é¢˜ç›®æè¿°"></a>é¢˜ç›®æè¿°</h1><p>å•è¯å¿…é¡»æŒ‰ç…§å­—æ¯é¡ºåºï¼Œé€šè¿‡ç›¸é‚»çš„å•å…ƒæ ¼å†…çš„å­—æ¯æ„æˆï¼Œå…¶ä¸­â€œç›¸é‚»â€å•å…ƒæ ¼æ˜¯é‚£äº›æ°´å¹³ç›¸é‚»æˆ–å‚ç›´ç›¸é‚»çš„å•å…ƒæ ¼ã€‚åŒä¸€ä¸ªå•å…ƒæ ¼å†…çš„å­—æ¯åœ¨ä¸€ä¸ªå•è¯ä¸­ä¸å…è®¸è¢«é‡å¤ä½¿ç”¨ã€‚</p><p>ç¤ºä¾‹:</p><p>è¾“å…¥: </p><pre><code>words = [&quot;oath&quot;,&quot;pea&quot;,&quot;eat&quot;,&quot;rain&quot;] and board =[  [&apos;o&apos;,&apos;a&apos;,&apos;a&apos;,&apos;n&apos;],  [&apos;e&apos;,&apos;t&apos;,&apos;a&apos;,&apos;e&apos;],  [&apos;i&apos;,&apos;h&apos;,&apos;k&apos;,&apos;r&apos;],  [&apos;i&apos;,&apos;f&apos;,&apos;l&apos;,&apos;v&apos;]]</code></pre><p>è¾“å‡º:</p><pre><code>[&quot;eat&quot;,&quot;oath&quot;]</code></pre><p>è¯´æ˜:</p><p>ä½ å¯ä»¥å‡è®¾æ‰€æœ‰è¾“å…¥éƒ½ç”±å°å†™å­—æ¯ a-z ç»„æˆã€‚</p><p>æç¤º:</p><ul><li><p>ä½ éœ€è¦ä¼˜åŒ–å›æº¯ç®—æ³•ä»¥é€šè¿‡æ›´å¤§æ•°æ®é‡çš„æµ‹è¯•ã€‚ä½ èƒ½å¦æ—©ç‚¹åœæ­¢å›æº¯ï¼Ÿ</p></li><li><p>å¦‚æœå½“å‰å•è¯ä¸å­˜åœ¨äºæ‰€æœ‰å•è¯çš„å‰ç¼€ä¸­ï¼Œåˆ™å¯ä»¥ç«‹å³åœæ­¢å›æº¯ã€‚ä»€ä¹ˆæ ·çš„æ•°æ®ç»“æ„å¯ä»¥æœ‰æ•ˆåœ°æ‰§è¡Œè¿™æ ·çš„æ“ä½œï¼Ÿæ•£åˆ—è¡¨æ˜¯å¦å¯è¡Œï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ å‰ç¼€æ ‘å¦‚ä½•ï¼Ÿå¦‚æœä½ æƒ³å­¦ä¹ å¦‚ä½•å®ç°ä¸€ä¸ªåŸºæœ¬çš„å‰ç¼€æ ‘ï¼Œè¯·å…ˆæŸ¥çœ‹è¿™ä¸ªé—®é¢˜ï¼š å®ç°Trieï¼ˆå‰ç¼€æ ‘ï¼‰ã€‚</p></li></ul><h4 id="æ–¹æ³•ä¸€ï¼šä½¿ç”¨å‰ç¼€æ ‘çš„å›æº¯"><a href="#æ–¹æ³•ä¸€ï¼šä½¿ç”¨å‰ç¼€æ ‘çš„å›æº¯" class="headerlink" title="æ–¹æ³•ä¸€ï¼šä½¿ç”¨å‰ç¼€æ ‘çš„å›æº¯"></a>æ–¹æ³•ä¸€ï¼šä½¿ç”¨å‰ç¼€æ ‘çš„å›æº¯</h4><p>è¿™ä¸ªé—®é¢˜å®é™…ä¸Šæ˜¯ä¸€ä¸ªç®€åŒ–çš„çºµæ¨ªå¡«å­—æ¸¸æˆï¼Œåœ¨è¿™ä¸ªæ¸¸æˆä¸­ï¼Œå•è¯çš„è§£å·²ç»è¢«åµŒå…¥äº†ä¸€äº›æ— å…³å­—æ¯ã€‚æˆ‘ä»¬è¦åšçš„å°±æ˜¯æŠŠå®ƒä»¬åˆ’æ‰ã€‚</p><p>ç›´è§‚åœ°è¯´ï¼Œä¸ºäº†åˆ’æ‰æ‰€æœ‰æ½œåœ¨çš„å•è¯ï¼Œæ€»ä½“ç­–ç•¥æ˜¯ä¸€ä¸ªæ¥ä¸€ä¸ªåœ°è¿­ä»£å•å…ƒæ ¼ï¼Œç„¶åä»æ¯ä¸ªå•å…ƒæ ¼æ²¿ç€å®ƒçš„å››ä¸ªæ½œåœ¨æ–¹å‘çš„èµ°ï¼Œæ‰¾åˆ°åŒ¹é…çš„å•è¯ã€‚</p><p>å½“æˆ‘ä»¬åœ¨é»‘æ¿ä¸Šå¾˜å¾Šæ—¶ï¼Œè‹¥æˆ‘ä»¬çŸ¥é“è¿™ä¸ä¼šå‘ç°æ–°å•è¯æ—¶ï¼Œæˆ‘ä»¬ä¼šåœæ­¢æ¢ç´¢ã€‚</p><p>æœ‰äººå¯èƒ½å·²ç»çŒœåˆ°äº†æˆ‘ä»¬ç”¨æ¥è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•ã€‚æ˜¯çš„ï¼Œå®ƒæ˜¯å›æº¯ï¼Œè¿™å°†æ˜¯è§£å†³æ–¹æ¡ˆçš„ä¸»å¹²ã€‚æ„é€ ä¸€ä¸ªå›æº¯çš„è§£å†³æ–¹æ¡ˆæ˜¯ç›¸å½“ç®€å•çš„ã€‚</p><p>è§£å†³è¿™ä¸ªé—®é¢˜çš„å…³é”®åœ¨äºæˆ‘ä»¬å¦‚ä½•ä»å­—å…¸ä¸­æ‰¾åˆ°å•è¯çš„åŒ¹é…é¡¹ã€‚ç›´è§‚åœ°è¯´ï¼Œå¯ä»¥ä½¿ç”¨ hashset æ•°æ®ç»“æ„ï¼ˆä¾‹å¦‚Python ä¸­çš„ <code>set()</code>ï¼‰ã€‚</p><p>ç„¶è€Œï¼Œåœ¨å›æº¯è¿‡ç¨‹ä¸­ï¼Œäººä»¬ä¼šæ›´ç»å¸¸åœ°é‡åˆ°è¿™æ ·çš„é—®é¢˜ï¼šæ˜¯å¦å­˜åœ¨ä»»ä½•åŒ…å«ç‰¹å®šå‰ç¼€çš„å•è¯ï¼Œè€Œä¸æ˜¯æ˜¯å¦æœ‰ä¸€ä¸ªå­—ç¬¦ä¸²ä½œä¸ºå•è¯å­˜åœ¨äºå­—å…¸ä¸­ã€‚å› ä¸ºå¦‚æœæˆ‘ä»¬çŸ¥é“ç»™å®šå‰ç¼€çš„å­—å…¸ä¸­ä¸å­˜åœ¨ä»»ä½•å•è¯åŒ¹é…ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±ä¸éœ€è¦è¿›ä¸€æ­¥æ¢ç´¢æŸä¸ªæ–¹å‘ã€‚è€Œè¿™ï¼Œå°†å¤§å¤§å‡å°‘æ¢æµ‹ç©ºé—´ï¼Œä»è€Œæé«˜å›æº¯ç®—æ³•çš„æ€§èƒ½ã€‚</p><p>èƒ½å¤ŸæŸ¥æ‰¾å‰ç¼€çš„æ•°æ®ç»“æ„å« Trieï¼Œäº hashset æ¯”è¾ƒã€‚Trie ä¸ä»…å¯ä»¥æ£€æŸ¥ä¸€ä¸ªå•è¯ï¼Œè¿˜å¯ä»¥ç«‹å³æ‰¾åˆ°å…±äº«ç»™å®šå‰ç¼€çš„å•è¯ã€‚äº‹å®è¯æ˜ï¼Œæ•°æ®ç»“æ„çš„é€‰æ‹©ï¼ˆTrie ä¸ hashsetï¼‰å¯èƒ½ä»¥æ’åå‰ 5% æˆ–å 5% çš„è§£å†³æ–¹æ¡ˆç»“æŸã€‚</p><p>è¿™é‡Œæˆ‘ä»¬å±•ç¤ºäº†ä¸€ä¸ªç”±å•è¯åˆ—è¡¨æ„å»ºçš„ Trie ç¤ºä¾‹ã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºï¼Œåœ¨æ‰€è¡¨ç¤ºçš„èŠ‚ç‚¹å¤„ï¼Œæˆ‘ä»¬å°†çŸ¥é“å­—å…¸ä¸­è‡³å°‘æœ‰ä¸¤ä¸ªå‰ç¼€ä¸º <code>d</code> çš„å•è¯ã€‚</p><p> <a href="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl90cmllX2V4YW1wbGUucG5n?x-oss-process=image/format,png" target="_blank" rel="noopener">ä¸€ä¸ªç”±å•è¯åˆ—è¡¨æ„å»ºçš„ Trie ç¤ºä¾‹</a></p><p>æˆ‘ä»¬åœ¨å®ç° Trie æ•°æ®ç»“æ„æ—¶é‡åˆ°éº»çƒ¦ã€‚æˆ‘ä»¬å¯ä»¥ä»<a href="https://leetcode.com/problems/implement-trie-prefix-tree/" target="_blank" rel="noopener">Trie é—®é¢˜</a>å¼€å§‹ä½œä¸ºçƒ­èº«ï¼Œç„¶åå†å›æ¥è¿™ä¸ªé—®é¢˜ã€‚</p><p><strong>ç®—æ³•ï¼š</strong></p><p>è¯¥ç®—æ³•çš„æ•´ä¸ªå·¥ä½œæµç¨‹æ˜¯ç›´è§‚çš„ï¼ŒåŒ…æ‹¬åœ¨äºŒç»´ç½‘æ ¼ä¸­çš„æ¯ä¸ªå•å…ƒä¸Šå¾ªç¯å’Œä»å•å…ƒå¼€å§‹çš„é€’å½’å‡½æ•°è°ƒç”¨ã€‚è¿™æ˜¯ç®—æ³•çš„æ¡†æ¶ã€‚</p><ul><li>æˆ‘ä»¬æ ¹æ®å­—å…¸ä¸­çš„å•è¯æ„å»ºä¸€ä¸ª Trieï¼Œç¨åå°†ç”¨äºåŒ¹é…è¿‡ç¨‹ã€‚</li><li>ä»æ¯ä¸ªå•å…ƒæ ¼å¼€å§‹ï¼Œå¦‚æœå­—å…¸ä¸­å­˜åœ¨ä»¥å•å…ƒæ ¼ä¸­çš„å­—æ¯å¼€å¤´çš„å•è¯,åˆ™æˆ‘ä»¬å¼€å§‹å›æº¯æ¢ç´¢ï¼ˆå³ <code>backtracking(cell)</code>ï¼‰ã€‚</li><li>åœ¨é€’å½’å‡½æ•° <code>backtracking(cell)</code> è°ƒç”¨è¿‡ç¨‹ä¸­ï¼Œæˆ‘ä»¬æ¢ç´¢å½“å‰å•å…ƒæ ¼å‘¨å›´çš„ç›¸é‚»å•å…ƒæ ¼ï¼ˆå³ <code>neighborCell</code>ï¼‰ä»¥è¿›è¡Œä¸‹ä¸€ä¸ªé€’å½’è°ƒç”¨ <code>backtracking(neighborCell)</code>ã€‚åœ¨æ¯æ¬¡è°ƒç”¨æ—¶ï¼Œæˆ‘ä»¬éƒ½ä¼šæ£€æŸ¥åˆ°ç›®å‰ä¸ºæ­¢éå†çš„å­—æ¯åºåˆ—æ˜¯å¦ä¸å­—å…¸ä¸­çš„ä»»ä½•å•è¯åŒ¹é…ï¼Œè¿™éœ€è¦å€ŸåŠ©äºæˆ‘ä»¬åœ¨å¼€å§‹æ—¶æ„å»ºçš„ Trie æ•°æ®ç»“æ„ã€‚</li></ul><p>ä¸‹é¢æ˜¯ç®—æ³•çš„å·¥ä½œåŸç†çš„ã€‚åŸºäºä¸Šè¿°æ€æƒ³ï¼Œæˆ‘ä»¬ç»™å‡ºäº†ä¸€äº›ç¤ºä¾‹å®ç°ã€‚ä¹‹åï¼Œæˆ‘ä»¬è¯¦ç»†ä»‹ç»äº†ä¸€äº›å¯ä»¥è¿›ä¸€æ­¥åº”ç”¨äºè¯¥ç®—æ³•çš„ä¼˜åŒ–ã€‚</p><p> <a href="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl90cmllX2FsZ28ucG5n?x-oss-process=image/format,png" target="_blank" rel="noopener">ç®—æ³•çš„å·¥ä½œåŸç†</a></p><figure class="highlight java"><figcaption><span>[solution1-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">TrieNode</span> </span>&#123;</span><br><span class="line">  HashMap&lt;Character, TrieNode&gt; children = <span class="keyword">new</span> HashMap&lt;Character, TrieNode&gt;();</span><br><span class="line">  String word = <span class="keyword">null</span>;</span><br><span class="line">  <span class="function"><span class="keyword">public</span> <span class="title">TrieNode</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">  <span class="keyword">char</span>[][] _board = <span class="keyword">null</span>;</span><br><span class="line">  ArrayList&lt;String&gt; _result = <span class="keyword">new</span> ArrayList&lt;String&gt;();</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">public</span> List&lt;String&gt; <span class="title">findWords</span><span class="params">(<span class="keyword">char</span>[][] board, String[] words)</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Step 1). Construct the Trie</span></span><br><span class="line">    TrieNode root = <span class="keyword">new</span> TrieNode();</span><br><span class="line">    <span class="keyword">for</span> (String word : words) &#123;</span><br><span class="line">      TrieNode node = root;</span><br><span class="line"></span><br><span class="line">      <span class="keyword">for</span> (Character letter : word.toCharArray()) &#123;</span><br><span class="line">        <span class="keyword">if</span> (node.children.containsKey(letter)) &#123;</span><br><span class="line">          node = node.children.get(letter);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">          TrieNode newNode = <span class="keyword">new</span> TrieNode();</span><br><span class="line">          node.children.put(letter, newNode);</span><br><span class="line">          node = newNode;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">      node.word = word;  <span class="comment">// store words in Trie</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">this</span>._board = board;</span><br><span class="line">    <span class="comment">// Step 2). Backtracking starting for each cell in the board</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> row = <span class="number">0</span>; row &lt; board.length; ++row) &#123;</span><br><span class="line">      <span class="keyword">for</span> (<span class="keyword">int</span> col = <span class="number">0</span>; col &lt; board[row].length; ++col) &#123;</span><br><span class="line">        <span class="keyword">if</span> (root.children.containsKey(board[row][col])) &#123;</span><br><span class="line">          backtracking(row, col, root);</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">this</span>._result;</span><br><span class="line">  &#125;</span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">backtracking</span><span class="params">(<span class="keyword">int</span> row, <span class="keyword">int</span> col, TrieNode parent)</span> </span>&#123;</span><br><span class="line">    Character letter = <span class="keyword">this</span>._board[row][col];</span><br><span class="line">    TrieNode currNode = parent.children.get(letter);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// check if there is any match</span></span><br><span class="line">    <span class="keyword">if</span> (currNode.word != <span class="keyword">null</span>) &#123;</span><br><span class="line">      <span class="keyword">this</span>._result.add(currNode.word);</span><br><span class="line">      currNode.word = <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// mark the current letter before the EXPLORATION</span></span><br><span class="line">    <span class="keyword">this</span>._board[row][col] = <span class="string">'#'</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// explore neighbor cells in around-clock directions: up, right, down, left</span></span><br><span class="line">    <span class="keyword">int</span>[] rowOffset = &#123;-<span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>&#125;;</span><br><span class="line">    <span class="keyword">int</span>[] colOffset = &#123;<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, -<span class="number">1</span>&#125;;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">4</span>; ++i) &#123;</span><br><span class="line">      <span class="keyword">int</span> newRow = row + rowOffset[i];</span><br><span class="line">      <span class="keyword">int</span> newCol = col + colOffset[i];</span><br><span class="line">      <span class="keyword">if</span> (newRow &lt; <span class="number">0</span> || newRow &gt;= <span class="keyword">this</span>._board.length || newCol &lt; <span class="number">0</span></span><br><span class="line">          || newCol &gt;= <span class="keyword">this</span>._board[<span class="number">0</span>].length) &#123;</span><br><span class="line">        <span class="keyword">continue</span>;</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">if</span> (currNode.children.containsKey(<span class="keyword">this</span>._board[newRow][newCol])) &#123;</span><br><span class="line">        backtracking(newRow, newCol, currNode);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// End of EXPLORATION, restore the original letter in the board.</span></span><br><span class="line">    <span class="keyword">this</span>._board[row][col] = letter;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Optimization: incrementally remove the leaf nodes</span></span><br><span class="line">    <span class="keyword">if</span> (currNode.children.isEmpty()) &#123;</span><br><span class="line">      parent.children.remove(letter);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æ›´å¥½åœ°ç†è§£å›æº¯è¿‡ç¨‹ï¼Œæˆ‘ä»¬å°†åœ¨ä¸‹é¢çš„åŠ¨ç”»ä¸­æ¼”ç¤ºå¦‚ä½•åœ¨ Trie ä¸­æ‰¾åˆ° <code>dog</code>ã€‚</p><p>  [1](<a href="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl9zbGlkZV8xLnBuZw?x-oss-process=image/format" target="_blank" rel="noopener">https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl9zbGlkZV8xLnBuZw?x-oss-process=image/format</a> png) </p><p>  [2](<a href="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl9zbGlkZV8yLnBuZw?x-oss-process=image/format" target="_blank" rel="noopener">https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl9zbGlkZV8yLnBuZw?x-oss-process=image/format</a> png)  </p><p>  [3](<a href="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl9zbGlkZV8zLnBuZw?x-oss-process=image/format" target="_blank" rel="noopener">https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl9zbGlkZV8zLnBuZw?x-oss-process=image/format</a> png)  </p><p>  [4](<a href="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl9zbGlkZV80LnBuZw?x-oss-process=image/format" target="_blank" rel="noopener">https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl9zbGlkZV80LnBuZw?x-oss-process=image/format</a> png)  </p><p>  [5](<a href="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl9zbGlkZV81LnBuZw?x-oss-process=image/format" target="_blank" rel="noopener">https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl9zbGlkZV81LnBuZw?x-oss-process=image/format</a> png)  </p><p>  [6](<a href="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl9zbGlkZV82LnBuZw?x-oss-process=image/format" target="_blank" rel="noopener">https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl9zbGlkZV82LnBuZw?x-oss-process=image/format</a> png) </p><h2 id="ä¼˜åŒ–ï¼š"><a href="#ä¼˜åŒ–ï¼š" class="headerlink" title="ä¼˜åŒ–ï¼š"></a><strong>ä¼˜åŒ–</strong>ï¼š</h2><p>åœ¨ä¸Šè¿°å®ç°ä¸­ï¼Œé™¤äº†åº”ç”¨ Trie æ•°æ®ç»“æ„å¤–ï¼Œæˆ‘ä»¬è¿˜åº”ç”¨äº†ä¸€äº›æŠ€å·§æ¥è¿›ä¸€æ­¥åŠ å¿«è¿è¡Œæ—¶é—´ã€‚ç‰¹åˆ«æ˜¯ï¼ŒPython å®ç°çš„è¿è¡Œé€Ÿåº¦å¯ä»¥è¶…è¿‡ 98% çš„æäº¤ã€‚æˆ‘ä»¬æŒ‰å…¶é‡è¦æ€§å°†è¿™äº›æŠ€å·§è¯¦è¿°å¦‚ä¸‹ã€‚</p><ul><li>æ²¿ç€ Trie çš„èŠ‚ç‚¹å›æº¯ã€‚</li></ul><p>äººä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨ Trie ä½œä¸ºå­—å…¸æ¥å¿«é€Ÿæ‰¾åˆ°å•è¯å’Œå‰ç¼€çš„åŒ¹é…ï¼Œå³åœ¨å›æº¯çš„æ¯ä¸€æ­¥ï¼Œæˆ‘ä»¬éƒ½ä»Trie çš„æ ¹å¼€å§‹ã€‚</p><p>ç„¶è€Œï¼Œæ›´æœ‰æ•ˆçš„æ–¹æ³•æ˜¯å°† Trie ä¸å›æº¯è¿‡ç¨‹ä¸€èµ·éå†ï¼Œå³æ¯ä¸€æ­¥ <code>backtracking(TrieNode)</code>ï¼Œ<code>TrieNode</code> çš„æ·±åº¦å¯¹åº”äºæˆ‘ä»¬åˆ°ç›®å‰ä¸ºæ­¢åŒ¹é…çš„å‰ç¼€çš„é•¿åº¦ã€‚è¿™é¡¹æªæ–½å¯ä»¥å°†æ‚¨çš„è§£å†³æ–¹æ¡ˆä»æäº¤çš„æœ€ä½ <em>5%</em> ä¸­è„±é¢–å‡ºæ¥ã€‚</p><ul><li>åœ¨å›æº¯è¿‡ç¨‹ä¸­é€æ¸å‰ªé™¤ Trie ä¸­çš„èŠ‚ç‚¹ï¼ˆå‰ªæï¼‰ã€‚</li></ul><p>è¿™ä¸ªæƒ³æ³•çš„åŠ¨æœºæ˜¯æ•´ä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦å–å†³äº Trie çš„å¤§å°ã€‚å¯¹äº Trie ä¸­çš„å¶èŠ‚ç‚¹ï¼Œä¸€æ—¦éå†å®ƒï¼ˆå³æ‰¾åˆ°åŒ¹é…çš„å•è¯ï¼‰ï¼Œå°±ä¸éœ€è¦å†éå†å®ƒäº†ã€‚ç»“æœï¼Œæˆ‘ä»¬å¯ä»¥æŠŠå®ƒä»æ ‘ä¸Šå‰ªä¸‹æ¥ã€‚</p><p>é€æ¸åœ°ï¼Œè¿™äº›éå¶èŠ‚ç‚¹å¯ä»¥æˆä¸ºå¶èŠ‚ç‚¹ä»¥åï¼Œå› ä¸ºæˆ‘ä»¬ä¿®å‰ªä»–ä»¬çš„å­©å­å¶èŠ‚ç‚¹ã€‚åœ¨æç«¯æƒ…å†µä¸‹ï¼Œä¸€æ—¦æˆ‘ä»¬æ‰¾åˆ°å­—å…¸ä¸­æ‰€æœ‰å•è¯çš„åŒ¹é…é¡¹ï¼ŒTrie å°±ä¼šå˜æˆç©ºçš„ã€‚è¿™ä¸ªå‰ªææªæ–½å¯ä»¥å‡å°‘åœ¨çº¿æµ‹è¯•ç”¨ä¾‹ 50% çš„è¿è¡Œæ—¶é—´ã€‚</p><p> <a href="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl90cmllX3BydW5lLnBuZw?x-oss-process=image/format,png" target="_blank" rel="noopener">å‰ªæ</a></p><ul><li>ä» Trie ä¸­åˆ é™¤åŒ¹é…çš„å•è¯ã€‚</li></ul><p>åœ¨è¿™ä¸ªé—®é¢˜ä¸­ï¼Œæˆ‘ä»¬è¢«è¦æ±‚è¿”å›æ‰€æœ‰åŒ¹é…çš„å•è¯ï¼Œè€Œä¸æ˜¯æ½œåœ¨åŒ¹é…çš„æ•°é‡ã€‚å› æ­¤ï¼Œä¸€æ—¦åˆ°è¾¾åŒ…å«å•è¯åŒ¹é…çš„ç‰¹å®š Trie èŠ‚ç‚¹ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä» Trie ä¸­åˆ é™¤åŒ¹é…å•è¯ã€‚</p><p>ä½œä¸ºé™„å¸¦å¥½å¤„ï¼Œæˆ‘ä»¬ä¸éœ€è¦æ£€æŸ¥ç»“æœé›†ä¸­æ˜¯å¦æœ‰ä»»ä½•é‡å¤é¡¹ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ç®€å•åœ°ä½¿ç”¨ä¸€ä¸ªåˆ—è¡¨è€Œä¸æ˜¯é›†åˆæ¥ä¿å­˜ç»“æœï¼Œè¿™æ ·å¯ä»¥åŠ å¿«è§£å†³æ–¹æ¡ˆçš„é€Ÿåº¦ã€‚</p><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li><p>æ—¶é—´å¤æ‚åº¦ï¼š<em>\mathcal{O}(M(4\cdot3^{L-1}))<em>ï¼Œå…¶ä¸­</em>M</em> æ˜¯äºŒç»´ç½‘æ ¼ä¸­çš„å•å…ƒæ ¼æ•°ï¼Œ<em>L</em> æ˜¯å•è¯çš„æœ€å¤§é•¿åº¦ã€‚</p><ul><li>è®¡ç®—å›æº¯ç®—æ³•å°†æ‰§è¡Œçš„ç¡®åˆ‡æ­¥æ•°æ˜¯ä¸€ä¸ªæ£˜æ‰‹çš„é—®é¢˜ã€‚æˆ‘ä»¬ä¸ºè¿™ä¸ªé—®é¢˜çš„æœ€åæƒ…å†µæä¾›äº†è¯¥æ­¥éª¤çš„ä¸Šé™ã€‚è¯¥ç®—æ³•å¾ªç¯éå†äºŒç»´ç½‘æ ¼ä¸­çš„æ‰€æœ‰å•å…ƒï¼Œå› æ­¤åœ¨å¤æ‚åº¦å…¬å¼ä¸­æˆ‘ä»¬æœ‰ <em>M</em> ä½œä¸ºå› å­ã€‚ç„¶åå°†å…¶å½’ç»“ä¸ºæ¯ä¸ªå¯åŠ¨å•å…ƒæ‰€éœ€çš„æœ€å¤§æ­¥éª¤æ•°ï¼ˆå³ <em>4\cdot3^{L-1}</em>ï¼‰ã€‚</li><li>å‡è®¾å•è¯çš„æœ€å¤§é•¿åº¦æ˜¯ <em>L</em>ï¼Œä»ä¸€ä¸ªå•å…ƒæ ¼å¼€å§‹ï¼Œæœ€åˆæˆ‘ä»¬æœ€å¤šå¯ä»¥æ¢ç´¢ 4 ä¸ªæ–¹å‘ã€‚å‡è®¾æ¯ä¸ªæ–¹å‘éƒ½æ˜¯æœ‰æ•ˆçš„ï¼ˆå³æœ€åæƒ…å†µï¼‰ï¼Œåœ¨æ¥ä¸‹æ¥çš„æ¢ç´¢ä¸­ï¼Œæˆ‘ä»¬æœ€å¤šæœ‰ 3 ä¸ªç›¸é‚»çš„å•å…ƒï¼ˆä¸åŒ…æ‹¬æˆ‘ä»¬æ¥çš„å•å…ƒï¼‰è¦æ¢ç´¢ã€‚å› æ­¤ï¼Œåœ¨å›æº¯æ¢ç´¢æœŸé—´ï¼Œæˆ‘ä»¬æœ€å¤šéå† <em>4\cdot3^{L-1}</em> ä¸ªå•å…ƒæ ¼ã€‚</li><li>ä½ å¯èƒ½ä¼šæƒ³æœ€åçš„æƒ…å†µæ˜¯ä»€ä¹ˆæ ·å­ã€‚è¿™é‡Œæœ‰ä¸€ä¸ªä¾‹å­ã€‚æƒ³è±¡ä¸€ä¸‹ï¼ŒäºŒç»´ç½‘æ ¼ä¸­çš„æ¯ä¸ªå•å…ƒéƒ½åŒ…å«å­—æ¯ <code>a</code>ï¼Œå•è¯è¯å…¸åŒ…å«ä¸€ä¸ªå•è¯ <code>[&#39;aaaa&#39;]</code>ã€‚è¿™æ˜¯ç®—æ³•å°†é‡åˆ°çš„æœ€åçš„æƒ…å†µä¹‹ä¸€ã€‚</li></ul><p><a href="https://imgconvert.csdnimg.cn/aHR0cHM6Ly9waWMubGVldGNvZGUtY24uY29tL0ZpZ3VyZXMvMjEyLzIxMl9jb21wbGV4aXR5X2V4YW1wbGUucG5n?x-oss-process=image/format,png" target="_blank" rel="noopener">æœ€åçš„æƒ…å†µ</a></p></li></ul><p>æ³¨æ„ï¼Œä¸Šè¿°æ—¶é—´å¤æ‚æ€§æ˜¯åœ¨ Trie æ•°æ®ç»“æ„ä¸€æ—¦æ„å»ºå°±ä¸ä¼šæ”¹å˜çš„å‡è®¾ä¸‹ä¼°è®¡çš„ã€‚å¦‚æœé‡‡ç”¨ä¼˜åŒ–ç­–ç•¥é€æ­¥åˆ é™¤ Trie ä¸­çš„èŠ‚ç‚¹ï¼Œåˆ™å¯ä»¥å¤§å¤§æé«˜æ—¶é—´å¤æ‚åº¦ï¼Œå› ä¸ºä¸€æ—¦åŒ¹é…è¯å…¸ä¸­çš„æ‰€æœ‰å•è¯ï¼Œå³ Trie å˜ä¸ºç©ºï¼Œå›æº¯çš„æˆæœ¬å°±ä¼šé™ä½åˆ°é›¶ã€‚ </p><ul><li>ç©ºé—´å¤æ‚åº¦ï¼š<em>\mathcal{O}(N)*ï¼Œå…¶ä¸­ *N</em> æ˜¯å­—å…¸ä¸­çš„å­—æ¯æ€»æ•°ã€‚<ul><li>ç®—æ³•æ¶ˆè€—çš„ä¸»è¦ç©ºé—´æ˜¯æˆ‘ä»¬æ„å»ºçš„ Trie æ•°æ®ç»“æ„ã€‚åœ¨æœ€åçš„æƒ…å†µä¸‹ï¼Œå¦‚æœå•è¯ä¹‹é—´æ²¡æœ‰å‰ç¼€é‡å ï¼Œåˆ™ Trie å°†æ‹¥æœ‰ä¸æ‰€æœ‰å•è¯çš„å­—æ¯ä¸€æ ·å¤šçš„èŠ‚ç‚¹ã€‚ä¹Ÿå¯ä»¥é€‰æ‹©åœ¨ Trie ä¸­ä¿ç•™å•è¯çš„å‰¯æœ¬ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯èƒ½éœ€è¦ *2N$ çš„ç©ºé—´ç”¨äº Trieã€‚</li></ul></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™å®šä¸€ä¸ªäºŒç»´ç½‘æ ¼boardå’Œä¸€ä¸ªå­—å…¸ä¸­çš„å•è¯åˆ—è¡¨ wordsï¼Œæ‰¾å‡ºæ‰€æœ‰åŒæ—¶åœ¨äºŒç»´ç½‘æ ¼å’Œå­—å…¸ä¸­å‡ºç°çš„å•è¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Backtracking" scheme="http://yoursite.com/tags/Backtracking/"/>
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Trie" scheme="http://yoursite.com/tags/Trie/"/>
    
  </entry>
  
  <entry>
    <title>Javaç¼–ç¨‹æ€æƒ³-ç¬¬äºŒåä¸‰ç«  æ³¨è§£é˜…è¯»ç¬”è®°</title>
    <link href="http://yoursite.com/2020/06/28/Java%E7%BC%96%E7%A8%8B%E6%80%9D%E6%83%B3-%E7%AC%AC%E4%BA%8C%E5%8D%81%E4%B8%89%E7%AB%A0%20%E6%B3%A8%E8%A7%A3%E9%98%85%E8%AF%BB%E7%AC%94%E8%AE%B0/"/>
    <id>http://yoursite.com/2020/06/28/Javaç¼–ç¨‹æ€æƒ³-ç¬¬äºŒåä¸‰ç«  æ³¨è§£é˜…è¯»ç¬”è®°/</id>
    <published>2020-06-28T02:59:12.000Z</published>
    <updated>2020-06-29T06:23:06.841Z</updated>
    
    <content type="html"><![CDATA[<p>æ¥å£å’ŒæŠ½è±¡ç±»æä¾›äº†ä¸€ç§å°†æ¥å£ä¸å®ç°åˆ†ç¦»çš„æ›´åŠ ç»“æ„åŒ–çš„æ–¹æ³•ã€‚</p><a id="more"></a><p>[TOC]</p><!-- Annotations --><h1 id="ç¬¬äºŒåä¸‰ç« -æ³¨è§£"><a href="#ç¬¬äºŒåä¸‰ç« -æ³¨è§£" class="headerlink" title="ç¬¬äºŒåä¸‰ç«  æ³¨è§£"></a>ç¬¬äºŒåä¸‰ç«  æ³¨è§£</h1><p>æ³¨è§£ï¼ˆä¹Ÿè¢«ç§°ä¸ºå…ƒæ•°æ®ï¼‰ä¸ºæˆ‘ä»¬åœ¨ä»£ç ä¸­æ·»åŠ ä¿¡æ¯æä¾›äº†ä¸€ç§å½¢å¼åŒ–çš„æ–¹å¼ï¼Œä½¿æˆ‘ä»¬å¯ä»¥åœ¨ç¨åçš„æŸä¸ªæ—¶åˆ»æ›´å®¹æ˜“çš„ä½¿ç”¨è¿™äº›æ•°æ®ã€‚</p><p>æ³¨è§£åœ¨ä¸€å®šç¨‹åº¦ä¸Šæ˜¯æŠŠå…ƒæ•°æ®å’Œæºä»£ç æ–‡ä»¶ç»“åˆåœ¨ä¸€èµ·çš„è¶‹åŠ¿æ‰€æ¿€å‘çš„ï¼Œè€Œä¸æ˜¯ä¿å­˜åœ¨å¤–éƒ¨æ–‡æ¡£ã€‚è¿™åŒæ ·æ˜¯å¯¹åƒ C# è¯­è¨€å¯¹äº Java è¯­è¨€ç‰¹æ€§å‹åŠ›çš„ä¸€ç§å›åº”ã€‚</p><p>æ³¨è§£æ˜¯ Java 5 æ‰€å¼•å…¥çš„ä¼—å¤šè¯­è¨€å˜åŒ–ä¹‹ä¸€ã€‚å®ƒä»¬æä¾›äº† Java æ— æ³•è¡¨è¾¾çš„ä½†æ˜¯ä½ éœ€è¦å®Œæ•´è¡¨è¿°ç¨‹åºæ‰€éœ€çš„ä¿¡æ¯ã€‚å› æ­¤ï¼Œæ³¨è§£ä½¿å¾—æˆ‘ä»¬å¯ä»¥ä»¥ç¼–è¯‘å™¨éªŒè¯çš„æ ¼å¼å­˜å‚¨ç¨‹åºçš„é¢å¤–ä¿¡æ¯ã€‚æ³¨è§£å¯ä»¥ç”Ÿæˆæè¿°ç¬¦æ–‡ä»¶ï¼Œç”šè‡³æ˜¯æ–°çš„ç±»å®šä¹‰ï¼Œå¹¶ä¸”æœ‰åŠ©äºå‡è½»ç¼–å†™â€œæ ·æ¿â€ä»£ç çš„è´Ÿæ‹…ã€‚é€šè¿‡ä½¿ç”¨æ³¨è§£ï¼Œä½ å¯ä»¥å°†å…ƒæ•°æ®ä¿å­˜åœ¨ Java æºä»£ç ä¸­ã€‚å¹¶æ‹¥æœ‰å¦‚ä¸‹ä¼˜åŠ¿ï¼šç®€å•æ˜“è¯»çš„ä»£ç ï¼Œç¼–è¯‘å™¨ç±»å‹æ£€æŸ¥ï¼Œä½¿ç”¨ annotation API ä¸ºè‡ªå·±çš„æ³¨è§£æ„é€ å¤„ç†å·¥å…·ã€‚å³ä½¿ Java å®šä¹‰äº†ä¸€äº›ç±»å‹çš„å…ƒæ•°æ®ï¼Œä½†æ˜¯ä¸€èˆ¬æ¥è¯´æ³¨è§£ç±»å‹çš„æ·»åŠ å’Œå¦‚ä½•ä½¿ç”¨å®Œå…¨å–å†³äºä½ ã€‚</p><p>æ³¨è§£çš„è¯­æ³•ååˆ†ç®€å•ï¼Œä¸»è¦æ˜¯åœ¨ç°æœ‰è¯­æ³•ä¸­æ·»åŠ  @ ç¬¦å·ã€‚Java 5 å¼•å…¥äº†å‰ä¸‰ç§å®šä¹‰åœ¨ <strong>java.lang</strong> åŒ…ä¸­çš„æ³¨è§£ï¼š</p><ul><li><strong>@Override</strong>ï¼šè¡¨ç¤ºå½“å‰çš„æ–¹æ³•å®šä¹‰å°†è¦†ç›–åŸºç±»çš„æ–¹æ³•ã€‚å¦‚æœä½ ä¸å°å¿ƒæ‹¼å†™é”™è¯¯ï¼Œæˆ–è€…æ–¹æ³•ç­¾åè¢«é”™è¯¯æ‹¼å†™çš„æ—¶å€™ï¼Œç¼–è¯‘å™¨å°±ä¼šå‘å‡ºé”™è¯¯æç¤ºã€‚</li><li><strong>@Deprecated</strong>ï¼šå¦‚æœä½¿ç”¨è¯¥æ³¨è§£çš„å…ƒç´ è¢«è°ƒç”¨ï¼Œç¼–è¯‘å™¨å°±ä¼šå‘å‡ºè­¦å‘Šä¿¡æ¯ã€‚</li><li><strong>@SuppressWarnings</strong>ï¼šå…³é—­ä¸å½“çš„ç¼–è¯‘å™¨è­¦å‘Šä¿¡æ¯ã€‚</li><li><strong>@SafeVarargs</strong>ï¼šåœ¨ Java 7 ä¸­åŠ å…¥ç”¨äºç¦æ­¢å¯¹å…·æœ‰æ³›å‹varargså‚æ•°çš„æ–¹æ³•æˆ–æ„é€ å‡½æ•°çš„è°ƒç”¨æ–¹å‘å‡ºè­¦å‘Šã€‚</li><li><strong>@FunctionalInterface</strong>ï¼šJava 8 ä¸­åŠ å…¥ç”¨äºè¡¨ç¤ºç±»å‹å£°æ˜ä¸ºå‡½æ•°å¼æ¥å£</li></ul><p>è¿˜æœ‰ 5 ç§é¢å¤–çš„æ³¨è§£ç±»å‹ç”¨äºåˆ›é€ æ–°çš„æ³¨è§£ã€‚ä½ å°†ä¼šåœ¨è¿™ä¸€ç« å­¦ä¹ å®ƒä»¬ã€‚</p><p>æ¯å½“åˆ›å»ºæ¶‰åŠé‡å¤å·¥ä½œçš„ç±»æˆ–æ¥å£æ—¶ï¼Œä½ é€šå¸¸å¯ä»¥ä½¿ç”¨æ³¨è§£æ¥è‡ªåŠ¨åŒ–å’Œç®€åŒ–æµç¨‹ã€‚ä¾‹å¦‚åœ¨ Enterprise JavaBeanï¼ˆEJBï¼‰ä¸­çš„è®¸å¤šé¢å¤–å·¥ä½œå°±æ˜¯é€šè¿‡æ³¨è§£æ¥æ¶ˆé™¤çš„ã€‚</p><p>æ³¨è§£çš„å‡ºç°å¯ä»¥æ›¿ä»£ä¸€äº›ç°æœ‰çš„ç³»ç»Ÿï¼Œä¾‹å¦‚ XDocletï¼Œå®ƒæ˜¯ä¸€ç§ç‹¬ç«‹çš„æ–‡æ¡£åŒ–å·¥å…·ï¼Œä¸“é—¨è®¾è®¡ç”¨æ¥ç”Ÿæˆæ³¨è§£é£æ ¼çš„æ–‡æ¡£ã€‚ä¸ä¹‹ç›¸æ¯”ï¼Œæ³¨è§£æ˜¯çœŸæ­£è¯­è¨€å±‚çº§çš„æ¦‚å¿µï¼Œä»¥å‰æ„é€ å‡ºæ¥å°±äº«æœ‰ç¼–è¯‘å™¨çš„ç±»å‹æ£€æŸ¥ä¿æŠ¤ã€‚æ³¨è§£åœ¨æºä»£ç çº§åˆ«ä¿å­˜æ‰€æœ‰ä¿¡æ¯è€Œä¸æ˜¯é€šè¿‡æ³¨é‡Šæ–‡å­—ï¼Œè¿™ä½¿å¾—ä»£ç æ›´åŠ æ•´æ´å’Œä¾¿äºç»´æŠ¤ã€‚é€šè¿‡ä½¿ç”¨æ‹“å±•çš„ annotation API æˆ–ç¨ååœ¨æœ¬ç« èŠ‚å¯ä»¥çœ‹åˆ°çš„å¤–éƒ¨çš„å­—èŠ‚ç å·¥å…·ç±»åº“ï¼Œä½ ä¼šæ‹¥æœ‰å¯¹æºä»£ç åŠå­—èŠ‚ç å¼ºå¤§çš„æ£€æŸ¥ä¸æ“ä½œèƒ½åŠ›ã€‚</p><!-- Basic Syntax --><h2 id="åŸºæœ¬è¯­æ³•"><a href="#åŸºæœ¬è¯­æ³•" class="headerlink" title="åŸºæœ¬è¯­æ³•"></a>åŸºæœ¬è¯­æ³•</h2><!-- Writing Annotation Processors --><p>åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œä½¿ç”¨ <code>@Test</code> å¯¹ <code>testExecute()</code> è¿›è¡Œæ³¨è§£ã€‚è¯¥æ³¨è§£æœ¬èº«ä¸åšä»»ä½•äº‹æƒ…ï¼Œä½†æ˜¯ç¼–è¯‘å™¨è¦ä¿è¯å…¶ç±»è·¯å¾„ä¸Šæœ‰ <code>@Test</code> æ³¨è§£çš„å®šä¹‰ã€‚ä½ å°†åœ¨æœ¬ç« çœ‹åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡æ³¨è§£åˆ›å»ºäº†ä¸€ä¸ªå·¥å…·ç”¨äºè¿è¡Œè¿™ä¸ªæ–¹æ³•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/Testable.java</span></span><br><span class="line"><span class="keyword">package</span> annotations;</span><br><span class="line"><span class="keyword">import</span> onjava.atunit.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Testable</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">execute</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Executing.."</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">testExecute</span><span class="params">()</span> </span>&#123; execute(); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¢«æ³¨è§£æ ‡æ³¨çš„æ–¹æ³•å’Œå…¶ä»–çš„æ–¹æ³•æ²¡æœ‰ä»»ä½•åŒºåˆ«ã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œæ³¨è§£ <code>@Test</code> å¯ä»¥å’Œä»»ä½•ä¿®é¥°ç¬¦å…±åŒç”¨äºæ–¹æ³•ï¼Œè¯¸å¦‚ <strong>public</strong>ã€<strong>static</strong> æˆ– <strong>void</strong>ã€‚ä»è¯­æ³•çš„è§’åº¦ä¸Šçœ‹ï¼Œæ³¨è§£çš„ä½¿ç”¨æ–¹å¼å’Œä¿®é¥°ç¬¦çš„ä½¿ç”¨æ–¹å¼ä¸€è‡´ã€‚</p><h3 id="å®šä¹‰æ³¨è§£"><a href="#å®šä¹‰æ³¨è§£" class="headerlink" title="å®šä¹‰æ³¨è§£"></a>å®šä¹‰æ³¨è§£</h3><p>å¦‚ä¸‹æ˜¯ä¸€ä¸ªæ³¨è§£çš„å®šä¹‰ã€‚æ³¨è§£çš„å®šä¹‰çœ‹èµ·æ¥å¾ˆåƒæ¥å£çš„å®šä¹‰ã€‚äº‹å®ä¸Šï¼Œå®ƒä»¬å’Œå…¶ä»– Java æ¥å£ä¸€æ ·ï¼Œä¹Ÿä¼šè¢«ç¼–è¯‘æˆ class æ–‡ä»¶ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// onjava/atunit/Test.java</span></span><br><span class="line"><span class="comment">// The @Test tag</span></span><br><span class="line"><span class="keyword">package</span> onjava.atunit;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Test &#123;&#125;</span><br></pre></td></tr></table></figure><p>é™¤äº† @ ç¬¦å·ä¹‹å¤–ï¼Œ <code>@Test</code> çš„å®šä¹‰çœ‹èµ·æ¥æ›´åƒä¸€ä¸ªç©ºæ¥å£ã€‚æ³¨è§£çš„å®šä¹‰ä¹Ÿéœ€è¦ä¸€äº›å…ƒæ³¨è§£ï¼ˆmeta-annoationï¼‰ï¼Œæ¯”å¦‚ <code>@Target</code> å’Œ <code>@Retention</code>ã€‚<code>@Target</code> å®šä¹‰ä½ çš„æ³¨è§£å¯ä»¥åº”ç”¨åœ¨å“ªé‡Œï¼ˆä¾‹å¦‚æ˜¯æ–¹æ³•è¿˜æ˜¯å­—æ®µï¼‰ã€‚<code>@Retention</code> å®šä¹‰äº†æ³¨è§£åœ¨å“ªé‡Œå¯ç”¨ï¼Œåœ¨æºä»£ç ä¸­ï¼ˆSOURCEï¼‰ï¼Œclassæ–‡ä»¶ï¼ˆCLASSï¼‰ä¸­æˆ–è€…æ˜¯åœ¨è¿è¡Œæ—¶ï¼ˆRUNTIMEï¼‰ã€‚</p><p>æ³¨è§£é€šå¸¸ä¼šåŒ…å«ä¸€äº›è¡¨ç¤ºç‰¹å®šå€¼çš„å…ƒç´ ã€‚å½“åˆ†æå¤„ç†æ³¨è§£çš„æ—¶å€™ï¼Œç¨‹åºæˆ–å·¥å…·å¯ä»¥åˆ©ç”¨è¿™äº›å€¼ã€‚æ³¨è§£çš„å…ƒç´ çœ‹èµ·æ¥å°±åƒæ¥å£çš„æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥ä¸ºå…¶æŒ‡å®šé»˜è®¤å€¼ã€‚</p><p>ä¸åŒ…å«ä»»ä½•å…ƒç´ çš„æ³¨è§£ç§°ä¸ºæ ‡è®°æ³¨è§£ï¼ˆmarker annotationï¼‰ï¼Œä¾‹å¦‚ä¸Šä¾‹ä¸­çš„ <code>@Test</code> å°±æ˜¯æ ‡è®°æ³¨è§£ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„æ³¨è§£ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨å®ƒæ¥è¿½è¸ªé¡¹ç›®ä¸­çš„ç”¨ä¾‹ã€‚ç¨‹åºå‘˜å¯ä»¥ä½¿ç”¨è¯¥æ³¨è§£æ¥æ ‡æ³¨æ»¡è¶³ç‰¹å®šç”¨ä¾‹çš„ä¸€ä¸ªæ–¹æ³•æˆ–è€…ä¸€ç»„æ–¹æ³•ã€‚äºæ˜¯ï¼Œé¡¹ç›®ç»ç†å¯ä»¥é€šè¿‡ç»Ÿè®¡å·²ç»å®ç°çš„ç”¨ä¾‹æ¥æŒæ§é¡¹ç›®çš„è¿›å±•ï¼Œè€Œå¼€å‘è€…åœ¨ç»´æŠ¤é¡¹ç›®æ—¶å¯ä»¥è½»æ¾çš„æ‰¾åˆ°ç”¨ä¾‹ç”¨äºæ›´æ–°ï¼Œæˆ–è€…ä»–ä»¬å¯ä»¥è°ƒè¯•ç³»ç»Ÿä¸­ä¸šåŠ¡é€»è¾‘ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/UseCase.java</span></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> UseCase &#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">id</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function">String <span class="title">description</span><span class="params">()</span> <span class="keyword">default</span> "no description"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨æ„ <strong>id</strong> å’Œ <strong>description</strong> ä¸æ–¹æ³•å®šä¹‰ç±»ä¼¼ã€‚ç”±äºç¼–è¯‘å™¨ä¼šå¯¹ <strong>id</strong> è¿›è¡Œç±»å‹æ£€æŸ¥ï¼Œå› æ­¤å°†è·Ÿè¸ªæ•°æ®åº“ä¸ç”¨ä¾‹æ–‡æ¡£å’Œæºä»£ç ç›¸å…³è”æ˜¯å¯é çš„æ–¹å¼ã€‚<strong>description</strong> å…ƒç´ æ‹¥æœ‰ä¸€ä¸ª <strong>default</strong> å€¼ï¼Œå¦‚æœåœ¨æ³¨è§£æŸä¸ªæ–¹æ³•æ—¶æ²¡æœ‰ç»™å‡º <strong>description</strong> çš„å€¼ã€‚åˆ™è¯¥æ³¨è§£çš„å¤„ç†å™¨ä¼šä½¿ç”¨æ­¤å…ƒç´ çš„é»˜è®¤å€¼ã€‚</p><p>åœ¨ä¸‹é¢çš„ç±»ä¸­ï¼Œæœ‰ä¸‰ä¸ªæ–¹æ³•è¢«æ³¨è§£ä¸ºç”¨ä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/PasswordUtils.java</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">PasswordUtils</span> </span>&#123;</span><br><span class="line">    <span class="meta">@UseCase</span>(id = <span class="number">47</span>, description =</span><br><span class="line">            <span class="string">"Passwords must contain at least one numeric"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">validatePassword</span><span class="params">(String passwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> (passwd.matches(<span class="string">"\\w*\\d\\w*"</span>));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@UseCase</span>(id = <span class="number">48</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">encryptPassword</span><span class="params">(String passwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> StringBuilder(passwd)</span><br><span class="line">                .reverse().toString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@UseCase</span>(id = <span class="number">49</span>, description =</span><br><span class="line">            <span class="string">"New passwords can't equal previously used ones"</span>)</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">checkForNewPassword</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            List&lt;String&gt; prevPasswords, String passwd)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> !prevPasswords.contains(passwd);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>æ³¨è§£çš„å…ƒç´ åœ¨ä½¿ç”¨æ—¶è¡¨ç°ä¸º å-å€¼ å¯¹çš„å½¢å¼ï¼Œå¹¶ä¸”éœ€è¦æ”¾ç½®åœ¨ <code>@UseCase</code> å£°æ˜ä¹‹åçš„æ‹¬å·å†…ã€‚åœ¨ <code>encryptPassword()</code> æ–¹æ³•çš„æ³¨è§£ä¸­ï¼Œå¹¶æ²¡æœ‰ç»™å‡º <strong>description</strong> çš„å€¼ï¼Œæ‰€ä»¥åœ¨ <strong>@interface UseCase</strong> çš„æ³¨è§£å¤„ç†å™¨åˆ†æå¤„ç†è¿™ä¸ªç±»çš„æ—¶å€™ä¼šä½¿ç”¨è¯¥å…ƒç´ çš„é»˜è®¤å€¼ã€‚</p><p>ä½ åº”è¯¥èƒ½å¤Ÿæƒ³è±¡åˆ°å¦‚ä½•ä½¿ç”¨è¿™å¥—å·¥å…·æ¥â€œå‹¾å‹’â€å‡ºå°†è¦å»ºé€ çš„ç³»ç»Ÿï¼Œç„¶ååœ¨å»ºé€ çš„è¿‡ç¨‹ä¸­é€æ¸å®ç°ç³»ç»Ÿçš„å„é¡¹åŠŸèƒ½ã€‚</p><h3 id="å…ƒæ³¨è§£"><a href="#å…ƒæ³¨è§£" class="headerlink" title="å…ƒæ³¨è§£"></a>å…ƒæ³¨è§£</h3><p>Java è¯­è¨€ä¸­ç›®å‰æœ‰ 5 ç§æ ‡å‡†æ³¨è§£ï¼ˆå‰é¢ä»‹ç»è¿‡ï¼‰ï¼Œä»¥åŠ 5 ç§å…ƒæ³¨è§£ã€‚å…ƒæ³¨è§£ç”¨äºæ³¨è§£å…¶ä»–çš„æ³¨è§£</p><table><thead><tr><th>æ³¨è§£</th><th>è§£é‡Š</th></tr></thead><tbody><tr><td>@Target</td><td>è¡¨ç¤ºæ³¨è§£å¯ä»¥ç”¨äºå“ªäº›åœ°æ–¹ã€‚å¯èƒ½çš„ <strong>ElementType</strong> å‚æ•°åŒ…æ‹¬ï¼š<br><strong>CONSTRUCTOR</strong>ï¼šæ„é€ å™¨çš„å£°æ˜<br><strong>FIELD</strong>ï¼šå­—æ®µå£°æ˜ï¼ˆåŒ…æ‹¬ enum å®ä¾‹ï¼‰<br><strong>LOCAL_VARIABLE</strong>ï¼šå±€éƒ¨å˜é‡å£°æ˜<br><strong>METHOD</strong>ï¼šæ–¹æ³•å£°æ˜<br><strong>PACKAGE</strong>ï¼šåŒ…å£°æ˜<br><strong>PARAMETER</strong>ï¼šå‚æ•°å£°æ˜<br><strong>TYPE</strong>ï¼šç±»ã€æ¥å£ï¼ˆåŒ…æ‹¬æ³¨è§£ç±»å‹ï¼‰æˆ–è€… enum å£°æ˜</td></tr><tr><td>@Retention</td><td>è¡¨ç¤ºæ³¨è§£ä¿¡æ¯ä¿å­˜çš„æ—¶é•¿ã€‚å¯é€‰çš„ <strong>RetentionPolicy</strong> å‚æ•°åŒ…æ‹¬ï¼š<br><strong>SOURCE</strong>ï¼šæ³¨è§£å°†è¢«ç¼–è¯‘å™¨ä¸¢å¼ƒ<br><strong>CLASS</strong>ï¼šæ³¨è§£åœ¨ class æ–‡ä»¶ä¸­å¯ç”¨ï¼Œä½†æ˜¯ä¼šè¢« VM ä¸¢å¼ƒã€‚<br><strong>RUNTIME</strong>ï¼šVM å°†åœ¨è¿è¡ŒæœŸä¹Ÿä¿ç•™æ³¨è§£ï¼Œå› æ­¤å¯ä»¥é€šè¿‡åå°„æœºåˆ¶è¯»å–æ³¨è§£çš„ä¿¡æ¯ã€‚</td></tr><tr><td>@Documented</td><td>å°†æ­¤æ³¨è§£ä¿å­˜åœ¨ Javadoc ä¸­</td></tr><tr><td>@Inherited</td><td>å…è®¸å­ç±»ç»§æ‰¿çˆ¶ç±»çš„æ³¨è§£</td></tr><tr><td>@Repeatable</td><td>å…è®¸ä¸€ä¸ªæ³¨è§£å¯ä»¥è¢«ä½¿ç”¨ä¸€æ¬¡æˆ–è€…å¤šæ¬¡ï¼ˆJava 8ï¼‰ã€‚</td></tr></tbody></table><p>å¤§å¤šæ•°æ—¶å€™ï¼Œç¨‹åºå‘˜å®šä¹‰è‡ªå·±çš„æ³¨è§£ï¼Œå¹¶ç¼–å†™è‡ªå·±çš„å¤„ç†å™¨æ¥å¤„ç†ä»–ä»¬ã€‚</p><h2 id="ç¼–å†™æ³¨è§£å¤„ç†å™¨"><a href="#ç¼–å†™æ³¨è§£å¤„ç†å™¨" class="headerlink" title="ç¼–å†™æ³¨è§£å¤„ç†å™¨"></a>ç¼–å†™æ³¨è§£å¤„ç†å™¨</h2><p>å¦‚æœæ²¡æœ‰ç”¨äºè¯»å–æ³¨è§£çš„å·¥å…·ï¼Œé‚£ä¹ˆæ³¨è§£ä¸ä¼šæ¯”æ³¨é‡Šæ›´æœ‰ç”¨ã€‚ä½¿ç”¨æ³¨è§£ä¸­ä¸€ä¸ªå¾ˆé‡è¦çš„éƒ¨åˆ†å°±æ˜¯ï¼Œåˆ›å»ºä¸ä½¿ç”¨æ³¨è§£å¤„ç†å™¨ã€‚Java æ‹“å±•äº†åå°„æœºåˆ¶çš„ API ç”¨äºå¸®åŠ©ä½ åˆ›é€ è¿™ç±»å·¥å…·ã€‚åŒæ—¶ä»–è¿˜æä¾›äº† javac ç¼–è¯‘å™¨é’©å­åœ¨ç¼–è¯‘æ—¶ä½¿ç”¨æ³¨è§£ã€‚</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„æ³¨è§£å¤„ç†å™¨ï¼Œæˆ‘ä»¬ç”¨å®ƒæ¥è¯»å–è¢«æ³¨è§£çš„ <strong>PasswordUtils</strong> ç±»ï¼Œå¹¶ä¸”ä½¿ç”¨åå°„æœºåˆ¶æ¥å¯»æ‰¾ <strong>@UseCase</strong> æ ‡è®°ã€‚ç»™å®šä¸€ç»„ <strong>id</strong> å€¼ï¼Œç„¶ååˆ—å‡ºåœ¨ <strong>PasswordUtils</strong> ä¸­æ‰¾åˆ°çš„ç”¨ä¾‹ï¼Œä»¥åŠç¼ºå¤±çš„ç”¨ä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/UseCaseTracker.java</span></span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.*;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">UseCaseTracker</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span></span><br><span class="line">    trackUseCases(List&lt;Integer&gt; useCases, Class&lt;?&gt; cl) &#123;</span><br><span class="line">        <span class="keyword">for</span>(Method m : cl.getDeclaredMethods()) &#123;</span><br><span class="line">            UseCase uc = m.getAnnotation(UseCase.class);</span><br><span class="line">            <span class="keyword">if</span>(uc != <span class="keyword">null</span>) &#123;</span><br><span class="line">                System.out.println(<span class="string">"Found Use Case "</span> +</span><br><span class="line">                        uc.id() + <span class="string">"\n "</span> + uc.description());</span><br><span class="line">                useCases.remove(Integer.valueOf(uc.id()));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        useCases.forEach(i -&gt;</span><br><span class="line">                System.out.println(<span class="string">"Missing use case "</span> + i));</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        List&lt;Integer&gt; useCases = IntStream.range(<span class="number">47</span>, <span class="number">51</span>)</span><br><span class="line">                .boxed().collect(Collectors.toList());</span><br><span class="line">        trackUseCases(useCases, PasswordUtils.class);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">Found Use Case <span class="number">48</span></span><br><span class="line">no description</span><br><span class="line">Found Use Case <span class="number">47</span></span><br><span class="line">Passwords must contain at least one numeric</span><br><span class="line">Found Use Case <span class="number">49</span></span><br><span class="line">New passwords can<span class="string">'t equal previously used ones</span></span><br><span class="line"><span class="string">Missing use case 50</span></span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¨‹åºç”¨äº†ä¸¤ä¸ªåå°„çš„æ–¹æ³•ï¼š<code>getDeclaredMethods()</code>  å’Œ <code>getAnnotation()</code>ï¼Œå®ƒä»¬éƒ½å±äº <strong>AnnotatedElement</strong> æ¥å£ï¼ˆ<strong>Class</strong>ï¼Œ<strong>Method</strong> ä¸ <strong>Field</strong> ç±»éƒ½å®ç°äº†è¯¥æ¥å£ï¼‰ã€‚<code>getAnnotation()</code> æ–¹æ³•è¿”å›æŒ‡å®šç±»å‹çš„æ³¨è§£å¯¹è±¡ï¼Œåœ¨æœ¬ä¾‹ä¸­å°±æ˜¯ â€œ<strong>UseCase</strong>â€ã€‚å¦‚æœè¢«æ³¨è§£çš„æ–¹æ³•ä¸Šæ²¡æœ‰è¯¥ç±»å‹çš„æ³¨è§£ï¼Œè¿”å›å€¼å°±ä¸º <strong>null</strong>ã€‚æˆ‘ä»¬é€šè¿‡è°ƒç”¨ <code>id()</code> å’Œ <code>description()</code> æ–¹æ³•æ¥æå–å…ƒç´ å€¼ã€‚æ³¨æ„ <code>encryptPassword()</code> æ–¹æ³•åœ¨æ³¨è§£çš„æ—¶å€™æ²¡æœ‰æŒ‡å®š <strong>description</strong> çš„å€¼ï¼Œå› æ­¤å¤„ç†å™¨åœ¨å¤„ç†å®ƒå¯¹åº”çš„æ³¨è§£æ—¶ï¼Œé€šè¿‡ <code>description()</code> å–å¾—çš„æ˜¯é»˜è®¤å€¼ â€œno descriptionâ€ã€‚</p><h3 id="æ³¨è§£å…ƒç´ "><a href="#æ³¨è§£å…ƒç´ " class="headerlink" title="æ³¨è§£å…ƒç´ "></a>æ³¨è§£å…ƒç´ </h3><p>åœ¨ <strong>UseCase.java</strong> ä¸­å®šä¹‰çš„ <strong>@UseCase</strong> çš„æ ‡ç­¾åŒ…å« int å…ƒç´  <strong>id</strong> å’Œ String å…ƒç´  <strong>description</strong>ã€‚æ³¨è§£å…ƒç´ å¯ç”¨çš„ç±»å‹å¦‚ä¸‹æ‰€ç¤ºï¼š</p><ul><li>æ‰€æœ‰åŸºæœ¬ç±»å‹ï¼ˆintã€floatã€booleanç­‰ï¼‰</li><li>String</li><li>Class</li><li>enum</li><li>Annotation</li><li>ä»¥ä¸Šç±»å‹çš„æ•°ç»„</li></ul><p>å¦‚æœä½ ä½¿ç”¨äº†å…¶ä»–ç±»å‹ï¼Œç¼–è¯‘å™¨å°±ä¼šæŠ¥é”™ã€‚æ³¨æ„ï¼Œä¹Ÿä¸å…è®¸ä½¿ç”¨ä»»ä½•åŒ…è£…ç±»å‹ï¼Œä½†æ˜¯ç”±äºè‡ªåŠ¨è£…ç®±çš„å­˜åœ¨ï¼Œè¿™ä¸ç®—æ˜¯ä»€ä¹ˆé™åˆ¶ã€‚æ³¨è§£ä¹Ÿå¯ä»¥ä½œä¸ºå…ƒç´ çš„ç±»å‹ã€‚ç¨åä½ ä¼šçœ‹åˆ°ï¼Œæ³¨è§£åµŒå¥—æ˜¯ä¸€ä¸ªéå¸¸æœ‰ç”¨çš„æŠ€å·§ã€‚</p><h3 id="é»˜è®¤å€¼é™åˆ¶"><a href="#é»˜è®¤å€¼é™åˆ¶" class="headerlink" title="é»˜è®¤å€¼é™åˆ¶"></a>é»˜è®¤å€¼é™åˆ¶</h3><p>ç¼–è¯‘å™¨å¯¹äºå…ƒç´ çš„é»˜è®¤å€¼æœ‰äº›è¿‡äºæŒ‘å‰”ã€‚é¦–å…ˆï¼Œå…ƒç´ ä¸èƒ½æœ‰ä¸ç¡®å®šçš„å€¼ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå…ƒç´ è¦ä¹ˆæœ‰é»˜è®¤å€¼ï¼Œè¦ä¹ˆå°±åœ¨ä½¿ç”¨æ³¨è§£æ—¶æä¾›å…ƒç´ çš„å€¼ã€‚</p><p>è¿™é‡Œæœ‰å¦å¤–ä¸€ä¸ªé™åˆ¶ï¼šä»»ä½•éåŸºæœ¬ç±»å‹çš„å…ƒç´ ï¼Œ æ— è®ºæ˜¯åœ¨æºä»£ç å£°æ˜æ—¶è¿˜æ˜¯åœ¨æ³¨è§£æ¥å£ä¸­å®šä¹‰é»˜è®¤å€¼æ—¶ï¼Œéƒ½ä¸èƒ½ä½¿ç”¨ null ä½œä¸ºå…¶å€¼ã€‚è¿™ä¸ªé™åˆ¶ä½¿å¾—å¤„ç†å™¨å¾ˆéš¾è¡¨ç°ä¸€ä¸ªå…ƒç´ çš„å­˜åœ¨æˆ–è€…ç¼ºå¤±çš„çŠ¶æ€ï¼Œå› ä¸ºåœ¨æ¯ä¸ªæ³¨è§£çš„å£°æ˜ä¸­ï¼Œæ‰€æœ‰çš„å…ƒç´ éƒ½å­˜åœ¨ï¼Œå¹¶ä¸”å…·æœ‰ç›¸åº”çš„å€¼ã€‚ä¸ºäº†ç»•å¼€è¿™ä¸ªçº¦æŸï¼Œå¯ä»¥è‡ªå®šä¹‰ä¸€äº›ç‰¹æ®Šçš„å€¼ï¼Œæ¯”å¦‚ç©ºå­—ç¬¦ä¸²æˆ–è€…è´Ÿæ•°ç”¨äºè¡¨è¾¾æŸä¸ªå…ƒç´ ä¸å­˜åœ¨ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/SimulatingNull.java</span></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SimulatingNull &#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">id</span><span class="params">()</span> <span class="keyword">default</span> -1</span>;</span><br><span class="line">    <span class="function">String <span class="title">description</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ªåœ¨å®šä¹‰æ³¨è§£çš„ä¹ æƒ¯ç”¨æ³•ã€‚</p><h3 id="ç”Ÿæˆå¤–éƒ¨æ–‡ä»¶"><a href="#ç”Ÿæˆå¤–éƒ¨æ–‡ä»¶" class="headerlink" title="ç”Ÿæˆå¤–éƒ¨æ–‡ä»¶"></a>ç”Ÿæˆå¤–éƒ¨æ–‡ä»¶</h3><p>å½“æœ‰äº›æ¡†æ¶éœ€è¦ä¸€äº›é¢å¤–çš„ä¿¡æ¯æ‰èƒ½ä¸ä½ çš„æºä»£ç ååŒå·¥ä½œï¼Œè¿™ç§æƒ…å†µä¸‹æ³¨è§£å°±ä¼šå˜å¾—ååˆ†æœ‰ç”¨ã€‚åƒ Enterprise JavaBeans (EJB3 ä¹‹å‰)è¿™æ ·çš„æŠ€æœ¯ï¼Œæ¯ä¸€ä¸ª Bean éƒ½éœ€è¦éœ€è¦å¤§é‡çš„æ¥å£å’Œéƒ¨ç½²æè¿°æ–‡ä»¶ï¼Œè€Œè¿™äº›å°±æ˜¯â€œæ ·æ¿â€æ–‡ä»¶ã€‚Web Serviceï¼Œè‡ªå®šä¹‰æ ‡ç­¾åº“ä»¥åŠå¯¹è±¡/å…³ç³»æ˜ å°„å·¥å…·ï¼ˆä¾‹å¦‚ Toplink å’Œ Hibernateï¼‰é€šå¸¸éƒ½éœ€è¦ XML æè¿°æ–‡ä»¶ï¼Œè€Œè¿™äº›æ–‡ä»¶è„±ç¦»äºä»£ç ä¹‹å¤–ã€‚é™¤äº†å®šä¹‰ Java ç±»ï¼Œç¨‹åºå‘˜è¿˜å¿…é¡»å¿å—æ²‰é—·ï¼Œé‡å¤çš„æä¾›æŸäº›ä¿¡æ¯ï¼Œä¾‹å¦‚ç±»åå’ŒåŒ…åç­‰å·²ç»åœ¨åŸå§‹ç±»ä¸­å·²ç»æä¾›çš„ä¿¡æ¯ã€‚æ¯å½“ä½ ä½¿ç”¨å¤–éƒ¨æè¿°æ–‡ä»¶æ—¶ï¼Œä»–å°±æ‹¥æœ‰äº†ä¸€ä¸ªç±»çš„ä¸¤ä¸ªç‹¬ç«‹ä¿¡æ¯æºï¼Œè¿™ç»å¸¸å¯¼è‡´ä»£ç çš„åŒæ­¥é—®é¢˜ã€‚åŒæ—¶è¿™ä¹Ÿè¦æ±‚äº†ä¸ºé¡¹ç›®å·¥ä½œçš„ç¨‹åºå‘˜åœ¨çŸ¥é“å¦‚ä½•ç¼–å†™ Java ç¨‹åºçš„åŒæ—¶ï¼Œä¹Ÿå¿…é¡»çŸ¥é“å¦‚ä½•ç¼–è¾‘æè¿°æ–‡ä»¶ã€‚</p><p>å‡è®¾ä½ æƒ³æä¾›ä¸€äº›åŸºæœ¬çš„å¯¹è±¡/å…³ç³»æ˜ å°„åŠŸèƒ½ï¼Œèƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆæ•°æ®åº“è¡¨ã€‚ä½ å¯ä»¥ä½¿ç”¨ XML æè¿°æ–‡ä»¶æ¥æŒ‡æ˜ç±»çš„åå­—ã€æ¯ä¸ªæˆå‘˜ä»¥åŠæ•°æ®åº“æ˜ å°„çš„ç›¸å…³ä¿¡æ¯ã€‚ä½†æ˜¯ï¼Œé€šè¿‡ä½¿ç”¨æ³¨è§£ï¼Œä½ å¯ä»¥æŠŠæ‰€æœ‰ä¿¡æ¯éƒ½ä¿å­˜åœ¨ <strong>JavaBean</strong> æºæ–‡ä»¶ä¸­ã€‚ä¸ºæ­¤ä½ éœ€è¦ä¸€äº›ç”¨äºå®šä¹‰æ•°æ®åº“è¡¨åç§°ã€æ•°æ®åº“åˆ—ä»¥åŠå°† SQL ç±»å‹æ˜ å°„åˆ°å±æ€§çš„æ³¨è§£ã€‚</p><p>ä»¥ä¸‹æ˜¯ä¸€ä¸ªæ³¨è§£çš„å®šä¹‰ï¼Œå®ƒå‘Šè¯‰æ³¨è§£å¤„ç†å™¨åº”è¯¥åˆ›å»ºä¸€ä¸ªæ•°æ®åº“è¡¨ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/database/DBTable.java</span></span><br><span class="line"><span class="keyword">package</span> annotations.database;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"><span class="meta">@Target</span>(ElementType.TYPE) <span class="comment">// Applies to classes only</span></span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> DBTable &#123;</span><br><span class="line">    <span class="function">String <span class="title">name</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>åœ¨ <code>@Target</code> æ³¨è§£ä¸­æŒ‡å®šçš„æ¯ä¸€ä¸ª <strong>ElementType</strong> å°±æ˜¯ä¸€ä¸ªçº¦æŸï¼Œå®ƒå‘Šè¯‰ç¼–è¯‘å™¨ï¼Œè¿™ä¸ªè‡ªå®šä¹‰çš„æ³¨è§£åªèƒ½ç”¨äºæŒ‡å®šçš„ç±»å‹ã€‚ä½ å¯ä»¥æŒ‡å®š <strong>enum ElementType</strong> ä¸­çš„ä¸€ä¸ªå€¼ï¼Œæˆ–è€…ä»¥é€—å·åˆ†å‰²çš„å½¢å¼æŒ‡å®šå¤šä¸ªå€¼ã€‚å¦‚æœæƒ³è¦å°†æ³¨è§£åº”ç”¨äºæ‰€æœ‰çš„ <strong>ElementType</strong>ï¼Œé‚£ä¹ˆå¯ä»¥çœå» <code>@Target</code> æ³¨è§£ï¼Œä½†æ˜¯è¿™å¹¶ä¸å¸¸è§ã€‚</p><p>æ³¨æ„ <strong>@DBTable</strong> ä¸­æœ‰ä¸€ä¸ª <code>name()</code> å…ƒç´ ï¼Œè¯¥æ³¨è§£é€šè¿‡è¿™ä¸ªå…ƒç´ ä¸ºå¤„ç†å™¨åˆ›å»ºæ•°æ®åº“æ—¶æä¾›è¡¨çš„åå­—ã€‚</p><p>å¦‚ä¸‹æ˜¯ä¿®é¥°å­—æ®µçš„æ³¨è§£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/database/Constraints.java</span></span><br><span class="line"><span class="keyword">package</span> annotations.database;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"><span class="meta">@Target</span>(ElementType.FIELD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Constraints &#123;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">primaryKey</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">false</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">allowNull</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">true</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">unique</span><span class="params">()</span> <span class="keyword">default</span> <span class="keyword">false</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/database/SQLString.java</span></span><br><span class="line"><span class="keyword">package</span> annotations.database;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"><span class="meta">@Target</span>(ElementType.FIELD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SQLString &#123;</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> 0</span>;</span><br><span class="line">    <span class="function">String <span class="title">name</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line">    <span class="function">Constraints <span class="title">constraints</span><span class="params">()</span> <span class="keyword">default</span> @Constraints</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/database/SQLInteger.java</span></span><br><span class="line"><span class="keyword">package</span> annotations.database;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"><span class="meta">@Target</span>(ElementType.FIELD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> SQLInteger &#123;</span><br><span class="line">    <span class="function">String <span class="title">name</span><span class="params">()</span> <span class="keyword">default</span> ""</span>;</span><br><span class="line">    <span class="function">Constraints <span class="title">constraints</span><span class="params">()</span> <span class="keyword">default</span> @Constraints</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>@Constraints</strong> æ³¨è§£å…è®¸å¤„ç†å™¨æä¾›æ•°æ®åº“è¡¨çš„å…ƒæ•°æ®ã€‚<strong>@Constraints</strong> ä»£è¡¨äº†æ•°æ®åº“é€šå¸¸æä¾›çš„çº¦æŸçš„ä¸€å°éƒ¨åˆ†ï¼Œä½†æ˜¯å®ƒæ‰€è¦è¡¨è¾¾çš„æ€æƒ³å·²ç»å¾ˆæ¸…æ¥šäº†ã€‚<code>primaryKey()</code>ï¼Œ<code>allowNull()</code> å’Œ <code>unique()</code> å…ƒç´ æ˜æ˜¾çš„æä¾›äº†é»˜è®¤å€¼ï¼Œä»è€Œä½¿å¾—åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œè¯¥æ³¨è§£çš„ä½¿ç”¨è€…ä¸éœ€è¦è¾“å…¥å¤ªå¤šä¸œè¥¿ã€‚</p><p>å¦å¤–ä¸¤ä¸ª <strong>@interface</strong> å®šä¹‰çš„æ˜¯ SQL ç±»å‹ã€‚å¦‚æœå¸Œæœ›è¿™ä¸ªæ¡†æ¶æ›´æœ‰ä»·å€¼çš„è¯ï¼Œæˆ‘ä»¬åº”è¯¥ä¸ºæ¯ä¸ª SQL ç±»å‹éƒ½å®šä¹‰ç›¸åº”çš„æ³¨è§£ã€‚ä¸è¿‡ä¸ºä¸ºç¤ºä¾‹ï¼Œä¸¤ä¸ªå…ƒç´ è¶³å¤Ÿäº†ã€‚</p><p>è¿™äº› SQL ç±»å‹å…·æœ‰ <code>name()</code> å…ƒç´ å’Œ <code>constraints()</code> å…ƒç´ ã€‚åè€…åˆ©ç”¨äº†åµŒå¥—æ³¨è§£çš„åŠŸèƒ½ï¼Œå°†æ•°æ®åº“åˆ—çš„ç±»å‹çº¦æŸä¿¡æ¯åµŒå…¥å…¶ä¸­ã€‚æ³¨æ„ <code>constraints()</code> å…ƒç´ çš„é»˜è®¤å€¼æ˜¯ <strong>@Constraints</strong>ã€‚ç”±äºåœ¨ <strong>@Constraints</strong> æ³¨è§£ç±»å‹ä¹‹åï¼Œæ²¡æœ‰åœ¨æ‹¬å·ä¸­æŒ‡æ˜ <strong>@Constraints</strong> å…ƒç´ çš„å€¼ï¼Œå› æ­¤ï¼Œ<strong>constraints()</strong> çš„é»˜è®¤å€¼ä¸ºæ‰€æœ‰å…ƒç´ éƒ½ä¸ºé»˜è®¤å€¼çš„ <strong>@Constraints</strong> æ³¨è§£ã€‚å¦‚æœè¦ä½¿å¾—åµŒå…¥çš„  <strong>@Constraints</strong>  æ³¨è§£ä¸­çš„ <code>unique()</code> å…ƒç´ ä¸º trueï¼Œå¹¶ä½œä¸º <code>constraints()</code> å…ƒç´ çš„é»˜è®¤å€¼ï¼Œä½ å¯ä»¥åƒå¦‚ä¸‹å®šä¹‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/database/Uniqueness.java</span></span><br><span class="line"><span class="comment">// Sample of nested annotations</span></span><br><span class="line"><span class="keyword">package</span> annotations.database;</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Uniqueness &#123;</span><br><span class="line">    <span class="function">Constraints <span class="title">constraints</span><span class="params">()</span></span></span><br><span class="line"><span class="function">            <span class="keyword">default</span> @<span class="title">Constraints</span><span class="params">(unique = <span class="keyword">true</span>)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ï¼Œä½¿ç”¨äº†å¦‚ä¸Šæ³¨è§£çš„ç±»ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/database/Member.java</span></span><br><span class="line"><span class="keyword">package</span> annotations.database;</span><br><span class="line"><span class="meta">@DBTable</span>(name = <span class="string">"MEMBER"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Member</span> </span>&#123;</span><br><span class="line">    <span class="meta">@SQLString</span>(<span class="number">30</span>) String firstName;</span><br><span class="line">    <span class="meta">@SQLString</span>(<span class="number">50</span>) String lastName;</span><br><span class="line">    <span class="meta">@SQLInteger</span> Integer age;</span><br><span class="line">    <span class="meta">@SQLString</span>(value = <span class="number">30</span>,</span><br><span class="line">            constraints = <span class="meta">@Constraints</span>(primaryKey = <span class="keyword">true</span>))</span><br><span class="line">    String reference;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> memberCount;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getReference</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> reference; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getFirstName</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> firstName; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getLastName</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> lastName; &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> reference; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> Integer <span class="title">getAge</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> age; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ç±»æ³¨è§£ <strong>@DBTable</strong> æ³¨è§£ç»™å®šäº†å…ƒç´ å€¼ MEMBERï¼Œå®ƒå°†ä¼šä½œä¸ºæ ‡çš„åå­—ã€‚ç±»çš„å±æ€§ <strong>firstName</strong> å’Œ <strong>lastName</strong> éƒ½è¢«æ³¨è§£ä¸º <strong>@SQLString</strong> ç±»å‹å¹¶ä¸”ç»™äº†é»˜è®¤å…ƒç´ å€¼åˆ†åˆ«ä¸º 30 å’Œ 50ã€‚è¿™äº›æ³¨è§£éƒ½æœ‰ä¸¤ä¸ªæœ‰è¶£çš„åœ°æ–¹ï¼šé¦–å…ˆï¼Œä»–ä»¬éƒ½ä½¿ç”¨äº†åµŒå…¥çš„ <strong>@Constraints</strong> æ³¨è§£çš„é»˜è®¤å€¼ï¼›å…¶æ¬¡ï¼Œå®ƒä»¬éƒ½æ˜¯ç”¨äº†å¿«æ·æ–¹å¼ç‰¹æ€§ã€‚å¦‚æœä½ åœ¨æ³¨è§£ä¸­å®šä¹‰äº†åä¸º <strong>value</strong> çš„å…ƒç´ ï¼Œå¹¶ä¸”åœ¨ä½¿ç”¨è¯¥æ³¨è§£æ—¶ï¼Œ<strong>value</strong> ä¸ºå”¯ä¸€ä¸€ä¸ªéœ€è¦èµ‹å€¼çš„å…ƒç´ ï¼Œä½ å°±ä¸éœ€è¦ä½¿ç”¨åâ€”å€¼å¯¹çš„è¯­æ³•ï¼Œä½ åªéœ€è¦åœ¨æ‹¬å·ä¸­ç»™å‡º <strong>value</strong> å…ƒç´ çš„å€¼å³å¯ã€‚è¿™å¯ä»¥åº”ç”¨äºä»»ä½•åˆæ³•ç±»å‹çš„å…ƒç´ ã€‚è¿™ä¹Ÿé™åˆ¶äº†ä½ å¿…é¡»å°†å…ƒç´ å‘½åä¸º <strong>value</strong>ï¼Œä¸è¿‡åœ¨ä¸Šé¢çš„ä¾‹å­ä¸­ï¼Œè¿™æ ·çš„æ³¨è§£è¯­å¥ä¹Ÿæ›´æ˜“äºç†è§£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">@SQLString</span>(<span class="number">30</span>)</span><br></pre></td></tr></table></figure><p>å¤„ç†å™¨å°†åœ¨åˆ›å»ºè¡¨çš„æ—¶å€™ä½¿ç”¨è¯¥å€¼è®¾ç½® SQL åˆ—çš„å¤§å°ã€‚</p><p>é»˜è®¤å€¼çš„è¯­æ³•è™½ç„¶å¾ˆçµå·§ï¼Œä½†æ˜¯å®ƒå¾ˆå¿«å°±å˜çš„å¤æ‚èµ·æ¥ã€‚ä»¥ <strong>reference</strong> å­—æ®µçš„æ³¨è§£ä¸ºä¾‹ï¼Œä¸Šé¢æ‹¥æœ‰ <strong>@SQLString</strong> æ³¨è§£ï¼Œä½†æ˜¯è¿™ä¸ªå­—æ®µä¹Ÿå°†æˆä¸ºè¡¨çš„ä¸»é”®ï¼Œå› æ­¤åœ¨åµŒå…¥çš„ <strong>@Constraint</strong> æ³¨è§£ä¸­è®¾å®š <strong>primaryKey</strong> å…ƒç´ çš„å€¼ã€‚è¿™æ—¶äº‹æƒ…å°±å˜çš„å¤æ‚äº†ã€‚ä½ ä¸å¾—ä¸ä¸ºè¿™ä¸ªåµŒå…¥çš„æ³¨è§£ä½¿ç”¨å¾ˆé•¿çš„é”®â€”å€¼å¯¹çš„å½¢å¼ï¼Œæ¥æŒ‡å®šå…ƒç´ åç§°å’Œ <strong>@interface</strong> çš„åç§°ã€‚åŒæ—¶ï¼Œç”±äºæœ‰ç‰¹æ®Šå‘½åçš„ <strong>value</strong> ä¹Ÿä¸æ˜¯å”¯ä¸€éœ€è¦èµ‹å€¼çš„å…ƒç´ ï¼Œå› æ­¤ä¸èƒ½å†ä½¿ç”¨å¿«æ·æ–¹å¼ç‰¹æ€§ã€‚å¦‚ä½ æ‰€è§ï¼Œæœ€ç»ˆç»“æœä¸ç®—æ¸…æ™°æ˜“æ‡‚ã€‚</p><h3 id="æ›¿ä»£æ–¹æ¡ˆ"><a href="#æ›¿ä»£æ–¹æ¡ˆ" class="headerlink" title="æ›¿ä»£æ–¹æ¡ˆ"></a>æ›¿ä»£æ–¹æ¡ˆ</h3><p>å¯ä»¥ä½¿ç”¨å¤šç§ä¸åŒçš„æ–¹å¼æ¥å®šä¹‰è‡ªå·±çš„æ³¨è§£ç”¨äºä¸Šè¿°ä»»åŠ¡ã€‚ä¾‹å¦‚ï¼Œä½ å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå•ä¸€çš„æ³¨è§£ç±» <strong>@TableColumn</strong>ï¼Œå®ƒæ‹¥æœ‰ä¸€ä¸ª <strong>enum</strong> å…ƒç´ ï¼Œå…ƒç´ å€¼å®šä¹‰äº† <strong>STRING</strong>ï¼Œ<strong>INTEGER</strong>ï¼Œ<strong>FLOAT</strong> ç­‰ç±»å‹ã€‚è¿™æ¶ˆé™¤äº†æ¯ä¸ª SQL ç±»å‹éƒ½éœ€è¦å®šä¹‰ä¸€ä¸ª <strong>@interface</strong> çš„è´Ÿæ‹…ï¼Œä¸è¿‡ä¹Ÿä½¿å¾—ç”¨é¢å¤–ä¿¡æ¯ä¿®é¥° SQL ç±»å‹å˜çš„ä¸å¯èƒ½ï¼Œè¿™äº›é¢å¤–çš„ä¿¡æ¯ä¾‹å¦‚é•¿åº¦æˆ–ç²¾åº¦ç­‰ï¼Œéƒ½å¯èƒ½æ˜¯éå¸¸æœ‰ç”¨çš„ã€‚</p><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€ä¸ª <strong>String</strong> ç±»å‹çš„å…ƒç´ æ¥æè¿°å®é™…çš„ SQL ç±»å‹ï¼Œæ¯”å¦‚ â€œVARCHAR(30)â€ æˆ–è€… â€œINTEGERâ€ã€‚è¿™ä½¿å¾—ä½ å¯ä»¥ä¿®é¥° SQL ç±»å‹ï¼Œä½†æ˜¯è¿™ä¹Ÿå°† Java ç±»å‹åˆ° SQL ç±»å‹çš„æ˜ å°„ç»‘åœ¨äº†ä¸€èµ·ï¼Œè¿™ä¸æ˜¯ä¸€ä¸ªå¥½çš„è®¾è®¡ã€‚ä½ å¹¶ä¸æƒ³åœ¨æ•°æ®åº“æ›´æ”¹ä¹‹åé‡æ–°ç¼–è¯‘ä½ çš„ä»£ç ï¼›å¦‚æœæˆ‘ä»¬åªéœ€è¦å‘Šè¯‰æ³¨è§£å¤„ç†å™¨ï¼Œæˆ‘ä»¬æ­£åœ¨ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆâ€œå£å‘³ï¼ˆfavorï¼‰â€çš„ SQLï¼Œç„¶åæ³¨è§£åŠ©åŠ›å™¨æ¥ä¸ºæˆ‘ä»¬å¤„ç† SQL ç±»å‹çš„ç»†èŠ‚ï¼Œé‚£å°†æ˜¯ä¸€ä¸ªä¼˜é›…çš„è®¾è®¡ã€‚</p><p>ç¬¬ä¸‰ç§å¯è¡Œçš„æ–¹æ¡ˆæ˜¯ä¸€èµ·ä½¿ç”¨ä¸¤ä¸ªæ³¨è§£ï¼Œ<strong>@Constraints</strong> å’Œç›¸åº”çš„ SQL ç±»å‹ï¼ˆä¾‹å¦‚ï¼Œ<strong>@SQLInteger</strong>ï¼‰å»æ³¨è§£åŒä¸€ä¸ªå­—æ®µã€‚è¿™å¯èƒ½ä¼šè®©ä»£ç æœ‰äº›æ··ä¹±ï¼Œä½†æ˜¯ç¼–è¯‘å™¨å…è®¸ä½ å¯¹åŒä¸€ä¸ªç›®æ ‡ä½¿ç”¨å¤šä¸ªæ³¨è§£ã€‚åœ¨ Java 8ï¼Œåœ¨ä½¿ç”¨å¤šä¸ªæ³¨è§£çš„æ—¶å€™ï¼Œä½ å¯ä»¥é‡å¤ä½¿ç”¨åŒä¸€ä¸ªæ³¨è§£ã€‚</p><h3 id="æ³¨è§£ä¸æ”¯æŒç»§æ‰¿"><a href="#æ³¨è§£ä¸æ”¯æŒç»§æ‰¿" class="headerlink" title="æ³¨è§£ä¸æ”¯æŒç»§æ‰¿"></a>æ³¨è§£ä¸æ”¯æŒç»§æ‰¿</h3><p>ä½ ä¸èƒ½ä½¿ç”¨ <strong>extends</strong> å…³é”®å­—æ¥ç»§æ‰¿ <strong>@interfaces</strong>ã€‚è¿™çœŸæ˜¯ä¸€ä¸ªé—æ†¾ï¼Œå¦‚æœå¯ä»¥å®šä¹‰ <strong>@TableColumn</strong> æ³¨è§£ï¼ˆå‚è€ƒå‰é¢çš„å»ºè®®ï¼‰ï¼ŒåŒæ—¶åµŒå¥—ä¸€ä¸ª <strong>@SQLType</strong> ç±»å‹çš„æ³¨è§£ï¼Œå°†æˆä¸ºä¸€ä¸ªä¼˜é›…çš„è®¾è®¡ã€‚æŒ‰ç…§è¿™ç§æ–¹å¼ï¼Œä½ å¯ä»¥é€šè¿‡ç»§æ‰¿ <strong>@SQLType</strong> æ¥åˆ›é€ å„ç§ SQL ç±»å‹ã€‚ä¾‹å¦‚ <strong>@SQLInteger</strong> å’Œ <strong>@SQLString</strong>ã€‚å¦‚æœæ”¯æŒç»§æ‰¿ï¼Œå°±ä¼šå¤§å¤§å‡å°‘æ‰“å­—çš„å·¥ä½œé‡å¹¶ä¸”ä½¿å¾—è¯­æ³•æ›´æ•´æ´ã€‚åœ¨ Java çš„æœªæ¥ç‰ˆæœ¬ä¸­ï¼Œä¼¼ä¹æ²¡æœ‰ä»»ä½•å…³äºè®©æ³¨è§£æ”¯æŒç»§æ‰¿çš„ææ¡ˆï¼Œæ‰€ä»¥åœ¨å½“å‰æƒ…å†µä¸‹ï¼Œä¸Šä¾‹ä¸­çš„è§£å†³æ–¹æ¡ˆå¯èƒ½å·²ç»æ˜¯æœ€ä½³æ–¹æ¡ˆäº†ã€‚</p><h3 id="å®ç°å¤„ç†å™¨"><a href="#å®ç°å¤„ç†å™¨" class="headerlink" title="å®ç°å¤„ç†å™¨"></a>å®ç°å¤„ç†å™¨</h3><p>ä¸‹é¢æ˜¯ä¸€ä¸ªæ³¨è§£å¤„ç†å™¨çš„ä¾‹å­ï¼Œä»–å°†è¯»å–ä¸€ä¸ªç±»æ–‡ä»¶ï¼Œæ£€æŸ¥ä¸Šé¢çš„æ•°æ®åº“æ³¨è§£ï¼Œå¹¶ç”Ÿæˆç”¨äºåˆ›å»ºæ•°æ®åº“çš„ SQL å‘½ä»¤ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/database/TableCreator.java</span></span><br><span class="line"><span class="comment">// Reflection-based annotation processor</span></span><br><span class="line"><span class="comment">// &#123;java annotations.database.TableCreator</span></span><br><span class="line"><span class="comment">// annotations.database.Member&#125;</span></span><br><span class="line"><span class="keyword">package</span> annotations.database;</span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Annotation;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.Field;</span><br><span class="line"><span class="keyword">import</span> java.util.ArrayList;</span><br><span class="line"><span class="keyword">import</span> java.util.List;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">TableCreator</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span></span><br><span class="line">    main(String[] args) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        <span class="keyword">if</span> (args.length &lt; <span class="number">1</span>) &#123;</span><br><span class="line">            System.out.println(</span><br><span class="line">                    <span class="string">"arguments: annotated classes"</span>);</span><br><span class="line">            System.exit(<span class="number">0</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (String className : args) &#123;</span><br><span class="line">            Class&lt;?&gt; cl = Class.forName(className);</span><br><span class="line">            DBTable dbTable = cl.getAnnotation(DBTable.class);</span><br><span class="line">            <span class="keyword">if</span> (dbTable == <span class="keyword">null</span>) &#123;</span><br><span class="line">                System.out.println(</span><br><span class="line">                        <span class="string">"No DBTable annotations in class "</span> +</span><br><span class="line">                                className);</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            String tableName = dbTable.name();</span><br><span class="line">            <span class="comment">// If the name is empty, use the Class name:</span></span><br><span class="line">            <span class="keyword">if</span> (tableName.length() &lt; <span class="number">1</span>)</span><br><span class="line">                tableName = cl.getName().toUpperCase();</span><br><span class="line">            List&lt;String&gt; columnDefs = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">            <span class="keyword">for</span> (Field field : cl.getDeclaredFields()) &#123;</span><br><span class="line">                String columnName = <span class="keyword">null</span>;</span><br><span class="line">                Annotation[] anns =</span><br><span class="line">                        field.getDeclaredAnnotations();</span><br><span class="line">                <span class="keyword">if</span> (anns.length &lt; <span class="number">1</span>)</span><br><span class="line">                    <span class="keyword">continue</span>; <span class="comment">// Not a db table column</span></span><br><span class="line">                <span class="keyword">if</span> (anns[<span class="number">0</span>] <span class="keyword">instanceof</span> SQLInteger) &#123;</span><br><span class="line">                    SQLInteger sInt = (SQLInteger) anns[<span class="number">0</span>];</span><br><span class="line">                    <span class="comment">// Use field name if name not specified</span></span><br><span class="line">                    <span class="keyword">if</span> (sInt.name().length() &lt; <span class="number">1</span>)</span><br><span class="line">                        columnName = field.getName().toUpperCase();</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        columnName = sInt.name();</span><br><span class="line">                    columnDefs.add(columnName + <span class="string">" INT"</span> +</span><br><span class="line">                            getConstraints(sInt.constraints()));</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> (anns[<span class="number">0</span>] <span class="keyword">instanceof</span> SQLString) &#123;</span><br><span class="line">                    SQLString sString = (SQLString) anns[<span class="number">0</span>];</span><br><span class="line">                    <span class="comment">// Use field name if name not specified.</span></span><br><span class="line">                    <span class="keyword">if</span> (sString.name().length() &lt; <span class="number">1</span>)</span><br><span class="line">                        columnName = field.getName().toUpperCase();</span><br><span class="line">                    <span class="keyword">else</span></span><br><span class="line">                        columnName = sString.name();</span><br><span class="line">                    columnDefs.add(columnName + <span class="string">" VARCHAR("</span> +</span><br><span class="line">                            sString.value() + <span class="string">")"</span> +</span><br><span class="line">                            getConstraints(sString.constraints()));</span><br><span class="line">                &#125;</span><br><span class="line">                StringBuilder createCommand = <span class="keyword">new</span> StringBuilder(</span><br><span class="line">                        <span class="string">"CREATE TABLE "</span> + tableName + <span class="string">"("</span>);</span><br><span class="line">                <span class="keyword">for</span> (String columnDef : columnDefs)</span><br><span class="line">                    createCommand.append(</span><br><span class="line">                            <span class="string">"\n "</span> + columnDef + <span class="string">","</span>);</span><br><span class="line">                <span class="comment">// Remove trailing comma</span></span><br><span class="line">                String tableCreate = createCommand.substring(</span><br><span class="line">                        <span class="number">0</span>, createCommand.length() - <span class="number">1</span>) + <span class="string">");"</span>;</span><br><span class="line">                System.out.println(<span class="string">"Table Creation SQL for "</span> +</span><br><span class="line">                        className + <span class="string">" is:\n"</span> + tableCreate);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">static</span> String <span class="title">getConstraints</span><span class="params">(Constraints con)</span> </span>&#123;</span><br><span class="line">        String constraints = <span class="string">""</span>;</span><br><span class="line">        <span class="keyword">if</span> (!con.allowNull())</span><br><span class="line">            constraints += <span class="string">" NOT NULL"</span>;</span><br><span class="line">        <span class="keyword">if</span> (con.primaryKey())</span><br><span class="line">            constraints += <span class="string">" PRIMARY KEY"</span>;</span><br><span class="line">        <span class="keyword">if</span> (con.unique())</span><br><span class="line">            constraints += <span class="string">" UNIQUE"</span>;</span><br><span class="line">        <span class="keyword">return</span> constraints;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">Table Creation SQL for annotations.database.Member is:</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">MEMBER</span>(</span><br><span class="line">    FIRSTNAME <span class="built_in">VARCHAR</span>(<span class="number">30</span>));</span><br><span class="line">Table Creation SQL for annotations.database.Member is:</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">MEMBER</span>(</span><br><span class="line">    FIRSTNAME <span class="built_in">VARCHAR</span>(<span class="number">30</span>),</span><br><span class="line">    LASTNAME <span class="built_in">VARCHAR</span>(<span class="number">50</span>));</span><br><span class="line">Table Creation SQL for annotations.database.Member is:</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">MEMBER</span>(</span><br><span class="line">    FIRSTNAME <span class="built_in">VARCHAR</span>(<span class="number">30</span>),</span><br><span class="line">    LASTNAME <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    AGE <span class="built_in">INT</span>);</span><br><span class="line">Table Creation SQL for annotations.database.Member is:</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLE</span> <span class="keyword">MEMBER</span>(</span><br><span class="line">    FIRSTNAME <span class="built_in">VARCHAR</span>(<span class="number">30</span>),</span><br><span class="line">    LASTNAME <span class="built_in">VARCHAR</span>(<span class="number">50</span>),</span><br><span class="line">    AGE <span class="built_in">INT</span>,</span><br><span class="line">    <span class="keyword">REFERENCE</span> <span class="built_in">VARCHAR</span>(<span class="number">30</span>) PRIMARY <span class="keyword">KEY</span>);</span><br></pre></td></tr></table></figure><p>ä¸»æ–¹æ³•ä¼šå¾ªç¯å¤„ç†å‘½ä»¤è¡Œä¼ å…¥çš„æ¯ä¸€ä¸ªç±»åã€‚æ¯ä¸€ä¸ªç±»éƒ½æ˜¯ç”¨ <code>forName()</code> æ–¹æ³•è¿›è¡ŒåŠ è½½ï¼Œå¹¶ä½¿ç”¨ <code>getAnnotation(DBTable.class)</code> æ¥æ£€æŸ¥è¯¥ç±»æ˜¯å¦å¸¦æœ‰ <strong>@DBTable</strong> æ³¨è§£ã€‚å¦‚æœå­˜åœ¨ï¼Œå°†è¡¨åå­˜å‚¨èµ·æ¥ã€‚ç„¶åè¯»å–è¿™ä¸ªç±»çš„æ‰€æœ‰å­—æ®µï¼Œå¹¶ä½¿ç”¨ <code>getDeclaredAnnotations()</code> è¿›è¡Œæ£€æŸ¥ã€‚è¿™ä¸ªæ–¹æ³•è¿”å›ä¸€ä¸ªåŒ…å«ç‰¹å®šå­—æ®µä¸Šæ‰€æœ‰æ³¨è§£çš„æ•°ç»„ã€‚ç„¶åä½¿ç”¨ <strong>instanceof</strong> æ“ä½œç¬¦åˆ¤æ–­è¿™äº›æ³¨è§£æ˜¯å¦æ˜¯ <strong>@SQLInteger</strong> æˆ–è€… <strong>@SQLString</strong> ç±»å‹ã€‚å¦‚æœæ˜¯çš„è¯ï¼Œåœ¨å¯¹åº”çš„å¤„ç†å—ä¸­å°†æ„é€ å‡ºç›¸åº”çš„æ•°æ®åº“åˆ—çš„å­—ç¬¦ä¸²ç‰‡æ®µã€‚æ³¨æ„ï¼Œç”±äºæ³¨è§£æ²¡æœ‰ç»§æ‰¿æœºåˆ¶ï¼Œå¦‚æœè¦è·å–è¿‘ä¼¼å¤šæ€çš„è¡Œä¸ºï¼Œä½¿ç”¨ <code>getDeclaredAnnotations()</code> ä¼¼ä¹æ˜¯å”¯ä¸€çš„æ–¹å¼ã€‚</p><p>åµŒå¥—çš„ <strong>@Constraint</strong> æ³¨è§£è¢«ä¼ é€’ç»™ <code>getConstraints()</code>æ–¹æ³•ï¼Œå¹¶ç”¨å®ƒæ¥æ„é€ ä¸€ä¸ªåŒ…å« SQL çº¦æŸçš„ String å¯¹è±¡ã€‚</p><p>éœ€è¦æé†’çš„æ˜¯ï¼Œä¸Šé¢æ¼”ç¤ºçš„æŠ€å·§å¯¹äºçœŸå®çš„å¯¹è±¡/æ˜ å°„å…³ç³»è€Œè¨€ï¼Œæ˜¯ååˆ†å¹¼ç¨šçš„ã€‚ä½¿ç”¨ <strong>@DBTable</strong> çš„æ³¨è§£æ¥è·å–è¡¨çš„åç§°ï¼Œè¿™ä½¿å¾—å¦‚æœè¦ä¿®æ”¹è¡¨çš„åå­—ï¼Œåˆ™è¿«ä½¿ä½ é‡æ–°ç¼–è¯‘ Java ä»£ç ã€‚è¿™ç§æ•ˆæœå¹¶ä¸ç†æƒ³ã€‚ç°åœ¨å·²ç»æœ‰äº†å¾ˆå¤šå¯ç”¨çš„æ¡†æ¶ï¼Œç”¨äºå°†å¯¹è±¡æ˜ å°„åˆ°æ•°æ®åº“ä¸­ï¼Œå¹¶ä¸”è¶Šæ¥è¶Šå¤šçš„æ¡†æ¶å¼€å§‹ä½¿ç”¨æ³¨è§£äº†ã€‚</p><!-- Using javac to Process Annotations --><h2 id="ä½¿ç”¨javacå¤„ç†æ³¨è§£"><a href="#ä½¿ç”¨javacå¤„ç†æ³¨è§£" class="headerlink" title="ä½¿ç”¨javacå¤„ç†æ³¨è§£"></a>ä½¿ç”¨javacå¤„ç†æ³¨è§£</h2><p>é€šè¿‡ <strong>javac</strong>ï¼Œä½ å¯ä»¥é€šè¿‡åˆ›å»ºç¼–è¯‘æ—¶ï¼ˆcompile-timeï¼‰æ³¨è§£å¤„ç†å™¨åœ¨ Java æºæ–‡ä»¶ä¸Šä½¿ç”¨æ³¨è§£ï¼Œè€Œä¸æ˜¯ç¼–è¯‘ä¹‹åçš„ class æ–‡ä»¶ã€‚ä½†æ˜¯è¿™é‡Œæœ‰ä¸€ä¸ªé‡å¤§é™åˆ¶ï¼šä½ ä¸èƒ½é€šè¿‡å¤„ç†å™¨æ¥æ”¹å˜æºä»£ç ã€‚å”¯ä¸€å½±å“è¾“å‡ºçš„æ–¹å¼å°±æ˜¯åˆ›å»ºæ–°çš„æ–‡ä»¶ã€‚</p><p>å¦‚æœä½ çš„æ³¨è§£å¤„ç†å™¨åˆ›å»ºäº†æ–°çš„æºæ–‡ä»¶ï¼Œåœ¨æ–°ä¸€è½®å¤„ç†ä¸­æ³¨è§£ä¼šæ£€æŸ¥æºæ–‡ä»¶æœ¬èº«ã€‚å·¥å…·åœ¨æ£€æµ‹ä¸€è½®ä¹‹åæŒç»­å¾ªç¯ï¼Œç›´åˆ°ä¸å†æœ‰æ–°çš„æºæ–‡ä»¶äº§ç”Ÿã€‚ç„¶åå®ƒç¼–è¯‘æ‰€æœ‰çš„æºæ–‡ä»¶ã€‚</p><p>æ¯ä¸€ä¸ªä½ ç¼–å†™çš„æ³¨è§£éƒ½éœ€è¦å¤„ç†å™¨ï¼Œä½†æ˜¯ <strong>javac</strong> å¯ä»¥éå¸¸å®¹æ˜“çš„å°†å¤šä¸ªæ³¨è§£å¤„ç†å™¨åˆå¹¶åœ¨ä¸€èµ·ã€‚ä½ å¯ä»¥æŒ‡å®šå¤šä¸ªéœ€è¦å¤„ç†çš„ç±»ï¼Œå¹¶ä¸”ä½ å¯ä»¥æ·»åŠ ç›‘å¬å™¨ç”¨äºç›‘å¬æ³¨è§£å¤„ç†å®Œæˆåæ¥åˆ°é€šçŸ¥ã€‚</p><p>æœ¬èŠ‚ä¸­çš„ç¤ºä¾‹å°†å¸®åŠ©ä½ å¼€å§‹å­¦ä¹ ï¼Œä½†å¦‚æœä½ å¿…é¡»æ·±å…¥å­¦ä¹ ï¼Œè¯·åšå¥½åå¤å­¦ä¹ ï¼Œå¤§é‡è®¿é—® Google å’ŒStackOverflow çš„å‡†å¤‡ã€‚</p><h3 id="æœ€ç®€å•çš„å¤„ç†å™¨"><a href="#æœ€ç®€å•çš„å¤„ç†å™¨" class="headerlink" title="æœ€ç®€å•çš„å¤„ç†å™¨"></a>æœ€ç®€å•çš„å¤„ç†å™¨</h3><p>è®©æˆ‘ä»¬å¼€å§‹å®šä¹‰æˆ‘ä»¬èƒ½æƒ³åˆ°çš„æœ€ç®€å•çš„å¤„ç†å™¨ï¼Œåªæ˜¯ä¸ºäº†ç¼–è¯‘å’Œæµ‹è¯•ã€‚å¦‚ä¸‹æ˜¯æ³¨è§£çš„å®šä¹‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/simplest/Simple.java</span></span><br><span class="line"><span class="comment">// A bare-bones annotation</span></span><br><span class="line"><span class="keyword">package</span> annotations.simplest;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Retention;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.RetentionPolicy;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.Target;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.ElementType;</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.TYPE, ElementType.METHOD,</span><br><span class="line">        ElementType.CONSTRUCTOR,</span><br><span class="line">        ElementType.ANNOTATION_TYPE,</span><br><span class="line">        ElementType.PACKAGE, ElementType.FIELD,</span><br><span class="line">        ElementType.LOCAL_VARIABLE&#125;)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> Simple &#123;</span><br><span class="line">    <span class="function">String <span class="title">value</span><span class="params">()</span> <span class="keyword">default</span> "-<span class="keyword">default</span>-"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>@Retention</strong> çš„å‚æ•°ç°åœ¨ä¸º <strong>SOURCE</strong>ï¼Œè¿™æ„å‘³ç€æ³¨è§£ä¸ä¼šå†å­˜ç•™åœ¨ç¼–è¯‘åçš„ä»£ç ã€‚è¿™åœ¨ç¼–è¯‘æ—¶å¤„ç†æ³¨è§£æ˜¯æ²¡æœ‰å¿…è¦çš„ï¼Œå®ƒåªæ˜¯æŒ‡å‡ºï¼Œåœ¨è¿™é‡Œï¼Œ<strong>javac</strong> æ˜¯å”¯ä¸€æœ‰æœºä¼šå¤„ç†æ³¨è§£çš„ä»£ç†ã€‚</p><p><strong>@Target</strong> å£°æ˜äº†å‡ ä¹æ‰€æœ‰çš„ç›®æ ‡ç±»å‹ï¼ˆé™¤äº† <strong>PACKAGE</strong>ï¼‰ ï¼ŒåŒæ ·æ˜¯ä¸ºäº†æ¼”ç¤ºã€‚ä¸‹é¢æ˜¯ä¸€ä¸ªæµ‹è¯•ç¤ºä¾‹ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/simplest/SimpleTest.java</span></span><br><span class="line"><span class="comment">// Test the "Simple" annotation</span></span><br><span class="line"><span class="comment">// &#123;java annotations.simplest.SimpleTest&#125;</span></span><br><span class="line"><span class="keyword">package</span> annotations.simplest;</span><br><span class="line"><span class="meta">@Simple</span></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleTest</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Simple</span></span><br><span class="line">    <span class="keyword">int</span> i;</span><br><span class="line">    <span class="meta">@Simple</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">SimpleTest</span><span class="params">()</span> </span>&#123;&#125;</span><br><span class="line">    <span class="meta">@Simple</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">foo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"SimpleTest.foo()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Simple</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">bar</span><span class="params">(String s, <span class="keyword">int</span> i, <span class="keyword">float</span> f)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"SimpleTest.bar()"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Simple</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="meta">@Simple</span></span><br><span class="line">        SimpleTest st = <span class="keyword">new</span> SimpleTest();</span><br><span class="line">        st.foo();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SimpleTest.foo()</span><br></pre></td></tr></table></figure><p>åœ¨è¿™é‡Œæˆ‘ä»¬ä½¿ç”¨ <strong>@Simple</strong> æ³¨è§£äº†æ‰€æœ‰ <strong>@Target</strong> å£°æ˜å…è®¸çš„åœ°æ–¹ã€‚</p><p><strong>SimpleTest.java</strong> åªéœ€è¦ <strong>Simple.java</strong> å°±å¯ä»¥ç¼–è¯‘æˆåŠŸã€‚å½“æˆ‘ä»¬ç¼–è¯‘çš„æ—¶å€™ä»€ä¹ˆéƒ½æ²¡æœ‰å‘ç”Ÿã€‚</p><p><strong>javac</strong> å…è®¸ <strong>@Simple</strong> æ³¨è§£ï¼ˆåªè¦å®ƒå­˜åœ¨ï¼‰åœ¨æˆ‘ä»¬åˆ›å»ºå¤„ç†å™¨å¹¶å°†å…¶ hook åˆ°ç¼–è¯‘å™¨ä¹‹å‰ï¼Œä¸åšä»»ä½•äº‹æƒ…ã€‚</p><p>å¦‚ä¸‹æ˜¯ä¸€ä¸ªååˆ†ç®€å•çš„å¤„ç†å™¨ï¼Œå…¶æ‰€ä½œçš„äº‹æƒ…å°±æ˜¯æŠŠæ³¨è§£ç›¸å…³çš„ä¿¡æ¯æ‰“å°å‡ºæ¥ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/simplest/SimpleProcessor.java</span></span><br><span class="line"><span class="comment">// A bare-bones annotation processor</span></span><br><span class="line"><span class="keyword">package</span> annotations.simplest;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.processing.*;</span><br><span class="line"><span class="keyword">import</span> javax.lang.model.SourceVersion;</span><br><span class="line"><span class="keyword">import</span> javax.lang.model.element.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="meta">@SupportedAnnotationTypes</span>(</span><br><span class="line">        <span class="string">"annotations.simplest.Simple"</span>)</span><br><span class="line"><span class="meta">@SupportedSourceVersion</span>(SourceVersion.RELEASE_8)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">SimpleProcessor</span></span></span><br><span class="line"><span class="class">        <span class="keyword">extends</span> <span class="title">AbstractProcessor</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">process</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            Set&lt;? extends TypeElement&gt; annotations,</span></span></span><br><span class="line"><span class="function"><span class="params">            RoundEnvironment env)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(TypeElement t : annotations)</span><br><span class="line">            System.out.println(t);</span><br><span class="line">        <span class="keyword">for</span>(Element el :</span><br><span class="line">                env.getElementsAnnotatedWith(Simple.class))</span><br><span class="line">            display(el);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">void</span> <span class="title">display</span><span class="params">(Element el)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"==== "</span> + el + <span class="string">" ===="</span>);</span><br><span class="line">        System.out.println(el.getKind() +</span><br><span class="line">                <span class="string">" : "</span> + el.getModifiers() +</span><br><span class="line">                <span class="string">" : "</span> + el.getSimpleName() +</span><br><span class="line">                <span class="string">" : "</span> + el.asType());</span><br><span class="line">        <span class="keyword">if</span>(el.getKind().equals(ElementKind.CLASS)) &#123;</span><br><span class="line">            TypeElement te = (TypeElement)el;</span><br><span class="line">            System.out.println(te.getQualifiedName());</span><br><span class="line">            System.out.println(te.getSuperclass());</span><br><span class="line">            System.out.println(te.getEnclosedElements());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(el.getKind().equals(ElementKind.METHOD)) &#123;</span><br><span class="line">            ExecutableElement ex = (ExecutableElement)el;</span><br><span class="line">            System.out.print(ex.getReturnType() + <span class="string">" "</span>);</span><br><span class="line">            System.out.print(ex.getSimpleName() + <span class="string">"("</span>);</span><br><span class="line">            System.out.println(ex.getParameters() + <span class="string">")"</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ï¼ˆæ—§çš„ï¼Œå¤±æ•ˆçš„ï¼‰<strong>apt</strong> ç‰ˆæœ¬çš„å¤„ç†å™¨éœ€è¦é¢å¤–çš„æ–¹æ³•æ¥ç¡®å®šæ”¯æŒå“ªäº›æ³¨è§£ä»¥åŠæ”¯æŒçš„ Java ç‰ˆæœ¬ã€‚ä¸è¿‡ï¼Œä½ ç°åœ¨å¯ä»¥ç®€å•çš„ä½¿ç”¨ <strong>@SupportedAnnotationTypes</strong> å’Œ <strong>@SupportedSourceVersion</strong> æ³¨è§£ï¼ˆè¿™æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„ç¤ºä¾‹å…³äºæ³¨è§£å¦‚ä½•ç®€åŒ–ä½ çš„ä»£ç ï¼‰ã€‚</p><p>ä½ å”¯ä¸€éœ€è¦å®ç°çš„æ–¹æ³•å°±æ˜¯ <code>process()</code>ï¼Œè¿™é‡Œæ˜¯æ‰€æœ‰è¡Œä¸ºå‘ç”Ÿçš„åœ°æ–¹ã€‚ç¬¬ä¸€ä¸ªå‚æ•°å‘Šè¯‰ä½ å“ªä¸ªæ³¨è§£æ˜¯å­˜åœ¨çš„ï¼Œç¬¬äºŒä¸ªå‚æ•°ä¿ç•™äº†å‰©ä½™ä¿¡æ¯ã€‚æˆ‘ä»¬æ‰€åšçš„äº‹æƒ…åªæ˜¯æ‰“å°äº†æ³¨è§£ï¼ˆè¿™é‡Œåªå­˜åœ¨ä¸€ä¸ªï¼‰ï¼Œå¯ä»¥çœ‹ <strong>TypeElement</strong> æ–‡æ¡£ä¸­çš„å…¶ä»–è¡Œä¸ºã€‚é€šè¿‡ä½¿ç”¨ <code>process()</code> çš„ç¬¬äºŒä¸ªæ“ä½œï¼Œæˆ‘ä»¬å¾ªç¯æ‰€æœ‰è¢« <strong>@Simple</strong> æ³¨è§£çš„å…ƒç´ ï¼Œå¹¶ä¸”é’ˆå¯¹æ¯ä¸€ä¸ªå…ƒç´ è°ƒç”¨æˆ‘ä»¬çš„ <code>display()</code> æ–¹æ³•ã€‚æ‰€æœ‰ <strong>Element</strong> å±•ç¤ºäº†æœ¬èº«çš„åŸºæœ¬ä¿¡æ¯ï¼›ä¾‹å¦‚ï¼Œ<code>getModifiers()</code> å‘Šè¯‰ä½ å®ƒæ˜¯å¦ä¸º <strong>public</strong> å’Œ <strong>static</strong> çš„ã€‚</p><p><strong>Element</strong> åªèƒ½æ‰§è¡Œé‚£äº›ç¼–è¯‘å™¨è§£æçš„æ‰€æœ‰åŸºæœ¬å¯¹è±¡å…±æœ‰çš„æ“ä½œï¼Œè€Œç±»å’Œæ–¹æ³•ä¹‹ç±»çš„ä¸œè¥¿æœ‰é¢å¤–çš„ä¿¡æ¯éœ€è¦æå–ã€‚æ‰€ä»¥ï¼ˆå¦‚æœä½ é˜…è¯»äº†æ­£ç¡®çš„æ–‡æ¡£ï¼Œä½†æ˜¯æˆ‘æ²¡æœ‰åœ¨ä»»ä½•æ–‡æ¡£ä¸­æ‰¾åˆ°â€”â€”æˆ‘ä¸å¾—ä¸é€šè¿‡ StackOverflow å¯»æ‰¾çº¿ç´¢ï¼‰ä½ æ£€æŸ¥å®ƒæ˜¯å“ªç§ <strong>ElementKind</strong>ï¼Œç„¶åå°†å…¶å‘ä¸‹è½¬æ¢ä¸ºæ›´å…·ä½“çš„å…ƒç´ ç±»å‹ï¼Œæ³¨å…¥é’ˆå¯¹ CLASS çš„ TypeElement å’Œ é’ˆå¯¹ METHOD çš„ExecutableElementã€‚æ­¤æ—¶ï¼Œå¯ä»¥ä¸ºè¿™äº›å…ƒç´ è°ƒç”¨å…¶ä»–æ–¹æ³•ã€‚</p><p>åŠ¨æ€å‘ä¸‹è½¬å‹ï¼ˆåœ¨ç¼–è¯‘æœŸä¸è¿›è¡Œæ£€æŸ¥ï¼‰å¹¶ä¸åƒæ˜¯ Java çš„åšäº‹æ–¹å¼ï¼Œè¿™éå¸¸ä¸ç›´è§‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆæˆ‘ä»æœªæƒ³è¿‡è¦è¿™æ ·åšäº‹ã€‚ç›¸åï¼Œæˆ‘èŠ±äº†å¥½å‡ å¤©çš„æ—¶é—´ï¼Œè¯•å›¾å‘ç°ä½ åº”è¯¥å¦‚ä½•è®¿é—®è¿™äº›ä¿¡æ¯ï¼Œè€Œè¿™äº›ä¿¡æ¯è‡³å°‘åœ¨æŸç§ç¨‹åº¦ä¸Šæ˜¯ç”¨ä¸èµ·ä½œç”¨çš„æ°å½“æ–¹æ³•ç®€å•æ˜äº†çš„ã€‚æˆ‘è¿˜æ²¡æœ‰é‡åˆ°ä»»ä½•ä¸œè¥¿è¯´ä¸Šé¢æ˜¯è§„èŒƒçš„å½¢å¼ï¼Œä½†åœ¨æˆ‘çœ‹æ¥æ˜¯ã€‚</p><p>å¦‚æœåªæ˜¯é€šè¿‡å¹³å¸¸çš„æ–¹å¼æ¥ç¼–è¯‘ <strong>SimpleTest.java</strong>ï¼Œä½ ä¸ä¼šå¾—åˆ°ä»»ä½•ç»“æœã€‚ä¸ºäº†å¾—åˆ°æ³¨è§£è¾“å‡ºï¼Œä½ å¿…é¡»å¢åŠ ä¸€ä¸ª <strong>processor</strong> æ ‡å¿—å¹¶ä¸”è¿æ¥æ³¨è§£å¤„ç†å™¨ç±»</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac -processor annotations.simplest.SimpleProcessor SimpleTest.java</span><br></pre></td></tr></table></figure><p>ç°åœ¨ç¼–è¯‘å™¨æœ‰äº†è¾“å‡º</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">annotations.simplest.Simple</span><br><span class="line">==== annotations.simplest.SimpleTest ====</span><br><span class="line">CLASS : [public] : SimpleTest : annotations.simplest.SimpleTest</span><br><span class="line">annotations.simplest.SimpleTest</span><br><span class="line">java.lang.Object</span><br><span class="line">i,SimpleTest(),foo(),bar(java.lang.String,int,float),main(java.lang.String[])</span><br><span class="line">==== i ====</span><br><span class="line">FIELD : [] : i : int</span><br><span class="line">==== SimpleTest() ====</span><br><span class="line">CONSTRUCTOR : [public] : &lt;init&gt; : ()void</span><br><span class="line">==== foo() ====</span><br><span class="line">METHOD : [public] : foo : ()void</span><br><span class="line">void foo()</span><br><span class="line">==== bar(java.lang.String,int,float) ====</span><br><span class="line">METHOD : [public] : bar : (java.lang.String,int,float)void</span><br><span class="line">void bar(s,i,f)</span><br><span class="line">==== main(java.lang.String[]) ====</span><br><span class="line">METHOD : [public, static] : main : (java.lang.String[])void</span><br><span class="line">void main(args)</span><br></pre></td></tr></table></figure><p>è¿™ç»™äº†ä½ ä¸€äº›å¯ä»¥å‘ç°çš„ä¸œè¥¿ï¼ŒåŒ…æ‹¬å‚æ•°åå’Œç±»å‹ã€è¿”å›å€¼ç­‰ã€‚</p><h3 id="æ›´å¤æ‚çš„å¤„ç†å™¨"><a href="#æ›´å¤æ‚çš„å¤„ç†å™¨" class="headerlink" title="æ›´å¤æ‚çš„å¤„ç†å™¨"></a>æ›´å¤æ‚çš„å¤„ç†å™¨</h3><p>å½“ä½ åˆ›å»ºç”¨äº javac æ³¨è§£å¤„ç†å™¨æ—¶ï¼Œä½ ä¸èƒ½ä½¿ç”¨ Java çš„åå°„ç‰¹æ€§ï¼Œå› ä¸ºä½ å¤„ç†çš„æ˜¯æºä»£ç ï¼Œè€Œå¹¶éæ˜¯ç¼–è¯‘åçš„ class æ–‡ä»¶ã€‚å„ç§ mirror[^3 ] è§£å†³è¿™ä¸ªé—®é¢˜çš„æ–¹æ³•æ˜¯ï¼Œé€šè¿‡å…è®¸ä½ åœ¨æœªç¼–è¯‘çš„æºä»£ç ä¸­æŸ¥çœ‹æ–¹æ³•ã€å­—æ®µå’Œç±»å‹ã€‚</p><p>å¦‚ä¸‹æ˜¯ä¸€ä¸ªç”¨äºæå–ç±»ä¸­æ–¹æ³•çš„æ³¨è§£ï¼Œæ‰€ä»¥å®ƒå¯ä»¥è¢«æŠ½å–æˆä¸ºä¸€ä¸ªæ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/ifx/ExtractInterface.java</span></span><br><span class="line"><span class="comment">// javac-based annotation processing</span></span><br><span class="line"><span class="keyword">package</span> annotations.ifx;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"><span class="meta">@Target</span>(ElementType.TYPE)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.SOURCE)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> ExtractInterface &#123;</span><br><span class="line">    <span class="function">String <span class="title">interfaceName</span><span class="params">()</span> <span class="keyword">default</span> "-!!-"</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>RetentionPolicy</strong> çš„å€¼ä¸º <strong>SOURCE</strong>ï¼Œè¿™æ˜¯ä¸ºäº†åœ¨æå–ç±»ä¸­çš„æ¥å£ä¹‹åä¸å†å°†æ³¨è§£ä¿¡æ¯ä¿ç•™åœ¨ class æ–‡ä»¶ä¸­ã€‚æ¥ä¸‹æ¥çš„æµ‹è¯•ç±»æä¾›äº†ä¸€äº›å…¬ç”¨æ–¹æ³•ï¼Œè¿™äº›æ–¹æ³•å¯ä»¥æˆä¸ºæ¥å£çš„ä¸€éƒ¨åˆ†ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/ifx/Multiplier.java</span></span><br><span class="line"><span class="comment">// javac-based annotation processing</span></span><br><span class="line"><span class="comment">// &#123;java annotations.ifx.Multiplier&#125;</span></span><br><span class="line"><span class="keyword">package</span> annotations.ifx;</span><br><span class="line"><span class="meta">@ExtractInterface</span>(interfaceName=<span class="string">"IMultiplier"</span>)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">Multiplier</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">boolean</span> flag = <span class="keyword">false</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> n = <span class="number">0</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">multiply</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> total = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; x; i++)</span><br><span class="line">            total = add(total, y);</span><br><span class="line">        <span class="keyword">return</span> total;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">fortySeven</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="number">47</span>; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">int</span> <span class="title">add</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> x + y;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">timesTen</span><span class="params">(<span class="keyword">double</span> arg)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> arg * <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        Multiplier m = <span class="keyword">new</span> Multiplier();</span><br><span class="line">        System.out.println(</span><br><span class="line">                <span class="string">"11 * 16 = "</span> + m.multiply(<span class="number">11</span>, <span class="number">16</span>));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">11</span> * <span class="number">16</span> = <span class="number">176</span></span><br></pre></td></tr></table></figure><p><strong>Multiplier</strong> ç±»ï¼ˆåªèƒ½å¤„ç†æ­£æ•´æ•°ï¼‰æ‹¥æœ‰ä¸€ä¸ª <code>multiply()</code> æ–¹æ³•ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šå¤šæ¬¡è°ƒç”¨ç§æœ‰æ–¹æ³• <code>add()</code> æ¥æ¨¡æ‹Ÿä¹˜æ³•æ“ä½œã€‚<code>add()</code> æ˜¯ç§æœ‰æ–¹æ³•ï¼Œå› æ­¤ä¸èƒ½æˆä¸ºæ¥å£çš„ä¸€éƒ¨åˆ†ã€‚å…¶ä»–çš„æ–¹æ³•æä¾›äº†è¯­æ³•å¤šæ ·æ€§ã€‚æ³¨è§£è¢«èµ‹äºˆ <strong>IMultiplier</strong> çš„ <strong>InterfaceName</strong> ä½œä¸ºè¦åˆ›å»ºçš„æ¥å£çš„åç§°ã€‚</p><p>è¿™é‡Œæœ‰ä¸€ä¸ªç¼–è¯‘æ—¶å¤„ç†å™¨ç”¨äºæå–æœ‰è¶£çš„æ–¹æ³•ï¼Œå¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ interface æºä»£ç æ–‡ä»¶ï¼ˆè¿™ä¸ªæºæ–‡ä»¶å°†ä¼šåœ¨ä¸‹ä¸€è½®ä¸­è¢«è‡ªåŠ¨ç¼–è¯‘ï¼‰ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/ifx/IfaceExtractorProcessor.java</span></span><br><span class="line"><span class="comment">// javac-based annotation processing</span></span><br><span class="line"><span class="keyword">package</span> annotations.ifx;</span><br><span class="line"><span class="keyword">import</span> javax.annotation.processing.*;</span><br><span class="line"><span class="keyword">import</span> javax.lang.model.SourceVersion;</span><br><span class="line"><span class="keyword">import</span> javax.lang.model.element.*;</span><br><span class="line"><span class="keyword">import</span> javax.lang.model.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="meta">@SupportedAnnotationTypes</span>(</span><br><span class="line">        <span class="string">"annotations.ifx.ExtractInterface"</span>)</span><br><span class="line"><span class="meta">@SupportedSourceVersion</span>(SourceVersion.RELEASE_8)</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">IfaceExtractorProcessor</span></span></span><br><span class="line"><span class="class">        <span class="keyword">extends</span> <span class="title">AbstractProcessor</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> ArrayList&lt;Element&gt;</span><br><span class="line">            interfaceMethods = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    Elements elementUtils;</span><br><span class="line">    <span class="keyword">private</span> ProcessingEnvironment processingEnv;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">init</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            ProcessingEnvironment processingEnv)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.processingEnv = processingEnv;</span><br><span class="line">        elementUtils = processingEnv.getElementUtils();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">process</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            Set&lt;? extends TypeElement&gt; annotations,</span></span></span><br><span class="line"><span class="function"><span class="params">            RoundEnvironment env)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">for</span>(Element elem:env.getElementsAnnotatedWith(</span><br><span class="line">                ExtractInterface.class)) &#123;</span><br><span class="line">            String interfaceName = elem.getAnnotation(</span><br><span class="line">                    ExtractInterface.class).interfaceName();</span><br><span class="line">            <span class="keyword">for</span>(Element enclosed :</span><br><span class="line">                    elem.getEnclosedElements()) &#123;</span><br><span class="line">                <span class="keyword">if</span>(enclosed.getKind()</span><br><span class="line">                        .equals(ElementKind.METHOD) &amp;&amp;</span><br><span class="line">                        enclosed.getModifiers()</span><br><span class="line">                                .contains(Modifier.PUBLIC) &amp;&amp;</span><br><span class="line">                        !enclosed.getModifiers()</span><br><span class="line">                                .contains(Modifier.STATIC)) &#123;</span><br><span class="line">                    interfaceMethods.add(enclosed);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span>(interfaceMethods.size() &gt; <span class="number">0</span>)</span><br><span class="line">                writeInterfaceFile(interfaceName);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">void</span></span><br><span class="line">    writeInterfaceFile(String interfaceName) &#123;</span><br><span class="line">        <span class="keyword">try</span>(</span><br><span class="line">                Writer writer = processingEnv.getFiler()</span><br><span class="line">                        .createSourceFile(interfaceName)</span><br><span class="line">                        .openWriter()</span><br><span class="line">        ) &#123;</span><br><span class="line">            String packageName = elementUtils</span><br><span class="line">                    .getPackageOf(interfaceMethods</span><br><span class="line">                            .get(<span class="number">0</span>)).toString();</span><br><span class="line">            writer.write(</span><br><span class="line">                    <span class="string">"package "</span> + packageName + <span class="string">";\n"</span>);</span><br><span class="line">            writer.write(<span class="string">"public interface "</span> +</span><br><span class="line">                    interfaceName + <span class="string">" &#123;\n"</span>);</span><br><span class="line">            <span class="keyword">for</span>(Element elem : interfaceMethods) &#123;</span><br><span class="line">                ExecutableElement method =</span><br><span class="line">                        (ExecutableElement)elem;</span><br><span class="line">                String signature = <span class="string">" public "</span>;</span><br><span class="line">                signature += method.getReturnType() + <span class="string">" "</span>;</span><br><span class="line">                signature += method.getSimpleName();</span><br><span class="line">                signature += createArgList(</span><br><span class="line">                        method.getParameters());</span><br><span class="line">                System.out.println(signature);</span><br><span class="line">                writer.write(signature + <span class="string">";\n"</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            writer.write(<span class="string">"&#125;"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">private</span> String <span class="title">createArgList</span><span class="params">(</span></span></span><br><span class="line"><span class="function"><span class="params">            List&lt;? extends VariableElement&gt; parameters)</span> </span>&#123;</span><br><span class="line">        String args = parameters.stream()</span><br><span class="line">                .map(p -&gt; p.asType() + <span class="string">" "</span> + p.getSimpleName())</span><br><span class="line">                .collect(Collectors.joining(<span class="string">", "</span>));</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"("</span> + args + <span class="string">")"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>Elements</strong> å¯¹è±¡å®ä¾‹ <strong>elementUtils</strong> æ˜¯ä¸€ç»„é™æ€æ–¹æ³•çš„å·¥å…·ï¼›æˆ‘ä»¬ç”¨å®ƒæ¥å¯»æ‰¾ <strong>writeInterfaceFile()</strong> ä¸­å«æœ‰çš„åŒ…åã€‚</p><p><code>getEnclosedElements()</code>æ–¹æ³•ä¼šé€šè¿‡æŒ‡å®šçš„å…ƒç´ ç”Ÿæˆæ‰€æœ‰çš„â€œé—­åŒ…â€å…ƒç´ ã€‚åœ¨è¿™é‡Œï¼Œè¿™ä¸ªç±»é—­åŒ…äº†å®ƒçš„æ‰€æœ‰å…ƒç´ ã€‚é€šè¿‡ä½¿ç”¨ <code>getKind()</code> æˆ‘ä»¬ä¼šæ‰¾åˆ°æ‰€æœ‰çš„ <strong>public</strong> å’Œ <strong>static</strong> æ–¹æ³•ï¼Œå¹¶å°†å…¶æ·»åŠ åˆ° <strong>interfaceMethods</strong> åˆ—è¡¨ä¸­ã€‚æ¥ä¸‹æ¥ <code>writeInterfaceFile()</code> ä½¿ç”¨ <strong>interfaceMethods</strong> åˆ—è¡¨é‡Œé¢çš„å€¼ç”Ÿæˆæ–°çš„æ¥å£å®šä¹‰ã€‚æ³¨æ„ï¼Œåœ¨ <code>writeInterfaceFile()</code> ä½¿ç”¨äº†å‘ä¸‹è½¬å‹åˆ° <strong>ExecutableElement</strong>ï¼Œè¿™ä½¿å¾—æˆ‘ä»¬å¯ä»¥è·å–æ‰€æœ‰çš„æ–¹æ³•ä¿¡æ¯ã€‚<strong>createArgList()</strong> æ˜¯ä¸€ä¸ªå¸®åŠ©æ–¹æ³•ï¼Œç”¨äºç”Ÿæˆå‚æ•°åˆ—è¡¨ã€‚</p><p><strong>Filer</strong>æ˜¯ <code>getFiler()</code> ç”Ÿæˆçš„ï¼Œå¹¶ä¸”æ˜¯ <strong>PrintWriter</strong> çš„ä¸€ç§å®ä¾‹ï¼Œå¯ä»¥ç”¨äºåˆ›å»ºæ–°æ–‡ä»¶ã€‚æˆ‘ä»¬ä½¿ç”¨ <strong>Filer</strong> å¯¹è±¡ï¼Œè€Œä¸æ˜¯åŸç”Ÿçš„ <strong>PrintWriter</strong> åŸå› æ˜¯ï¼Œè¿™ä¸ªå¯¹è±¡å¯ä»¥è¿è¡Œ <strong>javac</strong> è¿½è¸ªä½ åˆ›å»ºçš„æ–°æ–‡ä»¶ï¼Œè¿™ä½¿å¾—å®ƒå¯ä»¥åœ¨æ–°ä¸€è½®ä¸­æ£€æŸ¥æ–°æ–‡ä»¶ä¸­çš„æ³¨è§£å¹¶ç¼–è¯‘æ–‡ä»¶ã€‚</p><p>å¦‚ä¸‹æ˜¯ä¸€ä¸ªå‘½ä»¤è¡Œï¼Œå¯ä»¥åœ¨ç¼–è¯‘çš„æ—¶å€™ä½¿ç”¨å¤„ç†å™¨ï¼š</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">javac -processor annotations.ifx.IfaceExtractorProcessor Multiplier.java</span><br></pre></td></tr></table></figure><p>æ–°ç”Ÿæˆçš„ <strong>IMultiplier.java</strong> çš„æ–‡ä»¶ï¼Œæ­£å¦‚ä½ é€šè¿‡æŸ¥çœ‹ä¸Šé¢å¤„ç†å™¨çš„ <code>println()</code> è¯­å¥æ‰€çŒœæµ‹çš„é‚£æ ·ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">package</span> annotations.ifx;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">IMultiplier</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">multiply</span><span class="params">(<span class="keyword">int</span> x, <span class="keyword">int</span> y)</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">fortySeven</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">double</span> <span class="title">timesTen</span><span class="params">(<span class="keyword">double</span> arg)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç±»åŒæ ·ä¼šè¢« <strong>javac</strong> ç¼–è¯‘ï¼ˆåœ¨æŸä¸€è½®ä¸­ï¼‰ï¼Œæ‰€ä»¥ä½ ä¼šåœ¨åŒä¸€ä¸ªç›®å½•ä¸­çœ‹åˆ° <strong>IMultiplier.class</strong> æ–‡ä»¶ã€‚</p><!-- Annotation-Based Unit Testing --><h2 id="åŸºäºæ³¨è§£çš„å•å…ƒæµ‹è¯•"><a href="#åŸºäºæ³¨è§£çš„å•å…ƒæµ‹è¯•" class="headerlink" title="åŸºäºæ³¨è§£çš„å•å…ƒæµ‹è¯•"></a>åŸºäºæ³¨è§£çš„å•å…ƒæµ‹è¯•</h2><p>å•å…ƒæµ‹è¯•æ˜¯å¯¹ç±»ä¸­æ¯ä¸ªæ–¹æ³•æä¾›ä¸€ä¸ªæˆ–è€…å¤šä¸ªæµ‹è¯•çš„ä¸€ç§äº‹ä»¶ï¼Œå…¶ç›®çš„æ˜¯ä¸ºäº†æœ‰è§„å¾‹çš„æµ‹è¯•ä¸€ä¸ªç±»ä¸­æ¯ä¸ªéƒ¨åˆ†æ˜¯å¦å…·å¤‡æ­£ç¡®çš„è¡Œä¸ºã€‚åœ¨ Java ä¸­ï¼Œæœ€è‘—åçš„å•å…ƒæµ‹è¯•å·¥å…·å°±æ˜¯ <strong>JUnit</strong>ã€‚<strong>JUnit</strong> 4 ç‰ˆæœ¬å·²ç»åŒ…å«äº†æ³¨è§£ã€‚åœ¨æ³¨è§£ç‰ˆæœ¬ä¹‹å‰çš„ JUnit ä¸€ä¸ªæœ€ä¸»è¦çš„é—®é¢˜æ˜¯ï¼Œä¸ºäº†å¯åŠ¨å’Œè¿è¡Œ <strong>JUnit</strong> æµ‹è¯•ï¼Œæœ‰å¤§é‡çš„â€œä»ªå¼â€éœ€è¦æ ‡æ³¨ã€‚è¿™ç§è´Ÿæ‹…å·²ç»å‡è½»äº†ä¸€äº›ï¼Œ<strong>ä½†æ˜¯</strong>æ³¨è§£ä½¿å¾—æµ‹è¯•æ›´æ¥è¿‘â€œå¯ä»¥å·¥ä½œçš„æœ€ç®€å•çš„æµ‹è¯•ç³»ç»Ÿâ€ã€‚</p><p>åœ¨æ³¨è§£ç‰ˆæœ¬ä¹‹å‰çš„ JUnitï¼Œä½ å¿…é¡»åˆ›å»ºä¸€ä¸ªå•ç‹¬çš„æ–‡ä»¶æ¥ä¿å­˜å•å…ƒæµ‹è¯•ã€‚é€šè¿‡æ³¨è§£ï¼Œæˆ‘ä»¬å¯ä»¥å°†å•å…ƒæµ‹è¯•é›†æˆåœ¨éœ€è¦è¢«æµ‹è¯•çš„ç±»ä¸­ï¼Œä»è€Œå°†å•å…ƒæµ‹è¯•çš„æ—¶é—´å’Œéº»çƒ¦é™åˆ°äº†æœ€ä½ã€‚è¿™ç§æ–¹å¼æœ‰é¢å¤–çš„å¥½å¤„ï¼Œå°±æ˜¯ä½¿å¾—æµ‹è¯•ç§æœ‰æ–¹æ³•å’Œå…¬æœ‰æ–¹æ³•å˜çš„ä¸€æ ·å®¹æ˜“ã€‚</p><p>è¿™ä¸ªåŸºäºæ³¨è§£çš„æµ‹è¯•æ¡†æ¶å«åš <strong>@Unit</strong>ã€‚å…¶æœ€åŸºæœ¬çš„æµ‹è¯•å½¢å¼ï¼Œå¯èƒ½ä¹Ÿæ˜¯ä½ ä½¿ç”¨çš„æœ€å¤šçš„ä¸€ä¸ªæ³¨è§£æ˜¯ <strong>@Test</strong>ï¼Œæˆ‘ä»¬ä½¿ç”¨ <strong>@Test</strong> æ¥æ ‡è®°æµ‹è¯•æ–¹æ³•ã€‚æµ‹è¯•æ–¹æ³•ä¸å¸¦å‚æ•°ï¼Œå¹¶è¿”å› <strong>boolean</strong> ç»“æœæ¥è¯´æ˜æµ‹è¯•æ–¹æ³•æˆåŠŸæˆ–è€…å¤±è´¥ã€‚ä½ å¯ä»¥ä»»æ„å‘½åå®ƒçš„æµ‹è¯•æ–¹æ³•ã€‚åŒæ—¶ <strong>@Unit</strong> æµ‹è¯•æ–¹æ³•å¯ä»¥æ˜¯ä»»æ„ä½ å–œæ¬¢çš„è®¿é—®ä¿®é¥°æ–¹æ³•ï¼ŒåŒ…æ‹¬ <strong>private</strong>ã€‚</p><p>è¦ä½¿ç”¨ <strong>@Unit</strong>ï¼Œä½ å¿…é¡»å¯¼å…¥ <strong>onjava.atunit</strong> åŒ…ï¼Œå¹¶ä¸”ä½¿ç”¨ <strong>@Unit</strong> çš„æµ‹è¯•æ ‡è®°ä¸ºåˆé€‚çš„æ–¹æ³•å’Œå­—æ®µæ‰“ä¸Šæ ‡ç­¾ï¼ˆåœ¨æ¥ä¸‹æ¥çš„ä¾‹å­ä¸­ä½ ä¼šå­¦åˆ°ï¼‰ï¼Œç„¶åè®©ä½ çš„æ„å»ºç³»ç»Ÿå¯¹ç¼–è¯‘åçš„ç±»è¿è¡Œ <strong>@Unit</strong>ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç®€å•çš„ä¾‹å­ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/AtUnitExample1.java</span></span><br><span class="line"><span class="comment">// &#123;java onjava.atunit.AtUnit</span></span><br><span class="line"><span class="comment">// build/classes/main/annotations/AtUnitExample1.class&#125;</span></span><br><span class="line"><span class="keyword">package</span> annotations;</span><br><span class="line"><span class="keyword">import</span> onjava.atunit.*;</span><br><span class="line"><span class="keyword">import</span> onjava.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AtUnitExample1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">methodOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"This is methodOne"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">methodTwo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"This is methodTwo"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">methodOneTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> methodOne().equals(<span class="string">"This is methodOne"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">m2</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> methodTwo() == <span class="number">2</span>; &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">m3</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="keyword">true</span>; &#125;</span><br><span class="line">    <span class="comment">// Shows output for failure:</span></span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">failureTest</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> <span class="keyword">false</span>; &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">anotherDisappointment</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">annotations.AtUnitExample1</span><br><span class="line">. m3</span><br><span class="line">. methodOneTest</span><br><span class="line">. m2 This is methodTwo</span><br><span class="line">. failureTest (failed)</span><br><span class="line">. anotherDisappointment (failed)</span><br><span class="line">(<span class="number">5</span> tests)</span><br><span class="line">&gt;&gt;&gt; <span class="number">2</span> FAILURES &lt;&lt;&lt;</span><br><span class="line">annotations.AtUnitExample1: failureTest</span><br><span class="line">annotations.AtUnitExample1: anotherDisappointment</span><br></pre></td></tr></table></figure><p>ä½¿ç”¨ <strong>@Unit</strong> è¿›è¡Œæµ‹è¯•çš„ç±»å¿…é¡»å®šä¹‰åœ¨æŸä¸ªåŒ…ä¸­ï¼ˆå³å¿…é¡»åŒ…æ‹¬ <strong>package</strong> å£°æ˜ï¼‰ã€‚</p><p><strong>@Test</strong> æ³¨è§£è¢«ç½®äº <code>methodOneTest()</code>ã€ <code>m2()</code>ã€<code>m3()</code>ã€<code>failureTest()</code> ä»¥åŠ a<code>notherDisappointment()</code> æ–¹æ³•ä¹‹å‰ï¼Œå®ƒä»¬å‘Šè¯‰ <strong>@Unit</strong> æ–¹æ³•ä½œä¸ºå•å…ƒæµ‹è¯•æ¥è¿è¡Œã€‚åŒæ—¶ <strong>@Test</strong> ç¡®ä¿è¿™äº›æ–¹æ³•æ²¡æœ‰ä»»ä½•å‚æ•°å¹¶ä¸”è¿”å›å€¼ä¸º <strong>boolean</strong> æˆ–è€… <strong>void</strong>ã€‚å½“ä½ å¡«å†™å•å…ƒæµ‹è¯•æ—¶ï¼Œå”¯ä¸€éœ€è¦åšçš„å°±æ˜¯å†³å®šæµ‹è¯•æ˜¯æˆåŠŸè¿˜æ˜¯å¤±è´¥ï¼Œï¼ˆå¯¹äºè¿”å›å€¼ä¸º <strong>boolean</strong> çš„æ–¹æ³•ï¼‰åº”è¯¥è¿”å› <strong>ture</strong> è¿˜æ˜¯ <strong>false</strong>ã€‚</p><p>å¦‚æœä½ ç†Ÿæ‚‰ <strong>JUnit</strong>ï¼Œä½ è¿˜å°†æ³¨æ„åˆ° <strong>@Unit</strong> è¾“å‡ºçš„ä¿¡æ¯æ›´å¤šã€‚ä½ ä¼šçœ‹åˆ°ç°åœ¨æ­£åœ¨è¿è¡Œçš„æµ‹è¯•çš„è¾“å‡ºæ›´æœ‰ç”¨ï¼Œæœ€åå®ƒä¼šå‘Šè¯‰ä½ å¯¼è‡´å¤±è´¥çš„ç±»å’Œæµ‹è¯•ã€‚</p><p>ä½ å¹¶éå¿…é¡»å°†æµ‹è¯•æ–¹æ³•åµŒå…¥åˆ°åŸæ¥çš„ç±»ä¸­ï¼Œæœ‰æ—¶å€™è¿™ç§äº‹æƒ…æ ¹æœ¬åšä¸åˆ°ã€‚è¦ç”Ÿäº§ä¸€ä¸ªéåµŒå…¥å¼çš„æµ‹è¯•ï¼Œæœ€ç®€å•çš„æ–¹å¼å°±æ˜¯ç»§æ‰¿ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/AUExternalTest.java</span></span><br><span class="line"><span class="comment">// Creating non-embedded tests</span></span><br><span class="line"><span class="comment">// &#123;java onjava.atunit.AtUnit</span></span><br><span class="line"><span class="comment">// build/classes/main/annotations/AUExternalTest.class&#125;</span></span><br><span class="line"><span class="keyword">package</span> annotations;</span><br><span class="line"><span class="keyword">import</span> onjava.atunit.*;</span><br><span class="line"><span class="keyword">import</span> onjava.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AUExternalTest</span> <span class="keyword">extends</span> <span class="title">AtUnitExample1</span> </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">_MethodOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> methodOne().equals(<span class="string">"This is methodOne"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">_MethodTwo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> methodTwo() == <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">annotations.AUExternalTest</span><br><span class="line">. tMethodOne</span><br><span class="line">. tMethodTwo This is methodTwo</span><br><span class="line">OK (<span class="number">2</span> tests)</span><br></pre></td></tr></table></figure><p>è¿™ä¸ªç¤ºä¾‹è¿˜è¡¨ç°å‡ºçµæ´»å‘½åçš„ä»·å€¼ã€‚åœ¨è¿™é‡Œï¼Œ<strong>@Test</strong> æ–¹æ³•è¢«å‘½åä¸ºä¸‹åˆ’çº¿å‰ç¼€åŠ ä¸Šè¦æµ‹è¯•çš„æ–¹æ³•åç§°ï¼ˆæˆ‘å¹¶ä¸è®¤ä¸ºè¿™æ˜¯ä¸€ç§ç†æƒ³çš„å‘½åå½¢å¼ï¼Œè¿™åªæ˜¯è¡¨ç°ä¸€ç§å¯èƒ½æ€§ç½¢äº†ï¼‰ã€‚</p><p>ä½ ä¹Ÿå¯ä»¥ä½¿ç”¨ç»„åˆæ¥åˆ›å»ºéåµŒå…¥å¼çš„æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/AUComposition.java</span></span><br><span class="line"><span class="comment">// Creating non-embedded tests</span></span><br><span class="line"><span class="comment">// &#123;java onjava.atunit.AtUnit</span></span><br><span class="line"><span class="comment">// build/classes/main/annotations/AUComposition.class&#125;</span></span><br><span class="line"><span class="keyword">package</span> annotations;</span><br><span class="line"><span class="keyword">import</span> onjava.atunit.*;</span><br><span class="line"><span class="keyword">import</span> onjava.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AUComposition</span> </span>&#123;</span><br><span class="line">    AtUnitExample1 testObject = <span class="keyword">new</span> AtUnitExample1();</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">tMethodOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> testObject.methodOne()</span><br><span class="line">                .equals(<span class="string">"This is methodOne"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">tMethodTwo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> testObject.methodTwo() == <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">annotations.AUComposition</span><br><span class="line">. tMethodTwo This is methodTwo</span><br><span class="line">. tMethodOne</span><br><span class="line">OK (<span class="number">2</span> tests)</span><br></pre></td></tr></table></figure><p>å› ä¸ºåœ¨æ¯ä¸€ä¸ªæµ‹è¯•é‡Œé¢éƒ½ä¼šåˆ›å»º <strong>AUComposition</strong> å¯¹è±¡ï¼Œæ‰€ä»¥åˆ›å»ºæ–°çš„æˆå‘˜å˜é‡ <strong>testObject</strong> ç”¨äºä»¥åçš„æ¯ä¸€ä¸ªæµ‹è¯•æ–¹æ³•ã€‚</p><p>å› ä¸º <strong>@Unit</strong> ä¸­æ²¡æœ‰ <strong>JUnit</strong> ä¸­ç‰¹æ®Šçš„ <strong>assert</strong> æ–¹æ³•ï¼Œä¸è¿‡å¦ä¸€ç§å½¢å¼çš„ <strong>@Test</strong> æ–¹æ³•ä»ç„¶å…è®¸è¿”å›å€¼ä¸º <strong>void</strong>ï¼ˆå¦‚æœä½ è¿˜æƒ³ä½¿ç”¨ <strong>true</strong> æˆ–è€… <strong>false</strong> çš„è¯ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ <strong>boolean</strong> ä½œä¸ºæ–¹æ³•è¿”å›å€¼ç±»å‹ï¼‰ã€‚ä¸ºäº†è¡¨ç¤ºæµ‹è¯•æˆåŠŸï¼Œå¯ä»¥ä½¿ç”¨ Java çš„ <strong>assert</strong> è¯­å¥ã€‚Java æ–­è¨€æœºåˆ¶éœ€è¦ä½ åœ¨ java å‘½ä»¤è¡Œè¡ŒåŠ ä¸Š <strong>-ea</strong> æ ‡å¿—æ¥å¼€å¯ï¼Œä½†æ˜¯ <strong>@Unit</strong> å·²ç»è‡ªåŠ¨å¼€å¯äº†è¯¥åŠŸèƒ½ã€‚è¦è¡¨ç¤ºæµ‹è¯•å¤±è´¥çš„è¯ï¼Œä½ ç”šè‡³å¯ä»¥ä½¿ç”¨å¼‚å¸¸ã€‚<strong>@Unit</strong> çš„è®¾è®¡ç›®æ ‡ä¹‹ä¸€å°±æ˜¯å°½å¯èƒ½å‡å°‘æ·»åŠ é¢å¤–çš„è¯­æ³•ï¼Œè€Œ Java çš„ <strong>assert</strong> å’Œå¼‚å¸¸å¯¹äºæŠ¥å‘Šé”™è¯¯è€Œè¨€ï¼Œå³å·²ç»è¶³å¤Ÿäº†ã€‚ä¸€ä¸ªå¤±è´¥çš„ <strong>assert</strong> æˆ–è€…ä»æ–¹æ³•ä»æŠ›å‡ºçš„å¼‚å¸¸éƒ½è¢«è§†ä¸ºæµ‹è¯•å¤±è´¥ï¼Œä½†æ˜¯ <strong>@Unit</strong> ä¸ä¼šåœ¨è¿™ä¸ªå¤±è´¥çš„æµ‹è¯•ä¸Šå¡ä½ï¼Œå®ƒä¼šç»§ç»­è¿è¡Œï¼Œç›´åˆ°æ‰€æœ‰æµ‹è¯•å®Œæ¯•ï¼Œä¸‹é¢æ˜¯ä¸€ä¸ªç¤ºä¾‹ç¨‹åºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/AtUnitExample2.java</span></span><br><span class="line"><span class="comment">// Assertions and exceptions can be used in @Tests</span></span><br><span class="line"><span class="comment">// &#123;java onjava.atunit.AtUnit</span></span><br><span class="line"><span class="comment">// build/classes/main/annotations/AtUnitExample2.class&#125;</span></span><br><span class="line"><span class="keyword">package</span> annotations;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> onjava.atunit.*;</span><br><span class="line"><span class="keyword">import</span> onjava.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AtUnitExample2</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">methodOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"This is methodOne"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">methodTwo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"This is methodTwo"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">assertExample</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">methodOne</span><span class="params">()</span>.<span class="title">equals</span><span class="params">(<span class="string">"This is methodOne"</span>)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">assertFailureExample</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">assert</span> <span class="number">1</span> == <span class="number">2</span>: <span class="string">"What a surprise!"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">exceptionExample</span><span class="params">()</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        <span class="keyword">try</span>(FileInputStream fis =</span><br><span class="line">                    <span class="keyword">new</span> FileInputStream(<span class="string">"nofile.txt"</span>)) &#123;&#125; <span class="comment">// Throws</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">assertAndReturn</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// Assertion with message:</span></span><br><span class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">methodTwo</span><span class="params">()</span> </span>== <span class="number">2</span>: <span class="string">"methodTwo must equal 2"</span>;</span><br><span class="line">        <span class="keyword">return</span> methodOne().equals(<span class="string">"This is methodOne"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">annotations.AtUnitExample2</span><br><span class="line">. exceptionExample java.io.FileNotFoundException:</span><br><span class="line">nofile.txt (The system cannot find the file specified)</span><br><span class="line">(failed)</span><br><span class="line">. assertExample</span><br><span class="line">. assertAndReturn This is methodTwo</span><br><span class="line">. assertFailureExample java.lang.AssertionError: What</span><br><span class="line">a surprise!</span><br><span class="line">(failed)</span><br><span class="line">(<span class="number">4</span> tests)</span><br><span class="line">&gt;&gt;&gt; <span class="number">2</span> FAILURES &lt;&lt;&lt;</span><br><span class="line">annotations.AtUnitExample2: exceptionExample</span><br><span class="line">annotations.AtUnitExample2: assertFailureExample</span><br></pre></td></tr></table></figure><p>å¦‚ä¸‹æ˜¯ä¸€ä¸ªä½¿ç”¨éåµŒå…¥å¼æµ‹è¯•çš„ä¾‹å­ï¼Œå¹¶ä¸”ä½¿ç”¨äº†æ–­è¨€ï¼Œå®ƒå°†ä¼šå¯¹ <strong>java.util.HashSet</strong> è¿›è¡Œä¸€äº›ç®€å•çš„æµ‹è¯•ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/HashSetTest.java</span></span><br><span class="line"><span class="comment">// &#123;java onjava.atunit.AtUnit</span></span><br><span class="line"><span class="comment">// build/classes/main/annotations/HashSetTest.class&#125;</span></span><br><span class="line"><span class="keyword">package</span> annotations;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> onjava.atunit.*;</span><br><span class="line"><span class="keyword">import</span> onjava.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">HashSetTest</span> </span>&#123;</span><br><span class="line">    HashSet&lt;String&gt; testObject = <span class="keyword">new</span> HashSet&lt;&gt;();</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">initialization</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">assert</span> testObject.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">_Contains</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        testObject.add(<span class="string">"one"</span>);</span><br><span class="line">        <span class="keyword">assert</span> testObject.contains(<span class="string">"one"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">_Remove</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        testObject.add(<span class="string">"one"</span>);</span><br><span class="line">        testObject.remove(<span class="string">"one"</span>);</span><br><span class="line">        <span class="keyword">assert</span> testObject.isEmpty();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>é‡‡ç”¨ç»§æ‰¿çš„æ–¹å¼å¯èƒ½ä¼šæ›´ç®€å•ï¼Œä¹Ÿæ²¡æœ‰ä¸€äº›å…¶ä»–çš„çº¦æŸã€‚</p><p>å¯¹æ¯ä¸€ä¸ªå•å…ƒæµ‹è¯•è€Œè¨€ï¼Œ<strong>@Unit</strong> éƒ½ä¼šä½¿ç”¨é»˜è®¤çš„æ— å‚æ„é€ å™¨ï¼Œä¸ºè¯¥æµ‹è¯•ç±»æ‰€å±çš„ç±»åˆ›å»ºå‡ºä¸€ä¸ªæ–°çš„å®ä¾‹ã€‚å¹¶åœ¨æ­¤æ–°åˆ›å»ºçš„å¯¹è±¡ä¸Šè¿è¡Œæµ‹è¯•ï¼Œç„¶åä¸¢å¼ƒè¯¥å¯¹è±¡ï¼Œä»¥å…å¯¹å…¶ä»–æµ‹è¯•äº§ç”Ÿå‰¯ä½œç”¨ã€‚å¦‚æ­¤åˆ›å»ºå¯¹è±¡å¯¼è‡´æˆ‘ä»¬ä¾èµ–äºç±»çš„é»˜è®¤æ„é€ å™¨ã€‚å¦‚æœä½ çš„ç±»æ²¡æœ‰é»˜è®¤æ„é€ å™¨ï¼Œæˆ–è€…å¯¹è±¡éœ€è¦å¤æ‚çš„æ„é€ è¿‡ç¨‹ï¼Œé‚£ä¹ˆä½ å¯ä»¥åˆ›å»ºä¸€ä¸ª <strong>static</strong> æ–¹æ³•ä¸“é—¨è´Ÿè´£æ„é€ å¯¹è±¡ï¼Œç„¶åä½¿ç”¨ <strong>@TestObjectCreate</strong> æ³¨è§£æ ‡è®°è¯¥æ–¹æ³•ï¼Œä¾‹å­å¦‚ä¸‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/AtUnitExample3.java</span></span><br><span class="line"><span class="comment">// &#123;java onjava.atunit.AtUnit</span></span><br><span class="line"><span class="comment">// build/classes/main/annotations/AtUnitExample3.class&#125;</span></span><br><span class="line"><span class="keyword">package</span> annotations;</span><br><span class="line"><span class="keyword">import</span> onjava.atunit.*;</span><br><span class="line"><span class="keyword">import</span> onjava.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AtUnitExample3</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">int</span> n;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AtUnitExample3</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123; <span class="keyword">this</span>.n = n; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">getN</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> n; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">methodOne</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"This is methodOne"</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">methodTwo</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"This is methodTwo"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="number">2</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@TestObjectCreate</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> AtUnitExample3 <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AtUnitExample3(<span class="number">47</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">initialization</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> n == <span class="number">47</span>; &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">methodOneTest</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> methodOne().equals(<span class="string">"This is methodOne"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">m2</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> methodTwo() == <span class="number">2</span>; &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">annotations.AtUnitExample3</span><br><span class="line">. initialization</span><br><span class="line">. m2 This is methodTwo</span><br><span class="line">. methodOneTest</span><br><span class="line">OK (<span class="number">3</span> tests)</span><br></pre></td></tr></table></figure><p><strong>@TestObjectCreate</strong> ä¿®é¥°çš„æ–¹æ³•å¿…é¡»å£°æ˜ä¸º <strong>static</strong> ï¼Œä¸”å¿…é¡»è¿”å›ä¸€ä¸ªä½ æ­£åœ¨æµ‹è¯•çš„ç±»å‹å¯¹è±¡ï¼Œè¿™ä¸€åˆ‡éƒ½ç”± <strong>@Unit</strong> è´Ÿè´£ç¡®ä¿æˆç«‹ã€‚</p><p>æœ‰çš„æ—¶å€™ï¼Œä½ éœ€è¦å‘å•å…ƒæµ‹è¯•ä¸­å¢åŠ ä¸€äº›å­—æ®µã€‚è¿™æ—¶å€™å¯ä»¥ä½¿ç”¨ <strong>@TestProperty</strong> æ³¨è§£ï¼Œç”±å®ƒæ³¨è§£çš„å­—æ®µè¡¨ç¤ºåªåœ¨å•å…ƒæµ‹è¯•ä¸­ä½¿ç”¨ï¼ˆå› æ­¤ï¼Œåœ¨ä½ å°†äº§å“å‘å¸ƒç»™å®¢æˆ·ä¹‹å‰ï¼Œä»–ä»¬åº”è¯¥è¢«åˆ é™¤ï¼‰ã€‚åœ¨ä¸‹é¢çš„ä¾‹å­ä¸­ï¼Œä¸€ä¸ª <strong>String</strong> é€šè¿‡ <code>String.split()</code> æ–¹æ³•è¿›è¡Œåˆ†å‰²ï¼Œä»å…¶ä¸­è¯»å–ä¸€ä¸ªå€¼ï¼Œè¿™ä¸ªå€¼å°†ä¼šè¢«ç”Ÿæˆæµ‹è¯•å¯¹è±¡ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/AtUnitExample4.java</span></span><br><span class="line"><span class="comment">// &#123;java onjava.atunit.AtUnit</span></span><br><span class="line"><span class="comment">// build/classes/main/annotations/AtUnitExample4.class&#125;</span></span><br><span class="line"><span class="comment">// &#123;VisuallyInspectOutput&#125;</span></span><br><span class="line"><span class="keyword">package</span> annotations;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> onjava.atunit.*;</span><br><span class="line"><span class="keyword">import</span> onjava.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AtUnitExample4</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> String theory = <span class="string">"All brontosauruses "</span> +</span><br><span class="line">            <span class="string">"are thin at one end, much MUCH thicker in the "</span> +</span><br><span class="line">            <span class="string">"middle, and then thin again at the far end."</span>;</span><br><span class="line">    <span class="keyword">private</span> String word;</span><br><span class="line">    <span class="keyword">private</span> Random rand = <span class="keyword">new</span> Random(); <span class="comment">// Time-based seed</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AtUnitExample4</span><span class="params">(String word)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.word = word;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">getWord</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> word; &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">scrambleWord</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        List&lt;Character&gt; chars = Arrays.asList(</span><br><span class="line">                ConvertTo.boxed(word.toCharArray()));</span><br><span class="line">        Collections.shuffle(chars, rand);</span><br><span class="line">        StringBuilder result = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> ch : chars)</span><br><span class="line">            result.append(ch);</span><br><span class="line">        <span class="keyword">return</span> result.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@TestProperty</span></span><br><span class="line">    <span class="keyword">static</span> List&lt;String&gt; input =</span><br><span class="line">            Arrays.asList(theory.split(<span class="string">" "</span>));</span><br><span class="line">    <span class="meta">@TestProperty</span></span><br><span class="line">    <span class="keyword">static</span> Iterator&lt;String&gt; words = input.iterator();</span><br><span class="line">    <span class="meta">@TestObjectCreate</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> AtUnitExample4 <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(words.hasNext())</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">new</span> AtUnitExample4(words.next());</span><br><span class="line">        <span class="keyword">else</span></span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">words</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"'"</span> + getWord() + <span class="string">"'"</span>);</span><br><span class="line">        <span class="keyword">return</span> getWord().equals(<span class="string">"are"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">scramble1</span><span class="params">()</span> </span>&#123;</span><br><span class="line"><span class="comment">// Use specific seed to get verifiable results:</span></span><br><span class="line">        rand = <span class="keyword">new</span> Random(<span class="number">47</span>);</span><br><span class="line">        System.out.println(<span class="string">"'"</span> + getWord() + <span class="string">"'"</span>);</span><br><span class="line">        String scrambled = scrambleWord();</span><br><span class="line">        System.out.println(scrambled);</span><br><span class="line">        <span class="keyword">return</span> scrambled.equals(<span class="string">"lAl"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">scramble2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        rand = <span class="keyword">new</span> Random(<span class="number">74</span>);</span><br><span class="line">        System.out.println(<span class="string">"'"</span> + getWord() + <span class="string">"'"</span>);</span><br><span class="line">        String scrambled = scrambleWord();</span><br><span class="line">        System.out.println(scrambled);</span><br><span class="line">        <span class="keyword">return</span> scrambled.equals(<span class="string">"tsaeborornussu"</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">annotations.AtUnitExample4</span><br><span class="line">. words <span class="string">'All'</span></span><br><span class="line">(failed)</span><br><span class="line">. scramble1 <span class="string">'brontosauruses'</span></span><br><span class="line">ntsaueorosurbs</span><br><span class="line">(failed)</span><br><span class="line">. scramble2 <span class="string">'are'</span></span><br><span class="line">are</span><br><span class="line">(failed)</span><br><span class="line">(<span class="number">3</span> tests)</span><br><span class="line">&gt;&gt;&gt; <span class="number">3</span> FAILURES &lt;&lt;&lt;</span><br><span class="line">annotations.AtUnitExample4: words</span><br><span class="line">annotations.AtUnitExample4: scramble1</span><br><span class="line">annotations.AtUnitExample4: scramble2</span><br></pre></td></tr></table></figure><p><strong>@TestProperty</strong> ä¹Ÿå¯ä»¥ç”¨æ¥æ ‡è®°é‚£äº›åªåœ¨æµ‹è¯•ä¸­ä½¿ç”¨çš„æ–¹æ³•ï¼Œä½†æ˜¯å®ƒä»¬æœ¬èº«ä¸æ˜¯æµ‹è¯•æ–¹æ³•ã€‚</p><p>å¦‚æœä½ çš„æµ‹è¯•å¯¹è±¡éœ€è¦æ‰§è¡ŒæŸäº›åˆå§‹åŒ–å·¥ä½œï¼Œå¹¶ä¸”ä½¿ç”¨å®Œæˆä¹‹åè¿˜éœ€è¦æ‰§è¡Œæ¸…ç†å·¥ä½œï¼Œé‚£ä¹ˆå¯ä»¥é€‰æ‹©ä½¿ç”¨ <strong>static</strong> çš„  <strong>@TestObjectCleanup</strong> æ–¹æ³•ï¼Œå½“æµ‹è¯•å¯¹è±¡ä½¿ç”¨ç»“æŸä¹‹åï¼Œè¯¥æ–¹æ³•ä¼šä¸ºä½ æ‰§è¡Œæ¸…ç†å·¥ä½œã€‚åœ¨ä¸‹é¢çš„ç¤ºä¾‹ä¸­ï¼Œ<strong>@TestObjectCleanup</strong> ä¸ºæ¯ä¸€ä¸ªæµ‹è¯•å¯¹è±¡éƒ½æ‰“å¼€äº†ä¸€ä¸ªæ–‡ä»¶ï¼Œå› æ­¤å¿…é¡»åœ¨ä¸¢å¼ƒæµ‹è¯•çš„æ—¶å€™å…³é—­è¯¥æ–‡ä»¶ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/AtUnitExample5.java</span></span><br><span class="line"><span class="comment">// &#123;java onjava.atunit.AtUnit</span></span><br><span class="line"><span class="comment">// build/classes/main/annotations/AtUnitExample5.class&#125;</span></span><br><span class="line"><span class="keyword">package</span> annotations;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> onjava.atunit.*;</span><br><span class="line"><span class="keyword">import</span> onjava.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AtUnitExample5</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> String text;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">AtUnitExample5</span><span class="params">(String text)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.text = text;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">toString</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> text; &#125;</span><br><span class="line">    <span class="meta">@TestProperty</span></span><br><span class="line">    <span class="keyword">static</span> PrintWriter output;</span><br><span class="line">    <span class="meta">@TestProperty</span></span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">int</span> counter;</span><br><span class="line">    <span class="meta">@TestObjectCreate</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> AtUnitExample5 <span class="title">create</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        String id = Integer.toString(counter++);</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            output = <span class="keyword">new</span> PrintWriter(<span class="string">"Test"</span> + id + <span class="string">".txt"</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span>(IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> AtUnitExample5(id);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@TestObjectCleanup</span></span><br><span class="line">    <span class="function"><span class="keyword">static</span> <span class="keyword">void</span> <span class="title">cleanup</span><span class="params">(AtUnitExample5 tobj)</span> </span>&#123;</span><br><span class="line">        System.out.println(<span class="string">"Running cleanup"</span>);</span><br><span class="line">        output.close();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">test1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        output.print(<span class="string">"test1"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">test2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        output.print(<span class="string">"test2"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">boolean</span> <span class="title">test3</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        output.print(<span class="string">"test3"</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">annotations.AtUnitExample5</span><br><span class="line">. test1</span><br><span class="line">Running cleanup</span><br><span class="line">. test3</span><br><span class="line">Running cleanup</span><br><span class="line">. test2</span><br><span class="line">Running cleanup</span><br><span class="line">OK (<span class="number">3</span> tests)</span><br></pre></td></tr></table></figure><p>åœ¨è¾“å‡ºä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œæ¸…ç†æ–¹æ³•ä¼šåœ¨æ¯ä¸ªæµ‹è¯•æ–¹æ³•ç»“æŸä¹‹åè‡ªåŠ¨è¿è¡Œã€‚</p><h3 id="åœ¨-Unit-ä¸­ä½¿ç”¨æ³›å‹"><a href="#åœ¨-Unit-ä¸­ä½¿ç”¨æ³›å‹" class="headerlink" title="åœ¨ @Unit ä¸­ä½¿ç”¨æ³›å‹"></a>åœ¨ @Unit ä¸­ä½¿ç”¨æ³›å‹</h3><p>æ³›å‹ä¸º <strong>@Unit</strong> å‡ºäº†ä¸€ä¸ªéš¾é¢˜ï¼Œå› ä¸ºæˆ‘ä»¬ä¸å¯èƒ½â€œé€šç”¨æµ‹è¯•â€ã€‚æˆ‘ä»¬å¿…é¡»é’ˆå¯¹æŸä¸ªç‰¹å®šç±»å‹çš„å‚æ•°æˆ–è€…å‚æ•°é›†æ‰èƒ½è¿›è¡Œæµ‹è¯•ã€‚è§£å†³æ–¹æ³•ååˆ†ç®€å•ï¼Œè®©æµ‹è¯•ç±»ç»§æ‰¿è‡ªæ³›å‹ç±»çš„ä¸€ä¸ªç‰¹å®šç‰ˆæœ¬å³å¯ï¼š</p><p>ä¸‹é¢æ˜¯ä¸€ä¸ª <strong>stack</strong> çš„ç®€å•å®ç°ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/StackL.java</span></span><br><span class="line"><span class="comment">// A stack built on a LinkedList</span></span><br><span class="line"><span class="keyword">package</span> annotations;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">StackL</span>&lt;<span class="title">T</span>&gt; </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> LinkedList&lt;T&gt; list = <span class="keyword">new</span> LinkedList&lt;&gt;();</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">push</span><span class="params">(T v)</span> </span>&#123; list.addFirst(v); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">top</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> list.getFirst(); &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> T <span class="title">pop</span><span class="params">()</span> </span>&#123; <span class="keyword">return</span> list.removeFirst(); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>ä¸ºäº†æµ‹è¯• String ç‰ˆæœ¬ï¼Œæˆ‘ä»¬ç›´æ¥è®©æµ‹è¯•ç±»ç»§æ‰¿ä¸€ä¸ª Stack&lt;String&gt; ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/StackLStringTst.java</span></span><br><span class="line"><span class="comment">// Applying @Unit to generics</span></span><br><span class="line"><span class="comment">// &#123;java onjava.atunit.AtUnit</span></span><br><span class="line"><span class="comment">// build/classes/main/annotations/StackLStringTst.class&#125;</span></span><br><span class="line"><span class="keyword">package</span> annotations;</span><br><span class="line"><span class="keyword">import</span> onjava.atunit.*;</span><br><span class="line"><span class="keyword">import</span> onjava.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span></span></span><br><span class="line"><span class="class"><span class="title">StackLStringTst</span> <span class="keyword">extends</span> <span class="title">StackL</span>&lt;<span class="title">String</span>&gt; </span>&#123;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">tPush</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        push(<span class="string">"one"</span>);</span><br><span class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">top</span><span class="params">()</span>.<span class="title">equals</span><span class="params">(<span class="string">"one"</span>)</span></span>;</span><br><span class="line">        push(<span class="string">"two"</span>);</span><br><span class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">top</span><span class="params">()</span>.<span class="title">equals</span><span class="params">(<span class="string">"two"</span>)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">tPop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        push(<span class="string">"one"</span>);</span><br><span class="line">        push(<span class="string">"two"</span>);</span><br><span class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">pop</span><span class="params">()</span>.<span class="title">equals</span><span class="params">(<span class="string">"two"</span>)</span></span>;</span><br><span class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">pop</span><span class="params">()</span>.<span class="title">equals</span><span class="params">(<span class="string">"one"</span>)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Test</span></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">tTop</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        push(<span class="string">"A"</span>);</span><br><span class="line">        push(<span class="string">"B"</span>);</span><br><span class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">top</span><span class="params">()</span>.<span class="title">equals</span><span class="params">(<span class="string">"B"</span>)</span></span>;</span><br><span class="line">        <span class="function"><span class="keyword">assert</span> <span class="title">top</span><span class="params">()</span>.<span class="title">equals</span><span class="params">(<span class="string">"B"</span>)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">annotations.StackLStringTst</span><br><span class="line">. tTop</span><br><span class="line">. tPush</span><br><span class="line">. tPop</span><br><span class="line">OK (<span class="number">3</span> tests)</span><br></pre></td></tr></table></figure><p>è¿™ç§æ–¹æ³•å­˜åœ¨çš„å”¯ä¸€ç¼ºç‚¹æ˜¯ï¼Œç»§æ‰¿ä½¿æˆ‘ä»¬å¤±å»äº†è®¿é—®è¢«æµ‹è¯•çš„ç±»ä¸­ <strong>private</strong> æ–¹æ³•çš„èƒ½åŠ›ã€‚è¿™å¯¹ä½ éå¸¸é‡è¦ï¼Œé‚£ä½ è¦ä¹ˆæŠŠ private æ–¹æ³•å˜ä¸º <strong>protected</strong>ï¼Œè¦ä¹ˆæ·»åŠ ä¸€ä¸ªé <strong>private</strong> çš„ <strong>@TestProperty</strong> æ–¹æ³•ï¼Œç”±å®ƒæ¥è°ƒç”¨ <strong>private</strong> æ–¹æ³•ï¼ˆç¨åæˆ‘ä»¬ä¼šçœ‹åˆ°ï¼Œ<strong>AtUnitRemover</strong> ä¼šåˆ é™¤äº§å“ä¸­çš„ <strong>@TestProperty</strong> æ–¹æ³•ï¼‰ã€‚</p><p><strong>@Unit</strong> æœç´¢é‚£äº›åŒ…å«åˆé€‚æ³¨è§£çš„ç±»æ–‡ä»¶ï¼Œç„¶åè¿è¡Œ <strong>@Test</strong> æ–¹æ³•ã€‚æˆ‘çš„ä¸»è¦ç›®æ ‡å°±æ˜¯è®© <strong>@Unit</strong> æµ‹è¯•ç³»ç»Ÿå°½å¯èƒ½çš„é€æ˜ï¼Œä½¿å¾—äººä»¬ä½¿ç”¨å®ƒçš„æ—¶å€™åªéœ€è¦æ·»åŠ  <strong>@Test</strong> æ³¨è§£ï¼Œè€Œä¸éœ€è¦ç‰¹æ®Šçš„ç¼–ç å’ŒçŸ¥è¯†ï¼ˆç°åœ¨ç‰ˆæœ¬çš„ <strong>JUnit</strong> ç¬¦åˆè¿™ä¸ªå®è·µï¼‰ã€‚ä¸è¿‡ï¼Œå¦‚æœè¯´ç¼–å†™æµ‹è¯•ä¸ä¼šé‡åˆ°ä»»ä½•å›°éš¾ï¼Œä¹Ÿä¸å¤ªå¯èƒ½ï¼Œå› æ­¤ <strong>@Unit</strong> ä¼šå°½é‡è®©è¿™äº›å›°éš¾å˜çš„å¾®ä¸è¶³é“ï¼Œå¸Œæœ›é€šè¿‡è¿™ç§æ–¹å¼ï¼Œä½ ä»¬ä¼šæ›´ä¹æ„ç¼–å†™æµ‹è¯•ã€‚</p><h3 id="å®ç°-Unit"><a href="#å®ç°-Unit" class="headerlink" title="å®ç° @Unit"></a>å®ç° @Unit</h3><p>é¦–å…ˆæˆ‘ä»¬éœ€è¦å®šä¹‰æ‰€æœ‰çš„æ³¨è§£ç±»å‹ã€‚è¿™äº›éƒ½æ˜¯ç®€å•çš„æ ‡ç­¾ï¼Œå¹¶ä¸”æ²¡æœ‰ä»»ä½•å­—æ®µã€‚@Test æ ‡ç­¾åœ¨æœ¬ç« å¼€å¤´å·²ç»å®šä¹‰è¿‡äº†ï¼Œè¿™é‡Œæ˜¯å…¶ä»–æ‰€éœ€è¦çš„æ³¨è§£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// onjava/atunit/TestObjectCreate.java</span></span><br><span class="line"><span class="comment">// The @Unit @TestObjectCreate tag</span></span><br><span class="line"><span class="keyword">package</span> onjava.atunit;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> TestObjectCreate &#123;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// onjava/atunit/TestObjectCleanup.java</span></span><br><span class="line"><span class="comment">// The @Unit @TestObjectCleanup tag</span></span><br><span class="line"><span class="keyword">package</span> onjava.atunit;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"><span class="meta">@Target</span>(ElementType.METHOD)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> TestObjectCleanup &#123;&#125;</span><br></pre></td></tr></table></figure><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// onjava/atunit/TestProperty.java</span></span><br><span class="line"><span class="comment">// The @Unit @TestProperty tag</span></span><br><span class="line"><span class="keyword">package</span> onjava.atunit;</span><br><span class="line"><span class="keyword">import</span> java.lang.annotation.*;</span><br><span class="line"><span class="comment">// Both fields and methods can be tagged as properties:</span></span><br><span class="line"><span class="meta">@Target</span>(&#123;ElementType.FIELD, ElementType.METHOD&#125;)</span><br><span class="line"><span class="meta">@Retention</span>(RetentionPolicy.RUNTIME)</span><br><span class="line"><span class="keyword">public</span> <span class="meta">@interface</span> TestProperty &#123;&#125;</span><br></pre></td></tr></table></figure><p>æ‰€æœ‰æµ‹è¯•çš„ä¿ç•™å±æ€§éƒ½ä¸º <strong>RUNTIME</strong>ï¼Œè¿™æ˜¯å› ä¸º <strong>@Unit</strong> å¿…é¡»åœ¨ç¼–è¯‘åçš„ä»£ç ä¸­å‘ç°è¿™äº›æ³¨è§£ã€‚</p><p>è¦å®ç°ç³»ç»Ÿå¹¶è¿è¡Œæµ‹è¯•ï¼Œæˆ‘ä»¬è¿˜éœ€è¦åå°„æœºåˆ¶æ¥æå–æ³¨è§£ã€‚ä¸‹é¢è¿™ä¸ªç¨‹åºé€šè¿‡æ³¨è§£ä¸­çš„ä¿¡æ¯ï¼Œå†³å®šå¦‚ä½•æ„é€ æµ‹è¯•å¯¹è±¡ï¼Œå¹¶åœ¨æµ‹è¯•å¯¹è±¡ä¸Šè¿è¡Œæµ‹è¯•ã€‚æ­£æ˜¯ç”±äºæ³¨è§£å¸®åŠ©ï¼Œè¿™ä¸ªç¨‹åºæ‰ä¼šå¦‚æ­¤çŸ­å°è€Œç›´æ¥ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// onjava/atunit/AtUnit.java</span></span><br><span class="line"><span class="comment">// An annotation-based unit-test framework</span></span><br><span class="line"><span class="comment">// &#123;java onjava.atunit.AtUnit&#125;</span></span><br><span class="line"><span class="keyword">package</span> onjava.atunit;</span><br><span class="line"><span class="keyword">import</span> java.lang.reflect.*;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.*;</span><br><span class="line"><span class="keyword">import</span> java.util.stream.*;</span><br><span class="line"><span class="keyword">import</span> onjava.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">AtUnit</span> <span class="keyword">implements</span> <span class="title">ProcessFiles</span>.<span class="title">Strategy</span> </span>&#123;</span><br><span class="line">    <span class="keyword">static</span> Class&lt;?&gt; testClass;</span><br><span class="line">    <span class="keyword">static</span> List&lt;String&gt; failedTests= <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">long</span> testsRun = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">static</span> <span class="keyword">long</span> failures = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span></span><br><span class="line">    main(String[] args) <span class="keyword">throws</span> Exception &#123;</span><br><span class="line">        ClassLoader.getSystemClassLoader()</span><br><span class="line">                .setDefaultAssertionStatus(<span class="keyword">true</span>); <span class="comment">// Enable assert</span></span><br><span class="line">        <span class="keyword">new</span> ProcessFiles(<span class="keyword">new</span> AtUnit(), <span class="string">"class"</span>).start(args);</span><br><span class="line">        <span class="keyword">if</span>(failures == <span class="number">0</span>)</span><br><span class="line">            System.out.println(<span class="string">"OK ("</span> + testsRun + <span class="string">" tests)"</span>);</span><br><span class="line">        <span class="keyword">else</span> &#123;</span><br><span class="line">            System.out.println(<span class="string">"("</span> + testsRun + <span class="string">" tests)"</span>);</span><br><span class="line">            System.out.println(</span><br><span class="line">                    <span class="string">"\n&gt;&gt;&gt; "</span> + failures + <span class="string">" FAILURE"</span> +</span><br><span class="line">                            (failures &gt; <span class="number">1</span> ? <span class="string">"S"</span> : <span class="string">""</span>) + <span class="string">" &lt;&lt;&lt;"</span>);</span><br><span class="line">            <span class="keyword">for</span>(String failed : failedTests)</span><br><span class="line">                System.out.println(<span class="string">" "</span> + failed);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="meta">@Override</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">process</span><span class="params">(File cFile)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            String cName = ClassNameFinder.thisClass(</span><br><span class="line">                    Files.readAllBytes(cFile.toPath()));</span><br><span class="line">            <span class="keyword">if</span>(!cName.startsWith(<span class="string">"public:"</span>))</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            cName = cName.split(<span class="string">":"</span>)[<span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span>(!cName.contains(<span class="string">"."</span>))</span><br><span class="line">                <span class="keyword">return</span>; <span class="comment">// Ignore unpackaged classes</span></span><br><span class="line">            testClass = Class.forName(cName);</span><br><span class="line">        &#125; <span class="keyword">catch</span>(IOException | ClassNotFoundException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">        TestMethods testMethods = <span class="keyword">new</span> TestMethods();</span><br><span class="line">        Method creator = <span class="keyword">null</span>;</span><br><span class="line">        Method cleanup = <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">for</span>(Method m : testClass.getDeclaredMethods()) &#123;</span><br><span class="line">            testMethods.addIfTestMethod(m);</span><br><span class="line">            <span class="keyword">if</span>(creator == <span class="keyword">null</span>)</span><br><span class="line">                creator = checkForCreatorMethod(m);</span><br><span class="line">            <span class="keyword">if</span>(cleanup == <span class="keyword">null</span>)</span><br><span class="line">                cleanup = checkForCleanupMethod(m);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(testMethods.size() &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span>(creator == <span class="keyword">null</span>)</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span>(!Modifier.isPublic(testClass</span><br><span class="line">                            .getDeclaredConstructor()</span><br><span class="line">                            .getModifiers())) &#123;</span><br><span class="line">                        System.out.println(<span class="string">"Error: "</span> + testClass +</span><br><span class="line">                                <span class="string">" no-arg constructor must be public"</span>);</span><br><span class="line">                        System.exit(<span class="number">1</span>);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span>(NoSuchMethodException e) &#123;</span><br><span class="line"><span class="comment">// Synthesized no-arg constructor; OK</span></span><br><span class="line">                &#125;</span><br><span class="line">            System.out.println(testClass.getName());</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(Method m : testMethods) &#123;</span><br><span class="line">            System.out.print(<span class="string">" . "</span> + m.getName() + <span class="string">" "</span>);</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                Object testObject = createTestObject(creator);</span><br><span class="line">                <span class="keyword">boolean</span> success = <span class="keyword">false</span>;</span><br><span class="line">                <span class="keyword">try</span> &#123;</span><br><span class="line">                    <span class="keyword">if</span>(m.getReturnType().equals(<span class="keyword">boolean</span>.class))</span><br><span class="line">                        success = (Boolean)m.invoke(testObject);</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line">                        m.invoke(testObject);</span><br><span class="line">                        success = <span class="keyword">true</span>; <span class="comment">// If no assert fails</span></span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; <span class="keyword">catch</span>(InvocationTargetException e) &#123;</span><br><span class="line"><span class="comment">// Actual exception is inside e:</span></span><br><span class="line">                    System.out.println(e.getCause());</span><br><span class="line">                &#125;</span><br><span class="line">                System.out.println(success ? <span class="string">""</span> : <span class="string">"(failed)"</span>);</span><br><span class="line">                testsRun++;</span><br><span class="line">                <span class="keyword">if</span>(!success) &#123;</span><br><span class="line">                    failures++;</span><br><span class="line">                    failedTests.add(testClass.getName() +</span><br><span class="line">                            <span class="string">": "</span> + m.getName());</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span>(cleanup != <span class="keyword">null</span>)</span><br><span class="line">                    cleanup.invoke(testObject, testObject);</span><br><span class="line">            &#125; <span class="keyword">catch</span>(IllegalAccessException |</span><br><span class="line">                    IllegalArgumentException |</span><br><span class="line">                    InvocationTargetException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">static</span></span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">TestMethods</span> <span class="keyword">extends</span> <span class="title">ArrayList</span>&lt;<span class="title">Method</span>&gt; </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">addIfTestMethod</span><span class="params">(Method m)</span> </span>&#123;</span><br><span class="line">            <span class="keyword">if</span>(m.getAnnotation(Test.class) == <span class="keyword">null</span>)</span><br><span class="line">                <span class="keyword">return</span>;</span><br><span class="line">            <span class="keyword">if</span>(!(m.getReturnType().equals(<span class="keyword">boolean</span>.class) ||</span><br><span class="line">                    m.getReturnType().equals(<span class="keyword">void</span>.class)))</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"@Test method"</span> +</span><br><span class="line">                        <span class="string">" must return boolean or void"</span>);</span><br><span class="line">            m.setAccessible(<span class="keyword">true</span>); <span class="comment">// If it's private, etc.</span></span><br><span class="line">            add(m);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span></span><br><span class="line">    <span class="function">Method <span class="title">checkForCreatorMethod</span><span class="params">(Method m)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(m.getAnnotation(TestObjectCreate.class) == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(!m.getReturnType().equals(testClass))</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"@TestObjectCreate "</span> +</span><br><span class="line">                    <span class="string">"must return instance of Class to be tested"</span>);</span><br><span class="line">        <span class="keyword">if</span>((m.getModifiers() &amp;</span><br><span class="line">                java.lang.reflect.Modifier.STATIC) &lt; <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"@TestObjectCreate "</span> +</span><br><span class="line">                    <span class="string">"must be static."</span>);</span><br><span class="line">        m.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span></span><br><span class="line">    <span class="function">Method <span class="title">checkForCleanupMethod</span><span class="params">(Method m)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(m.getAnnotation(TestObjectCleanup.class) == <span class="keyword">null</span>)</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">null</span>;</span><br><span class="line">        <span class="keyword">if</span>(!m.getReturnType().equals(<span class="keyword">void</span>.class))</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"@TestObjectCleanup "</span> +</span><br><span class="line">                    <span class="string">"must return void"</span>);</span><br><span class="line">        <span class="keyword">if</span>((m.getModifiers() &amp;</span><br><span class="line">                java.lang.reflect.Modifier.STATIC) &lt; <span class="number">1</span>)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"@TestObjectCleanup "</span> +</span><br><span class="line">                    <span class="string">"must be static."</span>);</span><br><span class="line">        <span class="keyword">if</span>(m.getParameterTypes().length == <span class="number">0</span> ||</span><br><span class="line">                m.getParameterTypes()[<span class="number">0</span>] != testClass)</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"@TestObjectCleanup "</span> +</span><br><span class="line">                    <span class="string">"must take an argument of the tested type."</span>);</span><br><span class="line">        m.setAccessible(<span class="keyword">true</span>);</span><br><span class="line">        <span class="keyword">return</span> m;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="keyword">static</span> Object</span><br><span class="line">    createTestObject(Method creator) &#123;</span><br><span class="line">        <span class="keyword">if</span>(creator != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> creator.invoke(testClass);</span><br><span class="line">            &#125; <span class="keyword">catch</span>(IllegalAccessException |</span><br><span class="line">                    IllegalArgumentException |</span><br><span class="line">                    InvocationTargetException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(<span class="string">"Couldn't run "</span> +</span><br><span class="line">                        <span class="string">"@TestObject (creator) method."</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123; <span class="comment">// Use the no-arg constructor:</span></span><br><span class="line">            <span class="keyword">try</span> &#123;</span><br><span class="line">                <span class="keyword">return</span> testClass.newInstance();</span><br><span class="line">            &#125; <span class="keyword">catch</span>(InstantiationException |</span><br><span class="line">                    IllegalAccessException e) &#123;</span><br><span class="line">                <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(</span><br><span class="line">                        <span class="string">"Couldn't create a test object. "</span> +</span><br><span class="line">                                <span class="string">"Try using a @TestObject method."</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è™½ç„¶å®ƒå¯èƒ½æ˜¯â€œè¿‡æ—©çš„é‡æ„â€ï¼ˆå› ä¸ºå®ƒåªåœ¨ä¹¦ä¸­ä½¿ç”¨è¿‡ä¸€æ¬¡ï¼‰ï¼Œ<strong>AtUnit.java</strong> ä½¿ç”¨äº† <strong>ProcessFiles</strong> å·¥å…·é€æ­¥åˆ¤æ–­å‘½ä»¤è¡Œä¸­çš„å‚æ•°ï¼Œå†³å®šå®ƒæ˜¯ä¸€ä¸ªç›®å½•è¿˜æ˜¯æ–‡ä»¶ï¼Œå¹¶é‡‡å–ç›¸åº”çš„è¡Œä¸ºã€‚è¿™å¯ä»¥åº”ç”¨äºä¸åŒçš„è§£å†³æ–¹æ³•ï¼Œæ˜¯å› ä¸ºå®ƒåŒ…å«äº†ä¸€ä¸ª å¯ç”¨äºè‡ªå®šä¹‰çš„ <strong>Strategy</strong> æ¥å£ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// onjava/ProcessFiles.java</span></span><br><span class="line"><span class="keyword">package</span> onjava;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ProcessFiles</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Strategy</span> </span>&#123;</span><br><span class="line">        <span class="function"><span class="keyword">void</span> <span class="title">process</span><span class="params">(File file)</span></span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> Strategy strategy;</span><br><span class="line">    <span class="keyword">private</span> String ext;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="title">ProcessFiles</span><span class="params">(Strategy strategy, String ext)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.strategy = strategy;</span><br><span class="line">        <span class="keyword">this</span>.ext = ext;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">start</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            <span class="keyword">if</span>(args.length == <span class="number">0</span>)</span><br><span class="line">                processDirectoryTree(<span class="keyword">new</span> File(<span class="string">"."</span>));</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                <span class="keyword">for</span>(String arg : args) &#123;</span><br><span class="line">                    File fileArg = <span class="keyword">new</span> File(arg);</span><br><span class="line">                    <span class="keyword">if</span>(fileArg.isDirectory())</span><br><span class="line">                        processDirectoryTree(fileArg);</span><br><span class="line">                    <span class="keyword">else</span> &#123;</span><br><span class="line"><span class="comment">// Allow user to leave off extension:</span></span><br><span class="line">                        <span class="keyword">if</span>(!arg.endsWith(<span class="string">"."</span> + ext))</span><br><span class="line">                            arg += <span class="string">"."</span> + ext;</span><br><span class="line">                        strategy.process(</span><br><span class="line">                                <span class="keyword">new</span> File(arg).getCanonicalFile());</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">        &#125; <span class="keyword">catch</span>(IOException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">processDirectoryTree</span><span class="params">(File root)</span> <span class="keyword">throws</span> IOException </span>&#123;</span><br><span class="line">        PathMatcher matcher = FileSystems.getDefault()</span><br><span class="line">                .getPathMatcher(<span class="string">"glob:**/*.&#123;"</span> + ext + <span class="string">"&#125;"</span>);</span><br><span class="line">        Files.walk(root.toPath())</span><br><span class="line">                .filter(matcher::matches)</span><br><span class="line">                .forEach(p -&gt; strategy.process(p.toFile()));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p><strong>AtUnit</strong> ç±»å®ç°äº† <strong>ProcessFiles.Strategy</strong>ï¼Œå…¶åŒ…å«äº†ä¸€ä¸ª <code>process()</code> æ–¹æ³•ã€‚åœ¨è¿™ç§æ–¹å¼ä¸‹ï¼Œ<strong>AtUnit</strong> å®ä¾‹å¯ä»¥ä½œä¸ºå‚æ•°ä¼ é€’ç»™ <strong>ProcessFiles</strong> æ„é€ å™¨ã€‚ç¬¬äºŒä¸ªæ„é€ å™¨çš„å‚æ•°å‘Šè¯‰ <strong>ProcessFiles</strong> å¦‚å¯»æ‰¾æ‰€æœ‰åŒ…å« â€œclassâ€ æ‹“å±•åçš„æ–‡ä»¶ã€‚</p><p>å¦‚ä¸‹æ˜¯ä¸€ä¸ªç®€å•çš„ä½¿ç”¨ç¤ºä¾‹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// annotations/DemoProcessFiles.java</span></span><br><span class="line"><span class="keyword">import</span> onjava.ProcessFiles;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">DemoProcessFiles</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">new</span> ProcessFiles(file -&gt; System.out.println(file),</span><br><span class="line">                <span class="string">"java"</span>).start(args);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line">.\AtUnitExample1.java</span><br><span class="line">.\AtUnitExample2.java</span><br><span class="line">.\AtUnitExample3.java</span><br><span class="line">.\AtUnitExample4.java</span><br><span class="line">.\AtUnitExample5.java</span><br><span class="line">.\AUComposition.java</span><br><span class="line">.\AUExternalTest.java</span><br><span class="line">.\database\Constraints.java</span><br><span class="line">.\database\DBTable.java</span><br><span class="line">.\database\Member.java</span><br><span class="line">.\database\SQLInteger.java</span><br><span class="line">.\database\SQLString.java</span><br><span class="line">.\database\TableCreator.java</span><br><span class="line">.\database\Uniqueness.java</span><br><span class="line">.\DemoProcessFiles.java</span><br><span class="line">.\HashSetTest.java</span><br><span class="line">.\ifx\ExtractInterface.java</span><br><span class="line">.\ifx\IfaceExtractorProcessor.java</span><br><span class="line">.\ifx\Multiplier.java</span><br><span class="line">.\PasswordUtils.java</span><br><span class="line">.\simplest\Simple.java</span><br><span class="line">.\simplest\SimpleProcessor.java</span><br><span class="line">.\simplest\SimpleTest.java</span><br><span class="line">.\SimulatingNull.java</span><br><span class="line">.\StackL.java</span><br><span class="line">.\StackLStringTst.java</span><br><span class="line">.\Testable.java</span><br><span class="line">.\UseCase.java</span><br><span class="line">.\UseCaseTracker.java</span><br></pre></td></tr></table></figure><p>å¦‚æœæ²¡æœ‰å‘½ä»¤è¡Œå‚æ•°ï¼Œè¿™ä¸ªç¨‹åºä¼šéå†å½“å‰çš„ç›®å½•æ ‘ã€‚ä½ è¿˜å¯ä»¥æä¾›å¤šä¸ªå‚æ•°ï¼Œè¿™äº›å‚æ•°å¯ä»¥æ˜¯ç±»æ–‡ä»¶ï¼ˆå¸¦æˆ–ä¸å¸¦.classæ‰©å±•åï¼‰æˆ–ç›®å½•ã€‚</p><p>å›åˆ°æˆ‘ä»¬å¯¹ <strong>AtUnit.java</strong> çš„è®¨è®ºï¼Œå› ä¸º <strong>@Unit</strong> ä¼šè‡ªåŠ¨æ‰¾åˆ°å¯æµ‹è¯•çš„ç±»å’Œæ–¹æ³•ï¼Œæ‰€ä»¥ä¸éœ€è¦â€œå¥—ä»¶â€æœºåˆ¶ã€‚</p><p><strong>AtUnit.java</strong> ä¸­å­˜åœ¨çš„ä¸€ä¸ªæˆ‘ä»¬å¿…é¡»è¦è§£å†³çš„é—®é¢˜æ˜¯ï¼Œå½“å®ƒå‘ç°ç±»æ–‡ä»¶æ—¶ï¼Œç±»æ–‡ä»¶åä¸­çš„é™å®šç±»åï¼ˆåŒ…æ‹¬åŒ…ï¼‰ä¸æ˜æ˜¾ã€‚ä¸ºäº†å‘ç°è¿™ä¸ªä¿¡æ¯ï¼Œå¿…é¡»è§£æç±»æ–‡ä»¶ - è¿™ä¸æ˜¯å¾®ä¸è¶³é“çš„ï¼Œä½†ä¹Ÿä¸æ˜¯ä¸å¯èƒ½çš„ã€‚ æ‰¾åˆ° .class æ–‡ä»¶æ—¶ï¼Œä¼šæ‰“å¼€å®ƒå¹¶è¯»å–å…¶äºŒè¿›åˆ¶æ•°æ®å¹¶å°†å…¶ä¼ é€’ç»™ <code>ClassNameFinder.thisClass()</code>ã€‚ åœ¨è¿™é‡Œï¼Œæˆ‘ä»¬æ­£åœ¨è¿›å…¥â€œå­—èŠ‚ç å·¥ç¨‹â€é¢†åŸŸï¼Œå› ä¸ºæˆ‘ä»¬å®é™…ä¸Šæ­£åœ¨åˆ†æç±»æ–‡ä»¶çš„å†…å®¹ï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// onjava/atunit/ClassNameFinder.java</span></span><br><span class="line"><span class="comment">// &#123;java onjava.atunit.ClassNameFinder&#125;</span></span><br><span class="line"><span class="keyword">package</span> onjava.atunit;</span><br><span class="line"><span class="keyword">import</span> java.io.*;</span><br><span class="line"><span class="keyword">import</span> java.nio.file.*;</span><br><span class="line"><span class="keyword">import</span> java.util.*;</span><br><span class="line"><span class="keyword">import</span> onjava.*;</span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ClassNameFinder</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> String <span class="title">thisClass</span><span class="params">(<span class="keyword">byte</span>[] classBytes)</span> </span>&#123;</span><br><span class="line">        Map&lt;Integer,Integer&gt; offsetTable = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        Map&lt;Integer,String&gt; classNameTable = <span class="keyword">new</span> HashMap&lt;&gt;();</span><br><span class="line">        <span class="keyword">try</span> &#123;</span><br><span class="line">            DataInputStream data = <span class="keyword">new</span> DataInputStream(</span><br><span class="line">                    <span class="keyword">new</span> ByteArrayInputStream(classBytes));</span><br><span class="line">            <span class="keyword">int</span> magic = data.readInt(); <span class="comment">// 0xcafebabe</span></span><br><span class="line">            <span class="keyword">int</span> minorVersion = data.readShort();</span><br><span class="line">            <span class="keyword">int</span> majorVersion = data.readShort();</span><br><span class="line">            <span class="keyword">int</span> constantPoolCount = data.readShort();</span><br><span class="line">            <span class="keyword">int</span>[] constantPool = <span class="keyword">new</span> <span class="keyword">int</span>[constantPoolCount];</span><br><span class="line">            <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; constantPoolCount; i++) &#123;</span><br><span class="line">                <span class="keyword">int</span> tag = data.read();</span><br><span class="line">                <span class="comment">// int tableSize;</span></span><br><span class="line">                <span class="keyword">switch</span>(tag) &#123;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">1</span>: <span class="comment">// UTF</span></span><br><span class="line">                        <span class="keyword">int</span> length = data.readShort();</span><br><span class="line">                        <span class="keyword">char</span>[] bytes = <span class="keyword">new</span> <span class="keyword">char</span>[length];</span><br><span class="line">                        <span class="keyword">for</span>(<span class="keyword">int</span> k = <span class="number">0</span>; k &lt; bytes.length; k++)</span><br><span class="line">                            bytes[k] = (<span class="keyword">char</span>)data.read();</span><br><span class="line">                        String className = <span class="keyword">new</span> String(bytes);</span><br><span class="line">                        classNameTable.put(i, className);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">5</span>: <span class="comment">// LONG</span></span><br><span class="line">                    <span class="keyword">case</span> <span class="number">6</span>: <span class="comment">// DOUBLE</span></span><br><span class="line">                        data.readLong(); <span class="comment">// discard 8 bytes</span></span><br><span class="line">                        i++; <span class="comment">// Special skip necessary</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">7</span>: <span class="comment">// CLASS</span></span><br><span class="line">                        <span class="keyword">int</span> offset = data.readShort();</span><br><span class="line">                        offsetTable.put(i, offset);</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">8</span>: <span class="comment">// STRING</span></span><br><span class="line">                        data.readShort(); <span class="comment">// discard 2 bytes</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">3</span>: <span class="comment">// INTEGER</span></span><br><span class="line">                    <span class="keyword">case</span> <span class="number">4</span>: <span class="comment">// FLOAT</span></span><br><span class="line">                    <span class="keyword">case</span> <span class="number">9</span>: <span class="comment">// FIELD_REF</span></span><br><span class="line">                    <span class="keyword">case</span> <span class="number">10</span>: <span class="comment">// METHOD_REF</span></span><br><span class="line">                    <span class="keyword">case</span> <span class="number">11</span>: <span class="comment">// INTERFACE_METHOD_REF</span></span><br><span class="line">                    <span class="keyword">case</span> <span class="number">12</span>: <span class="comment">// NAME_AND_TYPE</span></span><br><span class="line">                    <span class="keyword">case</span> <span class="number">18</span>: <span class="comment">// Invoke Dynamic</span></span><br><span class="line">                        data.readInt(); <span class="comment">// discard 4 bytes</span></span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">15</span>: <span class="comment">// Method Handle</span></span><br><span class="line">                        data.readByte();</span><br><span class="line">                        data.readShort();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">case</span> <span class="number">16</span>: <span class="comment">// Method Type</span></span><br><span class="line">                        data.readShort();</span><br><span class="line">                        <span class="keyword">break</span>;</span><br><span class="line">                    <span class="keyword">default</span>:</span><br><span class="line">                        <span class="keyword">throw</span></span><br><span class="line">                                <span class="keyword">new</span> RuntimeException(<span class="string">"Bad tag "</span> + tag);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">short</span> accessFlags = data.readShort();</span><br><span class="line">            String access = (accessFlags &amp; <span class="number">0x0001</span>) == <span class="number">0</span> ?</span><br><span class="line">                    <span class="string">"nonpublic:"</span> : <span class="string">"public:"</span>;</span><br><span class="line">            <span class="keyword">int</span> thisClass = data.readShort();</span><br><span class="line">            <span class="keyword">int</span> superClass = data.readShort();</span><br><span class="line">            <span class="keyword">return</span> access + classNameTable.get(</span><br><span class="line">                    offsetTable.get(thisClass)).replace(<span class="string">'/'</span>, <span class="string">'.'</span>);</span><br><span class="line">        &#125; <span class="keyword">catch</span>(IOException | RuntimeException e) &#123;</span><br><span class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// Demonstration:</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">void</span> <span class="title">main</span><span class="params">(String[] args)</span> <span class="keyword">throws</span> Exception </span>&#123;</span><br><span class="line">        PathMatcher matcher = FileSystems.getDefault()</span><br><span class="line">                .getPathMatcher(<span class="string">"glob:**/*.class"</span>);</span><br><span class="line"><span class="comment">// Walk the entire tree:</span></span><br><span class="line">        Files.walk(Paths.get(<span class="string">"."</span>))</span><br><span class="line">                .filter(matcher::matches)</span><br><span class="line">                .map(p -&gt; &#123;</span><br><span class="line">                    <span class="keyword">try</span> &#123;</span><br><span class="line">                        <span class="keyword">return</span> thisClass(Files.readAllBytes(p));</span><br><span class="line">                    &#125; <span class="keyword">catch</span>(Exception e) &#123;</span><br><span class="line">                        <span class="keyword">throw</span> <span class="keyword">new</span> RuntimeException(e);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;)</span><br><span class="line">                .filter(s -&gt; s.startsWith(<span class="string">"public:"</span>))</span><br><span class="line"><span class="comment">// .filter(s -&gt; s.indexOf('$') &gt;= 0)</span></span><br><span class="line">                .map(s -&gt; s.split(<span class="string">":"</span>)[<span class="number">1</span>])</span><br><span class="line">                .filter(s -&gt; !s.startsWith(<span class="string">"enums."</span>))</span><br><span class="line">                .filter(s -&gt; s.contains(<span class="string">"."</span>))</span><br><span class="line">                .forEach(System.out::println);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>è¾“å‡ºä¸ºï¼š</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br></pre></td><td class="code"><pre><span class="line">onjava.ArrayShow</span><br><span class="line">onjava.atunit.AtUnit$TestMethods</span><br><span class="line">onjava.atunit.AtUnit</span><br><span class="line">onjava.atunit.ClassNameFinder</span><br><span class="line">onjava.atunit.Test</span><br><span class="line">onjava.atunit.TestObjectCleanup</span><br><span class="line">onjava.atunit.TestObjectCreate</span><br><span class="line">onjava.atunit.TestProperty</span><br><span class="line">onjava.BasicSupplier</span><br><span class="line">onjava.CollectionMethodDifferences</span><br><span class="line">onjava.ConvertTo</span><br><span class="line">onjava.Count$Boolean</span><br><span class="line">onjava.Count$Byte</span><br><span class="line">onjava.Count$Character</span><br><span class="line">onjava.Count$Double</span><br><span class="line">onjava.Count$Float</span><br><span class="line">onjava.Count$Integer</span><br><span class="line">onjava.Count$Long</span><br><span class="line">onjava.Count$Pboolean</span><br><span class="line">onjava.Count$Pbyte</span><br><span class="line">onjava.Count$Pchar</span><br><span class="line">onjava.Count$Pdouble</span><br><span class="line">onjava.Count$Pfloat</span><br><span class="line">onjava.Count$Pint</span><br><span class="line">onjava.Count$Plong</span><br><span class="line">onjava.Count$Pshort</span><br><span class="line">onjava.Count$Short</span><br><span class="line">onjava.Count</span><br><span class="line">onjava.CountingIntegerList</span><br><span class="line">onjava.CountMap</span><br><span class="line">onjava.Countries</span><br><span class="line">onjava.Enums</span><br><span class="line">onjava.FillMap</span><br><span class="line">onjava.HTMLColors</span><br><span class="line">onjava.MouseClick</span><br><span class="line">onjava.Nap</span><br><span class="line">onjava.Null</span><br><span class="line">onjava.Operations</span><br><span class="line">onjava.OSExecute</span><br><span class="line">onjava.OSExecuteException</span><br><span class="line">onjava.Pair</span><br><span class="line">onjava.ProcessFiles$Strategy</span><br><span class="line">onjava.ProcessFiles</span><br><span class="line">onjava.Rand$Boolean</span><br><span class="line">onjava.Rand$Byte</span><br><span class="line">onjava.Rand$Character</span><br><span class="line">onjava.Rand$Double</span><br><span class="line">onjava.Rand$Float</span><br><span class="line">onjava.Rand$Integer</span><br><span class="line">onjava.Rand$Long</span><br><span class="line">onjava.Rand$Pboolean</span><br><span class="line">onjava.Rand$Pbyte</span><br><span class="line">onjava.Rand$Pchar</span><br><span class="line">onjava.Rand$Pdouble</span><br><span class="line">onjava.Rand$Pfloat</span><br><span class="line">onjava.Rand$Pint</span><br><span class="line">onjava.Rand$Plong</span><br><span class="line">onjava.Rand$Pshort</span><br><span class="line">onjava.Rand$Short</span><br><span class="line">onjava.Rand$String</span><br><span class="line">onjava.Rand</span><br><span class="line">onjava.Range</span><br><span class="line">onjava.Repeat</span><br><span class="line">onjava.RmDir</span><br><span class="line">onjava.Sets</span><br><span class="line">onjava.Stack</span><br><span class="line">onjava.Suppliers</span><br><span class="line">onjava.TimedAbort</span><br><span class="line">onjava.Timer</span><br><span class="line">onjava.Tuple</span><br><span class="line">onjava.Tuple2</span><br><span class="line">onjava.Tuple3</span><br><span class="line">onjava.Tuple4</span><br><span class="line">onjava.Tuple5</span><br><span class="line">onjava.TypeCounter</span><br></pre></td></tr></table></figure><p> è™½ç„¶æ— æ³•åœ¨è¿™é‡Œä»‹ç»å…¶ä¸­æ‰€æœ‰çš„ç»†èŠ‚ï¼Œä½†æ˜¯æ¯ä¸ªç±»æ–‡ä»¶éƒ½å¿…é¡»éµå¾ªä¸€å®šçš„æ ¼å¼ï¼Œè€Œæˆ‘å·²ç»å°½åŠ›ç”¨æœ‰æ„ä¹‰çš„å­—æ®µæ¥è¡¨ç¤ºè¿™äº›ä» <strong>ByteArrayInputStream</strong> ä¸­æå–å‡ºæ¥çš„æ•°æ®ç‰‡æ®µã€‚é€šè¿‡æ–½åŠ åœ¨è¾“å…¥æµä¸Šçš„è¯»æ“ä½œï¼Œä½ èƒ½çœ‹å‡ºæ¯ä¸ªä¿¡æ¯ç‰‡çš„å¤§å°ã€‚ä¾‹å¦‚æ¯ä¸€ä¸ªç±»çš„å¤´ 32 ä¸ª bit æ€»æ˜¯ä¸€ä¸ª â€œç¥ç§˜æ•°å­—â€ <strong>0xcafebabe</strong>ï¼Œè€Œæ¥ä¸‹æ¥çš„ä¸¤ä¸ª <strong>short</strong> å€¼æ˜¯ç‰ˆæœ¬ä¿¡æ¯ã€‚å¸¸é‡æ± åŒ…å«äº†ç¨‹åºçš„å¸¸é‡ï¼Œæ‰€ä»¥è¿™æ˜¯ä¸€ä¸ªå¯å˜çš„å€¼ã€‚æ¥ä¸‹æ¥çš„ <strong>short</strong> å‘Šè¯‰æˆ‘ä»¬è¿™ä¸ªå¸¸é‡æ± æœ‰å¤šå¤§ï¼Œç„¶åæˆ‘ä»¬ä¸ºå…¶åˆ›å»ºä¸€ä¸ªå°ºå¯¸åˆé€‚çš„æ•°ç»„ã€‚å¸¸é‡æ± ä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ï¼Œå…¶é•¿åº¦å¯èƒ½æ˜¯å›ºå®šå¼ï¼Œä¹Ÿå¯èƒ½æ˜¯å¯å˜çš„å€¼ï¼Œå› æ­¤æˆ‘ä»¬å¿…é¡»æ£€æŸ¥æ¯ä¸€ä¸ªå¸¸é‡çš„èµ·å§‹æ ‡è®°ï¼Œç„¶åæ‰èƒ½çŸ¥é“è¯¥æ€ä¹ˆåšï¼Œè¿™å°±æ˜¯ switch è¯­å¥çš„å·¥ä½œã€‚æˆ‘ä»¬å¹¶ä¸æ‰“ç®—ç²¾ç¡®çš„åˆ†æç±»ä¸­æ‰€æœ‰çš„æ•°æ®ï¼Œä»…ä»…æ˜¯ä»æ–‡ä»¶çš„èµ·å§‹ä¸€æ­¥ä¸€æ­¥çš„èµ°ï¼Œç›´åˆ°å–å¾—æˆ‘ä»¬æ‰€éœ€çš„ä¿¡æ¯ï¼Œå› æ­¤ä½ ä¼šå‘ç°ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­æˆ‘ä»¬ä¸¢å¼ƒäº†å¤§é‡çš„æ•°æ®ã€‚å…³äºç±»çš„ä¿¡æ¯éƒ½ä¿å­˜åœ¨ <strong>classNameTable</strong> å’Œ <strong>offsetTable</strong> ä¸­ã€‚åœ¨è¯»å–å¸¸é‡æ± ä¹‹åï¼Œå°±æ‰¾åˆ°äº† <strong>this_class</strong> ä¿¡æ¯ï¼Œè¿™æ˜¯ <strong>offsetTable</strong> çš„ä¸€ä¸ªåæ ‡ï¼Œé€šè¿‡å®ƒå¯ä»¥æ‰¾åˆ°è¿›å…¥  <strong>classNameTable</strong> çš„åæ ‡ï¼Œç„¶åå°±å¯ä»¥å¾—åˆ°æˆ‘ä»¬æ‰€éœ€çš„ç±»çš„åå­—äº†ã€‚</p><p>ç°åœ¨è®©æˆ‘ä»¬å›åˆ° <strong>AtUtil.java</strong> ä¸­ï¼Œprocess() æ–¹æ³•ä¸­æ‹¥æœ‰äº†ç±»çš„åå­—ï¼Œç„¶åæ£€æŸ¥å®ƒæ˜¯å¦åŒ…å«â€œ.â€ï¼Œå¦‚æœæœ‰å°±è¡¨ç¤ºè¯¥ç±»å®šä¹‰äºä¸€ä¸ªåŒ…ä¸­ã€‚æ²¡æœ‰åŒ…çš„ç±»ä¼šè¢«å¿½ç•¥ã€‚å¦‚æœä¸€ä¸ªç±»åœ¨åŒ…ä¸­ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨æ ‡å‡†çš„ç±»åŠ è½½å™¨é€šè¿‡ <code>Class.forName()</code>  å°†å…¶åŠ è½½è¿›æ¥ã€‚ç°åœ¨æˆ‘ä»¬å¯ä»¥å¯¹è¿™ä¸ªç±»è¿›è¡Œ <strong>@Unit</strong> æ³¨è§£çš„åˆ†æå·¥ä½œäº†ã€‚</p><p>æˆ‘ä»¬åªéœ€è¦å…³æ³¨ä¸‰ä»¶äº‹ï¼šé¦–å…ˆæ˜¯ <strong>@Test</strong> æ–¹æ³•ï¼Œå®ƒä»¬è¢«ä¿å­˜åœ¨ <strong>TestMehtods</strong> åˆ—è¡¨ä¸­ï¼Œç„¶åæ£€æŸ¥å…¶æ˜¯å¦å…·æœ‰ @TestObjectCreate å’Œ <strong>@TestObjectCleanup****</strong> æ–¹æ³•ã€‚ä»ä»£ç ä¸­å¯ä»¥çœ‹åˆ°ï¼Œæˆ‘ä»¬é€šè¿‡è°ƒç”¨ç›¸åº”çš„æ–¹æ³•æ¥æŸ¥è¯¢æ³¨è§£ä»è€Œæ‰¾åˆ°è¿™äº›æ–¹æ³•ã€‚</p><p>æ¯æ‰¾åˆ°ä¸€ä¸ª @Test æ–¹æ³•ï¼Œå°±æ‰“å°å‡ºæ¥å½“å‰ç±»çš„åå­—ï¼Œäºæ˜¯è§‚å¯Ÿè€…ç«‹åˆ»å°±å¯ä»¥çŸ¥é“å‘ç”Ÿäº†ä»€ä¹ˆã€‚æ¥ä¸‹æ¥å¼€å§‹æ‰§è¡Œæµ‹è¯•ï¼Œä¹Ÿå°±æ˜¯æ‰“å°å‡ºæ–¹æ³•åï¼Œç„¶åè°ƒç”¨ createTestObject() ï¼ˆå¦‚æœå­˜åœ¨ä¸€ä¸ªåŠ äº† @TestObjectCreate æ³¨è§£çš„æ–¹æ³•ï¼‰ï¼Œæˆ–è€…è°ƒç”¨é»˜è®¤æ„é€ å™¨ã€‚ä¸€æ—¦åˆ›å»ºå‡ºæ¥æµ‹è¯•å¯¹è±¡ï¼Œå¦‚æœè°ƒç”¨å…¶ä¸Šçš„æµ‹è¯•æ–¹æ³•ã€‚å¦‚æœæµ‹è¯•çš„è¿”å›å€¼ä¸º booleanï¼Œå°±æ•è·è¯¥ç»“æœã€‚å¦‚æœæµ‹è¯•æ–¹æ³•æ²¡æœ‰è¿”å›å€¼ï¼Œé‚£ä¹ˆå°±æ²¡æœ‰å¼‚å¸¸å‘ç”Ÿï¼Œæˆ‘ä»¬å°±å‡è®¾æµ‹è¯•æˆåŠŸï¼Œåä¹‹ï¼Œå¦‚æœå½“ assert å¤±è´¥æˆ–è€…æœ‰ä»»ä½•å¼‚å¸¸æŠ›å‡ºçš„æ—¶å€™ï¼Œå°±è¯´æ˜æµ‹è¯•å¤±è´¥ï¼Œè¿™æ—¶å°†å¼‚å¸¸ä¿¡æ¯æ‰“å°å‡ºæ¥ä»¥æ˜¾ç¤ºé”™è¯¯çš„åŸå› ã€‚å¦‚æœæœ‰å¤±è´¥çš„æµ‹è¯•å‘ç”Ÿï¼Œé‚£ä¹ˆè¿˜è¦ç»Ÿè®¡å¤±è´¥çš„æ¬¡æ•°ï¼Œå¹¶å°†å¤±è´¥æ‰€å±çš„ç±»å’Œæ–¹æ³•åŠ å…¥åˆ° failedTests ä¸­ï¼Œä»¥ä¾¿æœ€åæŠ¥å‘Šç»™ç”¨æˆ·ã€‚</p><!-- Summary --><h2 id="æœ¬ç« å°ç»“"><a href="#æœ¬ç« å°ç»“" class="headerlink" title="æœ¬ç« å°ç»“"></a>æœ¬ç« å°ç»“</h2><p>æ³¨è§£æ˜¯ Java å¼•å…¥çš„ä¸€é¡¹éå¸¸å—æ¬¢è¿çš„è¡¥å……ï¼Œå®ƒæä¾›äº†ä¸€ç§ç»“æ„åŒ–ï¼Œå¹¶ä¸”å…·æœ‰ç±»å‹æ£€æŸ¥èƒ½åŠ›çš„æ–°é€”å¾„ï¼Œä»è€Œä½¿å¾—ä½ èƒ½å¤Ÿä¸ºä»£ç ä¸­åŠ å…¥å…ƒæ•°æ®ï¼Œè€Œä¸”ä¸ä¼šå¯¼è‡´ä»£ç æ‚ä¹±å¹¶éš¾ä»¥é˜…è¯»ã€‚ä½¿ç”¨æ³¨è§£èƒ½å¤Ÿå¸®åŠ©æˆ‘ä»¬é¿å…ç¼–å†™ç´¯èµ˜çš„éƒ¨ç½²æè¿°æ€§æ–‡ä»¶ï¼Œä»¥åŠå…¶ä»–çš„ç”Ÿæˆæ–‡ä»¶ã€‚è€Œ Javadoc ä¸­çš„ @deprecated è¢« @Deprecated æ³¨è§£æ‰€æ›¿ä»£çš„äº‹å®ä¹Ÿè¯´æ˜ï¼Œä¸æ³¨é‡Šæ€§æ–‡å­—ç›¸æ¯”ï¼Œæ³¨è§£ç»å¯¹æ›´é€‚ç”¨äºæè¿°ç±»ç›¸å…³çš„ä¿¡æ¯ã€‚</p><p>Java æä¾›äº†å¾ˆå°‘çš„å†…ç½®æ³¨è§£ã€‚è¿™æ„å‘³ç€å¦‚æœä½ åœ¨åˆ«å¤„æ‰¾ä¸åˆ°å¯ç”¨çš„ç±»åº“ï¼Œé‚£ä¹ˆå°±åªèƒ½è‡ªå·±åˆ›å»ºæ–°çš„æ³¨è§£ä»¥åŠç›¸åº”çš„å¤„ç†å™¨ã€‚é€šè¿‡å°†æ³¨è§£å¤„ç†å™¨é“¾æ¥åˆ° javacï¼Œä½ å¯ä»¥ä¸€æ­¥å®Œæˆç¼–è¯‘æ–°ç”Ÿæˆçš„æ–‡ä»¶ï¼Œç®€åŒ–äº†æ„é€ è¿‡ç¨‹ã€‚</p><p>API çš„æä¾›æ–¹å’Œæ¡†æ¶å°†ä¼šå°†æ³¨è§£ä½œä¸ºä»–ä»¬å·¥å…·çš„ä¸€éƒ¨åˆ†ã€‚é€šè¿‡ @Unit ç³»ç»Ÿï¼Œæˆ‘ä»¬å¯ä»¥æƒ³è±¡ï¼Œæ³¨è§£ä¼šæå¤§çš„æ”¹å˜æˆ‘ä»¬çš„ Java ç¼–ç¨‹ä½“éªŒã€‚</p><!-- åˆ†é¡µ --><div style="page-break-after: always;"></div><p>[^3 ]: The Java designers coyly suggest that a mirror is where you find a reflection.</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ¥å£å’ŒæŠ½è±¡ç±»æä¾›äº†ä¸€ç§å°†æ¥å£ä¸å®ç°åˆ†ç¦»çš„æ›´åŠ ç»“æ„åŒ–çš„æ–¹æ³•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2020å¹´6æœˆ" scheme="http://yoursite.com/categories/2020%E5%B9%B46%E6%9C%88/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
  </entry>
  
</feed>
