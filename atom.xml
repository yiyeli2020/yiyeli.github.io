<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Yiye Li</title>
  
  
  <link href="/atom.xml" rel="self"/>
  
  <link href="http://yoursite.com/"/>
  <updated>2021-12-24T12:12:22.782Z</updated>
  <id>http://yoursite.com/</id>
  
  <author>
    <name>Yiye Li</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>423. ä»è‹±æ–‡ä¸­é‡å»ºæ•°å­—</title>
    <link href="http://yoursite.com/2021/12/24/423.%20%E4%BB%8E%E8%8B%B1%E6%96%87%E4%B8%AD%E9%87%8D%E5%BB%BA%E6%95%B0%E5%AD%97/"/>
    <id>http://yoursite.com/2021/12/24/423. ä»è‹±æ–‡ä¸­é‡å»ºæ•°å­—/</id>
    <published>2021-12-24T10:12:12.000Z</published>
    <updated>2021-12-24T12:12:22.782Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² s ï¼Œå…¶ä¸­åŒ…å«å­—æ¯é¡ºåºæ‰“ä¹±çš„ç”¨è‹±æ–‡å•è¯è¡¨ç¤ºçš„è‹¥å¹²æ•°å­—ï¼ˆ0-9ï¼‰ã€‚æŒ‰ å‡åº è¿”å›åŸå§‹çš„æ•°å­—ã€‚</p><a id="more"></a><p>[TOC]</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼šs = &quot;owoztneoer&quot;è¾“å‡ºï¼š&quot;012&quot;</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼šs = &quot;fviefuro&quot;è¾“å‡ºï¼š&quot;45&quot;</code></pre><p>æç¤ºï¼š</p><pre><code>1 &lt;= s.length &lt;= 105s[i] ä¸º [&quot;e&quot;,&quot;g&quot;,&quot;f&quot;,&quot;i&quot;,&quot;h&quot;,&quot;o&quot;,&quot;n&quot;,&quot;s&quot;,&quot;r&quot;,&quot;u&quot;,&quot;t&quot;,&quot;w&quot;,&quot;v&quot;,&quot;x&quot;,&quot;z&quot;] è¿™äº›å­—ç¬¦ä¹‹ä¸€s ä¿è¯æ˜¯ä¸€ä¸ªç¬¦åˆé¢˜ç›®è¦æ±‚çš„å­—ç¬¦ä¸²</code></pre><h1 id="æ–¹æ³•ä¸€ï¼šä¾æ¬¡ç¡®å®šæ¯ä¸€ä¸ªæ•°å­—çš„æ¬¡æ•°-1"><a href="#æ–¹æ³•ä¸€ï¼šä¾æ¬¡ç¡®å®šæ¯ä¸€ä¸ªæ•°å­—çš„æ¬¡æ•°-1" class="headerlink" title="æ–¹æ³•ä¸€ï¼šä¾æ¬¡ç¡®å®šæ¯ä¸€ä¸ªæ•°å­—çš„æ¬¡æ•°^1"></a>æ–¹æ³•ä¸€ï¼šä¾æ¬¡ç¡®å®šæ¯ä¸€ä¸ªæ•°å­—çš„æ¬¡æ•°<a href="https://leetcode-cn.com/problems/reconstruct-original-digits-from-english/solution/cong-ying-wen-zhong-zhong-jian-shu-zi-by-9g1r/" target="_blank" rel="noopener">^1</a></h1><p><strong>æ€è·¯ä¸ç®—æ³•</strong></p><p>é¦–å…ˆæˆ‘ä»¬å¯ä»¥ç»Ÿè®¡æ¯ä¸ªå­—æ¯åˆ†åˆ«åœ¨å“ªäº›æ•°å­—ä¸­å‡ºç°ï¼š</p><table><thead><tr><th align="center">å­—æ¯</th><th align="center">æ•°å­—</th></tr></thead><tbody><tr><td align="center">e</td><td align="center">0 1 3 5 7 8 9</td></tr><tr><td align="center">f</td><td align="center">4 5</td></tr><tr><td align="center">g</td><td align="center">8</td></tr><tr><td align="center">h</td><td align="center">3 8</td></tr><tr><td align="center">i</td><td align="center">5 6 8 9</td></tr><tr><td align="center">n</td><td align="center">1 7 9</td></tr><tr><td align="center">o</td><td align="center">0 1 2 4</td></tr><tr><td align="center">r</td><td align="center">0 3 4</td></tr><tr><td align="center">s</td><td align="center">6 7</td></tr><tr><td align="center">t</td><td align="center">2 3 8</td></tr><tr><td align="center">u</td><td align="center">4</td></tr><tr><td align="center">v</td><td align="center">5 7</td></tr><tr><td align="center">w</td><td align="center">2</td></tr><tr><td align="center">x</td><td align="center">6</td></tr><tr><td align="center">z</td><td align="center">0</td></tr></tbody></table><p>å¯ä»¥å‘ç°ï¼Œz,w,u,x,g éƒ½åªåœ¨ä¸€ä¸ªæ•°å­—ä¸­ï¼Œå³ <em>0, 2, 4, 6, 8</em> ä¸­å‡ºç°ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä¸€ä¸ªå“ˆå¸Œè¡¨ç»Ÿè®¡æ¯ä¸ªå­—æ¯å‡ºç°çš„æ¬¡æ•°ï¼Œé‚£ä¹ˆ z,w,u,x,g å‡ºç°çš„æ¬¡æ•°ï¼Œå³åˆ†åˆ«ä¸º <em>0, 2, 4, 6, 8</em> å‡ºç°çš„æ¬¡æ•°ã€‚</p><p>éšåæˆ‘ä»¬å¯ä»¥æ³¨æ„é‚£äº›åªåœ¨ä¸¤ä¸ªæ•°å­—ä¸­å‡ºç°çš„å­—ç¬¦ï¼š</p><ul><li><p>h  åªåœ¨ <em>3, 8</em> ä¸­å‡ºç°ã€‚ç”±äºæˆ‘ä»¬å·²ç»çŸ¥é“äº† <em>8</em> å‡ºç°çš„æ¬¡æ•°ï¼Œå› æ­¤å¯ä»¥è®¡ç®—å‡º <em>3</em> å‡ºç°çš„æ¬¡æ•°ã€‚</p></li><li><p>f  åªåœ¨ <em>4, 5</em> ä¸­å‡ºç°ã€‚ç”±äºæˆ‘ä»¬å·²ç»çŸ¥é“äº† <em>4</em> å‡ºç°çš„æ¬¡æ•°ï¼Œå› æ­¤å¯ä»¥è®¡ç®—å‡º <em>5</em> å‡ºç°çš„æ¬¡æ•°ã€‚</p></li><li><p>s  åªåœ¨ <em>6, 7</em> ä¸­å‡ºç°ã€‚ç”±äºæˆ‘ä»¬å·²ç»çŸ¥é“äº† <em>6</em> å‡ºç°çš„æ¬¡æ•°ï¼Œå› æ­¤å¯ä»¥è®¡ç®—å‡º <em>7</em> å‡ºç°çš„æ¬¡æ•°ã€‚</p></li></ul><p>æ­¤æ—¶ï¼Œæˆ‘ä»¬è¿˜å‰©ä¸‹ <em>1</em> å’Œ <em>9</em> çš„å‡ºç°æ¬¡æ•°æ²¡æœ‰æ±‚å‡ºï¼š</p><ul><li>o  åªåœ¨ <em>0, 1, 2, 4</em> ä¸­å‡ºç°ï¼Œç”±äºæˆ‘ä»¬å·²ç»çŸ¥é“äº† <em>0, 2, 4</em> å‡ºç°çš„æ¬¡æ•°ï¼Œå› æ­¤å¯ä»¥è®¡ç®—å‡º <em>1</em> å‡ºç°çš„æ¬¡æ•°ã€‚</li></ul><p>æœ€åçš„ <em>9</em> å°±å¯ä»¥é€šè¿‡ n,i,e ä¸­çš„ä»»ä¸€å­—ç¬¦è®¡ç®—å¾—åˆ°äº†ã€‚è¿™é‡Œæ¨èä½¿ç”¨ i  è¿›è¡Œè®¡ç®—ï¼Œå› ä¸º n åœ¨ <em>9</em> ä¸­å‡ºç°äº† <em>2</em> æ¬¡ï¼Œe åœ¨ <em>3</em> ä¸­å‡ºç°äº† <em>2</em> æ¬¡ï¼Œå®¹æ˜“åœ¨è®¡ç®—ä¸­é—æ¼ã€‚</p><p>å½“æˆ‘ä»¬ç»Ÿè®¡å®Œæ¯ä¸ªæ•°å­—å‡ºç°çš„æ¬¡æ•°åï¼Œæˆ‘ä»¬æŒ‰ç…§å‡åºå°†å®ƒä»¬è¿›è¡Œæ‹¼æ¥å³å¯ã€‚</p><p><strong>ä»£ç </strong></p><details>    <summary>C++</summary><figure class="highlight c++"><figcaption><span>[sol1-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="built_in">string</span> <span class="title">originalDigits</span><span class="params">(<span class="built_in">string</span> s)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">unordered_map</span>&lt;<span class="keyword">char</span>, <span class="keyword">int</span>&gt; c;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">char</span> ch: s) &#123;</span><br><span class="line">            ++c[ch];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; cnt(<span class="number">10</span>);</span><br><span class="line">        cnt[<span class="number">0</span>] = c[<span class="string">'z'</span>];</span><br><span class="line">        cnt[<span class="number">2</span>] = c[<span class="string">'w'</span>];</span><br><span class="line">        cnt[<span class="number">4</span>] = c[<span class="string">'u'</span>];</span><br><span class="line">        cnt[<span class="number">6</span>] = c[<span class="string">'x'</span>];</span><br><span class="line">        cnt[<span class="number">8</span>] = c[<span class="string">'g'</span>];</span><br><span class="line"></span><br><span class="line">        cnt[<span class="number">3</span>] = c[<span class="string">'h'</span>] - cnt[<span class="number">8</span>];</span><br><span class="line">        cnt[<span class="number">5</span>] = c[<span class="string">'f'</span>] - cnt[<span class="number">4</span>];</span><br><span class="line">        cnt[<span class="number">7</span>] = c[<span class="string">'s'</span>] - cnt[<span class="number">6</span>];</span><br><span class="line"></span><br><span class="line">        cnt[<span class="number">1</span>] = c[<span class="string">'o'</span>] - cnt[<span class="number">0</span>] - cnt[<span class="number">2</span>] - cnt[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">        cnt[<span class="number">9</span>] = c[<span class="string">'i'</span>] - cnt[<span class="number">5</span>] - cnt[<span class="number">6</span>] - cnt[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">        <span class="built_in">string</span> ans;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cnt[i]; ++j) &#123;</span><br><span class="line">                ans += <span class="keyword">char</span>(i + <span class="string">'0'</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[sol1-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">originalDigits</span><span class="params">(String s)</span> </span>&#123;</span><br><span class="line">        Map&lt;Character, Integer&gt; c = <span class="keyword">new</span> HashMap&lt;Character, Integer&gt;();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; s.length(); ++i) &#123;</span><br><span class="line">            <span class="keyword">char</span> ch = s.charAt(i);</span><br><span class="line">            c.put(ch, c.getOrDefault(ch, <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span>[] cnt = <span class="keyword">new</span> <span class="keyword">int</span>[<span class="number">10</span>];</span><br><span class="line">        cnt[<span class="number">0</span>] = c.getOrDefault(<span class="string">'z'</span>, <span class="number">0</span>);</span><br><span class="line">        cnt[<span class="number">2</span>] = c.getOrDefault(<span class="string">'w'</span>, <span class="number">0</span>);</span><br><span class="line">        cnt[<span class="number">4</span>] = c.getOrDefault(<span class="string">'u'</span>, <span class="number">0</span>);</span><br><span class="line">        cnt[<span class="number">6</span>] = c.getOrDefault(<span class="string">'x'</span>, <span class="number">0</span>);</span><br><span class="line">        cnt[<span class="number">8</span>] = c.getOrDefault(<span class="string">'g'</span>, <span class="number">0</span>);</span><br><span class="line"></span><br><span class="line">        cnt[<span class="number">3</span>] = c.getOrDefault(<span class="string">'h'</span>, <span class="number">0</span>) - cnt[<span class="number">8</span>];</span><br><span class="line">        cnt[<span class="number">5</span>] = c.getOrDefault(<span class="string">'f'</span>, <span class="number">0</span>) - cnt[<span class="number">4</span>];</span><br><span class="line">        cnt[<span class="number">7</span>] = c.getOrDefault(<span class="string">'s'</span>, <span class="number">0</span>) - cnt[<span class="number">6</span>];</span><br><span class="line"></span><br><span class="line">        cnt[<span class="number">1</span>] = c.getOrDefault(<span class="string">'o'</span>, <span class="number">0</span>) - cnt[<span class="number">0</span>] - cnt[<span class="number">2</span>] - cnt[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">        cnt[<span class="number">9</span>] = c.getOrDefault(<span class="string">'i'</span>, <span class="number">0</span>) - cnt[<span class="number">5</span>] - cnt[<span class="number">6</span>] - cnt[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">        StringBuffer ans = <span class="keyword">new</span> StringBuffer();</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = <span class="number">0</span>; j &lt; cnt[i]; ++j) &#123;</span><br><span class="line">                ans.append((<span class="keyword">char</span>) (i + <span class="string">'0'</span>));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> ans.toString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>C#</summary><figure class="highlight plain"><figcaption><span>[sol1-C#]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">public class Solution &#123;</span><br><span class="line">    public string OriginalDigits(string s) &#123;</span><br><span class="line">        Dictionary&lt;char, int&gt; c = new Dictionary&lt;char, int&gt;();</span><br><span class="line">        foreach (char ch in s) &#123;</span><br><span class="line">            if (!c.ContainsKey(ch)) &#123;</span><br><span class="line">                c.Add(ch, 0);</span><br><span class="line">            &#125;</span><br><span class="line">            ++c[ch];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        int[] cnt = new int[10];</span><br><span class="line">        cnt[0] = c.ContainsKey(&apos;z&apos;) ? c[&apos;z&apos;] : 0;</span><br><span class="line">        cnt[2] = c.ContainsKey(&apos;w&apos;) ? c[&apos;w&apos;] : 0;</span><br><span class="line">        cnt[4] = c.ContainsKey(&apos;u&apos;) ? c[&apos;u&apos;] : 0;</span><br><span class="line">        cnt[6] = c.ContainsKey(&apos;x&apos;) ? c[&apos;x&apos;] : 0;</span><br><span class="line">        cnt[8] = c.ContainsKey(&apos;g&apos;) ? c[&apos;g&apos;] : 0;</span><br><span class="line"></span><br><span class="line">        cnt[3] = (c.ContainsKey(&apos;h&apos;) ? c[&apos;h&apos;] : 0) - cnt[8];</span><br><span class="line">        cnt[5] = (c.ContainsKey(&apos;f&apos;) ? c[&apos;f&apos;] : 0) - cnt[4];</span><br><span class="line">        cnt[7] = (c.ContainsKey(&apos;s&apos;) ? c[&apos;s&apos;] : 0) - cnt[6];</span><br><span class="line"></span><br><span class="line">        cnt[1] = (c.ContainsKey(&apos;o&apos;) ? c[&apos;o&apos;] : 0) - cnt[0] - cnt[2] - cnt[4];</span><br><span class="line"></span><br><span class="line">        cnt[9] = (c.ContainsKey(&apos;i&apos;) ? c[&apos;i&apos;] : 0) - cnt[5] - cnt[6] - cnt[8];</span><br><span class="line"></span><br><span class="line">        StringBuilder ans = new StringBuilder();</span><br><span class="line">        for (int i = 0; i &lt; 10; ++i) &#123;</span><br><span class="line">            for (int j = 0; j &lt; cnt[i]; ++j) &#123;</span><br><span class="line">                ans.Append((char) (i + &apos;0&apos;));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return ans.ToString();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>Python3</summary><figure class="highlight python"><figcaption><span>[sol1-Python3]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">originalDigits</span><span class="params">(self, s: str)</span> -&gt; str:</span></span><br><span class="line">        c = Counter(s)</span><br><span class="line"></span><br><span class="line">        cnt = [<span class="number">0</span>] * <span class="number">10</span></span><br><span class="line">        cnt[<span class="number">0</span>] = c[<span class="string">"z"</span>]</span><br><span class="line">        cnt[<span class="number">2</span>] = c[<span class="string">"w"</span>]</span><br><span class="line">        cnt[<span class="number">4</span>] = c[<span class="string">"u"</span>]</span><br><span class="line">        cnt[<span class="number">6</span>] = c[<span class="string">"x"</span>]</span><br><span class="line">        cnt[<span class="number">8</span>] = c[<span class="string">"g"</span>]</span><br><span class="line"></span><br><span class="line">        cnt[<span class="number">3</span>] = c[<span class="string">"h"</span>] - cnt[<span class="number">8</span>]</span><br><span class="line">        cnt[<span class="number">5</span>] = c[<span class="string">"f"</span>] - cnt[<span class="number">4</span>]</span><br><span class="line">        cnt[<span class="number">7</span>] = c[<span class="string">"s"</span>] - cnt[<span class="number">6</span>]</span><br><span class="line">        </span><br><span class="line">        cnt[<span class="number">1</span>] = c[<span class="string">"o"</span>] - cnt[<span class="number">0</span>] - cnt[<span class="number">2</span>] - cnt[<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">        cnt[<span class="number">9</span>] = c[<span class="string">"i"</span>] - cnt[<span class="number">5</span>] - cnt[<span class="number">6</span>] - cnt[<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="string">""</span>.join(str(x) * cnt[x] <span class="keyword">for</span> x <span class="keyword">in</span> range(<span class="number">10</span>))</span><br></pre></td></tr></table></figure></details><details>    <summary>Golang</summary><figure class="highlight go"><figcaption><span>[sol1-Golang]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">originalDigits</span><span class="params">(s <span class="keyword">string</span>)</span> <span class="title">string</span></span> &#123;</span><br><span class="line">    c := <span class="keyword">map</span>[<span class="keyword">rune</span>]<span class="keyword">int</span>&#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> _, ch := <span class="keyword">range</span> s &#123;</span><br><span class="line">        c[ch]++</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    cnt := [<span class="number">10</span>]<span class="keyword">int</span>&#123;&#125;</span><br><span class="line">    cnt[<span class="number">0</span>] = c[<span class="string">'z'</span>]</span><br><span class="line">    cnt[<span class="number">2</span>] = c[<span class="string">'w'</span>]</span><br><span class="line">    cnt[<span class="number">4</span>] = c[<span class="string">'u'</span>]</span><br><span class="line">    cnt[<span class="number">6</span>] = c[<span class="string">'x'</span>]</span><br><span class="line">    cnt[<span class="number">8</span>] = c[<span class="string">'g'</span>]</span><br><span class="line"></span><br><span class="line">    cnt[<span class="number">3</span>] = c[<span class="string">'h'</span>] - cnt[<span class="number">8</span>]</span><br><span class="line">    cnt[<span class="number">5</span>] = c[<span class="string">'f'</span>] - cnt[<span class="number">4</span>]</span><br><span class="line">    cnt[<span class="number">7</span>] = c[<span class="string">'s'</span>] - cnt[<span class="number">6</span>]</span><br><span class="line"></span><br><span class="line">    cnt[<span class="number">1</span>] = c[<span class="string">'o'</span>] - cnt[<span class="number">0</span>] - cnt[<span class="number">2</span>] - cnt[<span class="number">4</span>]</span><br><span class="line"></span><br><span class="line">    cnt[<span class="number">9</span>] = c[<span class="string">'i'</span>] - cnt[<span class="number">5</span>] - cnt[<span class="number">6</span>] - cnt[<span class="number">8</span>]</span><br><span class="line"></span><br><span class="line">    ans := []<span class="keyword">byte</span>&#123;&#125;</span><br><span class="line">    <span class="keyword">for</span> i, c := <span class="keyword">range</span> cnt &#123;</span><br><span class="line">        ans = <span class="built_in">append</span>(ans, bytes.Repeat([]<span class="keyword">byte</span>&#123;<span class="keyword">byte</span>(<span class="string">'0'</span> + i)&#125;, c)...)</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">string</span>(ans)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>JavaScript</summary><figure class="highlight javascript"><figcaption><span>[sol1-JavaScript]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> originalDigits = <span class="function"><span class="keyword">function</span>(<span class="params">s</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> c = <span class="keyword">new</span> <span class="built_in">Map</span>();</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> ch <span class="keyword">of</span> s) &#123;</span><br><span class="line">        c.set(ch, (c.get(ch) || <span class="number">0</span>) + <span class="number">1</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> cnt = <span class="keyword">new</span> <span class="built_in">Array</span>(<span class="number">10</span>).fill(<span class="number">0</span>);</span><br><span class="line">    cnt[<span class="number">0</span>] = c.get(<span class="string">'z'</span>) || <span class="number">0</span>;</span><br><span class="line">    cnt[<span class="number">2</span>] = c.get(<span class="string">'w'</span>) || <span class="number">0</span>;</span><br><span class="line">    cnt[<span class="number">4</span>] = c.get(<span class="string">'u'</span>) || <span class="number">0</span>;</span><br><span class="line">    cnt[<span class="number">6</span>] = c.get(<span class="string">'x'</span>) || <span class="number">0</span>;</span><br><span class="line">    cnt[<span class="number">8</span>] = c.get(<span class="string">'g'</span>) || <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">    cnt[<span class="number">3</span>] = (c.get(<span class="string">'h'</span>) || <span class="number">0</span>) - cnt[<span class="number">8</span>];</span><br><span class="line">    cnt[<span class="number">5</span>] = (c.get(<span class="string">'f'</span>) || <span class="number">0</span>) - cnt[<span class="number">4</span>];</span><br><span class="line">    cnt[<span class="number">7</span>] = (c.get(<span class="string">'s'</span>) || <span class="number">0</span>) - cnt[<span class="number">6</span>];</span><br><span class="line"></span><br><span class="line">    cnt[<span class="number">1</span>] = (c.get(<span class="string">'o'</span>) || <span class="number">0</span>) - cnt[<span class="number">0</span>] - cnt[<span class="number">2</span>] - cnt[<span class="number">4</span>];</span><br><span class="line"></span><br><span class="line">    cnt[<span class="number">9</span>] = (c.get(<span class="string">'i'</span>) || <span class="number">0</span>) - cnt[<span class="number">5</span>] - cnt[<span class="number">6</span>] - cnt[<span class="number">8</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> ans = [];</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; cnt[i]; ++j) &#123;</span><br><span class="line">            ans.push(<span class="built_in">String</span>.fromCharCode(i + <span class="string">'0'</span>.charCodeAt()));</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ans.join(<span class="string">''</span>);</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><h1 id="æ–¹æ³•äºŒï¼šçº¿æ€§ä»£æ•°-2"><a href="#æ–¹æ³•äºŒï¼šçº¿æ€§ä»£æ•°-2" class="headerlink" title="æ–¹æ³•äºŒï¼šçº¿æ€§ä»£æ•°^2"></a>æ–¹æ³•äºŒï¼šçº¿æ€§ä»£æ•°<a href="https://leetcode-cn.com/problems/reconstruct-original-digits-from-english/solution/jian-dan-de-xian-xing-dai-shu-kuai-lai-f-6e01/" target="_blank" rel="noopener">^2</a></h1><h2 id="æç¤º"><a href="#æç¤º" class="headerlink" title="æç¤º"></a>æç¤º</h2><p>å·²çŸ¥æ‰€æœ‰å­—ç¬¦åªèƒ½æœ‰<code>chs = [&quot;e&quot;,&quot;g&quot;,&quot;f&quot;,&quot;i&quot;,&quot;h&quot;,&quot;o&quot;,&quot;n&quot;,&quot;s&quot;,&quot;r&quot;,&quot;u&quot;,&quot;t&quot;,&quot;w&quot;,&quot;v&quot;,&quot;x&quot;,&quot;z&quot;]</code>è¿™15ä¸ªå­—ç¬¦ï¼ˆè¿™å¤§å¤§æ–¹ä¾¿äº†æˆ‘ä»¬æ‰‹ç®—å¢å¹¿çŸ©é˜µğŸ˜­ï¼‰</p><p>ä¸”æ„æˆçš„æ•°å­—ä¸º0åˆ°9</p><ul><li>å»ºä¸€ä¸ª<code>15Ã—10</code>çš„çŸ©é˜µ<code>A</code>,å¯ä»¥è®¤ä¸ºAæ˜¯ä¸€ä¸ª<strong>è¯å‘é‡çŸ©é˜µ</strong>ï¼Œç¬¬<code>i</code>è¡Œè¡¨ç¤ºå¯¹åº”çš„å­—ç¬¦<code>chs[i]</code>ï¼Œæ¯”å¦‚ç¬¬0è¡Œå¯¹åº”å­—ç¬¦â€eâ€ï¼›ç¬¬<code>j</code>åˆ—å‘é‡è¡¨ç¤ºæ•°å­—<code>j</code>ï¼Œæ¯”å¦‚ç¬¬0åˆ—è¡¨ç¤ºæ•°å­—0ï¼Œå¯¹åº”çš„å•è¯ä¸ºâ€zeroâ€, å…¶åˆ—å‘é‡è®°ä¸º<code>[1, 0, 0, 0, 0, 1, 0, 0, 1, 0, 0, 0, 0, 0, 1]</code>ã€‚</li><li>ç»™å®šå•è¯è¡¨èŒƒå›´çŸ©é˜µ<code>A</code>å°±å›ºå®šä¸‹æ¥ï¼Œä¸ä¼šå˜äº†ï¼Œä¸é¢˜ç›®ç»™å‡ºçš„å­—ç¬¦ä¸²æ— å…³</li><li>æ„å»º<code>10Ã—1</code>çš„åˆ—å‘é‡<code>X = [n0,n1,...,n9]</code>ï¼Œ<code>X[i]</code>å°±è¡¨ç¤ºæ•°å­—<code>i</code>æœ‰å¤šå°‘ä¸ª</li><li>å°±æœ‰è¿™æ ·çŸ©é˜µæ–¹ç¨‹<code>AX = b</code>ï¼Œå…¶ä¸­<code>b</code>å°±æ˜¯ç»™å‡ºå­—ç¬¦ä¸²çš„å­—ç¬¦ç»Ÿè®¡ï¼ˆä¹Ÿæ˜¯ä¸€ä¸ª<strong>åˆ—å‘é‡</strong>ï¼‰,<code>b[i]</code>è¡¨ç¤º<code>s</code>ä¸­<code>chs[i]</code>çš„ä¸ªæ•°</li><li>é‚£ä¹ˆæˆ‘ä»¬çš„ä»»åŠ¡å°±æ˜¯æ±‚è§£<code>AX = b</code>ï¼Œæ±‚è§£ä¸€ä¸ªéé½æ¬¡çº¿æ€§æ–¹ç¨‹</li></ul><h2 id="è®¡ç®—AçŸ©é˜µ"><a href="#è®¡ç®—AçŸ©é˜µ" class="headerlink" title="è®¡ç®—AçŸ©é˜µ"></a>è®¡ç®—AçŸ©é˜µ</h2><details>    <summary>Python3</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">chs = [<span class="string">"e"</span>,<span class="string">"g"</span>,<span class="string">"f"</span>,<span class="string">"i"</span>,<span class="string">"h"</span>,<span class="string">"o"</span>,<span class="string">"n"</span>,<span class="string">"s"</span>,<span class="string">"r"</span>,<span class="string">"u"</span>,<span class="string">"t"</span>,<span class="string">"w"</span>,<span class="string">"v"</span>,<span class="string">"x"</span>,<span class="string">"z"</span>]</span><br><span class="line">num2en = [<span class="string">'zero'</span>, <span class="string">'one'</span>, <span class="string">'two'</span>, <span class="string">'three'</span>, <span class="string">'four'</span>, <span class="string">'five'</span>, <span class="string">'six'</span>, <span class="string">'seven'</span>, <span class="string">'eight'</span>, <span class="string">'nine'</span>]</span><br><span class="line">A = []</span><br><span class="line"><span class="keyword">for</span> ch <span class="keyword">in</span> chs:</span><br><span class="line">    row = []</span><br><span class="line">    <span class="keyword">for</span> en <span class="keyword">in</span> num2en:</span><br><span class="line">        row.append(en.count(ch))</span><br><span class="line">    A.append(row)</span><br><span class="line">-----------------------------------------</span><br><span class="line">A = [</span><br><span class="line">        [<span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>, <span class="number">1</span>, <span class="number">1</span>], </span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">1</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">2</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>],</span><br><span class="line">        [<span class="number">1</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>]</span><br><span class="line">]</span><br></pre></td></tr></table></figure></details><h2 id="è®¡ç®—åˆ—å‘é‡b"><a href="#è®¡ç®—åˆ—å‘é‡b" class="headerlink" title="è®¡ç®—åˆ—å‘é‡b"></a>è®¡ç®—åˆ—å‘é‡b</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">chs = [&quot;e&quot;,&quot;g&quot;,&quot;f&quot;,&quot;i&quot;,&quot;h&quot;,&quot;o&quot;,&quot;n&quot;,&quot;s&quot;,&quot;r&quot;,&quot;u&quot;,&quot;t&quot;,&quot;w&quot;,&quot;v&quot;,&quot;x&quot;,&quot;z&quot;]</span><br><span class="line">b = [s.count(ch) for ch in chs]</span><br></pre></td></tr></table></figure><p>å®é™…åœ¨æ‰‹å†™å¢å¹¿çŸ©é˜µçš„æ—¶å€™å¯ä»¥å…ˆä¸ç”¨å¸¦å…¥å€¼ï¼Œå°±ä½¿ç”¨å­—ç¬¦ç¬¦å·</p><h2 id="å¾—åˆ°å¢å¹¿çŸ©é˜µ"><a href="#å¾—åˆ°å¢å¹¿çŸ©é˜µ" class="headerlink" title="å¾—åˆ°å¢å¹¿çŸ©é˜µ"></a>å¾—åˆ°å¢å¹¿çŸ©é˜µ</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">2</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">2</span> <span class="number">1</span> <span class="number">1</span> | e</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> | g</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | f</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> | i</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> | h</span><br><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | o</span><br><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">2</span> | n</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> | s</span><br><span class="line"><span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | r</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | u</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> | t</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | w</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> | v</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | x</span><br><span class="line"><span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | z</span><br></pre></td></tr></table></figure><h2 id="è®¡ç®—å¢å¹¿çŸ©é˜µ"><a href="#è®¡ç®—å¢å¹¿çŸ©é˜µ" class="headerlink" title="è®¡ç®—å¢å¹¿çŸ©é˜µ"></a>è®¡ç®—å¢å¹¿çŸ©é˜µ</h2><p>ä½¿ç”¨<strong>åˆç­‰è¡Œå˜æ¢</strong>æŠŠå¢å¹¿çŸ©é˜µçš„ç³»æ•°çŸ©é˜µåŒ–ä¸ºé˜¶æ¢¯å‹ï¼Œå› ä¸ºé¢˜ç›®ä¿è¯äº†ã€Œsæ˜¯ä¸€ä¸ªç¬¦åˆé¢˜ç›®è¦æ±‚çš„å­—ç¬¦ä¸²ã€ï¼Œ<strong>æ‰€ä»¥ä¸€å®šæœ‰è§£ä¸”æ˜¯å”¯ä¸€è§£</strong>ã€‚</p><p>æˆ‘å·æ‡’åŒ–åˆ°10ä¸ªè¡Œå‘é‡çº¿æ€§æ— å…³å°±è¡Œäº†ï¼Œæœ€åå¢å¹¿çŸ©é˜µåŒ–ä¸ºï¼š</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">2</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">2</span> <span class="number">1</span> <span class="number">1</span> | e</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> | g</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | f</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">1</span> <span class="number">1</span> | i</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> | h</span><br><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | o - z - w - u</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> | (n - s + x - o + z + w + u) / <span class="number">2</span></span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> | s - x</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | r - z - u</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | u</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> | t - w - r + z + u</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | w</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | v - s + x</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | x</span><br><span class="line"><span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | z</span><br></pre></td></tr></table></figure><p>è°ƒæ•´ä¸ºé˜¶æ¢¯é˜µï¼ŒæŠŠå€¼ä»£å…¥å¢å¹¿çŸ©é˜µçš„å³è¾¹ï¼Œå°±å¯ä»¥æ±‚è§£å‡ºåˆ—å‘é‡<code>X</code>äº†</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | z</span><br><span class="line"><span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | o - z - w - u</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | w</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | r - z - u</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | u</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | v - s + x</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> | x</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> | s - x</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> | t - w - r + z + u</span><br><span class="line"><span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> | (n - s + x - o + z + w + u) / <span class="number">2</span></span><br></pre></td></tr></table></figure><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><details>    <summary>Python3</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">originalDigits</span><span class="params">(self, s: str)</span> -&gt; str:</span></span><br><span class="line">        cnt = Counter(s)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">"0"</span> * cnt[<span class="string">"z"</span>] + \</span><br><span class="line">               <span class="string">"1"</span> * (cnt[<span class="string">"o"</span>] - cnt[<span class="string">"z"</span>] - cnt[<span class="string">"u"</span>] - cnt[<span class="string">"w"</span>]) + \</span><br><span class="line">               <span class="string">"2"</span> * cnt[<span class="string">"w"</span>] + \</span><br><span class="line">               <span class="string">"3"</span> * (cnt[<span class="string">"r"</span>] - cnt[<span class="string">"z"</span>] - cnt[<span class="string">"u"</span>]) + \</span><br><span class="line">               <span class="string">"4"</span> * cnt[<span class="string">"u"</span>] + \</span><br><span class="line">               <span class="string">"5"</span> * (cnt[<span class="string">"v"</span>] - cnt[<span class="string">"s"</span>] + cnt[<span class="string">"x"</span>]) + \</span><br><span class="line">               <span class="string">"6"</span> * cnt[<span class="string">"x"</span>] + \</span><br><span class="line">               <span class="string">"7"</span> * (cnt[<span class="string">"s"</span>] - cnt[<span class="string">"x"</span>]) + \</span><br><span class="line">               <span class="string">"8"</span> * (cnt[<span class="string">"t"</span>] - cnt[<span class="string">"w"</span>] - cnt[<span class="string">"r"</span>] + cnt[<span class="string">"z"</span>] + cnt[<span class="string">"u"</span>]) + \</span><br><span class="line">               <span class="string">"9"</span> * ((cnt[<span class="string">"n"</span>] - cnt[<span class="string">"s"</span>] + cnt[<span class="string">"x"</span>] - cnt[<span class="string">"o"</span>] + cnt[<span class="string">"z"</span>] + cnt[<span class="string">"u"</span>] + cnt[<span class="string">"w"</span>]) // <span class="number">2</span>)</span><br></pre></td></tr></table></figure></details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² s ï¼Œå…¶ä¸­åŒ…å«å­—æ¯é¡ºåºæ‰“ä¹±çš„ç”¨è‹±æ–‡å•è¯è¡¨ç¤ºçš„è‹¥å¹²æ•°å­—ï¼ˆ0-9ï¼‰ã€‚æŒ‰ å‡åº è¿”å›åŸå§‹çš„æ•°å­—ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="Hash Table" scheme="http://yoursite.com/tags/Hash-Table/"/>
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="String" scheme="http://yoursite.com/tags/String/"/>
    
      <category term="Math" scheme="http://yoursite.com/tags/Math/"/>
    
  </entry>
  
  <entry>
    <title>JAVA å¤šçº¿ç¨‹å¹¶å‘å­¦ä¹ ç¬”è®°ï¼ˆçº¿ç¨‹ï¼Œé”ï¼Œè¿›ç¨‹è°ƒåº¦ï¼‰</title>
    <link href="http://yoursite.com/2021/12/22/JAVA%20%E5%A4%9A%E7%BA%BF%E7%A8%8B%E5%B9%B6%E5%8F%91%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E7%BA%BF%E7%A8%8B%EF%BC%8C%E9%94%81%EF%BC%8C%E8%BF%9B%E7%A8%8B%E8%B0%83%E5%BA%A6%EF%BC%89/"/>
    <id>http://yoursite.com/2021/12/22/JAVA å¤šçº¿ç¨‹å¹¶å‘å­¦ä¹ ç¬”è®°ï¼ˆçº¿ç¨‹ï¼Œé”ï¼Œè¿›ç¨‹è°ƒåº¦ï¼‰/</id>
    <published>2021-12-22T13:30:12.000Z</published>
    <updated>2021-12-29T10:06:24.095Z</updated>
    
    <content type="html"><![CDATA[<p>JAVA å¤šçº¿ç¨‹å¹¶å‘</p><a id="more"></a><p>[TOC]</p><h1 id="JAVA-çº¿ç¨‹å®ç°-åˆ›å»ºæ–¹å¼"><a href="#JAVA-çº¿ç¨‹å®ç°-åˆ›å»ºæ–¹å¼" class="headerlink" title="JAVA çº¿ç¨‹å®ç°/åˆ›å»ºæ–¹å¼"></a>JAVA çº¿ç¨‹å®ç°/åˆ›å»ºæ–¹å¼</h1><h2 id="ç»§æ‰¿-Thread-ç±»"><a href="#ç»§æ‰¿-Thread-ç±»" class="headerlink" title="ç»§æ‰¿ Thread ç±»"></a>ç»§æ‰¿ Thread ç±»</h2><p>Thread ç±»æœ¬è´¨ä¸Šæ˜¯å®ç°äº† Runnable æ¥å£çš„ä¸€ä¸ªå®ä¾‹ï¼Œä»£è¡¨ä¸€ä¸ªçº¿ç¨‹çš„å®ä¾‹ã€‚å¯åŠ¨çº¿ç¨‹çš„å”¯ä¸€æ–¹æ³•å°±æ˜¯é€šè¿‡Threadç±»çš„start()å®ä¾‹æ–¹æ³•ã€‚start()æ–¹æ³•æ˜¯ä¸€ä¸ª nativeæ–¹æ³•ï¼Œå®ƒå°†å¯åŠ¨ä¸€ä¸ªæ–°çº¿ç¨‹ï¼Œå¹¶æ‰§è¡Œ run()æ–¹æ³•ã€‚</p><details>    <summary>Thread</summary><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br></pre></td><td class="code"><pre><span class="line">    public class MyThread extends Thread &#123;</span><br><span class="line">            public void run() &#123;</span><br><span class="line">                System.out.println(&quot;MyThread.run()&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        MyThread myThread1 = new MyThread();</span><br><span class="line">        myThread1.start();</span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">&lt;/details&gt;   </span><br><span class="line"></span><br><span class="line">## å®ç° Runnable æ¥å£ã€‚</span><br><span class="line">å¦‚æœè‡ªå·±çš„ç±»å·²ç» extends å¦ä¸€ä¸ªç±»ï¼Œå°±æ— æ³•ç›´æ¥ extends Threadï¼Œæ­¤æ—¶ï¼Œå¯ä»¥å®ç°ä¸€ä¸ªRunnable æ¥å£ã€‚</span><br><span class="line"> </span><br><span class="line">&lt;details&gt;</span><br><span class="line">    &lt;summary&gt;Runnable&lt;/summary&gt;</span><br><span class="line">    </span><br><span class="line">```    </span><br><span class="line">    public class MyThread extends OtherClass implements Runnable &#123;</span><br><span class="line">            public void run() &#123;</span><br><span class="line">                System.out.println(&quot;MyThread.run()&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        //å¯åŠ¨ MyThreadï¼Œéœ€è¦é¦–å…ˆå®ä¾‹åŒ–ä¸€ä¸ª Threadï¼Œå¹¶ä¼ å…¥è‡ªå·±çš„ MyThread å®ä¾‹ï¼š</span><br><span class="line">        MyThread myThread = new MyThread();</span><br><span class="line">        Thread thread = new Thread(myThread);</span><br><span class="line">        thread.start();</span><br><span class="line">        //äº‹å®ä¸Šï¼Œå½“ä¼ å…¥ä¸€ä¸ª Runnable target å‚æ•°ç»™ Thread åï¼ŒThread çš„ run()æ–¹æ³•å°±ä¼šè°ƒç”¨</span><br><span class="line">        target.run()</span><br><span class="line">        public void run() &#123;</span><br><span class="line">            if (target != null) &#123;</span><br><span class="line">                target.run();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">``` </span><br><span class="line">&lt;/details&gt;  </span><br><span class="line"></span><br><span class="line">## ExecutorServiceã€Callable&lt;Class&gt;ã€Future æœ‰è¿”å›å€¼çº¿ç¨‹</span><br><span class="line"></span><br><span class="line">æœ‰è¿”å›å€¼çš„ä»»åŠ¡å¿…é¡»å®ç°Callableæ¥å£ï¼Œç±»ä¼¼çš„ï¼Œæ— è¿”å›å€¼çš„ä»»åŠ¡å¿…é¡» Runnable æ¥å£ã€‚æ‰§è¡ŒCallable ä»»åŠ¡åï¼Œå¯ä»¥è·å–ä¸€ä¸ª Futureçš„å¯¹è±¡ï¼Œåœ¨è¯¥å¯¹è±¡ä¸Šè°ƒç”¨ get å°±å¯ä»¥è·å–åˆ° Callable ä»»åŠ¡è¿”å›çš„ Object äº†ï¼Œå†ç»“åˆçº¿ç¨‹æ± æ¥å£ExecutorServiceå°±å¯ä»¥å®ç°ä¼ è¯´ä¸­æœ‰è¿”å›ç»“æœçš„å¤šçº¿ç¨‹äº†ã€‚</span><br><span class="line">   </span><br><span class="line">&lt;details&gt;</span><br><span class="line">    &lt;summary&gt;ExecutorService&lt;/summary&gt;</span><br><span class="line">    </span><br><span class="line">```   </span><br><span class="line">    //åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± </span><br><span class="line">        ExecutorService pool = Executors.newFixedThreadPool(taskSize);</span><br><span class="line">        // åˆ›å»ºå¤šä¸ªæœ‰è¿”å›å€¼çš„ä»»åŠ¡</span><br><span class="line">        List&lt;Future&gt; list = new ArrayList&lt;Future&gt;();</span><br><span class="line">        for (int i = 0; i &lt; taskSize; i++) &#123;</span><br><span class="line">            Callable c = new MyCallable(i + &quot; &quot;);</span><br><span class="line">            // æ‰§è¡Œä»»åŠ¡å¹¶è·å– Future å¯¹è±¡</span><br><span class="line">            Future f = pool.submit(c);</span><br><span class="line">            list.add(f);</span><br><span class="line">        &#125;</span><br><span class="line">        // å…³é—­çº¿ç¨‹æ± </span><br><span class="line">        pool.shutdown();</span><br><span class="line">        // è·å–æ‰€æœ‰å¹¶å‘ä»»åŠ¡çš„è¿è¡Œç»“æœ</span><br><span class="line">        for (Future f : list) &#123;</span><br><span class="line">            // ä» Future å¯¹è±¡ä¸Šè·å–ä»»åŠ¡çš„è¿”å›å€¼ï¼Œå¹¶è¾“å‡ºåˆ°æ§åˆ¶å°</span><br><span class="line">            System.out.println(&quot;resï¼š&quot; + f.get().toString());</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">&lt;/details&gt;  </span><br><span class="line"></span><br><span class="line">## åŸºäºçº¿ç¨‹æ± çš„æ–¹å¼</span><br><span class="line">çº¿ç¨‹å’Œæ•°æ®åº“è¿æ¥è¿™äº›èµ„æºéƒ½æ˜¯éå¸¸å®è´µçš„èµ„æºã€‚é‚£ä¹ˆæ¯æ¬¡éœ€è¦çš„æ—¶å€™åˆ›å»ºï¼Œä¸éœ€è¦çš„æ—¶å€™é”€æ¯ï¼Œæ˜¯éå¸¸æµªè´¹èµ„æºçš„ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ç¼“å­˜çš„ç­–ç•¥ï¼Œä¹Ÿå°±æ˜¯ä½¿ç”¨çº¿ç¨‹æ± ã€‚</span><br><span class="line"></span><br><span class="line">&lt;details&gt;</span><br><span class="line">    &lt;summary&gt;åŸºäºçº¿ç¨‹æ± çš„æ–¹å¼&lt;/summary&gt;</span><br><span class="line">    </span><br><span class="line">```  </span><br><span class="line">      // åˆ›å»ºçº¿ç¨‹æ± </span><br><span class="line">        ExecutorService threadPool = Executors.newFixedThreadPool(10);</span><br><span class="line">        while(true) &#123;</span><br><span class="line">            threadPool.execute(new Runnable() &#123; // æäº¤å¤šä¸ªçº¿ç¨‹ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œ</span><br><span class="line">                @Override</span><br><span class="line">                public void run() &#123;</span><br><span class="line">                    System.out.println(Thread.currentThread().getName() + &quot; is running ..&quot;);</span><br><span class="line">                    try &#123;</span><br><span class="line">                        Thread.sleep(3000);</span><br><span class="line">                    &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                        e.printStackTrace();</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">&lt;/details&gt;  </span><br><span class="line"></span><br><span class="line"># 4 ç§çº¿ç¨‹æ± </span><br><span class="line">Java é‡Œé¢çº¿ç¨‹æ± çš„é¡¶çº§æ¥å£æ˜¯ Executorï¼Œä½†æ˜¯ä¸¥æ ¼æ„ä¹‰ä¸Šè®² Executor å¹¶ä¸æ˜¯ä¸€ä¸ªçº¿ç¨‹æ± ï¼Œè€Œåªæ˜¯ä¸€ä¸ªæ‰§è¡Œçº¿ç¨‹çš„å·¥å…·ã€‚çœŸæ­£çš„çº¿ç¨‹æ± æ¥å£æ˜¯ ExecutorServiceã€‚</span><br><span class="line"></span><br><span class="line">## newCachedThreadPool</span><br><span class="line">åˆ›å»ºä¸€ä¸ªå¯æ ¹æ®éœ€è¦åˆ›å»ºæ–°çº¿ç¨‹çš„çº¿ç¨‹æ± ï¼Œä½†æ˜¯åœ¨ä»¥å‰æ„é€ çš„çº¿ç¨‹å¯ç”¨æ—¶å°†é‡ç”¨å®ƒä»¬ã€‚å¯¹äºæ‰§è¡Œå¾ˆå¤šçŸ­æœŸå¼‚æ­¥ä»»åŠ¡çš„ç¨‹åºè€Œè¨€ï¼Œè¿™äº›çº¿ç¨‹æ± é€šå¸¸å¯æé«˜ç¨‹åºæ€§èƒ½ã€‚è°ƒç”¨ execute å°†é‡ç”¨ä»¥å‰æ„é€ çš„çº¿ç¨‹ï¼ˆå¦‚æœçº¿ç¨‹å¯ç”¨ï¼‰ã€‚å¦‚æœç°æœ‰çº¿ç¨‹æ²¡æœ‰å¯ç”¨çš„ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªæ–°çº¿ç¨‹å¹¶æ·»åŠ åˆ°æ± ä¸­ã€‚ç»ˆæ­¢å¹¶ä»ç¼“å­˜ä¸­ç§»é™¤é‚£äº›å·²æœ‰60ç§’é’Ÿæœªè¢«ä½¿ç”¨çš„çº¿ç¨‹ã€‚å› æ­¤ï¼Œé•¿æ—¶é—´ä¿æŒç©ºé—²çš„çº¿ç¨‹æ± ä¸ä¼šä½¿ç”¨ä»»ä½•èµ„æºã€‚</span><br><span class="line"></span><br><span class="line">## newFixedThreadPool</span><br><span class="line">åˆ›å»ºä¸€ä¸ªå¯é‡ç”¨å›ºå®šçº¿ç¨‹æ•°çš„çº¿ç¨‹æ± ï¼Œä»¥å…±äº«çš„æ— ç•Œé˜Ÿåˆ—æ–¹å¼æ¥è¿è¡Œè¿™äº›çº¿ç¨‹ã€‚åœ¨ä»»æ„ç‚¹ï¼Œåœ¨å¤§å¤šæ•°nThreadsçº¿ç¨‹ä¼šå¤„äºå¤„ç†ä»»åŠ¡çš„æ´»åŠ¨çŠ¶æ€ã€‚å¦‚æœåœ¨æ‰€æœ‰çº¿ç¨‹å¤„äºæ´»åŠ¨çŠ¶æ€æ—¶æäº¤é™„åŠ ä»»åŠ¡ï¼Œåˆ™åœ¨æœ‰å¯ç”¨çº¿ç¨‹ä¹‹å‰ï¼Œé™„åŠ ä»»åŠ¡å°†åœ¨é˜Ÿåˆ—ä¸­ç­‰å¾…ã€‚å¦‚æœåœ¨å…³é—­å‰çš„æ‰§è¡ŒæœŸé—´ç”±äºå¤±è´¥è€Œå¯¼è‡´ä»»ä½•çº¿ç¨‹ç»ˆæ­¢ï¼Œé‚£ä¹ˆä¸€ä¸ªæ–°çº¿ç¨‹å°†ä»£æ›¿å®ƒæ‰§è¡Œåç»­çš„ä»»åŠ¡ï¼ˆå¦‚æœéœ€è¦ï¼‰ã€‚åœ¨æŸä¸ªçº¿ç¨‹è¢«æ˜¾å¼åœ°å…³é—­ä¹‹å‰ï¼Œæ± ä¸­çš„çº¿ç¨‹å°†ä¸€ç›´å­˜åœ¨ã€‚</span><br><span class="line"></span><br><span class="line">## newScheduledThreadPool</span><br><span class="line">åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ± ï¼Œå®ƒå¯å®‰æ’åœ¨ç»™å®šå»¶è¿Ÿåè¿è¡Œå‘½ä»¤æˆ–è€…å®šæœŸåœ°æ‰§è¡Œã€‚</span><br><span class="line"> </span><br><span class="line">&lt;details&gt;</span><br><span class="line">    &lt;summary&gt;newScheduledThreadPool&lt;/summary&gt;</span><br><span class="line">    </span><br><span class="line">```  </span><br><span class="line">     ScheduledExecutorService scheduledThreadPool= Executors.newScheduledThreadPool(3);</span><br><span class="line">     scheduledThreadPool.schedule(newRunnable()&#123;</span><br><span class="line">         @Override</span><br><span class="line">         public void run() &#123;</span><br><span class="line">         System.out.println(&quot;å»¶è¿Ÿä¸‰ç§’&quot;);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;, 3, TimeUnit.SECONDS);</span><br><span class="line">    scheduledThreadPool.scheduleAtFixedRate(newRunnable()&#123;</span><br><span class="line">         @Override</span><br><span class="line">         public void run() &#123;</span><br><span class="line">         System.out.println(&quot;å»¶è¿Ÿ 1 ç§’åæ¯ä¸‰ç§’æ‰§è¡Œä¸€æ¬¡&quot;);</span><br><span class="line">         &#125;</span><br><span class="line">     &#125;,1,3,TimeUnit.SECONDS);</span><br><span class="line"></span><br><span class="line">``` </span><br><span class="line">&lt;/details&gt;  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## newSingleThreadExecutor</span><br><span class="line">Executors.newSingleThreadExecutor()è¿”å›ä¸€ä¸ªçº¿ç¨‹æ± ï¼ˆè¿™ä¸ªçº¿ç¨‹æ± åªæœ‰ä¸€ä¸ªçº¿ç¨‹ï¼‰,è¿™ä¸ªçº¿ç¨‹æ± å¯ä»¥åœ¨çº¿ç¨‹æ­»åï¼ˆæˆ–å‘ç”Ÿå¼‚å¸¸æ—¶ï¼‰é‡æ–°å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹æ¥æ›¿ä»£åŸæ¥çš„çº¿ç¨‹ç»§ç»­æ‰§è¡Œä¸‹å»ï¼</span><br><span class="line"></span><br><span class="line"># çº¿ç¨‹ç”Ÿå‘½å‘¨æœŸ(çŠ¶æ€)</span><br><span class="line">å½“çº¿ç¨‹è¢«åˆ›å»ºå¹¶å¯åŠ¨ä»¥åï¼Œå®ƒæ—¢ä¸æ˜¯ä¸€å¯åŠ¨å°±è¿›å…¥äº†æ‰§è¡ŒçŠ¶æ€ï¼Œä¹Ÿä¸æ˜¯ä¸€ç›´å¤„äºæ‰§è¡ŒçŠ¶æ€ã€‚åœ¨çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œå®ƒè¦ç»è¿‡æ–°å»º(New)ã€å°±ç»ªï¼ˆRunnableï¼‰ã€è¿è¡Œï¼ˆRunningï¼‰ã€é˜»å¡(Blocked)å’Œæ­»äº¡(Dead)5 ç§çŠ¶æ€ã€‚å°¤å…¶æ˜¯å½“çº¿ç¨‹å¯åŠ¨ä»¥åï¼Œå®ƒä¸å¯èƒ½ä¸€ç›´&quot;éœ¸å &quot;ç€ CPU ç‹¬è‡ªè¿è¡Œï¼Œæ‰€ä»¥CPUéœ€è¦åœ¨å¤šæ¡çº¿ç¨‹ä¹‹é—´åˆ‡æ¢ï¼Œäºæ˜¯çº¿ç¨‹çŠ¶æ€ä¹Ÿä¼šå¤šæ¬¡åœ¨è¿è¡Œã€é˜»å¡ä¹‹é—´åˆ‡æ¢</span><br><span class="line"></span><br><span class="line">## æ–°å»ºçŠ¶æ€ï¼ˆNEWï¼‰</span><br><span class="line">å½“ç¨‹åºä½¿ç”¨ newå…³é”®å­—åˆ›å»ºäº†ä¸€ä¸ªçº¿ç¨‹ä¹‹åï¼Œè¯¥çº¿ç¨‹å°±å¤„äºæ–°å»ºçŠ¶æ€ï¼Œæ­¤æ—¶ä»…ç”±JVMä¸ºå…¶åˆ†é…å†…å­˜ï¼Œå¹¶åˆå§‹åŒ–å…¶æˆå‘˜å˜é‡çš„å€¼</span><br><span class="line"></span><br><span class="line">## å°±ç»ªçŠ¶æ€ï¼ˆRUNNABLEï¼‰ï¼š</span><br><span class="line">å½“çº¿ç¨‹å¯¹è±¡è°ƒç”¨äº† start()æ–¹æ³•ä¹‹åï¼Œè¯¥çº¿ç¨‹å¤„äºå°±ç»ªçŠ¶æ€ã€‚Java è™šæ‹Ÿæœºä¼šä¸ºå…¶åˆ›å»ºæ–¹æ³•è°ƒç”¨æ ˆå’Œç¨‹åºè®¡æ•°å™¨ï¼Œç­‰å¾…è°ƒåº¦è¿è¡Œã€‚</span><br><span class="line"></span><br><span class="line">##  è¿è¡ŒçŠ¶æ€ï¼ˆRUNNINGï¼‰ï¼š</span><br><span class="line">å¦‚æœå¤„äºå°±ç»ªçŠ¶æ€çš„çº¿ç¨‹è·å¾—äº† CPUï¼Œå¼€å§‹æ‰§è¡Œ run()æ–¹æ³•çš„çº¿ç¨‹æ‰§è¡Œä½“ï¼Œåˆ™è¯¥çº¿ç¨‹å¤„äºè¿è¡ŒçŠ¶æ€ã€‚</span><br><span class="line"></span><br><span class="line">## é˜»å¡çŠ¶æ€ï¼ˆBLOCKEDï¼‰ï¼š</span><br><span class="line">é˜»å¡çŠ¶æ€æ˜¯æŒ‡çº¿ç¨‹å› ä¸ºæŸç§åŸå› æ”¾å¼ƒäº† cpu ä½¿ç”¨æƒï¼Œä¹Ÿå³è®©å‡ºäº† cpu timesliceï¼Œæš‚æ—¶åœæ­¢è¿è¡Œã€‚ç›´åˆ°çº¿ç¨‹è¿›å…¥å¯è¿è¡Œ(runnable)çŠ¶æ€ï¼Œæ‰æœ‰æœºä¼šå†æ¬¡è·å¾— cpu timeslice è½¬åˆ°è¿è¡Œ(running)çŠ¶æ€ã€‚é˜»å¡çš„æƒ…å†µåˆ†ä¸‰ç§ï¼š</span><br><span class="line"></span><br><span class="line">- ç­‰å¾…é˜»å¡ï¼ˆo.wait-&gt;ç­‰å¾…å¯¹åˆ—ï¼‰ï¼š</span><br><span class="line"></span><br><span class="line">è¿è¡Œ(running)çš„çº¿ç¨‹æ‰§è¡Œ o.wait()æ–¹æ³•ï¼ŒJVM ä¼šæŠŠè¯¥çº¿ç¨‹æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—(waitting queue)ä¸­ã€‚</span><br><span class="line"></span><br><span class="line">- åŒæ­¥é˜»å¡(lock-&gt;é”æ± )</span><br><span class="line"></span><br><span class="line">è¿è¡Œ(running)çš„çº¿ç¨‹åœ¨è·å–å¯¹è±¡çš„åŒæ­¥é”æ—¶ï¼Œè‹¥è¯¥åŒæ­¥é”è¢«åˆ«çš„çº¿ç¨‹å ç”¨ï¼Œåˆ™ JVM ä¼šæŠŠè¯¥çº¿ç¨‹æ”¾å…¥é”æ± (lock pool)ä¸­ã€‚</span><br><span class="line"></span><br><span class="line">- å…¶ä»–é˜»å¡(sleep/join)</span><br><span class="line"></span><br><span class="line">è¿è¡Œ(running)çš„çº¿ç¨‹æ‰§è¡Œ Thread.sleep(long ms)æˆ–t.join()æ–¹æ³•ï¼Œæˆ–è€…å‘å‡ºäº†I/Oè¯·æ±‚æ—¶ï¼ŒJVMä¼šæŠŠè¯¥çº¿ç¨‹ç½®ä¸ºé˜»å¡çŠ¶æ€ã€‚å½“sleep()çŠ¶æ€è¶…æ—¶ã€join()ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢æˆ–è€…è¶…æ—¶ã€æˆ–è€…I/Oå¤„ç†å®Œæ¯•æ—¶ï¼Œçº¿ç¨‹é‡æ–°è½¬å…¥å¯è¿è¡Œ(runnable)çŠ¶æ€ã€‚</span><br><span class="line">## çº¿ç¨‹æ­»äº¡ï¼ˆDEADï¼‰</span><br><span class="line">çº¿ç¨‹ä¼šä»¥ä¸‹é¢ä¸‰ç§æ–¹å¼ç»“æŸï¼Œç»“æŸåå°±æ˜¯æ­»äº¡çŠ¶æ€ã€‚</span><br><span class="line"></span><br><span class="line">- æ­£å¸¸ç»“æŸ</span><br><span class="line">1. run()æˆ– call()æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œçº¿ç¨‹æ­£å¸¸ç»“æŸã€‚</span><br><span class="line">- å¼‚å¸¸ç»“æŸ</span><br><span class="line">2. çº¿ç¨‹æŠ›å‡ºä¸€ä¸ªæœªæ•è·çš„ Exception æˆ– Errorã€‚</span><br><span class="line">- è°ƒç”¨ stop</span><br><span class="line">3. ç›´æ¥è°ƒç”¨è¯¥çº¿ç¨‹çš„ stop()æ–¹æ³•æ¥ç»“æŸè¯¥çº¿ç¨‹â€”è¯¥æ–¹æ³•é€šå¸¸å®¹æ˜“å¯¼è‡´æ­»é”ï¼Œä¸æ¨èä½¿ç”¨ã€‚</span><br><span class="line"></span><br><span class="line"># ç»ˆæ­¢çº¿ç¨‹ 4 ç§æ–¹å¼</span><br><span class="line"></span><br><span class="line">## æ­£å¸¸è¿è¡Œç»“æŸ</span><br><span class="line"> ç¨‹åºè¿è¡Œç»“æŸï¼Œçº¿ç¨‹è‡ªåŠ¨ç»“æŸã€‚</span><br><span class="line"></span><br><span class="line">## ä½¿ç”¨é€€å‡ºæ ‡å¿—é€€å‡ºçº¿ç¨‹</span><br><span class="line">ä¸€èˆ¬ run()æ–¹æ³•æ‰§è¡Œå®Œï¼Œçº¿ç¨‹å°±ä¼šæ­£å¸¸ç»“æŸï¼Œç„¶è€Œï¼Œå¸¸å¸¸æœ‰äº›çº¿ç¨‹æ˜¯ä¼ºæœçº¿ç¨‹ã€‚å®ƒä»¬éœ€è¦é•¿æ—¶é—´çš„è¿è¡Œï¼Œåªæœ‰åœ¨å¤–éƒ¨æŸäº›æ¡ä»¶æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œæ‰èƒ½å…³é—­è¿™äº›çº¿ç¨‹ã€‚ä½¿ç”¨ä¸€ä¸ªå˜é‡æ¥æ§åˆ¶å¾ªç¯ï¼Œä¾‹å¦‚ï¼šæœ€ç›´æ¥çš„æ–¹æ³•å°±æ˜¯è®¾ä¸€ä¸ª boolean ç±»å‹çš„æ ‡å¿—ï¼Œå¹¶é€šè¿‡è®¾ç½®è¿™ä¸ªæ ‡å¿—ä¸ºtrueæˆ–falseæ¥æ§åˆ¶whileå¾ªç¯æ˜¯å¦é€€å‡ºï¼Œä»£ç ç¤ºä¾‹ï¼š</span><br><span class="line"></span><br><span class="line">    public class ThreadSafe extends Thread &#123;</span><br><span class="line">         public volatile boolean exit = false;</span><br><span class="line">             public void run() &#123;</span><br><span class="line">             while (!exit)&#123;</span><br><span class="line">             //do something</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">å®šä¹‰äº†ä¸€ä¸ªé€€å‡ºæ ‡å¿— exitï¼Œå½“ exit ä¸º trueæ—¶ï¼Œwhileå¾ªç¯é€€å‡ºï¼Œexitçš„é»˜è®¤å€¼ä¸ºfalse.åœ¨å®šä¹‰exitæ—¶ï¼Œä½¿ç”¨äº†ä¸€ä¸ªJavaå…³é”®å­—volatileï¼Œè¿™ä¸ªå…³é”®å­—çš„ç›®çš„æ˜¯ä½¿ exitåŒæ­¥ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨åŒä¸€æ—¶åˆ»åªèƒ½ç”±ä¸€ä¸ªçº¿ç¨‹æ¥ä¿®æ”¹ exit çš„å€¼ã€‚</span><br><span class="line"></span><br><span class="line">## Interrupt æ–¹æ³•ç»“æŸçº¿ç¨‹</span><br><span class="line">ä½¿ç”¨ interrupt()æ–¹æ³•æ¥ä¸­æ–­çº¿ç¨‹æœ‰ä¸¤ç§æƒ…å†µï¼š</span><br><span class="line"></span><br><span class="line">1. çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ï¼š</span><br><span class="line"></span><br><span class="line">å¦‚ä½¿ç”¨äº† sleep,åŒæ­¥é”çš„wait,socketä¸­çš„receiver,acceptç­‰æ–¹æ³•æ—¶ï¼Œä¼šä½¿çº¿ç¨‹å¤„äºé˜»å¡çŠ¶æ€ã€‚å½“è°ƒç”¨çº¿ç¨‹çš„interrupt()æ–¹æ³•æ—¶ï¼Œä¼šæŠ›å‡º InterruptException å¼‚å¸¸ã€‚é˜»å¡ä¸­çš„é‚£ä¸ªæ–¹æ³•æŠ›å‡ºè¿™ä¸ªå¼‚å¸¸ï¼Œé€šè¿‡ä»£ç æ•è·è¯¥å¼‚å¸¸ï¼Œç„¶åbreakè·³å‡ºå¾ªç¯çŠ¶æ€ï¼Œä»è€Œè®©æˆ‘ä»¬æœ‰æœºä¼šç»“æŸè¿™ä¸ªçº¿ç¨‹çš„æ‰§è¡Œã€‚é€šå¸¸å¾ˆå¤šäººè®¤ä¸ºåªè¦è°ƒç”¨ interrupt æ–¹æ³•çº¿ç¨‹å°±ä¼šç»“æŸï¼Œå®é™…ä¸Šæ˜¯é”™çš„ï¼Œ ä¸€å®šè¦å…ˆæ•è· InterruptedException å¼‚å¸¸ä¹‹åé€šè¿‡ break æ¥è·³å‡ºå¾ªç¯ï¼Œæ‰èƒ½æ­£å¸¸ç»“æŸ run æ–¹æ³•ã€‚</span><br><span class="line"></span><br><span class="line">2. çº¿ç¨‹æœªå¤„äºé˜»å¡çŠ¶æ€ï¼š</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨ isInterrupted()åˆ¤æ–­çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—æ¥é€€å‡ºå¾ªç¯ã€‚å½“ä½¿ç”¨interrupt()æ–¹æ³•æ—¶ï¼Œä¸­æ–­æ ‡å¿—å°±ä¼šç½® trueï¼Œå’Œä½¿ç”¨è‡ªå®šä¹‰çš„æ ‡å¿—æ¥æ§åˆ¶å¾ªç¯æ˜¯ä¸€æ ·çš„é“ç†ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;details&gt;</span><br><span class="line">    &lt;summary&gt;isInterrupted&lt;/summary&gt;</span><br><span class="line">    </span><br><span class="line">```  </span><br><span class="line">     public class ThreadSafe extends Thread &#123;</span><br><span class="line">         public void run() &#123;</span><br><span class="line">                 while (!isInterrupted())&#123; //éé˜»å¡è¿‡ç¨‹ä¸­é€šè¿‡åˆ¤æ–­ä¸­æ–­æ ‡å¿—æ¥é€€å‡º</span><br><span class="line">                 try&#123;</span><br><span class="line">                    Thread.sleep(5*1000);//é˜»å¡è¿‡ç¨‹æ•è·ä¸­æ–­å¼‚å¸¸æ¥é€€å‡º</span><br><span class="line">                 &#125;catch(InterruptedException e)&#123;</span><br><span class="line">                     e.printStackTrace();</span><br><span class="line">                     break;//æ•è·åˆ°å¼‚å¸¸ä¹‹åï¼Œæ‰§è¡Œ break è·³å‡ºå¾ªç¯</span><br><span class="line">                 &#125;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">```  </span><br><span class="line">&lt;/details&gt;</span><br><span class="line"></span><br><span class="line">## stop æ–¹æ³•ç»ˆæ­¢çº¿ç¨‹ï¼ˆçº¿ç¨‹ä¸å®‰å…¨ï¼‰</span><br><span class="line"></span><br><span class="line">ç¨‹åºä¸­å¯ä»¥ç›´æ¥ä½¿ç”¨ thread.stop()æ¥å¼ºè¡Œç»ˆæ­¢çº¿ç¨‹ï¼Œä½†æ˜¯stopæ–¹æ³•æ˜¯å¾ˆå±é™©çš„ï¼Œå°±è±¡çªç„¶å…³é—­è®¡ç®—æœºç”µæºï¼Œè€Œä¸æ˜¯æŒ‰æ­£å¸¸ç¨‹åºå…³æœºä¸€æ ·ï¼Œå¯èƒ½ä¼šäº§ç”Ÿä¸å¯é¢„æ–™çš„ç»“æœï¼Œä¸å®‰å…¨ä¸»è¦æ˜¯ï¼šthread.stop()è°ƒç”¨ä¹‹åï¼Œåˆ›å»ºå­çº¿ç¨‹çš„çº¿ç¨‹å°±ä¼šæŠ›å‡ºThreadDeatherrorçš„é”™è¯¯ï¼Œå¹¶ä¸”ä¼šé‡Šæ”¾å­çº¿ç¨‹æ‰€æŒæœ‰çš„æ‰€æœ‰é”ã€‚ä¸€èˆ¬ä»»ä½•è¿›è¡ŒåŠ é”çš„ä»£ç å—ï¼Œéƒ½æ˜¯ä¸ºäº†ä¿æŠ¤æ•°æ®çš„ä¸€è‡´æ€§ï¼Œå¦‚æœåœ¨è°ƒç”¨thread.stop()åå¯¼è‡´äº†è¯¥çº¿ç¨‹æ‰€æŒæœ‰çš„æ‰€æœ‰é”çš„çªç„¶é‡Šæ”¾(ä¸å¯æ§åˆ¶)ï¼Œé‚£ä¹ˆè¢«ä¿æŠ¤æ•°æ®å°±æœ‰å¯èƒ½å‘ˆç°ä¸ä¸€è‡´æ€§ï¼Œå…¶ä»–çº¿ç¨‹åœ¨ä½¿ç”¨è¿™äº›è¢«ç ´åçš„æ•°æ®æ—¶ï¼Œæœ‰å¯èƒ½å¯¼è‡´ä¸€äº›å¾ˆå¥‡æ€ªçš„åº”ç”¨ç¨‹åºé”™è¯¯ã€‚å› æ­¤ï¼Œå¹¶ä¸æ¨èä½¿ç”¨ stop æ–¹æ³•æ¥ç»ˆæ­¢çº¿ç¨‹ã€‚</span><br><span class="line"></span><br><span class="line">### sleep ä¸ wait åŒºåˆ«</span><br><span class="line"></span><br><span class="line">1. å¯¹äº sleep()æ–¹æ³•ï¼Œæˆ‘ä»¬é¦–å…ˆè¦çŸ¥é“è¯¥æ–¹æ³•æ˜¯å±äº Thread ç±»ä¸­çš„ã€‚è€Œ wait()æ–¹æ³•ï¼Œåˆ™æ˜¯å±äºObject ç±»ä¸­çš„ã€‚</span><br><span class="line">2. sleep()æ–¹æ³•å¯¼è‡´äº†ç¨‹åºæš‚åœæ‰§è¡ŒæŒ‡å®šçš„æ—¶é—´ï¼Œè®©å‡º cpu è¯¥å…¶ä»–çº¿ç¨‹ï¼Œä½†æ˜¯ä»–çš„ç›‘æ§çŠ¶æ€ä¾ç„¶ä¿æŒè€…ï¼Œå½“æŒ‡å®šçš„æ—¶é—´åˆ°äº†åˆä¼šè‡ªåŠ¨æ¢å¤è¿è¡ŒçŠ¶æ€ã€‚</span><br><span class="line">3. åœ¨è°ƒç”¨ sleep()æ–¹æ³•çš„è¿‡ç¨‹ä¸­ï¼Œçº¿ç¨‹ä¸ä¼šé‡Šæ”¾å¯¹è±¡é”ã€‚</span><br><span class="line">4. è€Œå½“è°ƒç”¨ wait()æ–¹æ³•çš„æ—¶å€™ï¼Œçº¿ç¨‹ä¼šæ”¾å¼ƒå¯¹è±¡é”ï¼Œè¿›å…¥ç­‰å¾…æ­¤å¯¹è±¡çš„ç­‰å¾…é”å®šæ± ï¼Œåªæœ‰é’ˆå¯¹æ­¤å¯¹è±¡è°ƒç”¨notify()æ–¹æ³•åæœ¬çº¿ç¨‹æ‰è¿›å…¥å¯¹è±¡é”å®šæ± å‡†å¤‡è·å–å¯¹è±¡é”è¿›å…¥è¿è¡ŒçŠ¶æ€ã€‚</span><br><span class="line"></span><br><span class="line">## start ä¸ run åŒºåˆ«</span><br><span class="line">1. startï¼ˆï¼‰æ–¹æ³•æ¥å¯åŠ¨çº¿ç¨‹ï¼ŒçœŸæ­£å®ç°äº†å¤šçº¿ç¨‹è¿è¡Œã€‚è¿™æ—¶æ— éœ€ç­‰å¾… run æ–¹æ³•ä½“ä»£ç æ‰§è¡Œå®Œæ¯•ï¼Œå¯ä»¥ç›´æ¥ç»§ç»­æ‰§è¡Œä¸‹é¢çš„ä»£ç ã€‚</span><br><span class="line">2. é€šè¿‡è°ƒç”¨ Thread ç±»çš„ start()æ–¹æ³•æ¥å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œ è¿™æ—¶æ­¤çº¿ç¨‹æ˜¯å¤„äºå°±ç»ªçŠ¶æ€ï¼Œ å¹¶æ²¡æœ‰è¿è¡Œã€‚</span><br><span class="line">3. æ–¹æ³• run()ç§°ä¸ºçº¿ç¨‹ä½“ï¼Œå®ƒåŒ…å«äº†è¦æ‰§è¡Œçš„è¿™ä¸ªçº¿ç¨‹çš„å†…å®¹ï¼Œçº¿ç¨‹å°±è¿›å…¥äº†è¿è¡ŒçŠ¶æ€ï¼Œå¼€å§‹è¿è¡Œ run å‡½æ•°å½“ä¸­çš„ä»£ç ã€‚Runæ–¹æ³•è¿è¡Œç»“æŸï¼Œæ­¤çº¿ç¨‹ç»ˆæ­¢ã€‚ç„¶å CPU å†è°ƒåº¦å…¶å®ƒçº¿ç¨‹ã€‚</span><br><span class="line"></span><br><span class="line">## JAVA åå°çº¿ç¨‹</span><br><span class="line"></span><br><span class="line">1. å®šä¹‰ï¼šå®ˆæŠ¤çº¿ç¨‹--ä¹Ÿç§°â€œæœåŠ¡çº¿ç¨‹â€ï¼Œä»–æ˜¯åå°çº¿ç¨‹ï¼Œå®ƒæœ‰ä¸€ä¸ªç‰¹æ€§ï¼Œå³ä¸ºç”¨æˆ·çº¿ç¨‹ æä¾› å…¬å…±æœåŠ¡ï¼Œåœ¨æ²¡æœ‰ç”¨æˆ·çº¿ç¨‹å¯æœåŠ¡æ—¶ä¼šè‡ªåŠ¨ç¦»å¼€ã€‚</span><br><span class="line">2. ä¼˜å…ˆçº§ï¼šå®ˆæŠ¤çº¿ç¨‹çš„ä¼˜å…ˆçº§æ¯”è¾ƒä½ï¼Œç”¨äºä¸ºç³»ç»Ÿä¸­çš„å…¶å®ƒå¯¹è±¡å’Œçº¿ç¨‹æä¾›æœåŠ¡ã€‚</span><br><span class="line">3. è®¾ç½®ï¼šé€šè¿‡ setDaemon(true)æ¥è®¾ç½®çº¿ç¨‹ä¸ºâ€œå®ˆæŠ¤çº¿ç¨‹â€ï¼›å°†ä¸€ä¸ªç”¨æˆ·çº¿ç¨‹è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹çš„æ–¹å¼æ˜¯åœ¨ çº¿ç¨‹å¯¹è±¡åˆ›å»º ä¹‹å‰ ç”¨çº¿ç¨‹å¯¹è±¡çš„ setDaemon æ–¹æ³•ã€‚</span><br><span class="line">4. åœ¨ Daemon çº¿ç¨‹ä¸­äº§ç”Ÿçš„æ–°çº¿ç¨‹ä¹Ÿæ˜¯ Daemon çš„ã€‚</span><br><span class="line">5. çº¿ç¨‹åˆ™æ˜¯ JVM çº§åˆ«çš„ï¼Œä»¥ Tomcat ä¸ºä¾‹ï¼Œå¦‚æœä½ åœ¨ Web åº”ç”¨ä¸­å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹ï¼Œè¿™ä¸ªçº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå¹¶ä¸ä¼šå’ŒWebåº”ç”¨ç¨‹åºä¿æŒåŒæ­¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå³ä½¿ä½ åœæ­¢äº† Web åº”ç”¨ï¼Œè¿™ä¸ªçº¿ç¨‹ä¾æ—§æ˜¯æ´»è·ƒçš„ã€‚</span><br><span class="line">6. example: åƒåœ¾å›æ”¶çº¿ç¨‹å°±æ˜¯ä¸€ä¸ªç»å…¸çš„å®ˆæŠ¤çº¿ç¨‹ï¼Œå½“æˆ‘ä»¬çš„ç¨‹åºä¸­ä¸å†æœ‰ä»»ä½•è¿è¡Œçš„Thread,ç¨‹åºå°±ä¸ä¼šå†äº§ç”Ÿåƒåœ¾ï¼Œåƒåœ¾å›æ”¶å™¨ä¹Ÿå°±æ— äº‹å¯åšï¼Œæ‰€ä»¥å½“åƒåœ¾å›æ”¶çº¿ç¨‹æ˜¯ JVM ä¸Šä»…å‰©çš„çº¿ç¨‹æ—¶ï¼Œåƒåœ¾å›æ”¶çº¿ç¨‹ä¼šè‡ªåŠ¨ç¦»å¼€ã€‚å®ƒå§‹ç»ˆåœ¨ä½çº§åˆ«çš„çŠ¶æ€ä¸­è¿è¡Œï¼Œç”¨äºå®æ—¶ç›‘æ§å’Œç®¡ç†ç³»ç»Ÿä¸­çš„å¯å›æ”¶èµ„æºã€‚</span><br><span class="line">7. ç”Ÿå‘½å‘¨æœŸï¼šå®ˆæŠ¤è¿›ç¨‹ï¼ˆDaemonï¼‰æ˜¯è¿è¡Œåœ¨åå°çš„ä¸€ç§ç‰¹æ®Šè¿›ç¨‹ã€‚å®ƒç‹¬ç«‹äºæ§åˆ¶ç»ˆç«¯å¹¶ä¸”å‘¨æœŸæ€§åœ°æ‰§è¡ŒæŸç§ä»»åŠ¡æˆ–ç­‰å¾…å¤„ç†æŸäº›å‘ç”Ÿçš„äº‹ä»¶ã€‚ä¹Ÿå°±æ˜¯è¯´å®ˆæŠ¤çº¿ç¨‹ä¸ä¾èµ–äºç»ˆç«¯ï¼Œä½†æ˜¯ä¾èµ–äºç³»ç»Ÿï¼Œä¸ç³»ç»Ÿâ€œåŒç”Ÿå…±æ­»â€ã€‚å½“ JVM ä¸­æ‰€æœ‰çš„çº¿ç¨‹éƒ½æ˜¯å®ˆæŠ¤çº¿ç¨‹çš„æ—¶å€™ï¼ŒJVM å°±å¯ä»¥é€€å‡ºäº†ï¼›å¦‚æœè¿˜æœ‰ä¸€ä¸ªæˆ–ä»¥ä¸Šçš„éå®ˆæŠ¤çº¿ç¨‹åˆ™ JVM ä¸ä¼šé€€å‡ºã€‚</span><br><span class="line"></span><br><span class="line"># JAVA é”</span><br><span class="line">## ä¹è§‚é”</span><br><span class="line">ä¹è§‚é”æ˜¯ä¸€ç§ä¹è§‚æ€æƒ³ï¼Œå³è®¤ä¸ºè¯»å¤šå†™å°‘ï¼Œé‡åˆ°å¹¶å‘å†™çš„å¯èƒ½æ€§ä½ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¸ä¼šä¿®æ”¹ï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œé‡‡å–åœ¨å†™æ—¶å…ˆè¯»å‡ºå½“å‰ç‰ˆæœ¬å·ï¼Œç„¶ååŠ é”æ“ä½œï¼ˆæ¯”è¾ƒè·Ÿä¸Šä¸€æ¬¡çš„ç‰ˆæœ¬å·ï¼Œå¦‚æœä¸€æ ·åˆ™æ›´æ–°ï¼‰ï¼Œå¦‚æœå¤±è´¥åˆ™è¦é‡å¤è¯»-æ¯”è¾ƒ-å†™çš„æ“ä½œã€‚java ä¸­çš„ä¹è§‚é”åŸºæœ¬éƒ½æ˜¯é€šè¿‡ CAS æ“ä½œå®ç°çš„ï¼ŒCAS æ˜¯ä¸€ç§æ›´æ–°çš„åŸå­æ“ä½œï¼Œæ¯”è¾ƒå½“å‰å€¼è·Ÿä¼ å…¥å€¼æ˜¯å¦ä¸€æ ·ï¼Œä¸€æ ·åˆ™æ›´æ–°ï¼Œå¦åˆ™å¤±è´¥ã€‚</span><br><span class="line"></span><br><span class="line">## æ‚²è§‚é”</span><br><span class="line">æ‚²è§‚é”æ˜¯å°±æ˜¯æ‚²è§‚æ€æƒ³ï¼Œå³è®¤ä¸ºå†™å¤šï¼Œé‡åˆ°å¹¶å‘å†™çš„å¯èƒ½æ€§é«˜ï¼Œæ¯æ¬¡å»æ‹¿æ•°æ®çš„æ—¶å€™éƒ½è®¤ä¸ºåˆ«äººä¼šä¿®æ”¹ï¼Œæ‰€ä»¥æ¯æ¬¡åœ¨è¯»å†™æ•°æ®çš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³è¯»å†™è¿™ä¸ªæ•°æ®å°±ä¼š block ç›´åˆ°æ‹¿åˆ°é”ã€‚javaä¸­çš„æ‚²è§‚é”å°±æ˜¯Synchronized,AQSæ¡†æ¶ä¸‹çš„é”åˆ™æ˜¯å…ˆå°è¯•casä¹è§‚é”å»è·å–é”ï¼Œè·å–ä¸åˆ°ï¼Œæ‰ä¼šè½¬æ¢ä¸ºæ‚²è§‚é”ï¼Œå¦‚ RetreenLockã€‚</span><br><span class="line"></span><br><span class="line">## è‡ªæ—‹é”</span><br><span class="line">è‡ªæ—‹é”åŸç†éå¸¸ç®€å•ï¼Œå¦‚æœæŒæœ‰é”çš„çº¿ç¨‹èƒ½åœ¨å¾ˆçŸ­æ—¶é—´å†…é‡Šæ”¾é”èµ„æºï¼Œé‚£ä¹ˆé‚£äº›ç­‰å¾…ç«äº‰é”çš„çº¿ç¨‹å°±ä¸éœ€è¦åšå†…æ ¸æ€å’Œç”¨æˆ·æ€ä¹‹é—´çš„åˆ‡æ¢è¿›å…¥é˜»å¡æŒ‚èµ·çŠ¶æ€ï¼Œå®ƒä»¬åªéœ€è¦ç­‰ä¸€ç­‰ï¼ˆè‡ªæ—‹ï¼‰ï¼Œç­‰æŒæœ‰é”çš„çº¿ç¨‹é‡Šæ”¾é”åå³å¯ç«‹å³è·å–é”ï¼Œè¿™æ ·å°±é¿å…ç”¨æˆ·çº¿ç¨‹å’Œå†…æ ¸çš„åˆ‡æ¢çš„æ¶ˆè€—ã€‚</span><br><span class="line"></span><br><span class="line">çº¿ç¨‹è‡ªæ—‹æ˜¯éœ€è¦æ¶ˆè€—cpuçš„ï¼Œè¯´ç™½äº†å°±æ˜¯è®©cpuåœ¨åšæ— ç”¨åŠŸï¼Œå¦‚æœä¸€ç›´è·å–ä¸åˆ°é”ï¼Œé‚£çº¿ç¨‹ä¹Ÿä¸èƒ½ä¸€ç›´å ç”¨cpuè‡ªæ—‹åšæ— ç”¨åŠŸï¼Œæ‰€ä»¥éœ€è¦è®¾å®šä¸€ä¸ªè‡ªæ—‹ç­‰å¾…çš„æœ€å¤§æ—¶é—´ã€‚</span><br><span class="line"></span><br><span class="line">å¦‚æœæŒæœ‰é”çš„çº¿ç¨‹æ‰§è¡Œçš„æ—¶é—´è¶…è¿‡è‡ªæ—‹ç­‰å¾…çš„æœ€å¤§æ—¶é—´æ‰”æ²¡æœ‰é‡Šæ”¾é”ï¼Œå°±ä¼šå¯¼è‡´å…¶å®ƒäº‰ç”¨é”çš„çº¿ç¨‹åœ¨æœ€å¤§ç­‰å¾…æ—¶é—´å†…è¿˜æ˜¯è·å–ä¸åˆ°é”ï¼Œè¿™æ—¶äº‰ç”¨çº¿ç¨‹ä¼šåœæ­¢è‡ªæ—‹è¿›å…¥é˜»å¡çŠ¶æ€ã€‚</span><br><span class="line"></span><br><span class="line">### è‡ªæ—‹é”çš„ä¼˜ç¼ºç‚¹</span><br><span class="line">è‡ªæ—‹é”å°½å¯èƒ½çš„å‡å°‘çº¿ç¨‹çš„é˜»å¡ï¼Œè¿™å¯¹äºé”çš„ç«äº‰ä¸æ¿€çƒˆï¼Œä¸”å ç”¨é”æ—¶é—´éå¸¸çŸ­çš„ä»£ç å—æ¥è¯´æ€§èƒ½èƒ½å¤§å¹…åº¦çš„æå‡ï¼Œå› ä¸ºè‡ªæ—‹çš„æ¶ˆè€—ä¼šå°äºçº¿ç¨‹é˜»å¡æŒ‚èµ·å†å”¤é†’çš„æ“ä½œçš„æ¶ˆè€—ï¼Œè¿™äº›æ“ä½œä¼šå¯¼è‡´çº¿ç¨‹å‘ç”Ÿä¸¤æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼</span><br><span class="line"></span><br><span class="line">ä½†æ˜¯å¦‚æœé”çš„ç«äº‰æ¿€çƒˆï¼Œæˆ–è€…æŒæœ‰é”çš„çº¿ç¨‹éœ€è¦é•¿æ—¶é—´å ç”¨é”æ‰§è¡ŒåŒæ­¥å—ï¼Œè¿™æ—¶å€™å°±ä¸é€‚åˆä½¿ç”¨è‡ªæ—‹é”äº†ï¼Œå› ä¸ºè‡ªæ—‹é”åœ¨è·å–é”å‰ä¸€ç›´éƒ½æ˜¯å ç”¨cpuåšæ— ç”¨åŠŸï¼Œå ç€ XX ä¸ XXï¼ŒåŒæ—¶æœ‰å¤§é‡çº¿ç¨‹åœ¨ç«äº‰ä¸€ä¸ªé”ï¼Œä¼šå¯¼è‡´è·å–é”çš„æ—¶é—´å¾ˆé•¿ï¼Œçº¿ç¨‹è‡ªæ—‹çš„æ¶ˆè€—å¤§äºçº¿ç¨‹é˜»å¡æŒ‚èµ·æ“ä½œçš„æ¶ˆè€—ï¼Œå…¶å®ƒéœ€è¦cupçš„çº¿ç¨‹åˆä¸èƒ½è·å–åˆ°cpuï¼Œé€ æˆ cpu çš„æµªè´¹ã€‚æ‰€ä»¥è¿™ç§æƒ…å†µä¸‹æˆ‘ä»¬è¦å…³é—­è‡ªæ—‹é”ï¼›</span><br><span class="line"></span><br><span class="line">### è‡ªæ—‹é”æ—¶é—´é˜ˆå€¼ï¼ˆ1.6 å¼•å…¥äº†é€‚åº”æ€§è‡ªæ—‹é”ï¼‰</span><br><span class="line">è‡ªæ—‹é”çš„ç›®çš„æ˜¯ä¸ºäº†å ç€CPUçš„èµ„æºä¸é‡Šæ”¾ï¼Œç­‰åˆ°è·å–åˆ°é”ç«‹å³è¿›è¡Œå¤„ç†ã€‚ä½†æ˜¯å¦‚ä½•å»é€‰æ‹©è‡ªæ—‹çš„æ‰§è¡Œæ—¶é—´å‘¢ï¼Ÿå¦‚æœè‡ªæ—‹æ‰§è¡Œæ—¶é—´å¤ªé•¿ï¼Œä¼šæœ‰å¤§é‡çš„çº¿ç¨‹å¤„äºè‡ªæ—‹çŠ¶æ€å ç”¨ CPU èµ„æºï¼Œè¿›è€Œä¼šå½±å“æ•´ä½“ç³»ç»Ÿçš„æ€§èƒ½ã€‚å› æ­¤è‡ªæ—‹çš„å‘¨æœŸé€‰çš„é¢å¤–é‡è¦ï¼</span><br><span class="line"></span><br><span class="line">JVM å¯¹äºè‡ªæ—‹å‘¨æœŸçš„é€‰æ‹©ï¼Œjdk1.5 è¿™ä¸ªé™åº¦æ˜¯ä¸€å®šçš„å†™æ­»çš„ï¼Œåœ¨1.6å¼•å…¥äº†é€‚åº”æ€§è‡ªæ—‹é”ï¼Œé€‚åº”æ€§è‡ªæ—‹é”æ„å‘³ç€è‡ªæ—‹çš„æ—¶é—´ä¸å†æ˜¯å›ºå®šçš„äº†ï¼Œè€Œæ˜¯ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´ä»¥åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šï¼ŒåŸºæœ¬è®¤ä¸ºä¸€ä¸ªçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ—¶é—´æ˜¯æœ€ä½³çš„ä¸€ä¸ªæ—¶é—´ï¼ŒåŒæ—¶JVMè¿˜é’ˆå¯¹å½“å‰CPUçš„è´Ÿè·æƒ…å†µåšäº†è¾ƒå¤šçš„ä¼˜åŒ–ï¼Œå¦‚æœå¹³å‡è´Ÿè½½å°äº CPUs åˆ™ä¸€ç›´è‡ªæ—‹ï¼Œå¦‚æœæœ‰è¶…è¿‡(CPUs/2)ä¸ªçº¿ç¨‹æ­£åœ¨è‡ªæ—‹ï¼Œåˆ™åæ¥çº¿ç¨‹ç›´æ¥é˜»å¡ï¼Œå¦‚æœæ­£åœ¨è‡ªæ—‹çš„çº¿ç¨‹å‘ç° Owner å‘ç”Ÿäº†å˜åŒ–åˆ™å»¶è¿Ÿè‡ªæ—‹</span><br><span class="line">æ—¶é—´ï¼ˆè‡ªæ—‹è®¡æ•°ï¼‰æˆ–è¿›å…¥é˜»å¡ï¼Œå¦‚æœ CPU å¤„äºèŠ‚ç”µæ¨¡å¼åˆ™åœæ­¢è‡ªæ—‹ï¼Œè‡ªæ—‹æ—¶é—´çš„æœ€åæƒ…å†µæ˜¯ CPUçš„å­˜å‚¨å»¶è¿Ÿï¼ˆCPU A å­˜å‚¨äº†ä¸€ä¸ªæ•°æ®ï¼Œåˆ° CPU Bå¾—çŸ¥è¿™ä¸ªæ•°æ®ç›´æ¥çš„æ—¶é—´å·®ï¼‰ï¼Œè‡ªæ—‹æ—¶ä¼šé€‚å½“æ”¾å¼ƒçº¿ç¨‹ä¼˜å…ˆçº§ä¹‹é—´çš„å·®å¼‚ã€‚</span><br><span class="line"></span><br><span class="line">è‡ªæ—‹é”çš„å¼€å¯</span><br><span class="line">    </span><br><span class="line">    JDK1.6 ä¸­-XX:+UseSpinning å¼€å¯ï¼›</span><br><span class="line">    -XX:PreBlockSpin=10 ä¸ºè‡ªæ—‹æ¬¡æ•°ï¼›</span><br><span class="line">    JDK1.7 åï¼Œå»æ‰æ­¤å‚æ•°ï¼Œç”± jvm æ§åˆ¶ï¼›    </span><br><span class="line"></span><br><span class="line">## Synchronized åŒæ­¥é”</span><br><span class="line"></span><br><span class="line">synchronized å®ƒå¯ä»¥æŠŠä»»æ„ä¸€ä¸ªé NULL çš„å¯¹è±¡å½“ä½œé”ã€‚ä»–å±äºç‹¬å å¼çš„æ‚²è§‚é”ï¼ŒåŒæ—¶å±äºå¯é‡å…¥é”ã€‚</span><br><span class="line"></span><br><span class="line">### Synchronized ä½œç”¨èŒƒå›´</span><br><span class="line">1. ä½œç”¨äºæ–¹æ³•æ—¶ï¼Œé”ä½çš„æ˜¯å¯¹è±¡çš„å®ä¾‹(this)ï¼›</span><br><span class="line">2. å½“ä½œç”¨äºé™æ€æ–¹æ³•æ—¶ï¼Œé”ä½çš„æ˜¯Classå®ä¾‹ï¼Œåˆå› ä¸ºClassçš„ç›¸å…³æ•°æ®å­˜å‚¨åœ¨æ°¸ä¹…å¸¦PermGenï¼ˆjdk1.8åˆ™æ˜¯metaspaceï¼‰ï¼Œæ°¸ä¹…å¸¦æ˜¯å…¨å±€å…±äº«çš„ï¼Œå› æ­¤é™æ€æ–¹æ³•é”ç›¸å½“äºç±»çš„ä¸€ä¸ªå…¨å±€é”ï¼Œä¼šé”æ‰€æœ‰è°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹ï¼›</span><br><span class="line">3. synchronized ä½œç”¨äºä¸€ä¸ªå¯¹è±¡å®ä¾‹æ—¶ï¼Œé”ä½çš„æ˜¯æ‰€æœ‰ä»¥è¯¥å¯¹è±¡ä¸ºé”çš„ä»£ç å—ã€‚å®ƒæœ‰å¤šä¸ªé˜Ÿåˆ—ï¼Œå½“å¤šä¸ªçº¿ç¨‹ä¸€èµ·è®¿é—®æŸä¸ªå¯¹è±¡ç›‘è§†å™¨çš„æ—¶å€™ï¼Œå¯¹è±¡ç›‘è§†å™¨ä¼šå°†è¿™äº›çº¿ç¨‹å­˜å‚¨åœ¨ä¸åŒçš„å®¹å™¨ä¸­ã€‚</span><br><span class="line"></span><br><span class="line">### Synchronized æ ¸å¿ƒç»„ä»¶</span><br><span class="line">1) Wait Setï¼šå“ªäº›è°ƒç”¨ wait æ–¹æ³•è¢«é˜»å¡çš„çº¿ç¨‹è¢«æ”¾ç½®åœ¨è¿™é‡Œï¼›</span><br><span class="line">2) Contention Listï¼šç«äº‰é˜Ÿåˆ—ï¼Œæ‰€æœ‰è¯·æ±‚é”çš„çº¿ç¨‹é¦–å…ˆè¢«æ”¾åœ¨è¿™ä¸ªç«äº‰é˜Ÿåˆ—ä¸­ï¼›</span><br><span class="line">3) Entry Listï¼šContention List ä¸­é‚£äº›æœ‰èµ„æ ¼æˆä¸ºå€™é€‰èµ„æºçš„çº¿ç¨‹è¢«ç§»åŠ¨åˆ° Entry List ä¸­ï¼›</span><br><span class="line">4) OnDeckï¼šä»»æ„æ—¶åˆ»ï¼Œæœ€å¤šåªæœ‰ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨ç«äº‰é”èµ„æºï¼Œè¯¥çº¿ç¨‹è¢«æˆä¸º OnDeckï¼›</span><br><span class="line">5) Ownerï¼šå½“å‰å·²ç»è·å–åˆ°æ‰€èµ„æºçš„çº¿ç¨‹è¢«ç§°ä¸º Ownerï¼›</span><br><span class="line">6) !Ownerï¼šå½“å‰é‡Šæ”¾é”çš„çº¿ç¨‹ã€‚</span><br><span class="line"></span><br><span class="line">### Synchronized å®ç°</span><br><span class="line">1. JVM æ¯æ¬¡ä»é˜Ÿåˆ—çš„å°¾éƒ¨å–å‡ºä¸€ä¸ªæ•°æ®ç”¨äºé”ç«äº‰å€™é€‰è€…ï¼ˆOnDeckï¼‰ï¼Œä½†æ˜¯å¹¶å‘æƒ…å†µä¸‹ï¼ŒContentionListä¼šè¢«å¤§é‡çš„å¹¶å‘çº¿ç¨‹è¿›è¡ŒCASè®¿é—®ï¼Œä¸ºäº†é™ä½å¯¹å°¾éƒ¨å…ƒç´ çš„ç«äº‰ï¼ŒJVM ä¼šå°†ä¸€éƒ¨åˆ†çº¿ç¨‹ç§»åŠ¨åˆ° EntryList ä¸­ä½œä¸ºå€™é€‰ç«äº‰çº¿ç¨‹ã€‚</span><br><span class="line">2. Owner çº¿ç¨‹ä¼šåœ¨ unlock æ—¶ï¼Œå°† ContentionListä¸­çš„éƒ¨åˆ†çº¿ç¨‹è¿ç§»åˆ°EntryListä¸­ï¼Œå¹¶æŒ‡å®šEntryListä¸­çš„æŸä¸ªçº¿ç¨‹ä¸ºOnDeckçº¿ç¨‹ï¼ˆä¸€èˆ¬æ˜¯æœ€å…ˆè¿›å»çš„é‚£ä¸ªçº¿ç¨‹ï¼‰ã€‚</span><br><span class="line">3. Owner çº¿ç¨‹å¹¶ä¸ç›´æ¥æŠŠé”ä¼ é€’ç»™ OnDeckçº¿ç¨‹ï¼Œè€Œæ˜¯æŠŠé”ç«äº‰çš„æƒåˆ©äº¤ç»™OnDeckï¼ŒOnDeckéœ€è¦é‡æ–°ç«äº‰é”ã€‚è¿™æ ·è™½ç„¶ç‰ºç‰²äº†ä¸€äº›å…¬å¹³æ€§ï¼Œä½†æ˜¯èƒ½æå¤§çš„æå‡ç³»ç»Ÿçš„ååé‡ï¼Œåœ¨JVM ä¸­ï¼Œä¹ŸæŠŠè¿™ç§é€‰æ‹©è¡Œä¸ºç§°ä¹‹ä¸ºâ€œç«äº‰åˆ‡æ¢â€ã€‚</span><br><span class="line">4. OnDeck çº¿ç¨‹è·å–åˆ°é”èµ„æºåä¼šå˜ä¸º Owner çº¿ç¨‹ï¼Œè€Œæ²¡æœ‰å¾—åˆ°é”èµ„æºçš„ä»ç„¶åœç•™åœ¨ EntryListä¸­ã€‚å¦‚æœ Owner çº¿ç¨‹è¢« wait æ–¹æ³•é˜»å¡ï¼Œåˆ™è½¬ç§»åˆ° WaitSet é˜Ÿåˆ—ä¸­ï¼Œç›´åˆ°æŸä¸ªæ—¶åˆ»é€šè¿‡ notifyæˆ–è€… notifyAll å”¤é†’ï¼Œä¼šé‡æ–°è¿›å» EntryList ä¸­ã€‚</span><br><span class="line">5. å¤„äº ContentionListã€EntryListã€WaitSet ä¸­çš„çº¿ç¨‹éƒ½å¤„äºé˜»å¡çŠ¶æ€ï¼Œè¯¥é˜»å¡æ˜¯ç”±æ“ä½œç³»ç»Ÿæ¥å®Œæˆçš„ï¼ˆLinux å†…æ ¸ä¸‹é‡‡ç”¨ pthread_mutex_lock å†…æ ¸å‡½æ•°å®ç°çš„ï¼‰ã€‚</span><br><span class="line">6. Synchronized æ˜¯éå…¬å¹³é”ã€‚ Synchronizedåœ¨çº¿ç¨‹è¿›å…¥ContentionListæ—¶ï¼Œç­‰å¾…çš„çº¿ç¨‹ä¼šå…ˆå°è¯•è‡ªæ—‹è·å–é”ï¼Œå¦‚æœè·å–ä¸åˆ°å°±è¿›å…¥ContentionListï¼Œè¿™æ˜æ˜¾å¯¹äºå·²ç»è¿›å…¥é˜Ÿåˆ—çš„çº¿ç¨‹æ˜¯ä¸å…¬å¹³çš„ï¼Œè¿˜æœ‰ä¸€ä¸ªä¸å…¬å¹³çš„äº‹æƒ…å°±æ˜¯è‡ªæ—‹è·å–é”çš„çº¿ç¨‹è¿˜å¯èƒ½ç›´æ¥æŠ¢å  OnDeck çº¿ç¨‹çš„é”èµ„æºã€‚</span><br><span class="line">å‚è€ƒï¼šhttps://blog.csdn.net/zqz_zqz/article/details/70233767</span><br><span class="line">7. æ¯ä¸ªå¯¹è±¡éƒ½æœ‰ä¸ª monitor å¯¹è±¡ï¼ŒåŠ é”å°±æ˜¯åœ¨ç«äº‰monitorå¯¹è±¡ï¼Œä»£ç å—åŠ é”æ˜¯åœ¨å‰ååˆ†åˆ«åŠ ä¸Šmonitorenterå’ŒmonitorexitæŒ‡ä»¤æ¥å®ç°çš„ï¼Œæ–¹æ³•åŠ é”æ˜¯é€šè¿‡ä¸€ä¸ªæ ‡è®°ä½æ¥åˆ¤æ–­çš„</span><br><span class="line">8. synchronized æ˜¯ä¸€ä¸ªé‡é‡çº§æ“ä½œï¼Œéœ€è¦è°ƒç”¨æ“ä½œç³»ç»Ÿç›¸å…³æ¥å£ï¼Œæ€§èƒ½æ˜¯ä½æ•ˆçš„ï¼Œæœ‰å¯èƒ½ç»™çº¿ç¨‹åŠ é”æ¶ˆè€—çš„æ—¶é—´æ¯”æœ‰ç”¨æ“ä½œæ¶ˆè€—çš„æ—¶é—´æ›´å¤šã€‚</span><br><span class="line">9. Java1.6ï¼Œsynchronized è¿›è¡Œäº†å¾ˆå¤šçš„ä¼˜åŒ–ï¼Œæœ‰é€‚åº”è‡ªæ—‹ã€é”æ¶ˆé™¤ã€é”ç²—åŒ–ã€è½»é‡çº§é”åŠåå‘é”ç­‰ï¼Œæ•ˆç‡æœ‰äº†æœ¬è´¨ä¸Šçš„æé«˜ã€‚åœ¨ä¹‹åæ¨å‡ºçš„ Java1.7 ä¸ 1.8 ä¸­ï¼Œå‡å¯¹è¯¥å…³é”®å­—çš„å®ç°æœºç†åšäº†ä¼˜åŒ–ã€‚å¼•å…¥äº†åå‘é”å’Œè½»é‡çº§é”ã€‚éƒ½æ˜¯åœ¨å¯¹è±¡å¤´ä¸­æœ‰æ ‡è®°ä½ï¼Œä¸éœ€è¦ç»è¿‡æ“ä½œç³»ç»ŸåŠ é”ã€‚</span><br><span class="line">10. é”å¯ä»¥ä»åå‘é”å‡çº§åˆ°è½»é‡çº§é”ï¼Œå†å‡çº§åˆ°é‡é‡çº§é”ã€‚è¿™ç§å‡çº§è¿‡ç¨‹å«åšé”è†¨èƒ€ï¼›</span><br><span class="line">11. JDK 1.6 ä¸­é»˜è®¤æ˜¯å¼€å¯åå‘é”å’Œè½»é‡çº§é”ï¼Œå¯ä»¥é€šè¿‡-XX:-UseBiasedLocking æ¥ç¦ç”¨åå‘é”ã€‚</span><br><span class="line"></span><br><span class="line">## ReentrantLock</span><br><span class="line">ReentantLock ç»§æ‰¿æ¥å£ Lock å¹¶å®ç°äº†æ¥å£ä¸­å®šä¹‰çš„æ–¹æ³•ï¼Œä»–æ˜¯ä¸€ç§å¯é‡å…¥é”ï¼Œé™¤äº†èƒ½å®Œæˆsynchronizedæ‰€èƒ½å®Œæˆçš„æ‰€æœ‰å·¥ä½œå¤–ï¼Œè¿˜æä¾›äº†è¯¸å¦‚å¯å“åº”ä¸­æ–­é”ã€å¯è½®è¯¢é”è¯·æ±‚ã€å®šæ—¶é”ç­‰é¿å…å¤šçº¿ç¨‹æ­»é”çš„æ–¹æ³•ã€‚</span><br><span class="line"></span><br><span class="line">### Lock æ¥å£çš„ä¸»è¦æ–¹æ³•</span><br><span class="line"></span><br><span class="line">1. void lock(): æ‰§è¡Œæ­¤æ–¹æ³•æ—¶, å¦‚æœé”å¤„äºç©ºé—²çŠ¶æ€, å½“å‰çº¿ç¨‹å°†è·å–åˆ°é”. ç›¸å, å¦‚æœé”å·²ç»è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰, å°†ç¦ç”¨å½“å‰çº¿ç¨‹, ç›´åˆ°å½“å‰çº¿ç¨‹è·å–åˆ°é”.</span><br><span class="line">2. boolean tryLock()ï¼šå¦‚æœé”å¯ç”¨, åˆ™è·å–é”, å¹¶ç«‹å³è¿”å› true, å¦åˆ™è¿”å› false. è¯¥æ–¹æ³•å’Œlock()çš„åŒºåˆ«åœ¨äº, tryLock()åªæ˜¯&quot;è¯•å›¾&quot;è·å–é”, å¦‚æœé”ä¸å¯ç”¨, ä¸ä¼šå¯¼è‡´å½“å‰çº¿ç¨‹è¢«ç¦ç”¨,å½“å‰çº¿ç¨‹ä»ç„¶ç»§ç»­å¾€ä¸‹æ‰§è¡Œä»£ç .è€Œlock()æ–¹æ³•åˆ™æ˜¯ä¸€å®šè¦è·å–åˆ°é”,å¦‚æœé”ä¸å¯ç”¨,å°±ä¸€ç›´ç­‰å¾…,åœ¨æœªè·å¾—é”ä¹‹å‰,å½“å‰çº¿ç¨‹å¹¶ä¸ç»§ç»­å‘ä¸‹æ‰§è¡Œ.</span><br><span class="line">3. void unlock()ï¼šæ‰§è¡Œæ­¤æ–¹æ³•æ—¶, å½“å‰çº¿ç¨‹å°†é‡Šæ”¾æŒæœ‰çš„é”. é”åªèƒ½ç”±æŒæœ‰è€…é‡Šæ”¾, å¦‚æœçº¿ç¨‹å¹¶ä¸æŒæœ‰é”, å´æ‰§è¡Œè¯¥æ–¹æ³•, å¯èƒ½å¯¼è‡´å¼‚å¸¸çš„å‘ç”Ÿ.</span><br><span class="line">4. Condition newCondition()ï¼šæ¡ä»¶å¯¹è±¡ï¼Œè·å–ç­‰å¾…é€šçŸ¥ç»„ä»¶ã€‚è¯¥ç»„ä»¶å’Œå½“å‰çš„é”ç»‘å®šï¼Œå½“å‰çº¿ç¨‹åªæœ‰è·å–äº†é”ï¼Œæ‰èƒ½è°ƒç”¨è¯¥ç»„ä»¶çš„await()æ–¹æ³•ï¼Œè€Œè°ƒç”¨åï¼Œå½“å‰çº¿ç¨‹å°†ç¼©æ”¾é”ã€‚</span><br><span class="line">5. getHoldCount() ï¼šæŸ¥è¯¢å½“å‰çº¿ç¨‹ä¿æŒæ­¤é”çš„æ¬¡æ•°ï¼Œä¹Ÿå°±æ˜¯æ‰§è¡Œæ­¤çº¿ç¨‹æ‰§è¡Œ lock æ–¹æ³•çš„æ¬¡æ•°ã€‚</span><br><span class="line">6. getQueueLengthï¼ˆï¼‰ï¼šè¿”å›æ­£ç­‰å¾…è·å–æ­¤é”çš„çº¿ç¨‹ä¼°è®¡æ•°ï¼Œæ¯”å¦‚å¯åŠ¨ 10 ä¸ªçº¿ç¨‹ï¼Œ1 ä¸ªçº¿ç¨‹è·å¾—é”ï¼Œæ­¤æ—¶è¿”å›çš„æ˜¯ 9</span><br><span class="line">7. getWaitQueueLengthï¼šï¼ˆCondition conditionï¼‰è¿”å›ç­‰å¾…ä¸æ­¤é”ç›¸å…³çš„ç»™å®šæ¡ä»¶çš„çº¿ç¨‹ä¼°è®¡æ•°ã€‚æ¯”å¦‚ 10 ä¸ªçº¿ç¨‹ï¼Œç”¨åŒä¸€ä¸ª condition å¯¹è±¡ï¼Œå¹¶ä¸”æ­¤æ—¶è¿™ 10 ä¸ªçº¿ç¨‹éƒ½æ‰§è¡Œäº†condition å¯¹è±¡çš„ await æ–¹æ³•ï¼Œé‚£ä¹ˆæ­¤æ—¶æ‰§è¡Œæ­¤æ–¹æ³•è¿”å› 10</span><br><span class="line">8. hasWaiters(Condition condition)ï¼šæŸ¥è¯¢æ˜¯å¦æœ‰çº¿ç¨‹ç­‰å¾…ä¸æ­¤é”æœ‰å…³çš„ç»™å®šæ¡ä»¶(condition)ï¼Œå¯¹äºæŒ‡å®š contidion å¯¹è±¡ï¼Œæœ‰å¤šå°‘çº¿ç¨‹æ‰§è¡Œäº† condition.await æ–¹æ³•</span><br><span class="line">9. hasQueuedThread(Thread thread)ï¼šæŸ¥è¯¢ç»™å®šçº¿ç¨‹æ˜¯å¦ç­‰å¾…è·å–æ­¤é”</span><br><span class="line">10. hasQueuedThreads()ï¼šæ˜¯å¦æœ‰çº¿ç¨‹ç­‰å¾…æ­¤é”</span><br><span class="line">11. isFair()ï¼šè¯¥é”æ˜¯å¦å…¬å¹³é”</span><br><span class="line">12. isHeldByCurrentThread()ï¼š å½“å‰çº¿ç¨‹æ˜¯å¦ä¿æŒé”é”å®šï¼Œçº¿ç¨‹çš„æ‰§è¡Œ lock æ–¹æ³•çš„å‰ååˆ†åˆ«æ˜¯ false å’Œ true</span><br><span class="line">13. isLock()ï¼šæ­¤é”æ˜¯å¦æœ‰ä»»æ„çº¿ç¨‹å ç”¨</span><br><span class="line">14. lockInterruptiblyï¼ˆï¼‰ï¼šå¦‚æœå½“å‰çº¿ç¨‹æœªè¢«ä¸­æ–­ï¼Œè·å–é”</span><br><span class="line">15. tryLockï¼ˆï¼‰ï¼šå°è¯•è·å¾—é”ï¼Œä»…åœ¨è°ƒç”¨æ—¶é”æœªè¢«çº¿ç¨‹å ç”¨ï¼Œè·å¾—é”</span><br><span class="line">16. tryLock(long timeout TimeUnit unit)ï¼šå¦‚æœé”åœ¨ç»™å®šç­‰å¾…æ—¶é—´å†…æ²¡æœ‰è¢«å¦ä¸€ä¸ªçº¿ç¨‹ä¿æŒï¼Œåˆ™è·å–è¯¥é”ã€‚</span><br><span class="line"></span><br><span class="line">### éå…¬å¹³é”</span><br><span class="line">JVM æŒ‰éšæœºã€å°±è¿‘åŸåˆ™åˆ†é…é”çš„æœºåˆ¶åˆ™ç§°ä¸ºä¸å…¬å¹³é”ï¼ŒReentrantLockåœ¨æ„é€ å‡½æ•°ä¸­æä¾›äº†æ˜¯å¦å…¬å¹³é”çš„åˆå§‹åŒ–æ–¹å¼ï¼Œé»˜è®¤ä¸ºéå…¬å¹³é”ã€‚éå…¬å¹³é”å®é™…æ‰§è¡Œçš„æ•ˆç‡è¦è¿œè¿œè¶…å‡ºå…¬å¹³é”ï¼Œé™¤éç¨‹åºæœ‰ç‰¹æ®Šéœ€è¦ï¼Œå¦åˆ™æœ€å¸¸ç”¨éå…¬å¹³é”çš„åˆ†é…æœºåˆ¶ã€‚</span><br><span class="line"></span><br><span class="line">### å…¬å¹³é”</span><br><span class="line">å…¬å¹³é”æŒ‡çš„æ˜¯é”çš„åˆ†é…æœºåˆ¶æ˜¯å…¬å¹³çš„ï¼Œé€šå¸¸å…ˆå¯¹é”æå‡ºè·å–è¯·æ±‚çš„çº¿ç¨‹ä¼šå…ˆè¢«åˆ†é…åˆ°é”ï¼ŒReentrantLockåœ¨æ„é€ å‡½æ•°ä¸­æä¾›äº†æ˜¯å¦å…¬å¹³é”çš„åˆå§‹åŒ–æ–¹å¼æ¥å®šä¹‰å…¬å¹³é”ã€‚</span><br><span class="line"></span><br><span class="line">### ReentrantLock ä¸ synchronized</span><br><span class="line"></span><br><span class="line">1. ReentrantLock é€šè¿‡æ–¹æ³• lock()ä¸ unlock()æ¥è¿›è¡ŒåŠ é”ä¸è§£é”æ“ä½œï¼Œä¸synchronizedä¼šè¢«JVMè‡ªåŠ¨è§£é”æœºåˆ¶ä¸åŒï¼ŒReentrantLockåŠ é”åéœ€è¦æ‰‹åŠ¨è¿›è¡Œè§£é”ã€‚ä¸ºäº†é¿å…ç¨‹åºå‡ºç°å¼‚å¸¸è€Œæ— æ³•æ­£å¸¸è§£é”çš„æƒ…å†µï¼Œä½¿ç”¨ ReentrantLock å¿…é¡»åœ¨ finallyæ§åˆ¶å—ä¸­è¿›è¡Œè§£é”æ“ä½œã€‚</span><br><span class="line">2. ReentrantLock ç›¸æ¯” synchronized çš„ä¼˜åŠ¿æ˜¯å¯ä¸­æ–­ã€å…¬å¹³é”ã€å¤šä¸ªé”ã€‚è¿™ç§æƒ…å†µä¸‹éœ€è¦ä½¿ç”¨ ReentrantLockã€‚</span><br><span class="line"></span><br><span class="line">### ReentrantLock å®ç°</span><br><span class="line">&lt;details&gt;</span><br><span class="line">    &lt;summary&gt;ReentrantLock&lt;/summary&gt;</span><br></pre></td></tr></table></figure><p>public class MyService {<br>    private Lock lock = new ReentrantLock();<br>    //Lock lock=new ReentrantLock(true);//å…¬å¹³é”<br>    //Lock lock=new ReentrantLock(false);//éå…¬å¹³é”<br>    private Condition condition=lock.newCondition();//åˆ›å»º Condition<br>    public void testMethod() {<br>        try {<br>            lock.lock();//lock åŠ é”<br>            //1ï¼šwait æ–¹æ³•ç­‰å¾…ï¼š<br>            //System.out.println(â€œå¼€å§‹ waitâ€);<br>            condition.await();<br>            //é€šè¿‡åˆ›å»º Condition å¯¹è±¡æ¥ä½¿çº¿ç¨‹ waitï¼Œå¿…é¡»å…ˆæ‰§è¡Œ lock.lock æ–¹æ³•è·å¾—é”<br>            //:2ï¼šsignal æ–¹æ³•å”¤é†’<br>            condition.signal();//condition å¯¹è±¡çš„ signal æ–¹æ³•å¯ä»¥å”¤é†’ wait çº¿ç¨‹<br>            for (int i = 0; i &lt; 5; i++) {<br>                System.out.println(â€œThreadName=â€ + Thread.currentThread().getName()+ (â€œ â€œ + (i + 1)));<br>            }<br>        } catch (InterruptedException e) {<br>            e.printStackTrace();<br>        }<br>        finally{<br>            lock.unlock();<br>        }<br>    }<br>}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">&lt;/details&gt;</span><br><span class="line"></span><br><span class="line">### Condition ç±»å’Œ Object ç±»é”æ–¹æ³•åŒºåˆ« </span><br><span class="line">1. Condition ç±»çš„ awiat æ–¹æ³•å’Œ Object ç±»çš„ wait æ–¹æ³•ç­‰æ•ˆ</span><br><span class="line">2. Condition ç±»çš„ signal æ–¹æ³•å’Œ Object ç±»çš„ notify æ–¹æ³•ç­‰æ•ˆ</span><br><span class="line">3. Condition ç±»çš„ signalAll æ–¹æ³•å’Œ Object ç±»çš„ notifyAll æ–¹æ³•ç­‰æ•ˆ</span><br><span class="line">4. ReentrantLock ç±»å¯ä»¥å”¤é†’æŒ‡å®šæ¡ä»¶çš„çº¿ç¨‹ï¼Œè€Œ object çš„å”¤é†’æ˜¯éšæœºçš„</span><br><span class="line"></span><br><span class="line">### tryLock å’Œ lock å’Œ lockInterruptibly çš„åŒºåˆ«</span><br><span class="line">1. tryLock èƒ½è·å¾—é”å°±è¿”å› trueï¼Œä¸èƒ½å°±ç«‹å³è¿”å› falseï¼ŒtryLock(long timeout,TimeUnitunit)ï¼Œå¯ä»¥å¢åŠ æ—¶é—´é™åˆ¶ï¼Œå¦‚æœè¶…è¿‡è¯¥æ—¶é—´æ®µè¿˜æ²¡è·å¾—é”ï¼Œè¿”å› false</span><br><span class="line">2. lock èƒ½è·å¾—é”å°±è¿”å› trueï¼Œä¸èƒ½çš„è¯ä¸€ç›´ç­‰å¾…è·å¾—é”</span><br><span class="line">3. lock å’Œ lockInterruptiblyï¼Œå¦‚æœä¸¤ä¸ªçº¿ç¨‹åˆ†åˆ«æ‰§è¡Œè¿™ä¸¤ä¸ªæ–¹æ³•ï¼Œä½†æ­¤æ—¶ä¸­æ–­è¿™ä¸¤ä¸ªçº¿ç¨‹ï¼Œlock ä¸ä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œè€Œ lockInterruptibly ä¼šæŠ›å‡ºå¼‚å¸¸ã€‚</span><br><span class="line"></span><br><span class="line">## Semaphore ä¿¡å·é‡</span><br><span class="line">Semaphore æ˜¯ä¸€ç§åŸºäºè®¡æ•°çš„ä¿¡å·é‡ã€‚å®ƒå¯ä»¥è®¾å®šä¸€ä¸ªé˜ˆå€¼ï¼ŒåŸºäºæ­¤ï¼Œå¤šä¸ªçº¿ç¨‹ç«äº‰è·å–è®¸å¯ä¿¡å·ï¼Œåšå®Œè‡ªå·±çš„ç”³è¯·åå½’è¿˜ï¼Œè¶…è¿‡é˜ˆå€¼åï¼Œçº¿ç¨‹ç”³è¯·è®¸å¯ä¿¡å·å°†ä¼šè¢«é˜»å¡ã€‚Semaphore å¯ä»¥ç”¨æ¥æ„å»ºä¸€äº›å¯¹è±¡æ± ï¼Œèµ„æºæ± ä¹‹ç±»çš„ï¼Œæ¯”å¦‚æ•°æ®åº“è¿æ¥æ± </span><br><span class="line"></span><br><span class="line">### å®ç°äº’æ–¥é”ï¼ˆè®¡æ•°å™¨ä¸º 1ï¼‰</span><br><span class="line">æˆ‘ä»¬ä¹Ÿå¯ä»¥åˆ›å»ºè®¡æ•°ä¸º 1 çš„ Semaphoreï¼Œå°†å…¶ä½œä¸ºä¸€ç§ç±»ä¼¼äº’æ–¥é”çš„æœºåˆ¶ï¼Œè¿™ä¹Ÿå«äºŒå…ƒä¿¡å·é‡ï¼Œè¡¨ç¤ºä¸¤ç§äº’æ–¥çŠ¶æ€ã€‚</span><br><span class="line"></span><br><span class="line">### ä»£ç å®ç°</span><br><span class="line">å®ƒçš„ç”¨æ³•å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">&lt;details&gt;</span><br><span class="line">    &lt;summary&gt;ReentrantLock&lt;/summary&gt;</span><br></pre></td></tr></table></figure><pre><code>// åˆ›å»ºä¸€ä¸ªè®¡æ•°é˜ˆå€¼ä¸º 5 çš„ä¿¡å·é‡å¯¹è±¡// åªèƒ½ 5 ä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®Semaphore semp = new Semaphore(5);try { // ç”³è¯·è®¸å¯    semp.acquire();    try {// ä¸šåŠ¡é€»è¾‘    } catch (Exception e) {    } finally {// é‡Šæ”¾è®¸å¯        semp.release();    }} catch (InterruptedException e) {}</code></pre><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">&lt;/details&gt;</span><br><span class="line"></span><br><span class="line">### Semaphore ä¸ ReentrantLock</span><br><span class="line">Semaphore åŸºæœ¬èƒ½å®ŒæˆReentrantLockçš„æ‰€æœ‰å·¥ä½œï¼Œä½¿ç”¨æ–¹æ³•ä¹Ÿä¸ä¹‹ç±»ä¼¼ï¼Œé€šè¿‡acquire()ä¸release()æ–¹æ³•æ¥è·å¾—å’Œé‡Šæ”¾ä¸´ç•Œèµ„æºã€‚ç»å®æµ‹ï¼ŒSemaphone.acquire()æ–¹æ³•é»˜è®¤ä¸ºå¯å“åº”ä¸­æ–­é”ï¼Œä¸ReentrantLock.lockInterruptibly()ä½œç”¨æ•ˆæœä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨ç­‰å¾…ä¸´ç•Œèµ„æºçš„è¿‡ç¨‹ä¸­å¯ä»¥è¢«Thread.interrupt()æ–¹æ³•ä¸­æ–­ã€‚</span><br><span class="line"></span><br><span class="line">æ­¤å¤–ï¼ŒSemaphoreä¹Ÿå®ç°äº†å¯è½®è¯¢çš„é”è¯·æ±‚ä¸å®šæ—¶é”çš„åŠŸèƒ½ï¼Œé™¤äº†æ–¹æ³•åtryAcquireä¸tryLockä¸åŒï¼Œå…¶ä½¿ç”¨æ–¹æ³•ä¸ReentrantLockå‡ ä¹ä¸€è‡´ã€‚Semaphoreä¹Ÿæä¾›äº†å…¬å¹³ä¸éå…¬å¹³é”çš„æœºåˆ¶ï¼Œä¹Ÿå¯åœ¨æ„é€ å‡½æ•°ä¸­è¿›è¡Œè®¾å®šã€‚</span><br><span class="line"></span><br><span class="line">Semaphore çš„é”é‡Šæ”¾æ“ä½œä¹Ÿç”±æ‰‹åŠ¨è¿›è¡Œï¼Œå› æ­¤ä¸ReentrantLockä¸€æ ·ï¼Œä¸ºé¿å…çº¿ç¨‹å› æŠ›å‡ºå¼‚å¸¸è€Œæ— æ³•æ­£å¸¸é‡Šæ”¾é”çš„æƒ…å†µå‘ç”Ÿï¼Œé‡Šæ”¾é”çš„æ“ä½œä¹Ÿå¿…é¡»åœ¨finallyä»£ç å—ä¸­å®Œæˆã€‚</span><br><span class="line"></span><br><span class="line">## AtomicInteger</span><br><span class="line">é¦–å…ˆè¯´æ˜ï¼Œæ­¤å¤„ AtomicInteger ï¼Œä¸€ä¸ªæä¾›åŸå­æ“ä½œçš„ Integer çš„ç±»ï¼Œå¸¸è§çš„è¿˜æœ‰AtomicBooleanã€AtomicIntegerã€AtomicLongã€AtomicReference ç­‰ï¼Œä»–ä»¬çš„å®ç°åŸç†ç›¸åŒï¼ŒåŒºåˆ«åœ¨ä¸è¿ç®—å¯¹è±¡ç±»å‹çš„ä¸åŒã€‚ä»¤äººå…´å¥‹åœ°ï¼Œè¿˜å¯ä»¥é€šè¿‡ AtomicReference&lt;V&gt;å°†ä¸€ä¸ªå¯¹è±¡çš„æ‰€æœ‰æ“ä½œè½¬åŒ–æˆåŸå­æ“ä½œã€‚</span><br><span class="line"></span><br><span class="line">æˆ‘ä»¬çŸ¥é“ï¼Œåœ¨å¤šçº¿ç¨‹ç¨‹åºä¸­ï¼Œè¯¸å¦‚++i æˆ– i++ç­‰è¿ç®—ä¸å…·æœ‰åŸå­æ€§ï¼Œæ˜¯ä¸å®‰å…¨çš„çº¿ç¨‹æ“ä½œä¹‹ä¸€ã€‚é€šå¸¸æˆ‘ä»¬ä¼šä½¿ç”¨ synchronized å°†è¯¥æ“ä½œå˜æˆä¸€ä¸ªåŸå­æ“ä½œï¼Œä½† JVM ä¸ºæ­¤ç±»æ“ä½œç‰¹æ„æä¾›äº†ä¸€äº›åŒæ­¥ç±»ï¼Œä½¿å¾—ä½¿ç”¨æ›´æ–¹ä¾¿ï¼Œä¸”ä½¿ç¨‹åºè¿è¡Œæ•ˆç‡å˜å¾—æ›´é«˜ã€‚é€šè¿‡ç›¸å…³èµ„æ–™æ˜¾ç¤ºï¼Œé€šå¸¸AtomicIntegerçš„æ€§èƒ½æ˜¯ ReentantLock çš„å¥½å‡ å€ã€‚</span><br><span class="line"></span><br><span class="line">## å¯é‡å…¥é”ï¼ˆé€’å½’é”ï¼‰</span><br><span class="line">æœ¬æ–‡é‡Œé¢è®²çš„æ˜¯å¹¿ä¹‰ä¸Šçš„å¯é‡å…¥é”ï¼Œè€Œä¸æ˜¯å•æŒ‡ JAVA ä¸‹çš„ ReentrantLockã€‚å¯é‡å…¥é”ï¼Œä¹Ÿå«åšé€’å½’é”ï¼ŒæŒ‡çš„æ˜¯åŒä¸€çº¿ç¨‹ å¤–å±‚å‡½æ•°è·å¾—é”ä¹‹å ï¼Œå†…å±‚é€’å½’å‡½æ•°ä»ç„¶æœ‰è·å–è¯¥é”çš„ä»£ç ï¼Œä½†ä¸å—å½±å“ã€‚åœ¨ JAVA ç¯å¢ƒä¸‹ ReentrantLock å’Œ synchronized éƒ½æ˜¯ å¯é‡å…¥é”ã€‚</span><br><span class="line"></span><br><span class="line">### å¯é‡å…¥</span><br><span class="line">ä»€ä¹ˆæ˜¯ â€œå¯é‡å…¥â€ï¼Œå¯é‡å…¥å°±æ˜¯è¯´æŸä¸ªçº¿ç¨‹å·²ç»è·å¾—æŸä¸ªé”ï¼Œå¯ä»¥å†æ¬¡è·å–é”è€Œä¸ä¼šå‡ºç°æ­»é”ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">&lt;details&gt;</span><br><span class="line">    &lt;summary&gt;synchronized&lt;/summary&gt;</span><br></pre></td></tr></table></figure><p>public class Reentrant {<br>    public static void main(String[] args) {<br>        new Thread(new Runnable() {<br>            @Override<br>            public void run() {<br>                synchronized (this) {<br>                    System.out.println(â€œç¬¬1æ¬¡è·å–é”ï¼Œè¿™ä¸ªé”æ˜¯ï¼šâ€ + this);<br>                    int index = 1;<br>                    while (true) {<br>                        synchronized (this) {<br>                            System.out.println(â€œç¬¬â€ + index + â€œæ¬¡è·å–é”ï¼Œè¿™ä¸ªé”æ˜¯ï¼šâ€ + this);<br>                            index++;<br>                        }<br>                        if (index &gt; 10) {<br>                            break;<br>                        }<br>                    }<br>                }<br>            }<br>        }).start();<br>    }<br>}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;/details&gt;</span><br><span class="line"></span><br><span class="line">&lt;details&gt;</span><br><span class="line">    &lt;summary&gt;ReentrantLock&lt;/summary&gt;</span><br></pre></td></tr></table></figure><p>import java.util.Random;<br>import java.util.concurrent.locks.ReentrantLock;</p><p>public class Reentrant {<br>    public static void main(String[] args) {<br>        ReentrantLock reentrantLock = new ReentrantLock();</p><pre><code>    new Thread(new Runnable() {        @Override        public void run() {            try {                reentrantLock.lock();                System.out.println(&quot;ç¬¬1æ¬¡è·å–é”ï¼Œè¿™ä¸ªé”æ˜¯ï¼š&quot; + reentrantLock);                int index = 1;                while (true) {                    try {                        reentrantLock.lock();                        System.out.println(&quot;ç¬¬&quot; + ++index + &quot;æ¬¡è·å–é”ï¼Œè¿™ä¸ªé”æ˜¯ï¼š&quot; + reentrantLock);                        try {                            Thread.sleep(new Random().nextInt(200));                        } catch (InterruptedException e) {                            e.printStackTrace();                        }                        if (index &gt;= 10) {                            break;                        }                    } finally {                        reentrantLock.unlock();                    }                }            } finally {                reentrantLock.unlock();            }        }    }).start();}</code></pre><p>}</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br></pre></td><td class="code"><pre><span class="line">&lt;/details&gt;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">å¯ä»¥å‘ç°æ²¡å‘ç”Ÿæ­»é”ï¼Œå¯ä»¥å¤šæ¬¡è·å–ç›¸åŒçš„é”ã€‚</span><br><span class="line"></span><br><span class="line">### ReentrantLock å’Œ synchronizedåŒºåˆ«</span><br><span class="line"></span><br><span class="line">ä½¿ç”¨ReentrantLockçš„æ³¨æ„ç‚¹ReentrantLockå’Œsynchronizedä¸ä¸€æ ·ï¼Œéœ€è¦æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œæ‰€ä»¥ä½¿ç”¨ReentrantLockçš„æ—¶å€™ä¸€å®šè¦æ‰‹åŠ¨é‡Šæ”¾é”ï¼Œå¹¶ä¸”åŠ é”æ¬¡æ•°å’Œé‡Šæ”¾æ¬¡æ•°è¦ä¸€æ ·ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## å…¬å¹³é”ä¸éå…¬å¹³é”</span><br><span class="line"></span><br><span class="line">### å…¬å¹³é”ï¼ˆFairï¼‰</span><br><span class="line">åŠ é”å‰æ£€æŸ¥æ˜¯å¦æœ‰æ’é˜Ÿç­‰å¾…çš„çº¿ç¨‹ï¼Œä¼˜å…ˆæ’é˜Ÿç­‰å¾…çš„çº¿ç¨‹ï¼Œå…ˆæ¥å…ˆå¾—ã€‚</span><br><span class="line"></span><br><span class="line">### éå…¬å¹³é”ï¼ˆNonfairï¼‰</span><br><span class="line">åŠ é”æ—¶ä¸è€ƒè™‘æ’é˜Ÿç­‰å¾…é—®é¢˜ï¼Œç›´æ¥å°è¯•è·å–é”ï¼Œè·å–ä¸åˆ°è‡ªåŠ¨åˆ°é˜Ÿå°¾ç­‰å¾…ã€‚</span><br><span class="line"></span><br><span class="line">1. éå…¬å¹³é”æ€§èƒ½æ¯”å…¬å¹³é”é«˜5~10å€ï¼Œå› ä¸ºå…¬å¹³é”éœ€è¦åœ¨å¤šæ ¸çš„æƒ…å†µä¸‹ç»´æŠ¤ä¸€ä¸ªé˜Ÿåˆ—</span><br><span class="line">2. Java ä¸­çš„ synchronizedæ˜¯éå…¬å¹³é”ï¼ŒReentrantLock é»˜è®¤çš„ lock()æ–¹æ³•é‡‡ç”¨çš„æ˜¯éå…¬å¹³é”ã€‚</span><br><span class="line"></span><br><span class="line">å‚è€ƒhttps://blog.csdn.net/w8y56f/article/details/89554060</span><br><span class="line"></span><br><span class="line">## ReadWriteLock è¯»å†™é”</span><br><span class="line">ä¸ºäº†æé«˜æ€§èƒ½ï¼ŒJava æä¾›äº†è¯»å†™é”ï¼Œåœ¨è¯»çš„åœ°æ–¹ä½¿ç”¨è¯»é”ï¼Œåœ¨å†™çš„åœ°æ–¹ä½¿ç”¨å†™é”ï¼Œçµæ´»æ§åˆ¶ï¼Œå¦‚æœæ²¡æœ‰å†™é”çš„æƒ…å†µä¸‹ï¼Œè¯»æ˜¯æ— é˜»å¡çš„,åœ¨ä¸€å®šç¨‹åº¦ä¸Šæé«˜äº†ç¨‹åºçš„æ‰§è¡Œæ•ˆç‡ã€‚è¯»å†™é”åˆ†ä¸ºè¯»é”å’Œå†™é”ï¼Œå¤šä¸ªè¯»é”ä¸äº’æ–¥ï¼Œè¯»é”ä¸å†™é”äº’æ–¥ï¼Œè¿™æ˜¯ç”± jvm è‡ªå·±æ§åˆ¶çš„ï¼Œä½ åªè¦ä¸Šå¥½ç›¸åº”çš„é”å³å¯ã€‚</span><br><span class="line"></span><br><span class="line">### è¯»é”</span><br><span class="line">å¦‚æœä½ çš„ä»£ç åªè¯»æ•°æ®ï¼Œå¯ä»¥å¾ˆå¤šäººåŒæ—¶è¯»ï¼Œä½†ä¸èƒ½åŒæ—¶å†™ï¼Œé‚£å°±ä¸Šè¯»é”</span><br><span class="line"></span><br><span class="line">### å†™é”</span><br><span class="line">å¦‚æœä½ çš„ä»£ç ä¿®æ”¹æ•°æ®ï¼Œåªèƒ½æœ‰ä¸€ä¸ªäººåœ¨å†™ï¼Œä¸”ä¸èƒ½åŒæ—¶è¯»å–ï¼Œé‚£å°±ä¸Šå†™é”ã€‚æ€»ä¹‹ï¼Œè¯»çš„æ—¶å€™ä¸Šè¯»é”ï¼Œå†™çš„æ—¶å€™ä¸Šå†™é”ï¼</span><br><span class="line"></span><br><span class="line">Java ä¸­ è¯» å†™ é” æœ‰ ä¸ª æ¥ å£ java.util.concurrent.locks.ReadWriteLock ï¼Œ ä¹Ÿ æœ‰ å…· ä½“ çš„ å® ç°ReentrantReadWriteLockã€‚</span><br><span class="line"></span><br><span class="line">## å…±äº«é”å’Œç‹¬å é”</span><br><span class="line">java å¹¶å‘åŒ…æä¾›çš„åŠ é”æ¨¡å¼åˆ†ä¸ºç‹¬å é”å’Œå…±äº«é”ã€‚</span><br><span class="line"></span><br><span class="line">### ç‹¬å é”</span><br><span class="line">ç‹¬å é”æ¨¡å¼ä¸‹ï¼Œæ¯æ¬¡åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æŒæœ‰é”ï¼ŒReentrantLock å°±æ˜¯ä»¥ç‹¬å æ–¹å¼å®ç°çš„äº’æ–¥é”ã€‚</span><br><span class="line">ç‹¬å é”æ˜¯ä¸€ç§æ‚²è§‚ä¿å®ˆçš„åŠ é”ç­–ç•¥ï¼Œå®ƒé¿å…äº†è¯»/è¯»å†²çªï¼Œå¦‚æœæŸä¸ªåªè¯»çº¿ç¨‹è·å–é”ï¼Œåˆ™å…¶ä»–è¯»çº¿ç¨‹éƒ½åªèƒ½ç­‰å¾…ï¼Œè¿™ç§æƒ…å†µä¸‹å°±é™åˆ¶äº†ä¸å¿…è¦çš„å¹¶å‘æ€§ï¼Œå› ä¸ºè¯»æ“ä½œå¹¶ä¸ä¼šå½±å“æ•°æ®çš„ä¸€è‡´æ€§ã€‚</span><br><span class="line"></span><br><span class="line">### å…±äº«é”</span><br><span class="line">å…±äº«é”åˆ™å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å–é”ï¼Œå¹¶å‘è®¿é—®å…±äº«èµ„æºï¼Œå¦‚ï¼šReadWriteLockã€‚å…±äº«é”åˆ™æ˜¯ä¸€ç§ä¹è§‚é”ï¼Œå®ƒæ”¾å®½äº†åŠ é”ç­–ç•¥ï¼Œå…è®¸å¤šä¸ªæ‰§è¡Œè¯»æ“ä½œçš„çº¿ç¨‹åŒæ—¶è®¿é—®å…±äº«èµ„æºã€‚</span><br><span class="line">1. AQS çš„å†…éƒ¨ç±» Node å®šä¹‰äº†ä¸¤ä¸ªå¸¸é‡ SHARED å’Œ EXCLUSIVEï¼Œä»–ä»¬åˆ†åˆ«æ ‡è¯† AQS é˜Ÿåˆ—ä¸­ç­‰å¾…çº¿ç¨‹çš„é”è·å–æ¨¡å¼ã€‚</span><br><span class="line">2. java çš„å¹¶å‘åŒ…ä¸­æä¾›äº† ReadWriteLockï¼Œè¯»-å†™é”ã€‚å®ƒå…è®¸ä¸€ä¸ªèµ„æºå¯ä»¥è¢«å¤šä¸ªè¯»æ“ä½œè®¿é—®ï¼Œæˆ–è€…è¢«ä¸€ä¸ª å†™æ“ä½œè®¿é—®ï¼Œä½†ä¸¤è€…ä¸èƒ½åŒæ—¶è¿›è¡Œã€‚</span><br><span class="line"></span><br><span class="line">### é‡é‡çº§é”ï¼ˆMutex Lockï¼‰</span><br><span class="line">Synchronized æ˜¯é€šè¿‡å¯¹è±¡å†…éƒ¨çš„ä¸€ä¸ªå«åšç›‘è§†å™¨é”ï¼ˆmonitorï¼‰æ¥å®ç°çš„ã€‚ä½†æ˜¯ç›‘è§†å™¨é”æœ¬è´¨åˆæ˜¯ä¾èµ–äºåº•å±‚çš„æ“ä½œç³»ç»Ÿçš„MutexLockæ¥å®ç°çš„ã€‚è€Œæ“ä½œç³»ç»Ÿå®ç°çº¿ç¨‹ä¹‹é—´çš„åˆ‡æ¢è¿™å°±éœ€è¦ä»ç”¨æˆ·æ€è½¬æ¢åˆ°æ ¸å¿ƒæ€ï¼Œè¿™ä¸ªæˆæœ¬éå¸¸é«˜ï¼ŒçŠ¶æ€ä¹‹é—´çš„è½¬æ¢éœ€è¦ç›¸å¯¹æ¯”è¾ƒé•¿çš„æ—¶é—´ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆSynchronizedæ•ˆç‡ä½çš„åŸå› ã€‚å› æ­¤ï¼Œè¿™ç§ä¾èµ–äºæ“ä½œç³»ç»Ÿ Mutex Lock æ‰€å®ç°çš„é”æˆ‘ä»¬ç§°ä¹‹ä¸ºâ€œé‡é‡çº§é”â€ã€‚JDK ä¸­å¯¹ Synchronized åšçš„ç§ç§ä¼˜åŒ–ï¼Œå…¶æ ¸å¿ƒéƒ½æ˜¯ä¸ºäº†å‡å°‘è¿™ç§é‡é‡çº§é”çš„ä½¿ç”¨ã€‚</span><br><span class="line">JDK1.6 ä»¥åï¼Œä¸ºäº†å‡å°‘è·å¾—é”å’Œé‡Šæ”¾é”æ‰€å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—ï¼Œæé«˜æ€§èƒ½ï¼Œå¼•å…¥äº†â€œè½»é‡çº§é”â€å’Œâ€œåå‘é”â€ã€‚</span><br><span class="line"></span><br><span class="line">### è½»é‡çº§é”</span><br><span class="line">é”çš„çŠ¶æ€æ€»å…±æœ‰å››ç§ï¼šæ— é”çŠ¶æ€ã€åå‘é”ã€è½»é‡çº§é”å’Œé‡é‡çº§é”ã€‚</span><br><span class="line"></span><br><span class="line">#### é”å‡çº§</span><br><span class="line">éšç€é”çš„ç«äº‰ï¼Œé”å¯ä»¥ä»åå‘é”å‡çº§åˆ°è½»é‡çº§é”ï¼Œå†å‡çº§çš„é‡é‡çº§é”ï¼ˆä½†æ˜¯é”çš„å‡çº§æ˜¯å•å‘çš„ï¼Œä¹Ÿå°±æ˜¯è¯´åªèƒ½ä»ä½åˆ°é«˜å‡çº§ï¼Œä¸ä¼šå‡ºç°é”çš„é™çº§ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">â€œè½»é‡çº§â€æ˜¯ç›¸å¯¹äºä½¿ç”¨æ“ä½œç³»ç»Ÿäº’æ–¥é‡æ¥å®ç°çš„ä¼ ç»Ÿé”è€Œè¨€çš„ã€‚ä½†æ˜¯ï¼Œé¦–å…ˆéœ€è¦å¼ºè°ƒä¸€ç‚¹çš„æ˜¯ï¼Œè½»é‡çº§é”å¹¶ä¸æ˜¯ç”¨æ¥ä»£æ›¿é‡é‡çº§é”çš„ï¼Œå®ƒçš„æœ¬æ„æ˜¯åœ¨æ²¡æœ‰å¤šçº¿ç¨‹ç«äº‰çš„å‰æä¸‹ï¼Œå‡å°‘ä¼ ç»Ÿçš„é‡é‡çº§é”ä½¿ç”¨äº§ç”Ÿçš„æ€§èƒ½æ¶ˆè€—ã€‚åœ¨è§£é‡Šè½»é‡çº§é”çš„æ‰§è¡Œè¿‡ç¨‹ä¹‹å‰ï¼Œå…ˆæ˜ç™½ä¸€ç‚¹ï¼Œè½»é‡çº§é”æ‰€é€‚åº”çš„åœºæ™¯æ˜¯çº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—çš„æƒ…å†µï¼Œå¦‚æœå­˜åœ¨åŒä¸€æ—¶é—´è®¿é—®åŒä¸€é”çš„æƒ…å†µï¼Œå°±ä¼šå¯¼è‡´è½»é‡çº§é”è†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚</span><br><span class="line"></span><br><span class="line">### åå‘é”</span><br><span class="line">Hotspot çš„ä½œè€…ç»è¿‡ä»¥å¾€çš„ç ”ç©¶å‘ç°å¤§å¤šæ•°æƒ…å†µä¸‹é”ä¸ä»…ä¸å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰ï¼Œè€Œä¸”æ€»æ˜¯ç”±åŒä¸€çº¿ç¨‹å¤šæ¬¡è·å¾—ã€‚åå‘é”çš„ç›®çš„æ˜¯åœ¨æŸä¸ªçº¿ç¨‹è·å¾—é”ä¹‹åï¼Œæ¶ˆé™¤è¿™ä¸ªçº¿ç¨‹é”é‡å…¥ï¼ˆCASï¼‰çš„å¼€é”€ï¼Œçœ‹èµ·æ¥è®©è¿™ä¸ªçº¿ç¨‹å¾—åˆ°äº†åæŠ¤ã€‚å¼•å…¥åå‘é”æ˜¯ä¸ºäº†åœ¨æ— å¤šçº¿ç¨‹ç«äº‰çš„æƒ…å†µä¸‹å°½é‡å‡å°‘ä¸å¿…è¦çš„è½»é‡çº§é”æ‰§è¡Œè·¯å¾„ï¼Œå› ä¸ºè½»é‡çº§é”çš„è·å–åŠé‡Šæ”¾ä¾èµ–å¤šæ¬¡ CAS åŸå­æŒ‡ä»¤ï¼Œè€Œåå‘é”åªéœ€è¦åœ¨ç½®æ¢ThreadID çš„æ—¶å€™ä¾èµ–ä¸€æ¬¡ CAS åŸå­æŒ‡ä»¤ï¼ˆç”±äºä¸€æ—¦å‡ºç°å¤šçº¿ç¨‹ç«äº‰çš„æƒ…å†µå°±å¿…é¡»æ’¤é”€åå‘é”ï¼Œæ‰€</span><br><span class="line">ä»¥åå‘é”çš„æ’¤é”€æ“ä½œçš„æ€§èƒ½æŸè€—å¿…é¡»å°äºèŠ‚çœä¸‹æ¥çš„CASåŸå­æŒ‡ä»¤çš„æ€§èƒ½æ¶ˆè€—ï¼‰ã€‚ä¸Šé¢è¯´è¿‡ï¼Œè½»é‡çº§é”æ˜¯ä¸ºäº†åœ¨çº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—æ—¶æé«˜æ€§èƒ½ï¼Œè€Œåå‘é”åˆ™æ˜¯åœ¨åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥å—æ—¶è¿›ä¸€æ­¥æé«˜æ€§èƒ½ã€‚</span><br><span class="line"></span><br><span class="line">### åˆ†æ®µé”</span><br><span class="line">åˆ†æ®µé”ä¹Ÿå¹¶éä¸€ç§å®é™…çš„é”ï¼Œè€Œæ˜¯ä¸€ç§æ€æƒ³ ConcurrentHashMap æ˜¯å­¦ä¹ åˆ†æ®µé”çš„æœ€å¥½å®è·µ</span><br><span class="line"></span><br><span class="line">### é”ä¼˜åŒ–</span><br><span class="line"></span><br><span class="line">#### å‡å°‘é”æŒæœ‰æ—¶é—´</span><br><span class="line">åªç”¨åœ¨æœ‰çº¿ç¨‹å®‰å…¨è¦æ±‚çš„ç¨‹åºä¸ŠåŠ é”</span><br><span class="line"></span><br><span class="line">#### å‡å°é”ç²’åº¦</span><br><span class="line">å°†å¤§å¯¹è±¡ï¼ˆè¿™ä¸ªå¯¹è±¡å¯èƒ½ä¼šè¢«å¾ˆå¤šçº¿ç¨‹è®¿é—®ï¼‰ï¼Œæ‹†æˆå°å¯¹è±¡ï¼Œå¤§å¤§å¢åŠ å¹¶è¡Œåº¦ï¼Œé™ä½é”ç«äº‰ã€‚é™ä½äº†é”çš„ç«äº‰ï¼Œåå‘é”ï¼Œè½»é‡çº§é”æˆåŠŸç‡æ‰ä¼šæé«˜ã€‚æœ€æœ€å…¸å‹çš„å‡å°é”ç²’åº¦çš„æ¡ˆä¾‹å°±æ˜¯ConcurrentHashMapã€‚</span><br><span class="line"></span><br><span class="line">#### é”åˆ†ç¦»</span><br><span class="line">æœ€å¸¸è§çš„é”åˆ†ç¦»å°±æ˜¯è¯»å†™é” ReadWriteLockï¼Œæ ¹æ®åŠŸèƒ½è¿›è¡Œåˆ†ç¦»æˆè¯»é”å’Œå†™é”ï¼Œè¿™æ ·è¯»è¯»ä¸äº’æ–¥ï¼Œè¯»å†™äº’æ–¥ï¼Œå†™å†™äº’æ–¥ï¼Œå³ä¿è¯äº†çº¿ç¨‹å®‰å…¨ï¼Œåˆæé«˜äº†æ€§èƒ½ï¼Œå…·ä½“ä¹Ÿè¯·æŸ¥çœ‹[é«˜å¹¶å‘ Java äº”]JDK å¹¶å‘åŒ… 1ã€‚è¯»å†™åˆ†ç¦»æ€æƒ³å¯ä»¥å»¶ä¼¸ï¼Œåªè¦æ“ä½œäº’ä¸å½±å“ï¼Œé”å°±å¯ä»¥åˆ†ç¦»ã€‚æ¯”å¦‚LinkedBlockingQueue ä»å¤´éƒ¨å–å‡ºï¼Œä»å°¾éƒ¨æ”¾æ•°æ®</span><br><span class="line"></span><br><span class="line">#### é”ç²—åŒ–</span><br><span class="line">é€šå¸¸æƒ…å†µä¸‹ï¼Œä¸ºäº†ä¿è¯å¤šçº¿ç¨‹é—´çš„æœ‰æ•ˆå¹¶å‘ï¼Œä¼šè¦æ±‚æ¯ä¸ªçº¿ç¨‹æŒæœ‰é”çš„æ—¶é—´å°½é‡çŸ­ï¼Œå³åœ¨ä½¿ç”¨å®Œå…¬å…±èµ„æºåï¼Œåº”è¯¥ç«‹å³é‡Šæ”¾é”ã€‚ä½†æ˜¯ï¼Œå‡¡äº‹éƒ½æœ‰ä¸€ä¸ªåº¦ï¼Œå¦‚æœå¯¹åŒä¸€ä¸ªé”ä¸åœçš„è¿›è¡Œè¯·æ±‚ã€åŒæ­¥å’Œé‡Šæ”¾ï¼Œå…¶æœ¬èº«ä¹Ÿä¼šæ¶ˆè€—ç³»ç»Ÿå®è´µçš„èµ„æºï¼Œåè€Œä¸åˆ©äºæ€§èƒ½çš„ä¼˜åŒ– ã€‚</span><br><span class="line">#### é”æ¶ˆé™¤</span><br><span class="line">é”æ¶ˆé™¤æ˜¯åœ¨ç¼–è¯‘å™¨çº§åˆ«çš„äº‹æƒ…ã€‚åœ¨å³æ—¶ç¼–è¯‘å™¨æ—¶ï¼Œå¦‚æœå‘ç°ä¸å¯èƒ½è¢«å…±äº«çš„å¯¹è±¡ï¼Œåˆ™å¯ä»¥æ¶ˆé™¤è¿™äº›å¯¹è±¡çš„é”æ“ä½œï¼Œå¤šæ•°æ˜¯å› ä¸ºç¨‹åºå‘˜ç¼–ç ä¸è§„èŒƒå¼•èµ·ã€‚</span><br><span class="line">å‚è€ƒï¼šhttps://www.jianshu.com/p/39628e1180a9</span><br><span class="line"></span><br><span class="line"># çº¿ç¨‹åŸºæœ¬æ–¹æ³•</span><br><span class="line">çº¿ç¨‹ç›¸å…³çš„åŸºæœ¬æ–¹æ³•æœ‰ waitï¼Œnotifyï¼ŒnotifyAllï¼Œsleepï¼Œjoinï¼Œyield ç­‰ã€‚</span><br><span class="line"></span><br><span class="line">## çº¿ç¨‹ç­‰å¾…ï¼ˆwaitï¼‰</span><br><span class="line">è°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹è¿›å…¥WAITINGçŠ¶æ€ï¼Œåªæœ‰ç­‰å¾…å¦å¤–çº¿ç¨‹çš„é€šçŸ¥æˆ–è¢«ä¸­æ–­æ‰ä¼šè¿”å›ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯è°ƒç”¨wait()æ–¹æ³•åï¼Œä¼šé‡Šæ”¾å¯¹è±¡çš„é”ã€‚å› æ­¤ï¼Œwaitæ–¹æ³•ä¸€èˆ¬ç”¨åœ¨åŒæ­¥æ–¹æ³•æˆ–åŒæ­¥ä»£ç å—ä¸­ã€‚</span><br><span class="line"></span><br><span class="line">## çº¿ç¨‹ç¡çœ ï¼ˆsleepï¼‰</span><br><span class="line">sleep å¯¼è‡´å½“å‰çº¿ç¨‹ä¼‘çœ ï¼Œä¸ wait æ–¹æ³•ä¸åŒçš„æ˜¯sleepä¸ä¼šé‡Šæ”¾å½“å‰å æœ‰çš„é”,sleep(long)ä¼šå¯¼è‡´çº¿ç¨‹è¿›å…¥TIMED-WATINGçŠ¶æ€ï¼Œè€Œwait()æ–¹æ³•ä¼šå¯¼è‡´å½“å‰çº¿ç¨‹è¿›å…¥ WATING çŠ¶æ€</span><br><span class="line"></span><br><span class="line">## çº¿ç¨‹è®©æ­¥ï¼ˆyieldï¼‰</span><br><span class="line">yield ä¼šä½¿å½“å‰çº¿ç¨‹è®©å‡º CPU æ‰§è¡Œæ—¶é—´ç‰‡ï¼Œä¸å…¶ä»–çº¿ç¨‹ä¸€èµ·é‡æ–°ç«äº‰ CPU æ—¶é—´ç‰‡ã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œä¼˜å…ˆçº§é«˜çš„çº¿ç¨‹æœ‰æ›´å¤§çš„å¯èƒ½æ€§æˆåŠŸç«äº‰å¾—åˆ° CPU æ—¶é—´ç‰‡ï¼Œä½†è¿™åˆä¸æ˜¯ç»å¯¹çš„ï¼Œæœ‰çš„æ“ä½œç³»ç»Ÿå¯¹çº¿ç¨‹ä¼˜å…ˆçº§å¹¶ä¸æ•æ„Ÿã€‚</span><br><span class="line"></span><br><span class="line">## çº¿ç¨‹ä¸­æ–­ï¼ˆinterruptï¼‰</span><br><span class="line">ä¸­æ–­ä¸€ä¸ªçº¿ç¨‹ï¼Œå…¶æœ¬æ„æ˜¯ç»™è¿™ä¸ªçº¿ç¨‹ä¸€ä¸ªé€šçŸ¥ä¿¡å·ï¼Œä¼šå½±å“è¿™ä¸ªçº¿ç¨‹å†…éƒ¨çš„ä¸€ä¸ªä¸­æ–­æ ‡è¯†ä½ã€‚è¿™ä¸ªçº¿ç¨‹æœ¬èº«å¹¶ä¸ä¼šå› æ­¤è€Œæ”¹å˜çŠ¶æ€(å¦‚é˜»å¡ï¼Œç»ˆæ­¢ç­‰)ã€‚</span><br><span class="line">1. è°ƒç”¨ interrupt()æ–¹æ³•å¹¶ä¸ä¼šä¸­æ–­ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ã€‚ä¹Ÿå°±æ˜¯è¯´å¤„äºRunningçŠ¶æ€çš„çº¿ç¨‹å¹¶ä¸ä¼šå› ä¸ºè¢«ä¸­æ–­è€Œè¢«ç»ˆæ­¢ï¼Œä»…ä»…æ”¹å˜äº†å†…éƒ¨ç»´æŠ¤çš„ä¸­æ–­æ ‡è¯†ä½è€Œå·²ã€‚</span><br><span class="line">2. è‹¥è°ƒç”¨ sleep()è€Œä½¿çº¿ç¨‹å¤„äº TIMED-WATING çŠ¶æ€ï¼Œè¿™æ—¶è°ƒç”¨ interrupt()æ–¹æ³•ï¼Œä¼šæŠ›å‡ºInterruptedException,ä»è€Œä½¿çº¿ç¨‹æå‰ç»“æŸ TIMED-WATING çŠ¶æ€ã€‚</span><br><span class="line">3. è®¸å¤šå£°æ˜æŠ›å‡º InterruptedException çš„æ–¹æ³•(å¦‚ Thread.sleep(long mills æ–¹æ³•))ï¼ŒæŠ›å‡ºå¼‚å¸¸å‰ï¼Œéƒ½ä¼šæ¸…é™¤ä¸­æ–­æ ‡è¯†ä½ï¼Œæ‰€ä»¥æŠ›å‡ºå¼‚å¸¸åï¼Œè°ƒç”¨ isInterrupted()æ–¹æ³•å°†ä¼šè¿”å› falseã€‚</span><br><span class="line">4. ä¸­æ–­çŠ¶æ€æ˜¯çº¿ç¨‹å›ºæœ‰çš„ä¸€ä¸ªæ ‡è¯†ä½ï¼Œå¯ä»¥é€šè¿‡æ­¤æ ‡è¯†ä½å®‰å…¨çš„ç»ˆæ­¢çº¿ç¨‹ã€‚æ¯”å¦‚,ä½ æƒ³ç»ˆæ­¢ä¸€ä¸ªçº¿ç¨‹threadçš„æ—¶å€™ï¼Œå¯ä»¥è°ƒç”¨thread.interrupt()æ–¹æ³•ï¼Œåœ¨çº¿ç¨‹çš„ run æ–¹æ³•å†…éƒ¨å¯ä»¥æ ¹æ® thread.isInterrupted()çš„å€¼æ¥ä¼˜é›…çš„ç»ˆæ­¢çº¿ç¨‹ã€‚</span><br><span class="line"></span><br><span class="line">## Join ç­‰å¾…å…¶ä»–çº¿ç¨‹ç»ˆæ­¢</span><br><span class="line">join() æ–¹æ³•ï¼Œç­‰å¾…å…¶ä»–çº¿ç¨‹ç»ˆæ­¢ï¼Œåœ¨å½“å‰çº¿ç¨‹ä¸­è°ƒç”¨ä¸€ä¸ªçº¿ç¨‹çš„join()æ–¹æ³•ï¼Œåˆ™å½“å‰çº¿ç¨‹è½¬ä¸ºé˜»å¡çŠ¶æ€ï¼Œå›åˆ°å¦ä¸€ä¸ªçº¿ç¨‹ç»“æŸï¼Œå½“å‰çº¿ç¨‹å†ç”±é˜»å¡çŠ¶æ€å˜ä¸ºå°±ç»ªçŠ¶æ€ï¼Œç­‰å¾… cpu çš„å® å¹¸ã€‚</span><br><span class="line"></span><br><span class="line">## ä¸ºä»€ä¹ˆè¦ç”¨ join()æ–¹æ³•ï¼Ÿ</span><br><span class="line">å¾ˆå¤šæƒ…å†µä¸‹ï¼Œä¸»çº¿ç¨‹ç”Ÿæˆå¹¶å¯åŠ¨äº†å­çº¿ç¨‹ï¼Œéœ€è¦ç”¨åˆ°å­çº¿ç¨‹è¿”å›çš„ç»“æœï¼Œä¹Ÿå°±æ˜¯éœ€è¦ä¸»çº¿ç¨‹éœ€è¦åœ¨å­çº¿ç¨‹ç»“æŸåå†ç»“æŸï¼Œè¿™æ—¶å€™å°±è¦ç”¨åˆ° join() æ–¹æ³•ã€‚</span><br><span class="line">    </span><br><span class="line">    System.out.println(Thread.currentThread().getName() + &quot;çº¿ç¨‹è¿è¡Œå¼€å§‹!&quot;);</span><br><span class="line">     Thread6 thread1 = new Thread6();</span><br><span class="line">     thread1.setName(&quot;çº¿ç¨‹ B&quot;);</span><br><span class="line">     thread1.join();</span><br><span class="line">    System.out.println(&quot;è¿™æ—¶ thread1 æ‰§è¡Œå®Œæ¯•ä¹‹åæ‰èƒ½æ‰§è¡Œä¸»çº¿ç¨‹&quot;);</span><br><span class="line"></span><br><span class="line">## çº¿ç¨‹å”¤é†’ï¼ˆnotifyï¼‰</span><br><span class="line">Object ç±»ä¸­çš„ notify() æ–¹æ³•ï¼Œå”¤é†’åœ¨æ­¤å¯¹è±¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„å•ä¸ªçº¿ç¨‹ï¼Œå¦‚æœæ‰€æœ‰çº¿ç¨‹éƒ½åœ¨æ­¤å¯¹è±¡ä¸Šç­‰å¾…ï¼Œåˆ™ä¼šé€‰æ‹©å”¤é†’å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹ï¼Œé€‰æ‹©æ˜¯ä»»æ„çš„ï¼Œå¹¶åœ¨å¯¹å®ç°åšå‡ºå†³å®šæ—¶å‘ç”Ÿï¼Œçº¿ç¨‹é€šè¿‡è°ƒç”¨å…¶ä¸­ä¸€ä¸ªwait()æ–¹æ³•ï¼Œåœ¨å¯¹è±¡çš„ç›‘è§†å™¨ä¸Šç­‰å¾…ï¼Œç›´åˆ°å½“å‰çš„çº¿ç¨‹æ”¾å¼ƒæ­¤å¯¹è±¡ä¸Šçš„é”å®šï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œè¢«å”¤é†’çš„çº¿ç¨‹ï¼Œè¢«å”¤é†’çš„çº¿ç¨‹å°†ä»¥å¸¸è§„æ–¹å¼ä¸åœ¨è¯¥å¯¹è±¡ä¸Šä¸»åŠ¨åŒæ­¥çš„å…¶ä»–æ‰€æœ‰çº¿ç¨‹è¿›è¡Œç«äº‰ã€‚ç±»ä¼¼çš„æ–¹æ³•è¿˜æœ‰ notifyAll() ï¼Œå”¤é†’å†æ¬¡ç›‘è§†å™¨ä¸Šç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹ã€‚</span><br><span class="line"></span><br><span class="line">## å…¶ä»–æ–¹æ³•ï¼š</span><br><span class="line">1. sleep()ï¼šå¼ºè¿«ä¸€ä¸ªçº¿ç¨‹ç¡çœ ï¼®æ¯«ç§’ã€‚</span><br><span class="line">2. isAlive()ï¼š åˆ¤æ–­ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦å­˜æ´»ã€‚</span><br><span class="line">3. join()ï¼š ç­‰å¾…çº¿ç¨‹ç»ˆæ­¢ã€‚</span><br><span class="line">4. activeCount()ï¼š ç¨‹åºä¸­æ´»è·ƒçš„çº¿ç¨‹æ•°ã€‚</span><br><span class="line">5. enumerate()ï¼š æšä¸¾ç¨‹åºä¸­çš„çº¿ç¨‹ã€‚</span><br><span class="line">6. currentThread()ï¼š å¾—åˆ°å½“å‰çº¿ç¨‹ã€‚</span><br><span class="line">7. isDaemon()ï¼š ä¸€ä¸ªçº¿ç¨‹æ˜¯å¦ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚</span><br><span class="line">8. setDaemon()ï¼š è®¾ç½®ä¸€ä¸ªçº¿ç¨‹ä¸ºå®ˆæŠ¤çº¿ç¨‹ã€‚(ç”¨æˆ·çº¿ç¨‹å’Œå®ˆæŠ¤çº¿ç¨‹çš„åŒºåˆ«åœ¨äºï¼Œæ˜¯å¦ç­‰å¾…ä¸»çº¿</span><br><span class="line">ç¨‹ä¾èµ–äºä¸»çº¿ç¨‹ç»“æŸè€Œç»“æŸ)</span><br><span class="line">9. setName()ï¼š ä¸ºçº¿ç¨‹è®¾ç½®ä¸€ä¸ªåç§°ã€‚</span><br><span class="line">10. wait()ï¼š å¼ºè¿«ä¸€ä¸ªçº¿ç¨‹ç­‰å¾…ã€‚</span><br><span class="line">11. notify()ï¼š é€šçŸ¥ä¸€ä¸ªçº¿ç¨‹ç»§ç»­è¿è¡Œã€‚</span><br><span class="line">12. setPriority()ï¼š è®¾ç½®ä¸€ä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚</span><br><span class="line">13. getPriority():ï¼šè·å¾—ä¸€ä¸ªçº¿ç¨‹çš„ä¼˜å…ˆçº§ã€‚</span><br><span class="line"></span><br><span class="line"># çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢</span><br><span class="line">å·§å¦™åœ°åˆ©ç”¨äº†æ—¶é—´ç‰‡è½®è½¬çš„æ–¹å¼, CPU ç»™æ¯ä¸ªä»»åŠ¡éƒ½æœåŠ¡ä¸€å®šçš„æ—¶é—´ï¼Œç„¶åæŠŠå½“å‰ä»»åŠ¡çš„çŠ¶æ€ä¿å­˜ä¸‹æ¥ï¼Œåœ¨åŠ è½½ä¸‹ä¸€ä»»åŠ¡çš„çŠ¶æ€åï¼Œç»§ç»­æœåŠ¡ä¸‹ä¸€ä»»åŠ¡ï¼Œä»»åŠ¡çš„çŠ¶æ€ä¿å­˜åŠå†åŠ è½½, è¿™æ®µè¿‡ç¨‹å°±å«åšä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚æ—¶é—´ç‰‡è½®è½¬çš„æ–¹å¼ä½¿å¤šä¸ªä»»åŠ¡åœ¨åŒä¸€é¢— CPU ä¸Šæ‰§è¡Œå˜æˆäº†å¯èƒ½ã€‚</span><br><span class="line"></span><br><span class="line">## è¿›ç¨‹</span><br><span class="line">ï¼ˆæœ‰æ—¶å€™ä¹Ÿç§°åšä»»åŠ¡ï¼‰æ˜¯æŒ‡ä¸€ä¸ªç¨‹åºè¿è¡Œçš„å®ä¾‹ã€‚åœ¨Linuxç³»ç»Ÿä¸­ï¼Œçº¿ç¨‹å°±æ˜¯èƒ½å¹¶è¡Œè¿è¡Œå¹¶ä¸”ä¸ä»–ä»¬çš„çˆ¶è¿›ç¨‹ï¼ˆåˆ›å»ºä»–ä»¬çš„è¿›ç¨‹ï¼‰å…±äº«åŒä¸€åœ°å€ç©ºé—´ï¼ˆä¸€æ®µå†…å­˜åŒºåŸŸï¼‰å’Œå…¶ä»–èµ„æºçš„è½»é‡çº§çš„è¿›ç¨‹ã€‚</span><br><span class="line"></span><br><span class="line">## ä¸Šä¸‹æ–‡</span><br><span class="line">æ˜¯æŒ‡æŸä¸€æ—¶é—´ç‚¹ CPU å¯„å­˜å™¨å’Œç¨‹åºè®¡æ•°å™¨çš„å†…å®¹ã€‚</span><br><span class="line"></span><br><span class="line">## å¯„å­˜å™¨</span><br><span class="line">æ˜¯ CPU å†…éƒ¨çš„æ•°é‡è¾ƒå°‘ä½†æ˜¯é€Ÿåº¦å¾ˆå¿«çš„å†…å­˜ï¼ˆä¸ä¹‹å¯¹åº”çš„æ˜¯CPUå¤–éƒ¨ç›¸å¯¹è¾ƒæ…¢çš„RAMä¸»å†…å­˜ï¼‰ã€‚å¯„å­˜å™¨é€šè¿‡å¯¹å¸¸ç”¨å€¼ï¼ˆé€šå¸¸æ˜¯è¿ç®—çš„ä¸­é—´å€¼ï¼‰çš„å¿«é€Ÿè®¿é—®æ¥æé«˜è®¡ç®—æœºç¨‹åºè¿è¡Œçš„é€Ÿåº¦ã€‚</span><br><span class="line"></span><br><span class="line">## ç¨‹åºè®¡æ•°å™¨</span><br><span class="line">æ˜¯ä¸€ä¸ªä¸“ç”¨çš„å¯„å­˜å™¨ï¼Œç”¨äºè¡¨æ˜æŒ‡ä»¤åºåˆ—ä¸­CPUæ­£åœ¨æ‰§è¡Œçš„ä½ç½®ï¼Œå­˜çš„å€¼ä¸ºæ­£åœ¨æ‰§è¡Œçš„æŒ‡ä»¤çš„ä½ç½®æˆ–è€…ä¸‹ä¸€ä¸ªå°†è¦è¢«æ‰§è¡Œçš„æŒ‡ä»¤çš„ä½ç½®ï¼Œå…·ä½“ä¾èµ–äºç‰¹å®šçš„ç³»ç»Ÿã€‚</span><br><span class="line"></span><br><span class="line">## PCB-â€œåˆ‡æ¢æ¡¢â€</span><br><span class="line">ä¸Šä¸‹æ–‡åˆ‡æ¢å¯ä»¥è®¤ä¸ºæ˜¯å†…æ ¸ï¼ˆæ“ä½œç³»ç»Ÿçš„æ ¸å¿ƒï¼‰åœ¨ CPU ä¸Šå¯¹äºè¿›ç¨‹ï¼ˆåŒ…æ‹¬çº¿ç¨‹ï¼‰è¿›è¡Œåˆ‡æ¢ï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢è¿‡ç¨‹ä¸­çš„ä¿¡æ¯æ˜¯ä¿å­˜åœ¨è¿›ç¨‹æ§åˆ¶å—ï¼ˆPCB, process control blockï¼‰ä¸­çš„ã€‚PCB è¿˜ç»å¸¸è¢«ç§°ä½œâ€œåˆ‡æ¢æ¡¢â€ï¼ˆswitchframeï¼‰ã€‚ä¿¡æ¯ä¼šä¸€ç›´ä¿å­˜åˆ° CPU çš„å†…å­˜ä¸­ï¼Œç›´åˆ°ä»–ä»¬è¢«å†æ¬¡ä½¿ç”¨ã€‚</span><br><span class="line"></span><br><span class="line">## ä¸Šä¸‹æ–‡åˆ‡æ¢çš„æ´»åŠ¨ï¼š</span><br><span class="line">1. æŒ‚èµ·ä¸€ä¸ªè¿›ç¨‹ï¼Œå°†è¿™ä¸ªè¿›ç¨‹åœ¨ CPU ä¸­çš„çŠ¶æ€ï¼ˆä¸Šä¸‹æ–‡ï¼‰å­˜å‚¨äºå†…å­˜ä¸­çš„æŸå¤„ã€‚</span><br><span class="line">2. åœ¨å†…å­˜ä¸­æ£€ç´¢ä¸‹ä¸€ä¸ªè¿›ç¨‹çš„ä¸Šä¸‹æ–‡å¹¶å°†å…¶åœ¨ CPU çš„å¯„å­˜å™¨ä¸­æ¢å¤ã€‚</span><br><span class="line">3. è·³è½¬åˆ°ç¨‹åºè®¡æ•°å™¨æ‰€æŒ‡å‘çš„ä½ç½®ï¼ˆå³è·³è½¬åˆ°è¿›ç¨‹è¢«ä¸­æ–­æ—¶çš„ä»£ç è¡Œï¼‰ï¼Œä»¥æ¢å¤è¯¥è¿›ç¨‹åœ¨ç¨‹åºä¸­ã€‚</span><br><span class="line"></span><br><span class="line">## å¼•èµ·çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢çš„åŸå› </span><br><span class="line">1. å½“å‰æ‰§è¡Œä»»åŠ¡çš„æ—¶é—´ç‰‡ç”¨å®Œä¹‹åï¼Œç³»ç»Ÿ CPU æ­£å¸¸è°ƒåº¦ä¸‹ä¸€ä¸ªä»»åŠ¡ï¼›</span><br><span class="line">2. å½“å‰æ‰§è¡Œä»»åŠ¡ç¢°åˆ° IO é˜»å¡ï¼Œè°ƒåº¦å™¨å°†æ­¤ä»»åŠ¡æŒ‚èµ·ï¼Œç»§ç»­ä¸‹ä¸€ä»»åŠ¡ï¼›</span><br><span class="line">3. å¤šä¸ªä»»åŠ¡æŠ¢å é”èµ„æºï¼Œå½“å‰ä»»åŠ¡æ²¡æœ‰æŠ¢åˆ°é”èµ„æºï¼Œè¢«è°ƒåº¦å™¨æŒ‚èµ·ï¼Œç»§ç»­ä¸‹ä¸€ä»»åŠ¡ï¼›</span><br><span class="line">4. ç”¨æˆ·ä»£ç æŒ‚èµ·å½“å‰ä»»åŠ¡ï¼Œè®©å‡º CPU æ—¶é—´ï¼›</span><br><span class="line">5. ç¡¬ä»¶ä¸­æ–­ï¼›</span><br><span class="line"></span><br><span class="line"># åŒæ­¥é”ä¸æ­»é”</span><br><span class="line">## åŒæ­¥é”</span><br><span class="line">å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®åŒä¸€ä¸ªæ•°æ®æ—¶ï¼Œå¾ˆå®¹æ˜“å‡ºç°é—®é¢˜ã€‚ä¸ºäº†é¿å…è¿™ç§æƒ…å†µå‡ºç°ï¼Œæˆ‘ä»¬è¦ä¿è¯çº¿ç¨‹åŒæ­¥äº’æ–¥ï¼Œå°±æ˜¯æŒ‡å¹¶å‘æ‰§è¡Œçš„å¤šä¸ªçº¿ç¨‹ï¼Œåœ¨åŒä¸€æ—¶é—´å†…åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®å…±äº«æ•°æ®ã€‚ Java ä¸­å¯ä»¥ä½¿ç”¨ synchronized å…³é”®å­—æ¥å–å¾—ä¸€ä¸ªå¯¹è±¡çš„åŒæ­¥é”ã€‚</span><br><span class="line"></span><br><span class="line">## æ­»é”</span><br><span class="line">ä½•ä¸ºæ­»é”ï¼Œå°±æ˜¯å¤šä¸ªçº¿ç¨‹åŒæ—¶è¢«é˜»å¡ï¼Œå®ƒä»¬ä¸­çš„ä¸€ä¸ªæˆ–è€…å…¨éƒ¨éƒ½åœ¨ç­‰å¾…æŸä¸ªèµ„æºè¢«é‡Šæ”¾ã€‚</span><br><span class="line"></span><br><span class="line"># çº¿ç¨‹æ± åŸç†</span><br><span class="line">çº¿ç¨‹æ± åšçš„å·¥ä½œä¸»è¦æ˜¯æ§åˆ¶è¿è¡Œçš„çº¿ç¨‹çš„æ•°é‡ï¼Œå¤„ç†è¿‡ç¨‹ä¸­å°†ä»»åŠ¡æ”¾å…¥é˜Ÿåˆ—ï¼Œç„¶ååœ¨çº¿ç¨‹åˆ›å»ºåå¯åŠ¨è¿™äº›ä»»åŠ¡ï¼Œå¦‚æœçº¿ç¨‹æ•°é‡è¶…è¿‡äº†æœ€å¤§æ•°é‡è¶…å‡ºæ•°é‡çš„çº¿ç¨‹æ’é˜Ÿç­‰å€™ï¼Œç­‰å…¶å®ƒçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œå†ä»é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡æ¥æ‰§è¡Œã€‚ä»–çš„ä¸»è¦ç‰¹ç‚¹ä¸ºï¼šçº¿ç¨‹å¤ç”¨ï¼›æ§åˆ¶æœ€å¤§å¹¶å‘æ•°ï¼›ç®¡ç†çº¿ç¨‹ã€‚</span><br><span class="line"></span><br><span class="line">## çº¿ç¨‹å¤ç”¨</span><br><span class="line">æ¯ä¸€ä¸ª Thread çš„ç±»éƒ½æœ‰ä¸€ä¸ª start æ–¹æ³•ã€‚ å½“è°ƒç”¨ start å¯åŠ¨çº¿ç¨‹æ—¶ Java è™šæ‹Ÿæœºä¼šè°ƒç”¨è¯¥ç±»çš„ runæ–¹æ³•ã€‚ é‚£ä¹ˆè¯¥ç±»çš„ run() æ–¹æ³•ä¸­å°±æ˜¯è°ƒç”¨äº† Runnable å¯¹è±¡çš„ run() æ–¹æ³•ã€‚ æˆ‘ä»¬å¯ä»¥ç»§æ‰¿é‡å†™Threadç±»ï¼Œåœ¨å…¶startæ–¹æ³•ä¸­æ·»åŠ ä¸æ–­å¾ªç¯è°ƒç”¨ä¼ é€’è¿‡æ¥çš„Runnableå¯¹è±¡ã€‚è¿™å°±æ˜¯çº¿ç¨‹æ± çš„å®ç°åŸç†ã€‚å¾ªç¯æ–¹æ³•ä¸­ä¸æ–­è·å– Runnable æ˜¯ç”¨ Queue å®ç°çš„ï¼Œåœ¨è·å–ä¸‹ä¸€ä¸ª Runnable ä¹‹å‰å¯ä»¥æ˜¯é˜»å¡çš„ã€‚</span><br><span class="line"></span><br><span class="line">## çº¿ç¨‹æ± çš„ç»„æˆ</span><br><span class="line">ä¸€èˆ¬çš„çº¿ç¨‹æ± ä¸»è¦åˆ†ä¸ºä»¥ä¸‹ 4 ä¸ªç»„æˆéƒ¨åˆ†ï¼š</span><br><span class="line">1. çº¿ç¨‹æ± ç®¡ç†å™¨ï¼šç”¨äºåˆ›å»ºå¹¶ç®¡ç†çº¿ç¨‹æ± </span><br><span class="line">2. å·¥ä½œçº¿ç¨‹ï¼šçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹</span><br><span class="line">3. ä»»åŠ¡æ¥å£ï¼šæ¯ä¸ªä»»åŠ¡å¿…é¡»å®ç°çš„æ¥å£ï¼Œç”¨äºå·¥ä½œçº¿ç¨‹è°ƒåº¦å…¶è¿è¡Œ</span><br><span class="line">4. ä»»åŠ¡é˜Ÿåˆ—ï¼šç”¨äºå­˜æ”¾å¾…å¤„ç†çš„ä»»åŠ¡ï¼Œæä¾›ä¸€ç§ç¼“å†²æœºåˆ¶</span><br><span class="line">Java ä¸­çš„çº¿ç¨‹æ± æ˜¯é€šè¿‡ Executor æ¡†æ¶å®ç°çš„ï¼Œè¯¥æ¡†æ¶ä¸­ç”¨åˆ°äº†Executorï¼ŒExecutorsï¼ŒÃ¥ExecutorServiceï¼ŒThreadPoolExecutorï¼ŒCallableå’ŒFutureã€FutureTask è¿™å‡ ä¸ªç±»ã€‚</span><br><span class="line"></span><br><span class="line">ThreadPoolExecutor çš„æ„é€ æ–¹æ³•å¦‚ä¸‹ï¼š</span><br><span class="line"></span><br><span class="line">    public ThreadPoolExecutor(int corePoolSize,int maximumPoolSize, long keepAliveTime,</span><br><span class="line">    TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue) &#123;</span><br><span class="line">        this(corePoolSize, maximumPoolSize, keepAliveTime, unit, workQueue,</span><br><span class="line">        Executors.defaultThreadFactory(), defaultHandler);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">1. corePoolSizeï¼šæŒ‡å®šäº†çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡ã€‚</span><br><span class="line">2. maximumPoolSizeï¼šæŒ‡å®šäº†çº¿ç¨‹æ± ä¸­çš„æœ€å¤§çº¿ç¨‹æ•°é‡ã€‚</span><br><span class="line">3. keepAliveTimeï¼šå½“å‰çº¿ç¨‹æ± æ•°é‡è¶…è¿‡ corePoolSize æ—¶ï¼Œå¤šä½™çš„ç©ºé—²çº¿ç¨‹çš„å­˜æ´»æ—¶é—´ï¼Œå³å¤š</span><br><span class="line">æ¬¡æ—¶é—´å†…ä¼šè¢«é”€æ¯ã€‚</span><br><span class="line">4. unitï¼škeepAliveTime çš„å•ä½ã€‚</span><br><span class="line">5. workQueueï¼šä»»åŠ¡é˜Ÿåˆ—ï¼Œè¢«æäº¤ä½†å°šæœªè¢«æ‰§è¡Œçš„ä»»åŠ¡ã€‚</span><br><span class="line">6. threadFactoryï¼šçº¿ç¨‹å·¥å‚ï¼Œç”¨äºåˆ›å»ºçº¿ç¨‹ï¼Œä¸€èˆ¬ç”¨é»˜è®¤çš„å³å¯ã€‚</span><br><span class="line">7. handlerï¼šæ‹’ç»ç­–ç•¥ï¼Œå½“ä»»åŠ¡å¤ªå¤šæ¥ä¸åŠå¤„ç†ï¼Œå¦‚ä½•æ‹’ç»ä»»åŠ¡ã€‚</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## æ‹’ç»ç­–ç•¥</span><br><span class="line">çº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹å·²ç»ç”¨å®Œäº†ï¼Œæ— æ³•ç»§ç»­ä¸ºæ–°ä»»åŠ¡æœåŠ¡ï¼ŒåŒæ—¶ï¼Œç­‰å¾…é˜Ÿåˆ—ä¹Ÿå·²ç»æ’æ»¡äº†ï¼Œå†ä¹Ÿå¡ä¸ä¸‹æ–°ä»»åŠ¡äº†ã€‚è¿™æ—¶å€™æˆ‘ä»¬å°±éœ€è¦æ‹’ç»ç­–ç•¥æœºåˆ¶åˆç†çš„å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚</span><br><span class="line"></span><br><span class="line">JDK å†…ç½®çš„æ‹’ç»ç­–ç•¥å¦‚ä¸‹ï¼š</span><br><span class="line">1. AbortPolicy ï¼š ç›´æ¥æŠ›å‡ºå¼‚å¸¸ï¼Œé˜»æ­¢ç³»ç»Ÿæ­£å¸¸è¿è¡Œã€‚</span><br><span class="line">2. CallerRunsPolicy ï¼š åªè¦çº¿ç¨‹æ± æœªå…³é—­ï¼Œè¯¥ç­–ç•¥ç›´æ¥åœ¨è°ƒç”¨è€…çº¿ç¨‹ä¸­ï¼Œè¿è¡Œå½“å‰è¢«ä¸¢å¼ƒçš„ä»»åŠ¡ã€‚æ˜¾ç„¶è¿™æ ·åšä¸ä¼šçœŸçš„ä¸¢å¼ƒä»»åŠ¡ï¼Œä½†æ˜¯ï¼Œä»»åŠ¡æäº¤çº¿ç¨‹çš„æ€§èƒ½ææœ‰å¯èƒ½ä¼šæ€¥å‰§ä¸‹é™ã€‚</span><br><span class="line">3. DiscardOldestPolicy ï¼š ä¸¢å¼ƒæœ€è€çš„ä¸€ä¸ªè¯·æ±‚ï¼Œä¹Ÿå°±æ˜¯å³å°†è¢«æ‰§è¡Œçš„ä¸€ä¸ªä»»åŠ¡ï¼Œå¹¶å°è¯•å†æ¬¡æäº¤å½“å‰ä»»åŠ¡ã€‚</span><br><span class="line">4. DiscardPolicy ï¼š è¯¥ç­–ç•¥é»˜é»˜åœ°ä¸¢å¼ƒæ— æ³•å¤„ç†çš„ä»»åŠ¡ï¼Œä¸äºˆä»»ä½•å¤„ç†ã€‚å¦‚æœå…è®¸ä»»åŠ¡ä¸¢å¤±ï¼Œè¿™æ˜¯æœ€å¥½çš„ä¸€ç§æ–¹æ¡ˆã€‚</span><br><span class="line">ä»¥ä¸Šå†…ç½®æ‹’ç»ç­–ç•¥å‡å®ç°äº† RejectedExecutionHandler æ¥å£ï¼Œè‹¥ä»¥ä¸Šç­–ç•¥ä»æ— æ³•æ»¡è¶³å®é™…éœ€è¦ï¼Œå®Œå…¨å¯ä»¥è‡ªå·±æ‰©å±• RejectedExecutionHandler æ¥å£ã€‚</span><br><span class="line"></span><br><span class="line">## Java çº¿ç¨‹æ± å·¥ä½œè¿‡ç¨‹</span><br><span class="line">1. çº¿ç¨‹æ± åˆšåˆ›å»ºæ—¶ï¼Œé‡Œé¢æ²¡æœ‰ä¸€ä¸ªçº¿ç¨‹ã€‚ä»»åŠ¡é˜Ÿåˆ—æ˜¯ä½œä¸ºå‚æ•°ä¼ è¿›æ¥çš„ã€‚ä¸è¿‡ï¼Œå°±ç®—é˜Ÿåˆ—é‡Œé¢æœ‰ä»»åŠ¡ï¼Œçº¿ç¨‹æ± ä¹Ÿä¸ä¼šé©¬ä¸Šæ‰§è¡Œå®ƒä»¬ã€‚</span><br><span class="line">2. å½“è°ƒç”¨ execute() æ–¹æ³•æ·»åŠ ä¸€ä¸ªä»»åŠ¡æ—¶ï¼Œçº¿ç¨‹æ± ä¼šåšå¦‚ä¸‹åˆ¤æ–­ï¼š</span><br><span class="line">a) å¦‚æœæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•°é‡å°äº corePoolSizeï¼Œé‚£ä¹ˆé©¬ä¸Šåˆ›å»ºçº¿ç¨‹è¿è¡Œè¿™ä¸ªä»»åŠ¡ï¼›</span><br><span class="line">b) å¦‚æœæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•°é‡å¤§äºæˆ–ç­‰äº corePoolSizeï¼Œé‚£ä¹ˆå°†è¿™ä¸ªä»»åŠ¡æ”¾å…¥é˜Ÿåˆ—ï¼›</span><br><span class="line">c) å¦‚æœè¿™æ—¶å€™é˜Ÿåˆ—æ»¡äº†ï¼Œè€Œä¸”æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•°é‡å°äº maximumPoolSizeï¼Œé‚£ä¹ˆè¿˜æ˜¯è¦åˆ›å»ºéæ ¸å¿ƒçº¿ç¨‹ç«‹åˆ»è¿è¡Œè¿™ä¸ªä»»åŠ¡ï¼›</span><br><span class="line">d) å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œè€Œä¸”æ­£åœ¨è¿è¡Œçš„çº¿ç¨‹æ•°é‡å¤§äºæˆ–ç­‰äº maximumPoolSizeï¼Œé‚£ä¹ˆçº¿ç¨‹æ± ä¼šæŠ›å‡ºå¼‚å¸¸ RejectExecutionExceptionã€‚</span><br><span class="line">3. å½“ä¸€ä¸ªçº¿ç¨‹å®Œæˆä»»åŠ¡æ—¶ï¼Œå®ƒä¼šä»é˜Ÿåˆ—ä¸­å–ä¸‹ä¸€ä¸ªä»»åŠ¡æ¥æ‰§è¡Œã€‚</span><br><span class="line">4. å½“ä¸€ä¸ªçº¿ç¨‹æ— äº‹å¯åšï¼Œè¶…è¿‡ä¸€å®šçš„æ—¶é—´ï¼ˆkeepAliveTimeï¼‰æ—¶ï¼Œçº¿ç¨‹æ± ä¼šåˆ¤æ–­ï¼Œå¦‚æœå½“å‰è¿è¡Œçš„çº¿ç¨‹æ•°å¤§äºcorePoolSizeï¼Œé‚£ä¹ˆè¿™ä¸ªçº¿ç¨‹å°±è¢«åœæ‰ã€‚æ‰€ä»¥çº¿ç¨‹æ± çš„æ‰€æœ‰ä»»åŠ¡å®Œæˆåï¼Œå®ƒæœ€ç»ˆä¼šæ”¶ç¼©åˆ° corePoolSize çš„å¤§å°ã€‚</span><br><span class="line"></span><br><span class="line"># JAVA é˜»å¡é˜Ÿåˆ—åŸç†</span><br><span class="line">é˜»å¡é˜Ÿåˆ—ï¼Œå…³é”®å­—æ˜¯é˜»å¡ï¼Œå…ˆç†è§£é˜»å¡çš„å«ä¹‰ï¼Œåœ¨é˜»å¡é˜Ÿåˆ—ä¸­ï¼Œçº¿ç¨‹é˜»å¡æœ‰è¿™æ ·çš„ä¸¤ç§æƒ…å†µï¼š</span><br><span class="line">1. å½“é˜Ÿåˆ—ä¸­æ²¡æœ‰æ•°æ®çš„æƒ…å†µä¸‹ï¼Œæ¶ˆè´¹è€…ç«¯çš„æ‰€æœ‰çº¿ç¨‹éƒ½ä¼šè¢«è‡ªåŠ¨é˜»å¡ï¼ˆæŒ‚èµ·ï¼‰ï¼Œç›´åˆ°æœ‰æ•°æ®æ”¾å…¥é˜Ÿåˆ—ã€‚</span><br><span class="line">2. å½“é˜Ÿåˆ—ä¸­å¡«æ»¡æ•°æ®çš„æƒ…å†µä¸‹ï¼Œç”Ÿäº§è€…ç«¯çš„æ‰€æœ‰çº¿ç¨‹éƒ½ä¼šè¢«è‡ªåŠ¨é˜»å¡ï¼ˆæŒ‚èµ·ï¼‰ï¼Œç›´åˆ°é˜Ÿåˆ—ä¸­æœ‰ç©ºçš„ä½ç½®ï¼Œçº¿ç¨‹è¢«è‡ªåŠ¨å”¤é†’ã€‚</span><br><span class="line"></span><br><span class="line">## é˜»å¡é˜Ÿåˆ—çš„ä¸»è¦æ–¹æ³•</span><br><span class="line">æŠ›å‡ºå¼‚å¸¸ï¼šæŠ›å‡ºä¸€ä¸ªå¼‚å¸¸ï¼›</span><br><span class="line">- ç‰¹æ®Šå€¼ï¼šè¿”å›ä¸€ä¸ªç‰¹æ®Šå€¼ï¼ˆnull æˆ– false,è§†æƒ…å†µè€Œå®šï¼‰ </span><br><span class="line">- é˜»å¡ï¼šåœ¨æˆåŠŸæ“ä½œä¹‹å‰ï¼Œä¸€ç›´é˜»å¡çº¿ç¨‹</span><br><span class="line">- è¶…æ—¶ï¼šæ”¾å¼ƒå‰åªåœ¨æœ€å¤§çš„æ—¶é—´å†…é˜»å¡</span><br><span class="line"></span><br><span class="line">### æ’å…¥æ“ä½œï¼š</span><br><span class="line"></span><br><span class="line">1ï¼špublic abstract boolean add(E paramE)ï¼šå°†æŒ‡å®šå…ƒç´ æ’å…¥æ­¤é˜Ÿåˆ—ä¸­ï¼ˆå¦‚æœç«‹å³å¯è¡Œä¸”ä¸ä¼šè¿åå®¹é‡é™åˆ¶ï¼‰ï¼ŒæˆåŠŸæ—¶è¿”å› trueï¼Œå¦‚æœå½“å‰æ²¡æœ‰å¯ç”¨çš„ç©ºé—´ï¼Œåˆ™æŠ›å‡º IllegalStateExceptionã€‚å¦‚æœè¯¥å…ƒç´ æ˜¯ NULLï¼Œåˆ™ä¼šæŠ›å‡º NullPointerException å¼‚å¸¸ã€‚</span><br><span class="line"></span><br><span class="line">2ï¼špublic abstract boolean offer(E paramE)ï¼šå°†æŒ‡å®šå…ƒç´ æ’å…¥æ­¤é˜Ÿåˆ—ä¸­ï¼ˆå¦‚æœç«‹å³å¯è¡Œä¸”ä¸ä¼šè¿åå®¹é‡é™åˆ¶ï¼‰ï¼ŒæˆåŠŸæ—¶è¿”å›trueï¼Œå¦‚æœå½“å‰æ²¡æœ‰å¯ç”¨çš„ç©ºé—´ï¼Œåˆ™è¿”å› falseã€‚</span><br><span class="line"></span><br><span class="line">3ï¼špublic abstract void put(E paramE) throws InterruptedExceptionï¼š å°†æŒ‡å®šå…ƒç´ æ’å…¥æ­¤é˜Ÿåˆ—ä¸­ï¼Œå°†ç­‰å¾…å¯ç”¨çš„ç©ºé—´ï¼ˆå¦‚æœæœ‰å¿…è¦ï¼‰</span><br><span class="line"></span><br><span class="line">    public void put(E paramE) throws InterruptedException &#123;</span><br><span class="line">            checkNotNull(paramE);</span><br><span class="line">            ReentrantLock localReentrantLock = this.lock;</span><br><span class="line">            localReentrantLock.lockInterruptibly();</span><br><span class="line">            try &#123;</span><br><span class="line">                while (this.count == this.items.length)</span><br><span class="line">                    this.notFull.await();//å¦‚æœé˜Ÿåˆ—æ»¡äº†ï¼Œåˆ™çº¿ç¨‹é˜»å¡ç­‰å¾…</span><br><span class="line">                enqueue(paramE);</span><br><span class="line">                localReentrantLock.unlock();</span><br><span class="line">            &#125; finally &#123;</span><br><span class="line">                localReentrantLock.unlock();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">4ï¼šoffer(E o, long timeout, TimeUnit unit)ï¼šå¯ä»¥è®¾å®šç­‰å¾…çš„æ—¶é—´ï¼Œå¦‚æœåœ¨æŒ‡å®šçš„æ—¶é—´å†…ï¼Œè¿˜ä¸èƒ½å¾€é˜Ÿåˆ—ä¸­åŠ å…¥ BlockingQueueï¼Œåˆ™è¿”å›å¤±è´¥ã€‚</span><br><span class="line"></span><br><span class="line">### è·å–æ•°æ®æ“ä½œï¼š</span><br><span class="line">1ï¼špoll(time):å–èµ° BlockingQueue é‡Œæ’åœ¨é¦–ä½çš„å¯¹è±¡,è‹¥ä¸èƒ½ç«‹å³å–å‡º,åˆ™å¯ä»¥ç­‰ time å‚æ•°è§„å®šçš„æ—¶é—´,å–ä¸åˆ°æ—¶è¿”å› null;</span><br><span class="line"></span><br><span class="line">2ï¼špoll(long timeout, TimeUnit unit)ï¼šä»BlockingQueueå–å‡ºä¸€ä¸ªé˜Ÿé¦–çš„å¯¹è±¡ï¼Œå¦‚æœåœ¨æŒ‡å®šæ—¶é—´å†…ï¼Œé˜Ÿåˆ—ä¸€æ—¦æœ‰æ•°æ®å¯å–ï¼Œåˆ™ç«‹å³è¿”å›é˜Ÿåˆ—ä¸­çš„æ•°æ®ã€‚å¦åˆ™ç›´åˆ°æ—¶é—´è¶…æ—¶è¿˜æ²¡æœ‰æ•°æ®å¯å–ï¼Œè¿”å›å¤±è´¥ã€‚</span><br><span class="line"></span><br><span class="line">3ï¼štake():å–èµ° BlockingQueue é‡Œæ’åœ¨é¦–ä½çš„å¯¹è±¡,è‹¥ BlockingQueue ä¸ºç©º,é˜»æ–­è¿›å…¥ç­‰å¾…çŠ¶æ€ç›´åˆ° BlockingQueue æœ‰æ–°çš„æ•°æ®è¢«åŠ å…¥ã€‚</span><br><span class="line"></span><br><span class="line">4.drainTo():ä¸€æ¬¡æ€§ä» BlockingQueue è·å–æ‰€æœ‰å¯ç”¨çš„æ•°æ®å¯¹è±¡ï¼ˆè¿˜å¯ä»¥æŒ‡å®šè·å–æ•°æ®çš„ä¸ªæ•°ï¼‰ï¼Œé€šè¿‡è¯¥æ–¹æ³•ï¼Œå¯ä»¥æå‡è·å–æ•°æ®æ•ˆç‡ï¼›ä¸éœ€è¦å¤šæ¬¡åˆ†æ‰¹åŠ é”æˆ–é‡Šæ”¾é”ã€‚</span><br><span class="line"></span><br><span class="line">## Java ä¸­çš„é˜»å¡é˜Ÿåˆ—</span><br><span class="line">1. ArrayBlockingQueue ï¼šç”±æ•°ç»„ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚</span><br><span class="line">2. LinkedBlockingQueue ï¼šç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚</span><br><span class="line">3. PriorityBlockingQueue ï¼šæ”¯æŒä¼˜å…ˆçº§æ’åºçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚</span><br><span class="line">4. DelayQueueï¼šä½¿ç”¨ä¼˜å…ˆçº§é˜Ÿåˆ—å®ç°çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚</span><br><span class="line">5. SynchronousQueueï¼šä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ã€‚</span><br><span class="line">6. LinkedTransferQueueï¼šç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚</span><br><span class="line">7. LinkedBlockingDequeï¼šç”±é“¾è¡¨ç»“æ„ç»„æˆçš„åŒå‘é˜»å¡é˜Ÿåˆ—</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">## ArrayBlockingQueueï¼ˆå…¬å¹³ã€éå…¬å¹³ï¼‰</span><br><span class="line">ç”¨æ•°ç»„å®ç°çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ã€‚æ­¤é˜Ÿåˆ—æŒ‰ç…§å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„åŸåˆ™å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚é»˜è®¤æƒ…å†µä¸‹ä¸ä¿è¯è®¿é—®è€…å…¬å¹³çš„è®¿é—®é˜Ÿåˆ—ï¼Œæ‰€è°“å…¬å¹³è®¿é—®é˜Ÿåˆ—æ˜¯æŒ‡é˜»å¡çš„æ‰€æœ‰ç”Ÿäº§è€…çº¿ç¨‹æˆ–æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œå½“é˜Ÿåˆ—å¯ç”¨æ—¶ï¼Œå¯ä»¥æŒ‰ç…§é˜»å¡çš„å…ˆåé¡ºåºè®¿é—®é˜Ÿåˆ—ï¼Œå³å…ˆé˜»å¡çš„ç”Ÿäº§è€…çº¿ç¨‹ï¼Œå¯ä»¥å…ˆå¾€é˜Ÿåˆ—é‡Œæ’å…¥å…ƒç´ ï¼Œå…ˆé˜»å¡çš„æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œå¯ä»¥å…ˆä»é˜Ÿåˆ—é‡Œè·å–å…ƒç´ ã€‚é€šå¸¸æƒ…å†µä¸‹ä¸ºäº†ä¿è¯å…¬å¹³æ€§ä¼šé™ä½ååé‡ã€‚æˆ‘ä»¬å¯ä»¥ä½¿ç”¨ä»¥ä¸‹ä»£ç åˆ›å»ºä¸€ä¸ªå…¬å¹³çš„é˜»å¡é˜Ÿåˆ—ï¼š</span><br><span class="line"></span><br><span class="line">ArrayBlockingQueue fairQueue = new ArrayBlockingQueue(1000,true);</span><br><span class="line"></span><br><span class="line">## LinkedBlockingQueueï¼ˆä¸¤ä¸ªç‹¬ç«‹é”æé«˜å¹¶å‘ï¼‰</span><br><span class="line">åŸºäºé“¾è¡¨çš„é˜»å¡é˜Ÿåˆ—ï¼ŒåŒ ArrayListBlockingQueueç±»ä¼¼ï¼Œæ­¤é˜Ÿåˆ—æŒ‰ç…§å…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼‰çš„åŸåˆ™å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚è€ŒLinkedBlockingQueueä¹‹æ‰€ä»¥èƒ½å¤Ÿé«˜æ•ˆçš„å¤„ç†å¹¶å‘æ•°æ®ï¼Œè¿˜å› ä¸ºå…¶å¯¹äºç”Ÿäº§è€…ç«¯å’Œæ¶ˆè´¹è€…ç«¯åˆ†åˆ«é‡‡ç”¨äº†ç‹¬ç«‹çš„é”æ¥æ§åˆ¶æ•°æ®åŒæ­¥ï¼Œè¿™ä¹Ÿæ„å‘³ç€åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…å¯ä»¥å¹¶è¡Œåœ°æ“ä½œé˜Ÿåˆ—ä¸­çš„æ•°æ®ï¼Œä»¥æ­¤æ¥æé«˜æ•´ä¸ªé˜Ÿåˆ—çš„å¹¶å‘æ€§èƒ½ã€‚LinkedBlockingQueue ä¼šé»˜è®¤ä¸€ä¸ªç±»ä¼¼æ— é™å¤§å°çš„å®¹é‡ï¼ˆInteger.MAX_VALUEï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">## PriorityBlockingQueueï¼ˆcompareTo æ’åºå®ç°ä¼˜å…ˆï¼‰</span><br><span class="line">æ˜¯ä¸€ä¸ªæ”¯æŒä¼˜å…ˆçº§çš„æ— ç•Œé˜Ÿåˆ—ã€‚é»˜è®¤æƒ…å†µä¸‹å…ƒç´ é‡‡å–è‡ªç„¶é¡ºåºå‡åºæ’åˆ—ã€‚å¯ä»¥è‡ªå®šä¹‰å®ç°compareTo()æ–¹æ³•æ¥æŒ‡å®šå…ƒç´ è¿›è¡Œæ’åºè§„åˆ™ï¼Œæˆ–è€…åˆå§‹åŒ– PriorityBlockingQueue æ—¶ï¼ŒæŒ‡å®šæ„é€ å‚æ•° Comparator æ¥å¯¹å…ƒç´ è¿›è¡Œæ’åºã€‚éœ€è¦æ³¨æ„çš„æ˜¯ä¸èƒ½ä¿è¯åŒä¼˜å…ˆçº§å…ƒç´ çš„é¡ºåºã€‚</span><br><span class="line"></span><br><span class="line">## DelayQueueï¼ˆç¼“å­˜å¤±æ•ˆã€å®šæ—¶ä»»åŠ¡ ï¼‰</span><br><span class="line">æ˜¯ä¸€ä¸ªæ”¯æŒå»¶æ—¶è·å–å…ƒç´ çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚é˜Ÿåˆ—ä½¿ç”¨PriorityQueueæ¥å®ç°ã€‚é˜Ÿåˆ—ä¸­çš„å…ƒç´ å¿…é¡»å®ç°Delayedæ¥å£ï¼Œåœ¨åˆ›å»ºå…ƒç´ æ—¶å¯ä»¥æŒ‡å®šå¤šä¹…æ‰èƒ½ä»é˜Ÿåˆ—ä¸­è·å–å½“å‰å…ƒç´ ã€‚åªæœ‰åœ¨å»¶è¿ŸæœŸæ»¡æ—¶æ‰èƒ½ä»é˜Ÿåˆ—ä¸­æå–å…ƒç´ ã€‚æˆ‘ä»¬å¯ä»¥å°† DelayQueue è¿ç”¨åœ¨ä»¥ä¸‹åº”ç”¨åœºæ™¯ï¼š</span><br><span class="line"></span><br><span class="line">1. ç¼“å­˜ç³»ç»Ÿçš„è®¾è®¡ï¼šå¯ä»¥ç”¨ DelayQueueä¿å­˜ç¼“å­˜å…ƒç´ çš„æœ‰æ•ˆæœŸï¼Œä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹å¾ªç¯æŸ¥è¯¢DelayQueueï¼Œä¸€æ—¦èƒ½ä»DelayQueueä¸­è·å–å…ƒç´ æ—¶ï¼Œè¡¨ç¤ºç¼“å­˜æœ‰æ•ˆæœŸåˆ°äº†ã€‚</span><br><span class="line">2. å®šæ—¶ä»»åŠ¡è°ƒåº¦ï¼šä½¿ç”¨ DelayQueue ä¿å­˜å½“å¤©å°†ä¼šæ‰§è¡Œçš„ä»»åŠ¡å’Œæ‰§è¡Œæ—¶é—´ï¼Œä¸€æ—¦ä»DelayQueue ä¸­è·å–åˆ°ä»»åŠ¡å°±å¼€å§‹æ‰§è¡Œï¼Œä»æ¯”å¦‚ TimerQueue å°±æ˜¯ä½¿ç”¨ DelayQueue å®ç°çš„ã€‚</span><br><span class="line"></span><br><span class="line">## SynchronousQueueï¼ˆä¸å­˜å‚¨æ•°æ®ã€å¯ç”¨äºä¼ é€’æ•°æ®ï¼‰</span><br><span class="line">æ˜¯ä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ã€‚æ¯ä¸€ä¸ª putæ“ä½œå¿…é¡»ç­‰å¾…ä¸€ä¸ªtakeæ“ä½œï¼Œå¦åˆ™ä¸èƒ½ç»§ç»­æ·»åŠ å…ƒç´ ã€‚SynchronousQueueå¯ä»¥çœ‹æˆæ˜¯ä¸€ä¸ªä¼ çƒæ‰‹ï¼Œè´Ÿè´£æŠŠç”Ÿäº§è€…çº¿ç¨‹å¤„ç†çš„æ•°æ®ç›´æ¥ä¼ é€’ç»™æ¶ˆè´¹è€…çº¿ç¨‹ã€‚é˜Ÿåˆ—æœ¬èº«å¹¶ä¸å­˜å‚¨ä»»ä½•å…ƒç´ ï¼Œéå¸¸é€‚åˆäºä¼ é€’æ€§åœºæ™¯,æ¯”å¦‚åœ¨ä¸€ä¸ªçº¿ç¨‹ä¸­ä½¿ç”¨çš„æ•°æ®ï¼Œä¼ é€’ç»™å¦ å¤– ä¸€ ä¸ª çº¿ ç¨‹ ä½¿ ç”¨ ï¼Œ SynchronousQueue çš„ å å é‡ é«˜ äº LinkedBlockingQueue å’ŒArrayBlockingQueueã€‚</span><br><span class="line"></span><br><span class="line">## LinkedTransferQueue</span><br><span class="line">æ˜¯ ä¸€ ä¸ª ç”± é“¾ è¡¨ ç»“ æ„ ç»„ æˆ çš„ æ—  ç•Œ é˜» å¡ TransferQueue é˜Ÿ åˆ— ã€‚ ç›¸ å¯¹ äº å…¶ ä»– é˜» å¡ é˜Ÿ åˆ— ï¼ŒLinkedTransferQueue å¤šäº† tryTransfer å’Œ transfer æ–¹æ³•ã€‚</span><br><span class="line">1. transfer æ–¹æ³•ï¼šå¦‚æœå½“å‰æœ‰æ¶ˆè´¹è€…æ­£åœ¨ç­‰å¾…æ¥æ”¶å…ƒç´ ï¼ˆæ¶ˆè´¹è€…ä½¿ç”¨ take()æ–¹æ³•æˆ–å¸¦æ—¶é—´é™åˆ¶çš„poll()æ–¹æ³•æ—¶ï¼‰ï¼Œtransferæ–¹æ³•å¯ä»¥æŠŠç”Ÿäº§è€…ä¼ å…¥çš„å…ƒç´ ç«‹åˆ» transferï¼ˆä¼ è¾“ï¼‰ç»™æ¶ˆè´¹è€…ã€‚å¦‚æœæ²¡æœ‰æ¶ˆè´¹è€…åœ¨ç­‰å¾…æ¥æ”¶å…ƒç´ ï¼Œtransfer æ–¹æ³•ä¼šå°†å…ƒç´ å­˜æ”¾åœ¨é˜Ÿåˆ—çš„ tail èŠ‚ç‚¹ï¼Œå¹¶ç­‰åˆ°è¯¥å…ƒç´ è¢«æ¶ˆè´¹è€…æ¶ˆè´¹äº†æ‰è¿”å›ã€‚</span><br><span class="line">2. tryTransfer æ–¹æ³•ã€‚åˆ™æ˜¯ç”¨æ¥è¯•æ¢ä¸‹ç”Ÿäº§è€…ä¼ å…¥çš„å…ƒç´ æ˜¯å¦èƒ½ç›´æ¥ä¼ ç»™æ¶ˆè´¹è€…ã€‚å¦‚æœæ²¡æœ‰æ¶ˆè´¹è€…ç­‰å¾…æ¥æ”¶å…ƒç´ ï¼Œåˆ™è¿”å› falseã€‚å’Œ transfer æ–¹æ³•çš„åŒºåˆ«æ˜¯ tryTransfer æ–¹æ³•æ— è®ºæ¶ˆè´¹è€…æ˜¯å¦æ¥æ”¶ï¼Œæ–¹æ³•ç«‹å³è¿”å›ã€‚è€Œ transfer æ–¹æ³•æ˜¯å¿…é¡»ç­‰åˆ°æ¶ˆè´¹è€…æ¶ˆè´¹äº†æ‰è¿”å›ã€‚å¯¹äºå¸¦æœ‰æ—¶é—´é™åˆ¶çš„ tryTransfer(E e, long timeout, TimeUnit unit)æ–¹æ³•ï¼Œåˆ™æ˜¯è¯•å›¾æŠŠç”Ÿäº§è€…ä¼ å…¥çš„å…ƒç´ ç›´æ¥ä¼ ç»™æ¶ˆè´¹è€…ï¼Œä½†æ˜¯å¦‚æœæ²¡æœ‰æ¶ˆè´¹è€…æ¶ˆè´¹è¯¥å…ƒç´ åˆ™ç­‰å¾…æŒ‡å®šçš„æ—¶é—´å†è¿”å›ï¼Œå¦‚æœè¶…æ—¶è¿˜æ²¡æ¶ˆè´¹å…ƒç´ ï¼Œåˆ™è¿”å› falseï¼Œå¦‚æœåœ¨è¶…æ—¶æ—¶é—´å†…æ¶ˆè´¹äº†å…ƒç´ ï¼Œåˆ™è¿”å› trueã€‚</span><br><span class="line"></span><br><span class="line">## LinkedBlockingDeque</span><br><span class="line">æ˜¯ä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„åŒå‘é˜»å¡é˜Ÿåˆ—ã€‚æ‰€è°“åŒå‘é˜Ÿåˆ—æŒ‡çš„ä½ å¯ä»¥ä»é˜Ÿåˆ—çš„ä¸¤ç«¯æ’å…¥å’Œç§»å‡ºå…ƒç´ ã€‚åŒç«¯é˜Ÿåˆ—å› ä¸ºå¤šäº†ä¸€ä¸ªæ“ä½œé˜Ÿåˆ—çš„å…¥å£ï¼Œåœ¨å¤šçº¿ç¨‹åŒæ—¶å…¥é˜Ÿæ—¶ï¼Œä¹Ÿå°±å‡å°‘äº†ä¸€åŠçš„ç«äº‰ã€‚ç›¸æ¯”å…¶ä»–çš„é˜»å¡é˜Ÿåˆ—ï¼ŒLinkedBlockingDeque å¤šäº† addFirstï¼ŒaddLastï¼ŒofferFirstï¼ŒofferLastï¼ŒpeekFirstï¼ŒpeekLast ç­‰æ–¹æ³•ï¼Œä»¥ First å•è¯ç»“å°¾çš„æ–¹æ³•ï¼Œè¡¨ç¤ºæ’å…¥ï¼Œè·å–ï¼ˆpeekï¼‰æˆ–ç§»é™¤åŒç«¯é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚ä»¥ Lastå•è¯ç»“å°¾çš„æ–¹æ³•ï¼Œè¡¨ç¤ºæ’å…¥ï¼Œè·å–æˆ–ç§»é™¤åŒç«¯é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚å¦</span><br><span class="line">å¤–æ’å…¥æ–¹æ³• add ç­‰åŒäº addLastï¼Œç§»é™¤æ–¹æ³• remove ç­‰æ•ˆäº removeFirstã€‚ä½†æ˜¯ take æ–¹æ³•å´ç­‰åŒäº takeFirstï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯ Jdk çš„bugï¼Œä½¿ç”¨æ—¶è¿˜æ˜¯ç”¨å¸¦æœ‰ First å’Œ Last åç¼€çš„æ–¹æ³•æ›´æ¸…æ¥šã€‚åœ¨åˆå§‹åŒ– LinkedBlockingDeque æ—¶å¯ä»¥è®¾ç½®å®¹é‡é˜²æ­¢å…¶è¿‡æ¸¡è†¨èƒ€ã€‚å¦å¤–åŒå‘é˜»å¡é˜Ÿåˆ—å¯ä»¥è¿ç”¨åœ¨â€œå·¥ä½œçªƒå–â€æ¨¡å¼ä¸­ã€‚</span><br><span class="line"></span><br><span class="line"># CyclicBarrierã€CountDownLatchã€Semaphore çš„ç”¨æ³•</span><br><span class="line">## CountDownLatchï¼ˆçº¿ç¨‹è®¡æ•°å™¨ ï¼‰</span><br><span class="line">CountDownLatch ç±»ä½äº java.util.concurrentåŒ…ä¸‹ï¼Œåˆ©ç”¨å®ƒå¯ä»¥å®ç°ç±»ä¼¼è®¡æ•°å™¨çš„åŠŸèƒ½ã€‚æ¯”å¦‚æœ‰ä¸€ä¸ªä»»åŠ¡Aï¼Œå®ƒè¦ç­‰å¾…å…¶ä»–4ä¸ªä»»åŠ¡æ‰§è¡Œå®Œæ¯•ä¹‹åæ‰èƒ½æ‰§è¡Œï¼Œæ­¤æ—¶å°±å¯ä»¥åˆ©ç”¨ CountDownLatchæ¥å®ç°è¿™ç§åŠŸèƒ½äº†ã€‚CountDownLatchæ˜¯ä¸€ä¸ªåŒæ­¥å·¥å…·ç±»ï¼Œç”¨æ¥åè°ƒå¤šä¸ªçº¿ç¨‹ä¹‹é—´çš„åŒæ­¥ï¼Œæˆ–è€…è¯´èµ·åˆ°çº¿ç¨‹ä¹‹é—´çš„é€šä¿¡ï¼ˆè€Œä¸æ˜¯ç”¨ä½œäº’æ–¥çš„ä½œç”¨ï¼‰ã€‚</span><br><span class="line"></span><br><span class="line">CountDownLatchèƒ½å¤Ÿä½¿ä¸€ä¸ªçº¿ç¨‹åœ¨ç­‰å¾…å¦å¤–ä¸€äº›çº¿ç¨‹å®Œæˆå„è‡ªå·¥ä½œä¹‹åï¼Œå†ç»§ç»­æ‰§è¡Œã€‚ä½¿ç”¨ä¸€ä¸ªè®¡æ•°å™¨è¿›è¡Œå®ç°ã€‚è®¡æ•°å™¨åˆå§‹å€¼ä¸ºçº¿ç¨‹çš„æ•°é‡ã€‚å½“æ¯ä¸€ä¸ªçº¿ç¨‹å®Œæˆè‡ªå·±ä»»åŠ¡åï¼Œè®¡æ•°å™¨çš„å€¼å°±ä¼šå‡ä¸€ã€‚å½“è®¡æ•°å™¨çš„å€¼ä¸º0æ—¶ï¼Œè¡¨ç¤ºæ‰€æœ‰çš„çº¿ç¨‹éƒ½å·²ç»å®Œæˆä¸€äº›ä»»åŠ¡ï¼Œç„¶ååœ¨CountDownLatchä¸Šç­‰å¾…çš„çº¿ç¨‹å°±å¯ä»¥æ¢å¤æ‰§è¡Œæ¥ä¸‹æ¥çš„ä»»åŠ¡ã€‚</span><br><span class="line"></span><br><span class="line">&lt;details&gt;</span><br><span class="line">    &lt;summary&gt;CountDownLatch&lt;/summary&gt;</span><br><span class="line">    </span><br><span class="line">``` </span><br><span class="line"></span><br><span class="line">    final CountDownLatch latch = new CountDownLatch(2);</span><br><span class="line">        new Thread() &#123;</span><br><span class="line">            public void run() &#123;</span><br><span class="line">                System.out.println(&quot;å­çº¿ç¨‹&quot; + Thread.currentThread().getName() + &quot;æ­£åœ¨æ‰§è¡Œ&quot;);</span><br><span class="line">                Thread.sleep(3000);</span><br><span class="line">                System.out.println(&quot;å­çº¿ç¨‹&quot; + Thread.currentThread().getName() + &quot;æ‰§è¡Œå®Œæ¯•&quot;);</span><br><span class="line">                latch.countDown();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ;</span><br><span class="line">        &#125;.start();</span><br><span class="line">        new Thread() &#123;</span><br><span class="line">            public void run() &#123;</span><br><span class="line">                System.out.println(&quot;å­çº¿ç¨‹&quot; + Thread.currentThread().getName() + &quot;æ­£åœ¨æ‰§è¡Œ&quot;);</span><br><span class="line">                Thread.sleep(3000);</span><br><span class="line">                System.out.println(&quot;å­çº¿ç¨‹&quot; + Thread.currentThread().getName() + &quot;æ‰§è¡Œå®Œæ¯•&quot;);</span><br><span class="line">                latch.countDown();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            ;</span><br><span class="line">        &#125;.start();</span><br><span class="line">        System.out.println(&quot;ç­‰å¾… 2 ä¸ªå­çº¿ç¨‹æ‰§è¡Œå®Œæ¯•...&quot;);</span><br><span class="line">        latch.await();</span><br><span class="line">        System.out.println(&quot;2 ä¸ªå­çº¿ç¨‹å·²ç»æ‰§è¡Œå®Œæ¯•&quot;);</span><br><span class="line">        System.out.println(&quot;ç»§ç»­æ‰§è¡Œä¸»çº¿ç¨‹&quot;);</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></details><h3 id="CountDownLatchçš„ç”¨æ³•"><a href="#CountDownLatchçš„ç”¨æ³•" class="headerlink" title="CountDownLatchçš„ç”¨æ³•"></a>CountDownLatchçš„ç”¨æ³•</h3><p>CountDownLatchå…¸å‹ç”¨æ³•ï¼š</p><p>1ã€æŸä¸€çº¿ç¨‹åœ¨å¼€å§‹è¿è¡Œå‰ç­‰å¾…nä¸ªçº¿ç¨‹æ‰§è¡Œå®Œæ¯•ã€‚å°†CountDownLatchçš„è®¡æ•°å™¨åˆå§‹åŒ–ä¸ºnew CountDownLatch(n)ï¼Œæ¯å½“ä¸€ä¸ªä»»åŠ¡çº¿ç¨‹æ‰§è¡Œå®Œæ¯•ï¼Œå°±å°†è®¡æ•°å™¨å‡1 countdownLatch.countDown()ï¼Œå½“è®¡æ•°å™¨çš„å€¼å˜ä¸º0æ—¶ï¼Œåœ¨CountDownLatchä¸Šawait()çš„çº¿ç¨‹å°±ä¼šè¢«å”¤é†’ã€‚ä¸€ä¸ªå…¸å‹åº”ç”¨åœºæ™¯å°±æ˜¯å¯åŠ¨ä¸€ä¸ªæœåŠ¡æ—¶ï¼Œä¸»çº¿ç¨‹éœ€è¦ç­‰å¾…å¤šä¸ªç»„ä»¶åŠ è½½å®Œæ¯•ï¼Œä¹‹åå†ç»§ç»­æ‰§è¡Œã€‚</p><p>CountDownLatchå…¸å‹ç”¨æ³•ï¼š</p><p>2ã€å®ç°å¤šä¸ªçº¿ç¨‹å¼€å§‹æ‰§è¡Œä»»åŠ¡çš„æœ€å¤§å¹¶è¡Œæ€§ã€‚æ³¨æ„æ˜¯å¹¶è¡Œæ€§ï¼Œä¸æ˜¯å¹¶å‘ï¼Œå¼ºè°ƒçš„æ˜¯å¤šä¸ªçº¿ç¨‹åœ¨æŸä¸€æ—¶åˆ»åŒæ—¶å¼€å§‹æ‰§è¡Œã€‚ç±»ä¼¼äºèµ›è·‘ï¼Œå°†å¤šä¸ªçº¿ç¨‹æ”¾åˆ°èµ·ç‚¹ï¼Œç­‰å¾…å‘ä»¤æªå“ï¼Œç„¶ååŒæ—¶å¼€è·‘ã€‚åšæ³•æ˜¯åˆå§‹åŒ–ä¸€ä¸ªå…±äº«çš„CountDownLatch(1)ï¼Œå°†å…¶è®¡ç®—å™¨åˆå§‹åŒ–ä¸º1ï¼Œå¤šä¸ªçº¿ç¨‹åœ¨å¼€å§‹æ‰§è¡Œä»»åŠ¡å‰é¦–å…ˆcountdownlatch.await()ï¼Œå½“ä¸»çº¿ç¨‹è°ƒç”¨countDown()æ—¶ï¼Œè®¡æ•°å™¨å˜ä¸º0ï¼Œå¤šä¸ªçº¿ç¨‹åŒæ—¶è¢«å”¤é†’ã€‚</p><h3 id="CountDownLatchçš„ä¸è¶³"><a href="#CountDownLatchçš„ä¸è¶³" class="headerlink" title="CountDownLatchçš„ä¸è¶³"></a>CountDownLatchçš„ä¸è¶³</h3><p>CountDownLatchæ˜¯ä¸€æ¬¡æ€§çš„ï¼Œè®¡ç®—å™¨çš„å€¼åªèƒ½åœ¨æ„é€ æ–¹æ³•ä¸­åˆå§‹åŒ–ä¸€æ¬¡ï¼Œä¹‹åæ²¡æœ‰ä»»ä½•æœºåˆ¶å†æ¬¡å¯¹å…¶è®¾ç½®å€¼ï¼Œå½“CountDownLatchä½¿ç”¨å®Œæ¯•åï¼Œå®ƒä¸èƒ½å†æ¬¡è¢«ä½¿ç”¨</p><h2 id="CyclicBarrierï¼ˆå›ç¯æ …æ -ç­‰å¾…è‡³-barrier-çŠ¶æ€å†å…¨éƒ¨åŒæ—¶æ‰§è¡Œï¼‰"><a href="#CyclicBarrierï¼ˆå›ç¯æ …æ -ç­‰å¾…è‡³-barrier-çŠ¶æ€å†å…¨éƒ¨åŒæ—¶æ‰§è¡Œï¼‰" class="headerlink" title="CyclicBarrierï¼ˆå›ç¯æ …æ -ç­‰å¾…è‡³ barrier çŠ¶æ€å†å…¨éƒ¨åŒæ—¶æ‰§è¡Œï¼‰"></a>CyclicBarrierï¼ˆå›ç¯æ …æ -ç­‰å¾…è‡³ barrier çŠ¶æ€å†å…¨éƒ¨åŒæ—¶æ‰§è¡Œï¼‰</h2><p>å­—é¢æ„æ€å›ç¯æ …æ ï¼Œé€šè¿‡å®ƒå¯ä»¥å®ç°è®©ä¸€ç»„çº¿ç¨‹ç­‰å¾…è‡³æŸä¸ªçŠ¶æ€ä¹‹åå†å…¨éƒ¨åŒæ—¶æ‰§è¡Œã€‚å«åšå›ç¯æ˜¯å› ä¸ºå½“æ‰€æœ‰ç­‰å¾…çº¿ç¨‹éƒ½è¢«é‡Šæ”¾ä»¥åï¼ŒCyclicBarrier å¯ä»¥è¢«é‡ç”¨ã€‚æˆ‘ä»¬æš‚ä¸”æŠŠè¿™ä¸ªçŠ¶æ€å°±å«åšbarrierï¼Œå½“è°ƒç”¨ await()æ–¹æ³•ä¹‹åï¼Œçº¿ç¨‹å°±å¤„äº barrier äº†ã€‚CyclicBarrier ä¸­æœ€é‡è¦çš„æ–¹æ³•å°±æ˜¯ await æ–¹æ³•ï¼Œå®ƒæœ‰ 2 ä¸ªé‡è½½ç‰ˆæœ¬ï¼š</p><ol><li>public int await()ï¼šç”¨æ¥æŒ‚èµ·å½“å‰çº¿ç¨‹ï¼Œç›´è‡³æ‰€æœ‰çº¿ç¨‹éƒ½åˆ°è¾¾ barrier çŠ¶æ€å†åŒæ—¶æ‰§è¡Œåç»­ä»»<br>åŠ¡ï¼›</li><li>public int await(long timeout, TimeUnit unit)ï¼šè®©è¿™äº›çº¿ç¨‹ç­‰å¾…è‡³ä¸€å®šçš„æ—¶é—´ï¼Œå¦‚æœè¿˜æœ‰<br>çº¿ç¨‹æ²¡æœ‰åˆ°è¾¾ barrier çŠ¶æ€å°±ç›´æ¥è®©åˆ°è¾¾ barrier çš„çº¿ç¨‹æ‰§è¡Œåç»­ä»»åŠ¡ã€‚</li></ol><p>å…·ä½“ä½¿ç”¨å¦‚ä¸‹ï¼Œå¦å¤– CyclicBarrier æ˜¯å¯ä»¥é‡ç”¨çš„ã€‚</p><details>    <summary>CyclicBarrier</summary><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">import java.util.concurrent.BrokenBarrierException;</span><br><span class="line">import java.util.concurrent.CyclicBarrier;</span><br><span class="line"></span><br><span class="line">public class CyclicBarrierTest &#123;</span><br><span class="line">    static class Writer extends Thread &#123;</span><br><span class="line">        private CyclicBarrier cyclicBarrier;</span><br><span class="line"></span><br><span class="line">        public Writer(CyclicBarrier cyclicBarrier) &#123;</span><br><span class="line">            this.cyclicBarrier = cyclicBarrier;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void run() &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                Thread.sleep(5000);//ä»¥ç¡çœ æ¥æ¨¡æ‹Ÿçº¿ç¨‹éœ€è¦é¢„å®šå†™å…¥æ•°æ®æ“ä½œ</span><br><span class="line">                System.out.println(&quot;çº¿ç¨‹&quot; + Thread.currentThread().getName() + &quot;å†™å…¥æ•°æ®å®Œæ¯•ï¼Œç­‰å¾…å…¶ä»–çº¿ç¨‹å†™å…¥å®Œæ¯•&quot;);</span><br><span class="line">                cyclicBarrier.await();</span><br><span class="line">            &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125; catch (BrokenBarrierException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">            System.out.println(&quot;æ‰€æœ‰çº¿ç¨‹å†™å…¥å®Œæ¯•ï¼Œç»§ç»­å¤„ç†å…¶ä»–ä»»åŠ¡ï¼Œæ¯”å¦‚æ•°æ®æ“ä½œ&quot;);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        int N = 4;</span><br><span class="line">        CyclicBarrier cyclicBarrier = new CyclicBarrier(N);</span><br><span class="line">        for (int i = 0; i &lt; N; i++) &#123;</span><br><span class="line">            new Writer(cyclicBarrier).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h2 id="Semaphoreï¼ˆä¿¡å·é‡-æ§åˆ¶åŒæ—¶è®¿é—®çš„çº¿ç¨‹ä¸ªæ•°ï¼‰"><a href="#Semaphoreï¼ˆä¿¡å·é‡-æ§åˆ¶åŒæ—¶è®¿é—®çš„çº¿ç¨‹ä¸ªæ•°ï¼‰" class="headerlink" title="Semaphoreï¼ˆä¿¡å·é‡-æ§åˆ¶åŒæ—¶è®¿é—®çš„çº¿ç¨‹ä¸ªæ•°ï¼‰"></a>Semaphoreï¼ˆä¿¡å·é‡-æ§åˆ¶åŒæ—¶è®¿é—®çš„çº¿ç¨‹ä¸ªæ•°ï¼‰</h2><p>Semaphore ç¿»è¯‘æˆå­—é¢æ„æ€ä¸º ä¿¡å·é‡ï¼ŒSemaphore å¯ä»¥æ§åˆ¶åŒæ—¶è®¿é—®çš„çº¿ç¨‹ä¸ªæ•°ï¼Œé€šè¿‡acquire()è·å–ä¸€ä¸ªè®¸å¯ï¼Œå¦‚æœæ²¡æœ‰å°±ç­‰å¾…ï¼Œè€Œrelease()é‡Šæ”¾ä¸€ä¸ªè®¸å¯ã€‚</p><p>Semaphore ç±»ä¸­æ¯”è¾ƒé‡è¦çš„å‡ ä¸ªæ–¹æ³•ï¼š</p><ol><li>public void acquire(): ç”¨æ¥è·å–ä¸€ä¸ªè®¸å¯ï¼Œè‹¥æ— è®¸å¯èƒ½å¤Ÿè·å¾—ï¼Œåˆ™ä¼šä¸€ç›´ç­‰å¾…ï¼Œç›´åˆ°è·å¾—è®¸<br>å¯ã€‚</li><li>public void acquire(int permits):è·å– permits ä¸ªè®¸å¯</li><li>public void release() { } :é‡Šæ”¾è®¸å¯ã€‚æ³¨æ„ï¼Œåœ¨é‡Šæ”¾è®¸å¯ä¹‹å‰ï¼Œå¿…é¡»å…ˆè·è·å¾—è®¸å¯ã€‚</li><li>public void release(int permits) { }:é‡Šæ”¾ permits ä¸ªè®¸å¯</li></ol><p>ä¸Šé¢ 4 ä¸ªæ–¹æ³•éƒ½ä¼šè¢«é˜»å¡ï¼Œå¦‚æœæƒ³ç«‹å³å¾—åˆ°æ‰§è¡Œç»“æœï¼Œå¯ä»¥ä½¿ç”¨ä¸‹é¢å‡ ä¸ªæ–¹æ³•</p><ol><li>public boolean tryAcquire():å°è¯•è·å–ä¸€ä¸ªè®¸å¯ï¼Œè‹¥è·å–æˆåŠŸï¼Œåˆ™ç«‹å³è¿”å› trueï¼Œè‹¥è·å–å¤±è´¥ï¼Œåˆ™ç«‹å³è¿”å› false</li><li>public boolean tryAcquire(long timeout, TimeUnit unit):å°è¯•è·å–ä¸€ä¸ªè®¸å¯ï¼Œè‹¥åœ¨æŒ‡å®šçš„æ—¶é—´å†…è·å–æˆåŠŸï¼Œåˆ™ç«‹å³è¿”å› trueï¼Œå¦åˆ™åˆ™ç«‹å³è¿”å› false</li><li>public boolean tryAcquire(int permits):å°è¯•è·å– permits ä¸ªè®¸å¯ï¼Œè‹¥è·å–æˆåŠŸï¼Œåˆ™ç«‹å³è¿”å› trueï¼Œè‹¥è·å–å¤±è´¥ï¼Œåˆ™ç«‹å³è¿”å› false</li><li>public boolean tryAcquire(int permits, long timeout, TimeUnit unit): å°è¯•è·å– permitsä¸ªè®¸å¯ï¼Œè‹¥åœ¨æŒ‡å®šçš„æ—¶é—´å†…è·å–æˆåŠŸï¼Œåˆ™ç«‹å³è¿”å› trueï¼Œå¦åˆ™åˆ™ç«‹å³è¿”å› false</li><li>è¿˜å¯ä»¥é€šè¿‡ availablePermits()æ–¹æ³•å¾—åˆ°å¯ç”¨çš„è®¸å¯æ•°ç›®ã€‚</li></ol><p>ä¾‹å­ï¼šè‹¥ä¸€ä¸ªå·¥å‚æœ‰ 5 å°æœºå™¨ï¼Œä½†æ˜¯æœ‰ 8 ä¸ªå·¥äººï¼Œä¸€å°æœºå™¨åŒæ—¶åªèƒ½è¢«ä¸€ä¸ªå·¥äººä½¿ç”¨ï¼Œåªæœ‰ä½¿ç”¨å®Œäº†ï¼Œå…¶ä»–å·¥äººæ‰èƒ½ç»§ç»­ä½¿ç”¨ã€‚é‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡ Semaphore æ¥å®ç°ï¼š</p><details>    <summary>Semaphore</summary><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">import java.util.concurrent.Semaphore;</span><br><span class="line"></span><br><span class="line">public class SemaphoreTest &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        int N = 8;//å·¥äººæ•°</span><br><span class="line">        Semaphore semaphore = new Semaphore(5); //æœºå™¨æ•°ç›®</span><br><span class="line">        for (int i = 0; i &lt; N; i++) &#123;</span><br><span class="line">            new Worker(i,semaphore).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    static class Worker extends Thread &#123;</span><br><span class="line">        private int num;</span><br><span class="line">        private Semaphore semaphore;</span><br><span class="line"></span><br><span class="line">        public Worker(int num, Semaphore semaphore) &#123;</span><br><span class="line">            this.num = num;</span><br><span class="line">            this.semaphore = semaphore;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void run() &#123;</span><br><span class="line">            try &#123;</span><br><span class="line">                semaphore.acquire();</span><br><span class="line">                System.out.println(&quot;å·¥äºº&quot;+this.num+&quot;å ç”¨ä¸€ä¸ªæœºå™¨åœ¨ç”Ÿäº§...&quot;);</span><br><span class="line">                Thread.sleep(1000);</span><br><span class="line">                System.out.println(&quot;å·¥äºº&quot;+this.num+&quot;é‡Šæ”¾å‡ºæœºå™¨&quot;);</span><br><span class="line">                semaphore.release();</span><br><span class="line">            &#125; catch (InterruptedException e) &#123;</span><br><span class="line">                e.printStackTrace();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><ul><li>CountDownLatch å’ŒCyclicBarrieréƒ½èƒ½å¤Ÿå®ç°çº¿ç¨‹ä¹‹é—´çš„ç­‰å¾…ï¼Œåªä¸è¿‡å®ƒä»¬ä¾§é‡ç‚¹ä¸åŒï¼›CountDownLatchä¸€èˆ¬ç”¨äºæŸä¸ªçº¿ç¨‹Aç­‰å¾…è‹¥å¹²ä¸ªå…¶ä»–çº¿ç¨‹æ‰§è¡Œå®Œä»»åŠ¡ä¹‹åï¼Œå®ƒæ‰æ‰§è¡Œï¼›è€ŒCyclicBarrierä¸€èˆ¬ç”¨äºä¸€ç»„çº¿ç¨‹äº’ç›¸ç­‰å¾…è‡³æŸä¸ªçŠ¶æ€ï¼Œç„¶åè¿™ä¸€ç»„çº¿ç¨‹å†åŒæ—¶æ‰§è¡Œï¼›å¦å¤–ï¼ŒCountDownLatchæ˜¯ä¸èƒ½å¤Ÿé‡ç”¨çš„ï¼Œè€ŒCyclicBarrier æ˜¯å¯ä»¥é‡ç”¨çš„ã€‚</li><li>Semaphore å…¶å®å’Œé”æœ‰ç‚¹ç±»ä¼¼ï¼Œå®ƒä¸€èˆ¬ç”¨äºæ§åˆ¶å¯¹æŸç»„èµ„æºçš„è®¿é—®æƒé™ã€‚</li></ul><h1 id="volatile-å…³é”®å­—çš„ä½œç”¨ï¼ˆå˜é‡å¯è§æ€§ã€ç¦æ­¢é‡æ’åºï¼‰"><a href="#volatile-å…³é”®å­—çš„ä½œç”¨ï¼ˆå˜é‡å¯è§æ€§ã€ç¦æ­¢é‡æ’åºï¼‰" class="headerlink" title="volatile å…³é”®å­—çš„ä½œç”¨ï¼ˆå˜é‡å¯è§æ€§ã€ç¦æ­¢é‡æ’åºï¼‰"></a>volatile å…³é”®å­—çš„ä½œç”¨ï¼ˆå˜é‡å¯è§æ€§ã€ç¦æ­¢é‡æ’åºï¼‰</h1><p>Java è¯­è¨€æä¾›äº†ä¸€ç§ç¨å¼±çš„åŒæ­¥æœºåˆ¶ï¼Œå³ volatile å˜é‡ï¼Œç”¨æ¥ç¡®ä¿å°†å˜é‡çš„æ›´æ–°æ“ä½œé€šçŸ¥åˆ°å…¶ä»–çº¿ç¨‹ã€‚volatile å˜é‡å…·å¤‡ä¸¤ç§ç‰¹æ€§ï¼Œvolatile å˜é‡ä¸ä¼šè¢«ç¼“å­˜åœ¨å¯„å­˜å™¨æˆ–è€…å¯¹å…¶ä»–å¤„ç†å™¨ä¸å¯è§çš„åœ°æ–¹ï¼Œå› æ­¤åœ¨è¯»å– volatile ç±»å‹çš„å˜é‡æ—¶æ€»ä¼šè¿”å›æœ€æ–°å†™å…¥çš„å€¼ã€‚</p><h2 id="å˜é‡å¯è§æ€§"><a href="#å˜é‡å¯è§æ€§" class="headerlink" title="å˜é‡å¯è§æ€§"></a>å˜é‡å¯è§æ€§</h2><p>å…¶ä¸€æ˜¯ä¿è¯è¯¥å˜é‡å¯¹æ‰€æœ‰çº¿ç¨‹å¯è§ï¼Œè¿™é‡Œçš„å¯è§æ€§æŒ‡çš„æ˜¯å½“ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†å˜é‡çš„å€¼ï¼Œé‚£ä¹ˆæ–°çš„å€¼å¯¹äºå…¶ä»–çº¿ç¨‹æ˜¯å¯ä»¥ç«‹å³è·å–çš„ã€‚</p><h2 id="ç¦æ­¢é‡æ’åº"><a href="#ç¦æ­¢é‡æ’åº" class="headerlink" title="ç¦æ­¢é‡æ’åº"></a>ç¦æ­¢é‡æ’åº</h2><p>volatile ç¦æ­¢äº†æŒ‡ä»¤é‡æ’ã€‚</p><h2 id="æ¯”-sychronized-æ›´è½»é‡çº§çš„åŒæ­¥é”"><a href="#æ¯”-sychronized-æ›´è½»é‡çº§çš„åŒæ­¥é”" class="headerlink" title="æ¯” sychronized æ›´è½»é‡çº§çš„åŒæ­¥é”"></a>æ¯” sychronized æ›´è½»é‡çº§çš„åŒæ­¥é”</h2><p>åœ¨è®¿é—® volatile å˜é‡æ—¶ä¸ä¼šæ‰§è¡ŒåŠ é”æ“ä½œï¼Œå› æ­¤ä¹Ÿå°±ä¸ä¼šä½¿æ‰§è¡Œçº¿ç¨‹é˜»å¡ï¼Œå› æ­¤ volatile å˜é‡æ˜¯ä¸€ç§æ¯”sychronizedå…³é”®å­—æ›´è½»é‡çº§çš„åŒæ­¥æœºåˆ¶ã€‚volatile é€‚åˆè¿™ç§åœºæ™¯ï¼šä¸€ä¸ªå˜é‡è¢«å¤šä¸ªçº¿ç¨‹å…±äº«ï¼Œçº¿ç¨‹ç›´æ¥ç»™è¿™ä¸ªå˜é‡èµ‹å€¼ã€‚</p><p>å½“å¯¹é volatile å˜é‡è¿›è¡Œè¯»å†™çš„æ—¶å€™ï¼Œæ¯ä¸ªçº¿ç¨‹å…ˆä»å†…å­˜æ‹·è´å˜é‡åˆ°CPUç¼“å­˜ä¸­ã€‚å¦‚æœè®¡ç®—æœºæœ‰å¤šä¸ªCPUï¼Œæ¯ä¸ªçº¿ç¨‹å¯èƒ½åœ¨ä¸åŒçš„CPUä¸Šè¢«å¤„ç†ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªçº¿ç¨‹å¯ä»¥æ‹·è´åˆ°ä¸åŒçš„ CPU cache ä¸­ã€‚è€Œå£°æ˜å˜é‡æ˜¯ volatile çš„ï¼ŒJVM ä¿è¯äº†æ¯æ¬¡è¯»å˜é‡éƒ½ä»å†…å­˜ä¸­è¯»ï¼Œè·³è¿‡ CPU cacheè¿™ä¸€æ­¥ã€‚</p><h2 id="é€‚ç”¨åœºæ™¯"><a href="#é€‚ç”¨åœºæ™¯" class="headerlink" title="é€‚ç”¨åœºæ™¯"></a>é€‚ç”¨åœºæ™¯</h2><p>å€¼å¾—è¯´æ˜çš„æ˜¯å¯¹ volatile å˜é‡çš„å•æ¬¡è¯»/å†™æ“ä½œå¯ä»¥ä¿è¯åŸå­æ€§çš„ï¼Œå¦‚longå’Œdoubleç±»å‹å˜é‡ï¼Œä½†æ˜¯å¹¶ä¸èƒ½ä¿è¯i++è¿™ç§æ“ä½œçš„åŸå­æ€§ï¼Œå› ä¸ºæœ¬è´¨ä¸Ši++æ˜¯è¯»ã€å†™ä¸¤æ¬¡æ“ä½œã€‚åœ¨æŸäº›åœºæ™¯ä¸‹å¯ä»¥ä»£æ›¿Synchronizedã€‚ä½†æ˜¯,volatileçš„ä¸èƒ½å®Œå…¨å–ä»£Synchronizedçš„ä½ç½®ï¼Œåªæœ‰åœ¨ä¸€äº›ç‰¹æ®Šçš„åœºæ™¯ä¸‹ï¼Œæ‰èƒ½é€‚ç”¨volatileã€‚æ€»çš„æ¥è¯´ï¼Œå¿…é¡»åŒæ—¶æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶æ‰èƒ½ä¿è¯åœ¨å¹¶å‘ç¯å¢ƒçš„çº¿ç¨‹å®‰å…¨ï¼š</p><p> ï¼ˆ1ï¼‰å¯¹å˜é‡çš„å†™æ“ä½œä¸ä¾èµ–äºå½“å‰å€¼ï¼ˆæ¯”å¦‚i++ï¼‰ï¼Œæˆ–è€…è¯´æ˜¯å•çº¯çš„å˜é‡èµ‹å€¼ï¼ˆbooleanflag = trueï¼‰ã€‚</p><p>ï¼ˆ2ï¼‰è¯¥å˜é‡æ²¡æœ‰åŒ…å«åœ¨å…·æœ‰å…¶ä»–å˜é‡çš„ä¸å˜å¼ä¸­ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œä¸åŒçš„volatile å˜é‡ä¹‹é—´ï¼Œä¸èƒ½äº’ç›¸ä¾èµ–ã€‚åªæœ‰åœ¨çŠ¶æ€çœŸæ­£ç‹¬ç«‹äºç¨‹åºå†…å…¶ä»–å†…å®¹æ—¶æ‰èƒ½ä½¿ç”¨ volatileã€‚</p><h1 id="å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´å…±äº«æ•°æ®"><a href="#å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´å…±äº«æ•°æ®" class="headerlink" title="å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´å…±äº«æ•°æ®"></a>å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´å…±äº«æ•°æ®</h1><p>Java é‡Œé¢è¿›è¡Œå¤šçº¿ç¨‹é€šä¿¡çš„ä¸»è¦æ–¹å¼å°±æ˜¯å…±äº«å†…å­˜çš„æ–¹å¼ï¼Œå…±äº«å†…å­˜ä¸»è¦çš„å…³æ³¨ç‚¹æœ‰ä¸¤ä¸ªï¼šå¯è§æ€§å’Œæœ‰åºæ€§åŸå­æ€§ã€‚Javaå†…å­˜æ¨¡å‹ï¼ˆJMMï¼‰è§£å†³äº†å¯è§æ€§å’Œæœ‰åºæ€§çš„é—®é¢˜ï¼Œè€Œé”è§£å†³äº†åŸå­æ€§çš„é—®é¢˜ï¼Œç†æƒ³æƒ…å†µä¸‹æˆ‘ä»¬å¸Œæœ›åšåˆ°â€œåŒæ­¥â€å’Œâ€œäº’æ–¥â€ã€‚æœ‰ä»¥ä¸‹å¸¸è§„å®ç°æ–¹æ³•ï¼š</p><h2 id="å°†æ•°æ®æŠ½è±¡æˆä¸€ä¸ªç±»ï¼Œå¹¶å°†æ•°æ®çš„æ“ä½œä½œä¸ºè¿™ä¸ªç±»çš„æ–¹æ³•"><a href="#å°†æ•°æ®æŠ½è±¡æˆä¸€ä¸ªç±»ï¼Œå¹¶å°†æ•°æ®çš„æ“ä½œä½œä¸ºè¿™ä¸ªç±»çš„æ–¹æ³•" class="headerlink" title="å°†æ•°æ®æŠ½è±¡æˆä¸€ä¸ªç±»ï¼Œå¹¶å°†æ•°æ®çš„æ“ä½œä½œä¸ºè¿™ä¸ªç±»çš„æ–¹æ³•"></a>å°†æ•°æ®æŠ½è±¡æˆä¸€ä¸ªç±»ï¼Œå¹¶å°†æ•°æ®çš„æ“ä½œä½œä¸ºè¿™ä¸ªç±»çš„æ–¹æ³•</h2><ol><li>å°†æ•°æ®æŠ½è±¡æˆä¸€ä¸ªç±»ï¼Œå¹¶å°†å¯¹è¿™ä¸ªæ•°æ®çš„æ“ä½œä½œä¸ºè¿™ä¸ªç±»çš„æ–¹æ³•ï¼Œè¿™ä¹ˆè®¾è®¡å¯ä»¥å’Œå®¹æ˜“åšåˆ°åŒæ­¥ï¼Œåªè¦åœ¨æ–¹æ³•ä¸ŠåŠ â€synchronizedâ€œ</li></ol><details>    <summary>æ•°æ®æŠ½è±¡æˆä¸€ä¸ªç±»</summary><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public class MyData &#123;</span><br><span class="line">    private int j=0;</span><br><span class="line">    public synchronized void add()&#123;</span><br><span class="line">        j++;</span><br><span class="line">        System.out.println(&quot;çº¿ç¨‹&quot;+Thread.currentThread().getName()+&quot; j ä¸ºï¼š&quot;+j);</span><br><span class="line">    &#125;</span><br><span class="line">    public synchronized void dec()&#123;</span><br><span class="line">        j--;</span><br><span class="line">        System.out.println(&quot;çº¿ç¨‹&quot;+Thread.currentThread().getName()+&quot; j ä¸ºï¼š&quot;+j);</span><br><span class="line">    &#125;</span><br><span class="line">    public int getData()&#123;</span><br><span class="line">        return j;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        MyData data = new MyData();</span><br><span class="line">        Runnable add = new AddRunnable(data);</span><br><span class="line">        Runnable dec = new DecRunnable(data);</span><br><span class="line">        for(int i=0;i&lt;2;i++)&#123;</span><br><span class="line">            new Thread(add).start();</span><br><span class="line">            new Thread(dec).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class DecRunnable implements Runnable &#123;</span><br><span class="line">    MyData data;</span><br><span class="line">    public DecRunnable(MyData data)&#123;</span><br><span class="line">        this.data = data;</span><br><span class="line">    &#125;</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        data.dec();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">class AddRunnable implements Runnable&#123;</span><br><span class="line">    MyData data;</span><br><span class="line">    public AddRunnable(MyData data)&#123;</span><br><span class="line">        this.data= data;</span><br><span class="line">    &#125; public void run() &#123;</span><br><span class="line">        data.add();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h2 id="Runnable-å¯¹è±¡ä½œä¸ºä¸€ä¸ªç±»çš„å†…éƒ¨ç±»"><a href="#Runnable-å¯¹è±¡ä½œä¸ºä¸€ä¸ªç±»çš„å†…éƒ¨ç±»" class="headerlink" title="Runnable å¯¹è±¡ä½œä¸ºä¸€ä¸ªç±»çš„å†…éƒ¨ç±»"></a>Runnable å¯¹è±¡ä½œä¸ºä¸€ä¸ªç±»çš„å†…éƒ¨ç±»</h2><ol start="2"><li>å°† Runnable å¯¹è±¡ä½œä¸ºä¸€ä¸ªç±»çš„å†…éƒ¨ç±»ï¼Œå…±äº«æ•°æ®ä½œä¸ºè¿™ä¸ªç±»çš„æˆå‘˜å˜é‡ï¼Œæ¯ä¸ªçº¿ç¨‹å¯¹å…±äº«æ•°æ®çš„æ“ä½œæ–¹æ³•ä¹Ÿå°è£…åœ¨å¤–éƒ¨ç±»ï¼Œä»¥ä¾¿å®ç°å¯¹æ•°æ®çš„å„ä¸ªæ“ä½œçš„åŒæ­¥å’Œäº’æ–¥ï¼Œä½œä¸ºå†…éƒ¨ç±»çš„å„ä¸ªRunnableå¯¹è±¡è°ƒç”¨å¤–éƒ¨ç±»çš„è¿™äº›æ–¹æ³•ã€‚</li></ol><details>    <summary>æ•°æ®æŠ½è±¡æˆä¸€ä¸ªç±»</summary><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">public class MyData &#123;</span><br><span class="line">    private int j = 0;</span><br><span class="line"></span><br><span class="line">    public synchronized void add() &#123;</span><br><span class="line">        j++;</span><br><span class="line">        System.out.println(&quot;çº¿ç¨‹&quot; + Thread.currentThread().getName() + &quot; j ä¸ºï¼š&quot; + j);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public synchronized void dec() &#123;</span><br><span class="line">        j--;</span><br><span class="line">        System.out.println(&quot;çº¿ç¨‹&quot; + Thread.currentThread().getName() + &quot; j ä¸ºï¼š&quot; + j);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public int getData() &#123;</span><br><span class="line">        return j;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line">class TestThread &#123;</span><br><span class="line"></span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        final MyData data = new MyData();</span><br><span class="line">        for (int i = 0; i &lt; 2; i++) &#123;</span><br><span class="line">            new Thread(new Runnable() &#123;</span><br><span class="line">                public void run() &#123;</span><br><span class="line">                    data.add();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).start();</span><br><span class="line">            new Thread(new Runnable() &#123;</span><br><span class="line">                public void run() &#123;</span><br><span class="line">                    data.dec();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;).start();</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h1 id="ThreadLocal-ä½œç”¨ï¼ˆçº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼‰"><a href="#ThreadLocal-ä½œç”¨ï¼ˆçº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼‰" class="headerlink" title="ThreadLocal ä½œç”¨ï¼ˆçº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼‰"></a>ThreadLocal ä½œç”¨ï¼ˆçº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼‰</h1><p>ThreadLocalï¼Œå¾ˆå¤šåœ°æ–¹å«åšçº¿ç¨‹æœ¬åœ°å˜é‡ï¼Œä¹Ÿæœ‰äº›åœ°æ–¹å«åšçº¿ç¨‹æœ¬åœ°å­˜å‚¨ï¼ŒThreadLocalçš„ä½œç”¨æ˜¯æä¾›çº¿ç¨‹å†…çš„å±€éƒ¨å˜é‡ï¼Œè¿™ç§å˜é‡åœ¨çº¿ç¨‹çš„ç”Ÿå‘½å‘¨æœŸå†…èµ·ä½œç”¨ï¼Œå‡å°‘åŒä¸€ä¸ªçº¿ç¨‹å†…å¤šä¸ªå‡½æ•°æˆ–è€…ç»„ä»¶ä¹‹é—´ä¸€äº›å…¬å…±å˜é‡çš„ä¼ é€’çš„å¤æ‚åº¦ã€‚</p><h2 id="ThreadLocalMapï¼ˆçº¿ç¨‹çš„ä¸€ä¸ªå±æ€§ï¼‰"><a href="#ThreadLocalMapï¼ˆçº¿ç¨‹çš„ä¸€ä¸ªå±æ€§ï¼‰" class="headerlink" title="ThreadLocalMapï¼ˆçº¿ç¨‹çš„ä¸€ä¸ªå±æ€§ï¼‰"></a>ThreadLocalMapï¼ˆçº¿ç¨‹çš„ä¸€ä¸ªå±æ€§ï¼‰</h2><ol><li>æ¯ä¸ªçº¿ç¨‹ä¸­éƒ½æœ‰ä¸€ä¸ªè‡ªå·±çš„ ThreadLocalMap ç±»å¯¹è±¡ï¼Œå¯ä»¥å°†çº¿ç¨‹è‡ªå·±çš„å¯¹è±¡ä¿æŒåˆ°å…¶ä¸­ï¼Œå„ç®¡å„çš„ï¼Œçº¿ç¨‹å¯ä»¥æ­£ç¡®çš„è®¿é—®åˆ°è‡ªå·±çš„å¯¹è±¡ã€‚</li><li>å°†ä¸€ä¸ªå…±ç”¨çš„ ThreadLocalé™æ€å®ä¾‹ä½œä¸ºkeyï¼Œå°†ä¸åŒå¯¹è±¡çš„å¼•ç”¨ä¿å­˜åˆ°ä¸åŒçº¿ç¨‹çš„ThreadLocalMap ä¸­ï¼Œç„¶ååœ¨çº¿ç¨‹æ‰§è¡Œçš„å„å¤„é€šè¿‡è¿™ä¸ªé™æ€ ThreadLocal å®ä¾‹çš„get()æ–¹æ³•å–å¾—è‡ªå·±çº¿ç¨‹ä¿å­˜çš„é‚£ä¸ªå¯¹è±¡ï¼Œé¿å…äº†å°†è¿™ä¸ªå¯¹è±¡ä½œä¸ºå‚æ•°ä¼ é€’çš„éº»çƒ¦ã€‚</li><li>ThreadLocalMap å…¶å®å°±æ˜¯çº¿ç¨‹é‡Œé¢çš„ä¸€ä¸ªå±æ€§ï¼Œå®ƒåœ¨ Thread ç±»ä¸­å®šä¹‰</li></ol><p>ThreadLocal.ThreadLocalMap threadLocals = null;</p><h2 id="ä½¿ç”¨åœºæ™¯"><a href="#ä½¿ç”¨åœºæ™¯" class="headerlink" title="ä½¿ç”¨åœºæ™¯"></a>ä½¿ç”¨åœºæ™¯</h2><p>æœ€å¸¸è§çš„ ThreadLocal ä½¿ç”¨åœºæ™¯ä¸º ç”¨æ¥è§£å†³ æ•°æ®åº“è¿æ¥ã€Session ç®¡ç†ç­‰ã€‚</p><details>    <summary>æ•°æ®æŠ½è±¡æˆä¸€ä¸ªç±»</summary><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">private static final ThreadLocal threadSession = new ThreadLocal();</span><br><span class="line">public static Session getSession() throws InfrastructureException &#123;</span><br><span class="line">    Session s = (Session) threadSession.get();</span><br><span class="line">    try &#123;</span><br><span class="line">        if (s == null) &#123;</span><br><span class="line">            s = getSessionFactory().openSession();</span><br><span class="line">            threadSession.set(s);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; catch (HibernateException ex) &#123;</span><br><span class="line">        throw new InfrastructureException(ex);</span><br><span class="line">    &#125;</span><br><span class="line">    return s;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h1 id="synchronized-å’Œ-ReentrantLock-çš„åŒºåˆ«"><a href="#synchronized-å’Œ-ReentrantLock-çš„åŒºåˆ«" class="headerlink" title="synchronized å’Œ ReentrantLock çš„åŒºåˆ«"></a>synchronized å’Œ ReentrantLock çš„åŒºåˆ«</h1><h2 id="ä¸¤è€…çš„å…±åŒç‚¹ï¼š"><a href="#ä¸¤è€…çš„å…±åŒç‚¹ï¼š" class="headerlink" title="ä¸¤è€…çš„å…±åŒç‚¹ï¼š"></a>ä¸¤è€…çš„å…±åŒç‚¹ï¼š</h2><ol><li>éƒ½æ˜¯ç”¨æ¥åè°ƒå¤šçº¿ç¨‹å¯¹å…±äº«å¯¹è±¡ã€å˜é‡çš„è®¿é—®</li><li>éƒ½æ˜¯å¯é‡å…¥é”ï¼ŒåŒä¸€çº¿ç¨‹å¯ä»¥å¤šæ¬¡è·å¾—åŒä¸€ä¸ªé”</li><li>éƒ½ä¿è¯äº†å¯è§æ€§å’Œäº’æ–¥æ€§</li></ol><h2 id="ä¸¤è€…çš„ä¸åŒç‚¹ï¼š"><a href="#ä¸¤è€…çš„ä¸åŒç‚¹ï¼š" class="headerlink" title="ä¸¤è€…çš„ä¸åŒç‚¹ï¼š"></a>ä¸¤è€…çš„ä¸åŒç‚¹ï¼š</h2><ol><li>ReentrantLock æ˜¾ç¤ºçš„è·å¾—ã€é‡Šæ”¾é”ï¼Œsynchronized éšå¼è·å¾—é‡Šæ”¾é”</li><li>ReentrantLock å¯å“åº”ä¸­æ–­ã€å¯è½®å›ï¼Œsynchronized æ˜¯ä¸å¯ä»¥å“åº”ä¸­æ–­çš„ï¼Œä¸ºå¤„ç†é”çš„ä¸å¯ç”¨æ€§æä¾›äº†æ›´é«˜çš„çµæ´»æ€§</li><li>ReentrantLock æ˜¯ API çº§åˆ«çš„ï¼Œsynchronized æ˜¯ JVM çº§åˆ«çš„</li><li>ReentrantLock å¯ä»¥å®ç°å…¬å¹³é”</li><li>ReentrantLock é€šè¿‡ Condition å¯ä»¥ç»‘å®šå¤šä¸ªæ¡ä»¶</li><li>åº•å±‚å®ç°ä¸ä¸€æ ·ï¼Œ synchronized æ˜¯åŒæ­¥é˜»å¡ï¼Œä½¿ç”¨çš„æ˜¯æ‚²è§‚å¹¶å‘ç­–ç•¥ï¼Œlock æ˜¯åŒæ­¥éé˜»å¡ï¼Œé‡‡ç”¨çš„æ˜¯ä¹è§‚å¹¶å‘ç­–ç•¥</li><li>Lock æ˜¯ä¸€ä¸ªæ¥å£ï¼Œè€Œ synchronized æ˜¯ Java ä¸­çš„å…³é”®å­—ï¼Œsynchronized æ˜¯å†…ç½®çš„è¯­è¨€å®ç°ã€‚</li><li>synchronized åœ¨å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œä¼šè‡ªåŠ¨é‡Šæ”¾çº¿ç¨‹å æœ‰çš„é”ï¼Œå› æ­¤ä¸ä¼šå¯¼è‡´æ­»é”ç°è±¡å‘ç”Ÿï¼›è€Œ Lock åœ¨å‘ç”Ÿå¼‚å¸¸æ—¶ï¼Œå¦‚æœæ²¡æœ‰ä¸»åŠ¨é€šè¿‡ unLock()å»é‡Šæ”¾é”ï¼Œåˆ™å¾ˆå¯èƒ½é€ æˆæ­»é”ç°è±¡ï¼Œå› æ­¤ä½¿ç”¨ Lock æ—¶éœ€è¦åœ¨ finally å—ä¸­é‡Šæ”¾é”ã€‚</li><li>Lock å¯ä»¥è®©ç­‰å¾…é”çš„çº¿ç¨‹å“åº”ä¸­æ–­ï¼Œè€Œ synchronized å´ä¸è¡Œï¼Œä½¿ç”¨ synchronized æ—¶ï¼Œç­‰å¾…çš„çº¿ç¨‹ä¼šä¸€ç›´ç­‰å¾…ä¸‹å»ï¼Œä¸èƒ½å¤Ÿå“åº”ä¸­æ–­ã€‚</li><li>é€šè¿‡ Lock å¯ä»¥çŸ¥é“æœ‰æ²¡æœ‰æˆåŠŸè·å–é”ï¼Œè€Œ synchronized å´æ— æ³•åŠåˆ°ã€‚</li><li>Lock å¯ä»¥æé«˜å¤šä¸ªçº¿ç¨‹è¿›è¡Œè¯»æ“ä½œçš„æ•ˆç‡ï¼Œæ—¢å°±æ˜¯å®ç°è¯»å†™é”ç­‰ã€‚</li></ol><h1 id="ConcurrentHashMap-å¹¶å‘"><a href="#ConcurrentHashMap-å¹¶å‘" class="headerlink" title="ConcurrentHashMap å¹¶å‘"></a>ConcurrentHashMap å¹¶å‘</h1><h2 id="å‡å°é”ç²’åº¦"><a href="#å‡å°é”ç²’åº¦" class="headerlink" title="å‡å°é”ç²’åº¦"></a>å‡å°é”ç²’åº¦</h2><p>å‡å°é”ç²’åº¦æ˜¯æŒ‡ç¼©å°é”å®šå¯¹è±¡çš„èŒƒå›´ï¼Œä»è€Œå‡å°é”å†²çªçš„å¯èƒ½æ€§ï¼Œä»è€Œæé«˜ç³»ç»Ÿçš„å¹¶å‘èƒ½åŠ›ã€‚å‡å°é”ç²’åº¦æ˜¯ä¸€ç§å‰Šå¼±å¤šçº¿ç¨‹é”ç«äº‰çš„æœ‰æ•ˆæ‰‹æ®µï¼Œè¿™ç§æŠ€æœ¯å…¸å‹çš„åº”ç”¨æ˜¯ ConcurrentHashMap(é«˜æ€§èƒ½çš„ HashMap)ç±»çš„å®ç°ã€‚å¯¹äºHashMapè€Œè¨€ï¼Œæœ€é‡è¦çš„ä¸¤ä¸ªæ–¹æ³•æ˜¯getä¸setæ–¹æ³•ï¼Œå¦‚æœæˆ‘ä»¬å¯¹æ•´ä¸ªHashMapåŠ é”ï¼Œå¯ä»¥å¾—åˆ°çº¿ç¨‹å®‰å…¨çš„å¯¹è±¡ï¼Œä½†æ˜¯åŠ é”ç²’åº¦å¤ªå¤§ã€‚Segment çš„å¤§å°ä¹Ÿè¢«ç§°ä¸º ConcurrentHashMap çš„å¹¶å‘åº¦ã€‚</p><h2 id="ConcurrentHashMap-åˆ†æ®µé”"><a href="#ConcurrentHashMap-åˆ†æ®µé”" class="headerlink" title="ConcurrentHashMap åˆ†æ®µé”"></a>ConcurrentHashMap åˆ†æ®µé”</h2><p>ConcurrentHashMapï¼Œå®ƒå†…éƒ¨ç»†åˆ†äº†è‹¥å¹²ä¸ªå°çš„HashMapï¼Œç§°ä¹‹ä¸ºæ®µ(Segment)ã€‚é»˜è®¤æƒ…å†µä¸‹ä¸€ä¸ªConcurrentHashMapè¢«è¿›ä¸€æ­¥ç»†åˆ†ä¸º16ä¸ªæ®µï¼Œæ—¢å°±æ˜¯é”çš„å¹¶å‘åº¦ã€‚å¦‚æœéœ€è¦åœ¨ ConcurrentHashMap ä¸­æ·»åŠ ä¸€ä¸ªæ–°çš„è¡¨é¡¹ï¼Œå¹¶ä¸æ˜¯å°†æ•´ä¸ªHashMapåŠ é”ï¼Œè€Œæ˜¯é¦–å…ˆæ ¹æ®hashcodeå¾—åˆ°è¯¥è¡¨é¡¹åº”è¯¥å­˜æ”¾åœ¨å“ªä¸ªæ®µä¸­ï¼Œç„¶åå¯¹è¯¥æ®µåŠ é”ï¼Œå¹¶å®Œæˆ put æ“ä½œã€‚åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œå¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è¿›è¡Œ putæ“ä½œï¼Œåªè¦è¢«åŠ å…¥çš„è¡¨é¡¹ä¸å­˜æ”¾åœ¨åŒä¸€ä¸ªæ®µä¸­ï¼Œåˆ™çº¿ç¨‹é—´å¯ä»¥åšåˆ°çœŸæ­£çš„å¹¶è¡Œã€‚</p><h3 id="ConcurrentHashMap-æ˜¯ç”±-Segment-æ•°ç»„ç»“æ„å’Œ-HashEntry-æ•°ç»„ç»“æ„ç»„æˆ"><a href="#ConcurrentHashMap-æ˜¯ç”±-Segment-æ•°ç»„ç»“æ„å’Œ-HashEntry-æ•°ç»„ç»“æ„ç»„æˆ" class="headerlink" title="ConcurrentHashMap æ˜¯ç”± Segment æ•°ç»„ç»“æ„å’Œ HashEntry æ•°ç»„ç»“æ„ç»„æˆ"></a>ConcurrentHashMap æ˜¯ç”± Segment æ•°ç»„ç»“æ„å’Œ HashEntry æ•°ç»„ç»“æ„ç»„æˆ</h3><p>ConcurrentHashMap æ˜¯ç”± Segment æ•°ç»„ç»“æ„å’Œ HashEntry æ•°ç»„ç»“æ„ç»„æˆã€‚Segment æ˜¯ä¸€ç§å¯é‡å…¥é” ReentrantLockï¼Œåœ¨ ConcurrentHashMap é‡Œæ‰®æ¼”é”çš„è§’è‰²ï¼ŒHashEntry åˆ™ç”¨äºå­˜å‚¨é”®å€¼å¯¹æ•°æ®ã€‚ä¸€ä¸ªConcurrentHashMapé‡ŒåŒ…å«ä¸€ä¸ªSegmentæ•°ç»„ï¼ŒSegmentçš„ç»“æ„å’ŒHashMapç±»ä¼¼ï¼Œæ˜¯ä¸€ç§æ•°ç»„å’Œé“¾è¡¨ç»“æ„ï¼Œ ä¸€ä¸ª Segment é‡ŒåŒ…å«ä¸€ä¸ª HashEntry æ•°ç»„ï¼Œæ¯ä¸ª HashEntry æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„çš„å…ƒç´ ï¼Œ æ¯ä¸ª Segment å®ˆæŠ¤ä¸€ä¸ª HashEntry æ•°ç»„é‡Œçš„å…ƒç´ ,å½“å¯¹ HashEntry æ•°ç»„çš„æ•°æ®è¿›è¡Œä¿®æ”¹æ—¶ï¼Œå¿…é¡»é¦–å…ˆè·å¾—å®ƒå¯¹åº”çš„ Segment é”ã€‚</p><h1 id="Java-ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦"><a href="#Java-ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦" class="headerlink" title="Java ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦"></a>Java ä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦</h1><h2 id="æŠ¢å å¼è°ƒåº¦ï¼š"><a href="#æŠ¢å å¼è°ƒåº¦ï¼š" class="headerlink" title="æŠ¢å å¼è°ƒåº¦ï¼š"></a>æŠ¢å å¼è°ƒåº¦ï¼š</h2><p>æŠ¢å å¼è°ƒåº¦æŒ‡çš„æ˜¯æ¯æ¡çº¿ç¨‹æ‰§è¡Œçš„æ—¶é—´ã€çº¿ç¨‹çš„åˆ‡æ¢éƒ½ç”±ç³»ç»Ÿæ§åˆ¶ï¼Œç³»ç»Ÿæ§åˆ¶æŒ‡çš„æ˜¯åœ¨ç³»ç»ŸæŸç§è¿è¡Œæœºåˆ¶ä¸‹ï¼Œå¯èƒ½æ¯æ¡çº¿ç¨‹éƒ½åˆ†åŒæ ·çš„æ‰§è¡Œæ—¶é—´ç‰‡ï¼Œä¹Ÿå¯èƒ½æ˜¯æŸäº›çº¿ç¨‹æ‰§è¡Œçš„æ—¶é—´ç‰‡è¾ƒé•¿ï¼Œç”šè‡³æŸäº›çº¿ç¨‹å¾—ä¸åˆ°æ‰§è¡Œçš„æ—¶é—´ç‰‡ã€‚åœ¨è¿™ç§æœºåˆ¶ä¸‹ï¼Œä¸€ä¸ªçº¿ç¨‹çš„å µå¡ä¸ä¼šå¯¼è‡´æ•´ä¸ªè¿›ç¨‹å µå¡ã€‚</p><h2 id="ååŒå¼è°ƒåº¦ï¼š"><a href="#ååŒå¼è°ƒåº¦ï¼š" class="headerlink" title="ååŒå¼è°ƒåº¦ï¼š"></a>ååŒå¼è°ƒåº¦ï¼š</h2><p>ååŒå¼è°ƒåº¦æŒ‡æŸä¸€çº¿ç¨‹æ‰§è¡Œå®Œåä¸»åŠ¨é€šçŸ¥ç³»ç»Ÿåˆ‡æ¢åˆ°å¦ä¸€çº¿ç¨‹ä¸Šæ‰§è¡Œï¼Œè¿™ç§æ¨¡å¼å°±åƒæ¥åŠ›èµ›ä¸€æ ·ï¼Œä¸€ä¸ªäººè·‘å®Œè‡ªå·±çš„è·¯ç¨‹å°±æŠŠæ¥åŠ›æ£’äº¤æ¥ç»™ä¸‹ä¸€ä¸ªäººï¼Œä¸‹ä¸ªäººç»§ç»­å¾€ä¸‹è·‘ã€‚çº¿ç¨‹çš„æ‰§è¡Œæ—¶é—´ç”±çº¿ç¨‹æœ¬èº«æ§åˆ¶ï¼Œçº¿ç¨‹åˆ‡æ¢å¯ä»¥é¢„çŸ¥ï¼Œä¸å­˜åœ¨å¤šçº¿ç¨‹åŒæ­¥é—®é¢˜ï¼Œä½†å®ƒæœ‰ä¸€ä¸ªè‡´å‘½å¼±ç‚¹ï¼šå¦‚æœä¸€ä¸ªçº¿ç¨‹ç¼–å†™æœ‰é—®é¢˜ï¼Œè¿è¡Œåˆ°ä¸€åŠå°±ä¸€ç›´å µå¡ï¼Œé‚£ä¹ˆå¯èƒ½å¯¼è‡´æ•´ä¸ªç³»ç»Ÿå´©æºƒã€‚</p><h2 id="JVM-çš„çº¿ç¨‹è°ƒåº¦å®ç°ï¼ˆæŠ¢å å¼è°ƒåº¦ï¼‰"><a href="#JVM-çš„çº¿ç¨‹è°ƒåº¦å®ç°ï¼ˆæŠ¢å å¼è°ƒåº¦ï¼‰" class="headerlink" title="JVM çš„çº¿ç¨‹è°ƒåº¦å®ç°ï¼ˆæŠ¢å å¼è°ƒåº¦ï¼‰"></a>JVM çš„çº¿ç¨‹è°ƒåº¦å®ç°ï¼ˆæŠ¢å å¼è°ƒåº¦ï¼‰</h2><p>java ä½¿ç”¨çš„çº¿ç¨‹è°ƒä½¿ç”¨æŠ¢å å¼è°ƒåº¦ï¼ŒJavaä¸­çº¿ç¨‹ä¼šæŒ‰ä¼˜å…ˆçº§åˆ†é…CPUæ—¶é—´ç‰‡è¿è¡Œï¼Œä¸”ä¼˜å…ˆçº§è¶Šé«˜è¶Šä¼˜å…ˆæ‰§è¡Œï¼Œä½†ä¼˜å…ˆçº§é«˜å¹¶ä¸ä»£è¡¨èƒ½ç‹¬è‡ªå ç”¨æ‰§è¡Œæ—¶é—´ç‰‡ï¼Œå¯èƒ½æ˜¯ä¼˜å…ˆçº§é«˜å¾—åˆ°è¶Šå¤šçš„æ‰§è¡Œæ—¶é—´ç‰‡ï¼Œåä¹‹ï¼Œä¼˜å…ˆçº§ä½çš„åˆ†åˆ°çš„æ‰§è¡Œæ—¶é—´å°‘ä½†ä¸ä¼šåˆ†é…ä¸åˆ°æ‰§è¡Œæ—¶é—´ã€‚</p><h2 id="çº¿ç¨‹è®©å‡º-cpu-çš„æƒ…å†µï¼š"><a href="#çº¿ç¨‹è®©å‡º-cpu-çš„æƒ…å†µï¼š" class="headerlink" title="çº¿ç¨‹è®©å‡º cpu çš„æƒ…å†µï¼š"></a>çº¿ç¨‹è®©å‡º cpu çš„æƒ…å†µï¼š</h2><ol><li>å½“å‰è¿è¡Œçº¿ç¨‹ä¸»åŠ¨æ”¾å¼ƒ CPUï¼ŒJVM æš‚æ—¶æ”¾å¼ƒCPUæ“ä½œï¼ˆåŸºäºæ—¶é—´ç‰‡è½®è½¬è°ƒåº¦çš„JVMæ“ä½œç³»ç»Ÿä¸ä¼šè®©çº¿ç¨‹æ°¸ä¹…æ”¾å¼ƒCPUï¼Œæˆ–è€…è¯´æ”¾å¼ƒæœ¬æ¬¡æ—¶é—´ç‰‡çš„æ‰§è¡Œæƒï¼‰ï¼Œä¾‹å¦‚è°ƒç”¨ yield()æ–¹æ³•ã€‚</li><li>å½“å‰è¿è¡Œçº¿ç¨‹å› ä¸ºæŸäº›åŸå› è¿›å…¥é˜»å¡çŠ¶æ€ï¼Œä¾‹å¦‚é˜»å¡åœ¨ I/O ä¸Šã€‚</li><li>å½“å‰è¿è¡Œçº¿ç¨‹ç»“æŸï¼Œå³è¿è¡Œå®Œ run()æ–¹æ³•é‡Œé¢çš„ä»»åŠ¡ã€‚</li></ol><h1 id="è¿›ç¨‹è°ƒåº¦ç®—æ³•"><a href="#è¿›ç¨‹è°ƒåº¦ç®—æ³•" class="headerlink" title="è¿›ç¨‹è°ƒåº¦ç®—æ³•"></a>è¿›ç¨‹è°ƒåº¦ç®—æ³•</h1><h2 id="ä¼˜å…ˆè°ƒåº¦ç®—æ³•"><a href="#ä¼˜å…ˆè°ƒåº¦ç®—æ³•" class="headerlink" title="ä¼˜å…ˆè°ƒåº¦ç®—æ³•"></a>ä¼˜å…ˆè°ƒåº¦ç®—æ³•</h2><ol><li>å…ˆæ¥å…ˆæœåŠ¡è°ƒåº¦ç®—æ³•ï¼ˆFCFSï¼‰<br>å½“åœ¨ä½œä¸šè°ƒåº¦ä¸­é‡‡ç”¨è¯¥ç®—æ³•æ—¶ï¼Œæ¯æ¬¡è°ƒåº¦éƒ½æ˜¯ä»åå¤‡ä½œä¸šé˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªæˆ–å¤šä¸ªæœ€å…ˆè¿›å…¥è¯¥é˜Ÿåˆ—çš„ä½œä¸šï¼Œå°†å®ƒä»¬è°ƒå…¥å†…å­˜ï¼Œä¸ºå®ƒä»¬åˆ†é…èµ„æºã€åˆ›å»ºè¿›ç¨‹ï¼Œç„¶åæ”¾å…¥å°±ç»ªé˜Ÿåˆ—ã€‚åœ¨è¿›ç¨‹è°ƒåº¦ä¸­é‡‡ç”¨FCFSç®—æ³•æ—¶ï¼Œåˆ™æ¯æ¬¡è°ƒåº¦æ˜¯ä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªæœ€å…ˆè¿›å…¥è¯¥é˜Ÿåˆ—çš„è¿›ç¨‹ï¼Œä¸ºä¹‹åˆ†é…å¤„ç†æœºï¼Œä½¿ä¹‹æŠ•å…¥è¿è¡Œã€‚è¯¥è¿›ç¨‹ä¸€ç›´è¿è¡Œåˆ°å®Œæˆæˆ–å‘ç”ŸæŸäº‹ä»¶è€Œé˜»å¡åæ‰æ”¾å¼ƒå¤„ç†æœºï¼Œç‰¹ç‚¹æ˜¯ï¼šç®—æ³•æ¯”è¾ƒç®€å•ï¼Œå¯ä»¥å®ç°åŸºæœ¬ä¸Šçš„å…¬å¹³ã€‚</li><li>çŸ­ä½œä¸š(è¿›ç¨‹)ä¼˜å…ˆè°ƒåº¦ç®—æ³•<br>çŸ­ä½œä¸šä¼˜å…ˆ(SJF)çš„è°ƒåº¦ç®—æ³•æ˜¯ä»åå¤‡é˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªæˆ–è‹¥å¹²ä¸ªä¼°è®¡è¿è¡Œæ—¶é—´æœ€çŸ­çš„ä½œä¸šï¼Œå°†å®ƒä»¬è°ƒå…¥å†…å­˜è¿è¡Œã€‚è€ŒçŸ­è¿›ç¨‹ä¼˜å…ˆ(SPF)è°ƒåº¦ç®—æ³•åˆ™æ˜¯ä»å°±ç»ªé˜Ÿåˆ—ä¸­é€‰å‡ºä¸€ä¸ªä¼°è®¡è¿è¡Œæ—¶é—´æœ€çŸ­çš„è¿›ç¨‹ï¼Œå°†å¤„ç†æœºåˆ†é…ç»™å®ƒï¼Œä½¿å®ƒç«‹å³æ‰§è¡Œå¹¶ä¸€ç›´æ‰§è¡Œåˆ°å®Œæˆï¼Œæˆ–å‘ç”ŸæŸäº‹ä»¶è€Œè¢«é˜»å¡æ”¾å¼ƒå¤„ç†æœºæ—¶å†é‡æ–°è°ƒåº¦ã€‚è¯¥ç®—æ³•æœªç…§é¡¾ç´§è¿«å‹ä½œä¸šã€‚</li></ol><h2 id="é«˜ä¼˜å…ˆæƒä¼˜å…ˆè°ƒåº¦ç®—æ³•"><a href="#é«˜ä¼˜å…ˆæƒä¼˜å…ˆè°ƒåº¦ç®—æ³•" class="headerlink" title="é«˜ä¼˜å…ˆæƒä¼˜å…ˆè°ƒåº¦ç®—æ³•"></a>é«˜ä¼˜å…ˆæƒä¼˜å…ˆè°ƒåº¦ç®—æ³•</h2><p> ä¸ºäº†ç…§é¡¾ç´§è¿«å‹ä½œä¸šï¼Œä½¿ä¹‹åœ¨è¿›å…¥ç³»ç»Ÿåä¾¿è·å¾—ä¼˜å…ˆå¤„ç†ï¼Œå¼•å…¥äº†æœ€é«˜ä¼˜å…ˆæƒä¼˜å…ˆ(FPF)è°ƒåº¦ç®—æ³•ã€‚å½“æŠŠè¯¥ç®—æ³•ç”¨äºä½œä¸šè°ƒåº¦æ—¶ï¼Œç³»ç»Ÿå°†ä»åå¤‡é˜Ÿåˆ—ä¸­é€‰æ‹©è‹¥å¹²ä¸ªä¼˜å…ˆæƒæœ€é«˜çš„ä½œä¸šè£…å…¥å†…å­˜ã€‚å½“ç”¨äºè¿›ç¨‹è°ƒåº¦æ—¶ï¼Œè¯¥ç®—æ³•æ˜¯æŠŠå¤„ç†æœºåˆ†é…ç»™å°±ç»ªé˜Ÿåˆ—ä¸­ä¼˜å…ˆæƒæœ€é«˜çš„è¿›ç¨‹ã€‚</p><ol><li>éæŠ¢å å¼ä¼˜å…ˆæƒç®—æ³•</li></ol><p>åœ¨è¿™ç§æ–¹å¼ä¸‹ï¼Œç³»ç»Ÿä¸€æ—¦æŠŠå¤„ç†æœºåˆ†é…ç»™å°±ç»ªé˜Ÿåˆ—ä¸­ä¼˜å…ˆæƒæœ€é«˜çš„è¿›ç¨‹åï¼Œè¯¥è¿›ç¨‹ä¾¿ä¸€ç›´æ‰§è¡Œä¸‹å»ï¼Œç›´è‡³å®Œæˆï¼›æˆ–å› å‘ç”ŸæŸäº‹ä»¶ä½¿è¯¥è¿›ç¨‹æ”¾å¼ƒå¤„ç†æœºæ—¶ã€‚è¿™ç§è°ƒåº¦ç®—æ³•ä¸»è¦ç”¨äºæ‰¹å¤„ç†ç³»ç»Ÿä¸­ï¼›ä¹Ÿå¯ç”¨äºæŸäº›å¯¹å®æ—¶æ€§è¦æ±‚ä¸ä¸¥çš„å®æ—¶ç³»ç»Ÿä¸­ã€‚</p><ol start="2"><li>æŠ¢å å¼ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•</li></ol><p>åœ¨è¿™ç§æ–¹å¼ä¸‹ï¼Œç³»ç»ŸåŒæ ·æ˜¯æŠŠå¤„ç†æœºåˆ†é…ç»™ä¼˜å…ˆæƒæœ€é«˜çš„è¿›ç¨‹ï¼Œä½¿ä¹‹æ‰§è¡Œã€‚ä½†åœ¨å…¶æ‰§è¡ŒæœŸé—´ï¼Œåªè¦åˆå‡ºç°äº†å¦ä¸€ä¸ªå…¶ä¼˜å…ˆæƒæ›´é«˜çš„è¿›ç¨‹ï¼Œè¿›ç¨‹è°ƒåº¦ç¨‹åºå°±ç«‹å³åœæ­¢å½“å‰è¿›ç¨‹(åŸä¼˜å…ˆæƒæœ€é«˜çš„è¿›ç¨‹)çš„æ‰§è¡Œï¼Œé‡æ–°å°†å¤„ç†æœºåˆ†é…ç»™æ–°åˆ°çš„ä¼˜å…ˆæƒæœ€é«˜çš„è¿›ç¨‹ã€‚æ˜¾ç„¶ï¼Œè¿™ç§æŠ¢å å¼çš„ä¼˜å…ˆæƒè°ƒåº¦ç®—æ³•èƒ½æ›´å¥½åœ°æ»¡è¶³ç´§è¿«ä½œä¸šçš„è¦æ±‚ï¼Œæ•…è€Œå¸¸ç”¨äºè¦æ±‚æ¯”è¾ƒä¸¥æ ¼çš„å®æ—¶ç³»ç»Ÿä¸­ï¼Œä»¥åŠå¯¹æ€§èƒ½è¦æ±‚è¾ƒé«˜çš„æ‰¹å¤„ç†å’Œåˆ†æ—¶ç³»ç»Ÿä¸­ã€‚</p><p>3ï¼é«˜å“åº”æ¯”ä¼˜å…ˆè°ƒåº¦ç®—æ³•</p><p>åœ¨æ‰¹å¤„ç†ç³»ç»Ÿä¸­ï¼ŒçŸ­ä½œä¸šä¼˜å…ˆç®—æ³•æ˜¯ä¸€ç§æ¯”è¾ƒå¥½çš„ç®—æ³•ï¼Œå…¶ä¸»è¦çš„ä¸è¶³ä¹‹å¤„æ˜¯é•¿ä½œä¸šçš„è¿è¡Œå¾—ä¸åˆ°ä¿è¯ã€‚å¦‚æœæˆ‘ä»¬èƒ½ä¸ºæ¯ä¸ªä½œä¸šå¼•å…¥å‰é¢æ‰€è¿°çš„åŠ¨æ€ä¼˜å…ˆæƒï¼Œå¹¶ä½¿ä½œä¸šçš„ä¼˜å…ˆçº§éšç€ç­‰å¾…æ—¶é—´çš„å¢åŠ è€Œä»¥é€Ÿç‡aæé«˜ï¼Œåˆ™é•¿ä½œä¸šåœ¨ç­‰å¾…ä¸€å®šçš„æ—¶é—´åï¼Œå¿…ç„¶æœ‰æœºä¼šåˆ†é…åˆ°å¤„ç†æœºã€‚è¯¥ä¼˜å…ˆæƒçš„å˜åŒ–è§„å¾‹å¯æè¿°ä¸ºï¼š</p><p> (1) å¦‚æœä½œä¸šçš„ç­‰å¾…æ—¶é—´ç›¸åŒï¼Œåˆ™è¦æ±‚æœåŠ¡çš„æ—¶é—´æ„ˆçŸ­ï¼Œå…¶ä¼˜å…ˆæƒæ„ˆé«˜ï¼Œå› è€Œè¯¥ç®—æ³•æœ‰åˆ©äºçŸ­ä½œä¸šã€‚</p><p> (2) å½“è¦æ±‚æœåŠ¡çš„æ—¶é—´ç›¸åŒæ—¶ï¼Œä½œä¸šçš„ä¼˜å…ˆæƒå†³å®šäºå…¶ç­‰å¾…æ—¶é—´ï¼Œç­‰å¾…æ—¶é—´æ„ˆé•¿ï¼Œå…¶ä¼˜å…ˆæƒæ„ˆé«˜ï¼Œå› è€Œå®ƒå®ç°çš„æ˜¯å…ˆæ¥å…ˆæœåŠ¡ã€‚</p><p> (3) å¯¹äºé•¿ä½œä¸šï¼Œä½œä¸šçš„ä¼˜å…ˆçº§å¯ä»¥éšç­‰å¾…æ—¶é—´çš„å¢åŠ è€Œæé«˜ï¼Œå½“å…¶ç­‰å¾…æ—¶é—´è¶³å¤Ÿé•¿æ—¶ï¼Œå…¶ä¼˜å…ˆçº§ä¾¿å¯å‡åˆ°å¾ˆé«˜ï¼Œä»è€Œä¹Ÿå¯è·å¾—å¤„ç†æœºã€‚ç®€è¨€ä¹‹ï¼Œè¯¥ç®—æ³•æ—¢ç…§é¡¾äº†çŸ­ä½œä¸šï¼Œåˆè€ƒè™‘äº†ä½œä¸šåˆ°è¾¾çš„å…ˆåæ¬¡åºï¼Œä¸ä¼šä½¿é•¿ä½œä¸šé•¿æœŸå¾—ä¸åˆ°æœåŠ¡ã€‚å› æ­¤ï¼Œè¯¥ç®—æ³•å®ç°äº†ä¸€ç§è¾ƒå¥½çš„æŠ˜è¡·ã€‚å½“ç„¶ï¼Œåœ¨åˆ©ç”¨è¯¥ç®—æ³•æ—¶ï¼Œæ¯è¦è¿›è¡Œè°ƒåº¦ä¹‹å‰ï¼Œéƒ½é¡»å…ˆåšå“åº”æ¯”çš„è®¡ç®—ï¼Œè¿™ä¼šå¢åŠ ç³»ç»Ÿå¼€é”€ã€‚</p><h2 id="åŸºäºæ—¶é—´ç‰‡çš„è½®è½¬è°ƒåº¦ç®—æ³•"><a href="#åŸºäºæ—¶é—´ç‰‡çš„è½®è½¬è°ƒåº¦ç®—æ³•" class="headerlink" title="åŸºäºæ—¶é—´ç‰‡çš„è½®è½¬è°ƒåº¦ç®—æ³•"></a>åŸºäºæ—¶é—´ç‰‡çš„è½®è½¬è°ƒåº¦ç®—æ³•</h2><ol><li>æ—¶é—´ç‰‡è½®è½¬æ³•</li></ol><p>åœ¨æ—©æœŸçš„æ—¶é—´ç‰‡è½®è½¬æ³•ä¸­ï¼Œç³»ç»Ÿå°†æ‰€æœ‰çš„å°±ç»ªè¿›ç¨‹æŒ‰å…ˆæ¥å…ˆæœåŠ¡çš„åŸåˆ™æ’æˆä¸€ä¸ªé˜Ÿåˆ—ï¼Œæ¯æ¬¡è°ƒåº¦æ—¶ï¼ŒæŠŠCPUåˆ†é…ç»™é˜Ÿé¦–è¿›ç¨‹ï¼Œå¹¶ä»¤å…¶æ‰§è¡Œä¸€ä¸ªæ—¶é—´ç‰‡ã€‚æ—¶é—´ç‰‡çš„å¤§å°ä»å‡  ms åˆ°å‡ ç™¾msã€‚å½“æ‰§è¡Œçš„æ—¶é—´ç‰‡ç”¨å®Œæ—¶ï¼Œç”±ä¸€ä¸ªè®¡æ—¶å™¨å‘å‡ºæ—¶é’Ÿä¸­æ–­è¯·æ±‚ï¼Œè°ƒåº¦ç¨‹åºä¾¿æ®æ­¤ä¿¡å·æ¥åœæ­¢è¯¥è¿›ç¨‹çš„æ‰§è¡Œï¼Œå¹¶å°†å®ƒé€å¾€å°±ç»ªé˜Ÿåˆ—çš„æœ«å°¾ï¼›ç„¶åï¼Œå†æŠŠå¤„ç†æœºåˆ†é…ç»™å°±ç»ªé˜Ÿåˆ—ä¸­æ–°çš„é˜Ÿé¦–è¿›ç¨‹ï¼ŒåŒæ—¶ä¹Ÿè®©å®ƒæ‰§è¡Œä¸€ä¸ªæ—¶é—´ç‰‡ã€‚è¿™æ ·å°±å¯ä»¥ä¿è¯å°±ç»ªé˜Ÿåˆ—ä¸­çš„æ‰€æœ‰è¿›ç¨‹åœ¨ä¸€ç»™å®šçš„æ—¶é—´å†…å‡èƒ½è·å¾—ä¸€æ—¶é—´ç‰‡çš„å¤„<br>ç†æœºæ‰§è¡Œæ—¶é—´ã€‚</p><ol start="2"><li><p>å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç®—æ³•</p><p>(1) åº”è®¾ç½®å¤šä¸ªå°±ç»ªé˜Ÿåˆ—ï¼Œå¹¶ä¸ºå„ä¸ªé˜Ÿåˆ—èµ‹äºˆä¸åŒçš„ä¼˜å…ˆçº§ã€‚ç¬¬ä¸€ä¸ªé˜Ÿåˆ—çš„ä¼˜å…ˆçº§æœ€é«˜ï¼Œç¬¬äºŒä¸ªé˜Ÿåˆ—æ¬¡ä¹‹ï¼Œå…¶ä½™å„é˜Ÿåˆ—çš„ä¼˜å…ˆæƒé€ä¸ªé™ä½ã€‚è¯¥ç®—æ³•èµ‹äºˆå„ä¸ªé˜Ÿåˆ—ä¸­è¿›ç¨‹æ‰§è¡Œæ—¶é—´ç‰‡çš„å¤§å°ä¹Ÿå„ä¸ç›¸åŒï¼Œåœ¨ä¼˜å…ˆæƒæ„ˆé«˜çš„é˜Ÿåˆ—ä¸­ï¼Œä¸ºæ¯ä¸ªè¿›ç¨‹æ‰€è§„å®šçš„æ‰§è¡Œæ—¶é—´ç‰‡å°±æ„ˆå°ã€‚ä¾‹å¦‚ï¼Œç¬¬äºŒä¸ªé˜Ÿåˆ—çš„æ—¶é—´ç‰‡è¦æ¯”ç¬¬ä¸€ä¸ªé˜Ÿåˆ—çš„æ—¶é—´ç‰‡é•¿ä¸€å€ï¼Œâ€¦â€¦ï¼Œç¬¬ i+1 ä¸ªé˜Ÿåˆ—çš„æ—¶é—´ç‰‡è¦æ¯”ç¬¬ i ä¸ªé˜Ÿåˆ—çš„æ—¶é—´ç‰‡é•¿ä¸€å€ã€‚</p><p>(2) å½“ä¸€ä¸ªæ–°è¿›ç¨‹è¿›å…¥å†…å­˜åï¼Œé¦–å…ˆå°†å®ƒæ”¾å…¥ç¬¬ä¸€é˜Ÿåˆ—çš„æœ«å°¾ï¼ŒæŒ‰ FCFS åŸåˆ™æ’é˜Ÿç­‰å¾…è°ƒåº¦ã€‚å½“è½®åˆ°è¯¥è¿›ç¨‹æ‰§è¡Œæ—¶ï¼Œå¦‚å®ƒèƒ½åœ¨è¯¥æ—¶é—´ç‰‡å†…å®Œæˆï¼Œä¾¿å¯å‡†å¤‡æ’¤ç¦»ç³»ç»Ÿï¼›å¦‚æœå®ƒåœ¨ä¸€ä¸ªæ—¶é—´ç‰‡ç»“æŸæ—¶å°šæœªå®Œæˆï¼Œè°ƒåº¦ç¨‹åºä¾¿å°†è¯¥è¿›ç¨‹è½¬å…¥ç¬¬äºŒé˜Ÿåˆ—çš„æœ«å°¾ï¼Œå†åŒæ ·åœ°æŒ‰FCFSåŸåˆ™ç­‰å¾…è°ƒåº¦æ‰§è¡Œï¼›å¦‚æœå®ƒåœ¨ç¬¬äºŒé˜Ÿåˆ—ä¸­è¿è¡Œä¸€ä¸ªæ—¶é—´ç‰‡åä»æœªå®Œæˆï¼Œå†ä¾æ¬¡å°†å®ƒæ”¾å…¥ç¬¬ä¸‰é˜Ÿåˆ—ï¼Œâ€¦â€¦ï¼Œå¦‚æ­¤ä¸‹å»ï¼Œå½“ä¸€ä¸ªé•¿ä½œä¸š(è¿›ç¨‹)ä»ç¬¬ä¸€é˜Ÿåˆ—ä¾æ¬¡é™åˆ°ç¬¬ n é˜Ÿåˆ—åï¼Œåœ¨ç¬¬ n é˜Ÿåˆ—ä¾¿é‡‡å–æŒ‰æ—¶é—´ç‰‡è½®è½¬çš„æ–¹å¼è¿è¡Œã€‚</p></li></ol><p>(3) ä»…å½“ç¬¬ä¸€é˜Ÿåˆ—ç©ºé—²æ—¶ï¼Œè°ƒåº¦ç¨‹åºæ‰è°ƒåº¦ç¬¬äºŒé˜Ÿåˆ—ä¸­çš„è¿›ç¨‹è¿è¡Œï¼›ä»…å½“ç¬¬ 1ï½(i-1)é˜Ÿåˆ—å‡ç©ºæ—¶ï¼Œæ‰ä¼šè°ƒåº¦ç¬¬ ié˜Ÿåˆ—ä¸­çš„è¿›ç¨‹è¿è¡Œã€‚å¦‚æœå¤„ç†æœºæ­£åœ¨ç¬¬ i é˜Ÿåˆ—ä¸­ä¸ºæŸè¿›ç¨‹æœåŠ¡æ—¶ï¼Œåˆæœ‰æ–°è¿›ç¨‹è¿›å…¥ä¼˜å…ˆæƒè¾ƒé«˜çš„é˜Ÿåˆ—(ç¬¬1ï½(i-1)ä¸­çš„ä»»ä½•ä¸€ä¸ªé˜Ÿåˆ—)ï¼Œåˆ™æ­¤æ—¶æ–°è¿›ç¨‹å°†æŠ¢å æ­£åœ¨è¿è¡Œè¿›ç¨‹çš„å¤„ç†æœºï¼Œå³ç”±è°ƒåº¦ç¨‹åºæŠŠæ­£åœ¨è¿è¡Œçš„è¿›ç¨‹æ”¾å›åˆ°ç¬¬ié˜Ÿåˆ—çš„æœ«å°¾ï¼ŒæŠŠå¤„ç†æœºåˆ†é…ç»™æ–°åˆ°çš„é«˜ä¼˜å…ˆæƒè¿›ç¨‹ã€‚åœ¨å¤šçº§åé¦ˆé˜Ÿåˆ—è°ƒåº¦ç®—æ³•ä¸­ï¼Œå¦‚æœè§„å®šç¬¬ä¸€ä¸ªé˜Ÿåˆ—çš„æ—¶é—´ç‰‡ç•¥å¤§äºå¤šæ•°äººæœºäº¤äº’æ‰€éœ€ä¹‹å¤„ç†æ—¶é—´æ—¶ï¼Œä¾¿èƒ½å¤Ÿè¾ƒå¥½çš„æ»¡è¶³å„ç§ç±»å‹ç”¨æˆ·çš„éœ€è¦ã€‚</p><h1 id="ä»€ä¹ˆæ˜¯-CASï¼ˆæ¯”è¾ƒå¹¶äº¤æ¢-ä¹è§‚é”æœºåˆ¶-é”è‡ªæ—‹ï¼‰"><a href="#ä»€ä¹ˆæ˜¯-CASï¼ˆæ¯”è¾ƒå¹¶äº¤æ¢-ä¹è§‚é”æœºåˆ¶-é”è‡ªæ—‹ï¼‰" class="headerlink" title="ä»€ä¹ˆæ˜¯ CASï¼ˆæ¯”è¾ƒå¹¶äº¤æ¢-ä¹è§‚é”æœºåˆ¶-é”è‡ªæ—‹ï¼‰"></a>ä»€ä¹ˆæ˜¯ CASï¼ˆæ¯”è¾ƒå¹¶äº¤æ¢-ä¹è§‚é”æœºåˆ¶-é”è‡ªæ—‹ï¼‰</h1><h2 id="æ¦‚å¿µåŠç‰¹æ€§"><a href="#æ¦‚å¿µåŠç‰¹æ€§" class="headerlink" title="æ¦‚å¿µåŠç‰¹æ€§"></a>æ¦‚å¿µåŠç‰¹æ€§</h2><p>CASï¼ˆCompare And Swap/Setï¼‰æ¯”è¾ƒå¹¶äº¤æ¢ï¼ŒCAS ç®—æ³•çš„è¿‡ç¨‹æ˜¯è¿™æ ·ï¼šå®ƒåŒ…å« 3 ä¸ªå‚æ•°<br>CAS(V,E,N)ã€‚V è¡¨ç¤ºè¦æ›´æ–°çš„å˜é‡(å†…å­˜å€¼)ï¼ŒE è¡¨ç¤ºé¢„æœŸå€¼(æ—§çš„)ï¼ŒN è¡¨ç¤ºæ–°å€¼ã€‚å½“ä¸”ä»…å½“ V å€¼ç­‰äº E å€¼æ—¶ï¼Œæ‰ä¼šå°† V çš„å€¼è®¾ä¸º Nï¼Œå¦‚æœ V å€¼å’Œ E å€¼ä¸åŒï¼Œåˆ™è¯´æ˜å·²ç»æœ‰å…¶ä»–çº¿ç¨‹åšäº†æ›´æ–°ï¼Œåˆ™å½“å‰çº¿ç¨‹ä»€ä¹ˆéƒ½ä¸åšã€‚æœ€åï¼ŒCASè¿”å›å½“å‰Vçš„çœŸå®å€¼ã€‚CASæ“ä½œæ˜¯æŠ±ç€ä¹è§‚çš„æ€åº¦è¿›è¡Œçš„(ä¹è§‚é”)ï¼Œå®ƒæ€»æ˜¯è®¤ä¸ºè‡ªå·±å¯ä»¥æˆåŠŸå®Œæˆæ“ä½œã€‚å½“å¤šä¸ªçº¿ç¨‹åŒæ—¶ä½¿ç”¨CASæ“ä½œä¸€ä¸ªå˜é‡æ—¶ï¼Œåªæœ‰ä¸€ä¸ªä¼šèƒœå‡ºï¼Œå¹¶æˆåŠŸæ›´æ–°ï¼Œå…¶ä½™å‡ä¼šå¤±è´¥ã€‚å¤±è´¥çš„çº¿ç¨‹ä¸ä¼šè¢«æŒ‚èµ·ï¼Œä»…æ˜¯è¢«å‘ŠçŸ¥å¤±è´¥ï¼Œå¹¶ä¸”å…è®¸å†æ¬¡å°è¯•ï¼Œå½“ç„¶ä¹Ÿå…è®¸å¤±è´¥çš„çº¿ç¨‹æ”¾å¼ƒæ“ä½œã€‚åŸºäºè¿™æ ·çš„åŸç†ï¼ŒCAS æ“ä½œå³ä½¿æ²¡æœ‰é”ï¼Œä¹Ÿå¯ä»¥å‘ç°å…¶ä»–çº¿ç¨‹å¯¹å½“å‰çº¿ç¨‹çš„å¹²æ‰°ï¼Œå¹¶è¿›è¡Œæ°å½“çš„å¤„ç†ã€‚</p><h2 id="åŸå­åŒ…-java-util-concurrent-atomicï¼ˆé”è‡ªæ—‹ï¼‰"><a href="#åŸå­åŒ…-java-util-concurrent-atomicï¼ˆé”è‡ªæ—‹ï¼‰" class="headerlink" title="åŸå­åŒ… java.util.concurrent.atomicï¼ˆé”è‡ªæ—‹ï¼‰"></a>åŸå­åŒ… java.util.concurrent.atomicï¼ˆé”è‡ªæ—‹ï¼‰</h2><p>JDK1.5 çš„åŸå­åŒ…ï¼šjava.util.concurrent.atomic è¿™ä¸ªåŒ…é‡Œé¢æä¾›äº†ä¸€ç»„åŸå­ç±»ã€‚å…¶åŸºæœ¬çš„ç‰¹æ€§å°±<br>æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ï¼Œå½“æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œè¿™äº›ç±»çš„å®ä¾‹åŒ…å«çš„æ–¹æ³•æ—¶ï¼Œå…·æœ‰æ’ä»–æ€§ï¼Œå³å½“æŸä¸ªçº¿ç¨‹è¿›å…¥æ–¹æ³•ï¼Œæ‰§è¡Œå…¶ä¸­çš„æŒ‡ä»¤æ—¶ï¼Œä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹æ‰“æ–­ï¼Œè€Œåˆ«çš„çº¿ç¨‹å°±åƒè‡ªæ—‹é”ä¸€æ ·ï¼Œä¸€ç›´ç­‰åˆ°è¯¥æ–¹æ³•æ‰§è¡Œå®Œæˆï¼Œæ‰ç”± JVM ä»ç­‰å¾…é˜Ÿåˆ—ä¸­é€‰æ‹©ä¸€ä¸ªå¦ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ï¼Œè¿™åªæ˜¯ä¸€ç§é€»è¾‘ä¸Šçš„ç†è§£ã€‚</p><p>ç›¸å¯¹äºå¯¹äº synchronizedè¿™ç§é˜»å¡ç®—æ³•ï¼ŒCASæ˜¯éé˜»å¡ç®—æ³•çš„ä¸€ç§å¸¸è§å®ç°ã€‚ç”±äºä¸€èˆ¬ CPU åˆ‡æ¢æ—¶é—´æ¯”CPUæŒ‡ä»¤é›†æ“ä½œæ›´åŠ é•¿ï¼Œæ‰€ä»¥J.U.Cåœ¨æ€§èƒ½ä¸Šæœ‰äº†å¾ˆå¤§çš„æå‡ã€‚å¦‚ä¸‹ä»£ç ï¼š</p><details>    <summary>åŸå­åŒ…</summary><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">public class AtomicInteger extends Number implements java.io.Serializable &#123;</span><br><span class="line">            private volatile int value;</span><br><span class="line">            public final int get() &#123;</span><br><span class="line">                return value;</span><br><span class="line">            &#125;</span><br><span class="line">            public final int getAndIncrement() &#123;</span><br><span class="line">                for (;;) &#123; //CAS è‡ªæ—‹ï¼Œä¸€ç›´å°è¯•ï¼Œç›´è¾¾æˆåŠŸ</span><br><span class="line">                    int current = get();</span><br><span class="line">                    int next = current + 1;</span><br><span class="line">                    if (compareAndSet(current, next))</span><br><span class="line">                        return current;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            public final boolean compareAndSet(int expect, int update) &#123;</span><br><span class="line">                return unsafe.compareAndSwapInt(this, valueOffset, expect, update);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure></details>getAndIncrement é‡‡ç”¨äº†CASæ“ä½œï¼Œæ¯æ¬¡ä»å†…å­˜ä¸­è¯»å–æ•°æ®ç„¶åå°†æ­¤æ•°æ®å’Œ+1 åçš„ç»“æœè¿›è¡ŒCASæ“ä½œï¼Œå¦‚æœæˆåŠŸå°±è¿”å›ç»“æœï¼Œå¦åˆ™é‡è¯•ç›´åˆ°æˆåŠŸä¸ºæ­¢ã€‚è€Œ compareAndSet åˆ©ç”¨ JNI æ¥å®ŒæˆCPU æŒ‡ä»¤çš„æ“ä½œã€‚<h2 id="ABA-é—®é¢˜"><a href="#ABA-é—®é¢˜" class="headerlink" title="ABA é—®é¢˜"></a>ABA é—®é¢˜</h2><p>CAS ä¼šå¯¼è‡´â€œABA é—®é¢˜â€ã€‚CAS ç®—æ³•å®ç°ä¸€ä¸ªé‡è¦å‰æéœ€è¦å–å‡ºå†…å­˜ä¸­æŸæ—¶åˆ»çš„æ•°æ®ï¼Œè€Œåœ¨ä¸‹æ—¶åˆ»æ¯”è¾ƒå¹¶æ›¿æ¢ï¼Œé‚£ä¹ˆåœ¨è¿™ä¸ªæ—¶é—´å·®ç±»ä¼šå¯¼è‡´æ•°æ®çš„å˜åŒ–ã€‚</p><p>æ¯”å¦‚è¯´ä¸€ä¸ªçº¿ç¨‹ one ä»å†…å­˜ä½ç½® V ä¸­å–å‡º Aï¼Œè¿™æ—¶å€™å¦ä¸€ä¸ªçº¿ç¨‹ two ä¹Ÿä»å†…å­˜ä¸­å–å‡º Aï¼Œå¹¶ä¸”two è¿›è¡Œäº†ä¸€äº›æ“ä½œå˜æˆäº† Bï¼Œç„¶å two åˆå°†Vä½ç½®çš„æ•°æ®å˜æˆ Aï¼Œè¿™æ—¶å€™çº¿ç¨‹ one è¿›è¡Œ CAS æ“ä½œå‘ç°å†…å­˜ä¸­ä»ç„¶æ˜¯ Aï¼Œç„¶å one æ“ä½œæˆåŠŸã€‚å°½ç®¡çº¿ç¨‹ one çš„ CAS æ“ä½œæˆåŠŸï¼Œä½†æ˜¯ä¸ä»£è¡¨è¿™ä¸ªè¿‡ç¨‹å°±æ˜¯æ²¡æœ‰é—®é¢˜çš„ã€‚</p><p>éƒ¨åˆ†ä¹è§‚é”çš„å®ç°æ˜¯é€šè¿‡ç‰ˆæœ¬å·ï¼ˆversionï¼‰çš„æ–¹å¼æ¥è§£å†³ABAé—®é¢˜ï¼Œä¹è§‚é”æ¯æ¬¡åœ¨æ‰§è¡Œæ•°æ®çš„ä¿®æ”¹æ“ä½œæ—¶ï¼Œéƒ½ä¼šå¸¦ä¸Šä¸€ä¸ªç‰ˆæœ¬å·ï¼Œä¸€æ—¦ç‰ˆæœ¬å·å’Œæ•°æ®çš„ç‰ˆæœ¬å·ä¸€è‡´å°±å¯ä»¥æ‰§è¡Œä¿®æ”¹æ“ä½œå¹¶å¯¹ç‰ˆæœ¬å·æ‰§è¡Œ+1æ“ä½œï¼Œå¦åˆ™å°±æ‰§è¡Œå¤±è´¥ã€‚å› ä¸ºæ¯æ¬¡æ“ä½œçš„ç‰ˆæœ¬å·éƒ½ä¼šéšä¹‹å¢åŠ ï¼Œæ‰€ä»¥ä¸ä¼šå‡ºç°ABAé—®é¢˜ï¼Œå› ä¸ºç‰ˆæœ¬å·åªä¼šå¢åŠ ä¸ä¼šå‡å°‘ã€‚</p><h1 id="ä»€ä¹ˆæ˜¯-AQSï¼ˆæŠ½è±¡çš„é˜Ÿåˆ—åŒæ­¥å™¨ï¼‰"><a href="#ä»€ä¹ˆæ˜¯-AQSï¼ˆæŠ½è±¡çš„é˜Ÿåˆ—åŒæ­¥å™¨ï¼‰" class="headerlink" title="ä»€ä¹ˆæ˜¯ AQSï¼ˆæŠ½è±¡çš„é˜Ÿåˆ—åŒæ­¥å™¨ï¼‰"></a>ä»€ä¹ˆæ˜¯ AQSï¼ˆæŠ½è±¡çš„é˜Ÿåˆ—åŒæ­¥å™¨ï¼‰</h1><p>AbstractQueuedSynchronizerç±»å¦‚å…¶åï¼ŒæŠ½è±¡çš„é˜Ÿåˆ—å¼çš„åŒæ­¥å™¨ï¼ŒAQSå®šä¹‰äº†ä¸€å¥—å¤šçº¿ç¨‹è®¿é—®å…±äº«èµ„æºçš„åŒæ­¥å™¨æ¡†æ¶ï¼Œè®¸å¤šåŒæ­¥ç±»å®ç°éƒ½ä¾èµ–äºå®ƒï¼Œå¦‚å¸¸ç”¨çš„ReentrantLock/Semaphore/CountDownLatchã€‚</p><p>å®ƒç»´æŠ¤äº†ä¸€ä¸ª volatile int stateï¼ˆä»£è¡¨å…±äº«èµ„æºï¼‰å’Œä¸€ä¸ª FIFO çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—ï¼ˆå¤šçº¿ç¨‹äº‰ç”¨èµ„æºè¢«é˜»å¡æ—¶ä¼šè¿›å…¥æ­¤é˜Ÿåˆ—ï¼‰ã€‚è¿™é‡Œ volatile æ˜¯æ ¸å¿ƒå…³é”®è¯ï¼Œå…·ä½“volatileçš„è¯­ä¹‰ï¼Œåœ¨æ­¤ä¸è¿°ã€‚stateçš„è®¿é—®æ–¹å¼æœ‰ä¸‰ç§:</p><pre><code>getState()setState()compareAndSetState()</code></pre><p>AQS å®šä¹‰ä¸¤ç§èµ„æºå…±äº«æ–¹å¼</p><h2 id="Exclusive-ç‹¬å èµ„æº-ReentrantLock"><a href="#Exclusive-ç‹¬å èµ„æº-ReentrantLock" class="headerlink" title="Exclusive ç‹¬å èµ„æº-ReentrantLock"></a>Exclusive ç‹¬å èµ„æº-ReentrantLock</h2><p>Exclusiveï¼ˆç‹¬å ï¼Œåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œï¼Œå¦‚ ReentrantLockï¼‰</p><h2 id="Share-å…±äº«èµ„æº-Semaphore-CountDownLatch"><a href="#Share-å…±äº«èµ„æº-Semaphore-CountDownLatch" class="headerlink" title="Share å…±äº«èµ„æº-Semaphore/CountDownLatch"></a>Share å…±äº«èµ„æº-Semaphore/CountDownLatch</h2><p>Shareï¼ˆå…±äº«ï¼Œå¤šä¸ªçº¿ç¨‹å¯åŒæ—¶æ‰§è¡Œï¼Œå¦‚ Semaphore/CountDownLatchï¼‰ã€‚</p><p>AQS åªæ˜¯ä¸€ä¸ªæ¡†æ¶ï¼Œå…·ä½“èµ„æºçš„è·å–/é‡Šæ”¾æ–¹å¼äº¤ç”±è‡ªå®šä¹‰åŒæ­¥å™¨å»å®ç°ï¼ŒAQS è¿™é‡Œåªå®šä¹‰äº†ä¸€ä¸ªæ¥å£ï¼Œå…·ä½“èµ„æºçš„è·å–äº¤ç”±è‡ªå®šä¹‰åŒæ­¥å™¨å»å®ç°äº†ï¼ˆé€šè¿‡ state çš„ get/set/CAS)ä¹‹æ‰€ä»¥æ²¡æœ‰å®šä¹‰æˆabstract ï¼Œæ˜¯ å›  ä¸ºç‹¬ å æ¨¡ å¼ ä¸‹ åª ç”¨å®ç° tryAcquire-tryRelease ï¼Œè€Œ å…±äº« æ¨¡ å¼ ä¸‹ åªç”¨ å® ç°tryAcquireShared-tryReleaseSharedã€‚å¦‚æœéƒ½å®šä¹‰æˆabstractï¼Œé‚£ä¹ˆæ¯ä¸ªæ¨¡å¼ä¹Ÿè¦å»å®ç°å¦ä¸€æ¨¡å¼ä¸‹çš„æ¥å£ã€‚ä¸åŒçš„è‡ªå®šä¹‰åŒæ­¥å™¨äº‰ç”¨å…±äº«èµ„æºçš„æ–¹å¼ä¹Ÿä¸åŒã€‚è‡ªå®šä¹‰åŒæ­¥å™¨åœ¨å®ç°æ—¶åªéœ€è¦å®ç°å…±äº«èµ„æºstateçš„è·å–ä¸é‡Šæ”¾æ–¹å¼å³å¯ï¼Œè‡³äºå…·ä½“çº¿ç¨‹ç­‰å¾…é˜Ÿåˆ—çš„ç»´æŠ¤ï¼ˆå¦‚è·å–èµ„æºå¤±è´¥å…¥é˜Ÿ/å”¤é†’å‡ºé˜Ÿç­‰ï¼‰ï¼ŒAQSå·²ç»åœ¨é¡¶å±‚å®ç°å¥½äº†ã€‚è‡ªå®šä¹‰åŒæ­¥å™¨å®ç°æ—¶ä¸»è¦å®ç°ä»¥ä¸‹å‡ ç§æ–¹æ³•ï¼š</p><p>1ï¼isHeldExclusively()ï¼šè¯¥çº¿ç¨‹æ˜¯å¦æ­£åœ¨ç‹¬å èµ„æºã€‚åªæœ‰ç”¨åˆ° condition æ‰éœ€è¦å»å®ç°å®ƒã€‚</p><p>2ï¼tryAcquire(int)ï¼šç‹¬å æ–¹å¼ã€‚å°è¯•è·å–èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å› falseã€‚</p><p>3ï¼tryRelease(int)ï¼šç‹¬å æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å› falseã€‚</p><p>4ï¼tryAcquireShared(int)ï¼šå…±äº«æ–¹å¼ã€‚å°è¯•è·å–èµ„æºã€‚è´Ÿæ•°è¡¨ç¤ºå¤±è´¥ï¼›0 è¡¨ç¤ºæˆåŠŸï¼Œä½†æ²¡æœ‰å‰©ä½™å¯ç”¨èµ„æºï¼›æ­£æ•°è¡¨ç¤ºæˆåŠŸï¼Œä¸”æœ‰å‰©ä½™èµ„æºã€‚</p><p>5ï¼tryReleaseShared(int)ï¼šå…±äº«æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼Œå¦‚æœé‡Šæ”¾åå…è®¸å”¤é†’åç»­ç­‰å¾…ç»“ç‚¹è¿”å›trueï¼Œå¦åˆ™è¿”å› falseã€‚</p><h2 id="åŒæ­¥å™¨çš„å®ç°æ˜¯-ABS-æ ¸å¿ƒï¼ˆstate-èµ„æºçŠ¶æ€è®¡æ•°ï¼‰"><a href="#åŒæ­¥å™¨çš„å®ç°æ˜¯-ABS-æ ¸å¿ƒï¼ˆstate-èµ„æºçŠ¶æ€è®¡æ•°ï¼‰" class="headerlink" title="åŒæ­¥å™¨çš„å®ç°æ˜¯ ABS æ ¸å¿ƒï¼ˆstate èµ„æºçŠ¶æ€è®¡æ•°ï¼‰"></a>åŒæ­¥å™¨çš„å®ç°æ˜¯ ABS æ ¸å¿ƒï¼ˆstate èµ„æºçŠ¶æ€è®¡æ•°ï¼‰</h2><p>åŒæ­¥å™¨çš„å®ç°æ˜¯ ABS æ ¸å¿ƒï¼Œä»¥ ReentrantLock ä¸ºä¾‹ï¼Œstate åˆå§‹åŒ–ä¸º 0ï¼Œè¡¨ç¤ºæœªé”å®šçŠ¶æ€ã€‚A çº¿ç¨‹lock()æ—¶ï¼Œä¼šè°ƒç”¨ tryAcquire()ç‹¬å è¯¥é”å¹¶å°† state+1ã€‚æ­¤åï¼Œå…¶ä»–çº¿ç¨‹å† tryAcquire()æ—¶å°±ä¼šå¤±è´¥ï¼Œç›´åˆ° A çº¿ç¨‹unlock()åˆ°state=0ï¼ˆå³é‡Šæ”¾é”ï¼‰ä¸ºæ­¢ï¼Œå…¶å®ƒçº¿ç¨‹æ‰æœ‰æœºä¼šè·å–è¯¥é”ã€‚å½“ç„¶ï¼Œé‡Šæ”¾é”ä¹‹å‰ï¼ŒA çº¿ç¨‹è‡ªå·±æ˜¯å¯ä»¥é‡å¤è·å–æ­¤é”çš„ï¼ˆstate ä¼šç´¯åŠ ï¼‰ï¼Œè¿™å°±æ˜¯å¯é‡å…¥çš„æ¦‚å¿µã€‚ä½†è¦æ³¨æ„ï¼Œè·å–å¤šå°‘æ¬¡å°±è¦é‡Šæ”¾å¤šä¹ˆæ¬¡ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯ state æ˜¯èƒ½å›åˆ°é›¶æ€çš„ã€‚</p><p>ä»¥ CountDownLatch ä»¥ä¾‹ï¼Œä»»åŠ¡åˆ†ä¸º N ä¸ªå­çº¿ç¨‹å»æ‰§è¡Œï¼Œstate ä¹Ÿåˆå§‹åŒ–ä¸º Nï¼ˆæ³¨æ„ N è¦ä¸çº¿ç¨‹ä¸ªæ•°ä¸€è‡´ï¼‰ã€‚è¿™Nä¸ªå­çº¿ç¨‹æ˜¯å¹¶è¡Œæ‰§è¡Œçš„ï¼Œæ¯ä¸ªå­çº¿ç¨‹æ‰§è¡Œå®Œå countDown()ä¸€æ¬¡ï¼Œstateä¼š CAS å‡ 1ã€‚ç­‰åˆ°æ‰€æœ‰å­çº¿ç¨‹éƒ½æ‰§è¡Œå®Œå(å³state=0)ï¼Œä¼šunpark()ä¸»è°ƒç”¨çº¿ç¨‹ï¼Œç„¶åä¸»è°ƒç”¨çº¿ç¨‹å°±ä¼šä»await()å‡½æ•°è¿”å›ï¼Œç»§ç»­åä½™åŠ¨ä½œã€‚</p><h2 id="ReentrantReadWriteLock-å®ç°ç‹¬å å’Œå…±äº«ä¸¤ç§æ–¹å¼"><a href="#ReentrantReadWriteLock-å®ç°ç‹¬å å’Œå…±äº«ä¸¤ç§æ–¹å¼" class="headerlink" title="ReentrantReadWriteLock å®ç°ç‹¬å å’Œå…±äº«ä¸¤ç§æ–¹å¼"></a>ReentrantReadWriteLock å®ç°ç‹¬å å’Œå…±äº«ä¸¤ç§æ–¹å¼</h2><p> ä¸€èˆ¬æ¥è¯´ï¼Œè‡ªå®šä¹‰åŒæ­¥å™¨è¦ä¹ˆæ˜¯ç‹¬å æ–¹æ³•ï¼Œè¦ä¹ˆæ˜¯å…±äº«æ–¹å¼ï¼Œä»–ä»¬ä¹Ÿåªéœ€å®ç° tryAcquiretryReleaseã€tryAcquireShared-tryReleaseSharedä¸­çš„ä¸€ç§å³å¯ã€‚ä½† AQS ä¹Ÿæ”¯æŒè‡ªå®šä¹‰åŒæ­¥å™¨åŒæ—¶å®ç°ç‹¬å å’Œå…±äº«ä¸¤ç§æ–¹å¼ï¼Œå¦‚ ReentrantReadWriteLockã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;JAVA å¤šçº¿ç¨‹å¹¶å‘&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="Concurrency" scheme="http://yoursite.com/tags/Concurrency/"/>
    
  </entry>
  
  <entry>
    <title>JAVA é›†åˆå­¦ä¹ ç¬”è®°ï¼ˆsetï¼Œlistå’Œmapï¼‰</title>
    <link href="http://yoursite.com/2021/12/22/JAVA%20%E9%9B%86%E5%90%88%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88set%EF%BC%8Clist%E5%92%8Cmap%EF%BC%89/"/>
    <id>http://yoursite.com/2021/12/22/JAVA é›†åˆå­¦ä¹ ç¬”è®°ï¼ˆsetï¼Œlistå’Œmapï¼‰/</id>
    <published>2021-12-22T11:30:12.000Z</published>
    <updated>2021-12-29T10:10:13.359Z</updated>
    
    <content type="html"><![CDATA[<p>é›†åˆç±»å­˜æ”¾äº Java.util åŒ…ä¸­ï¼Œä¸»è¦æœ‰ 3 ç§ï¼šset(é›†ï¼‰ã€list(åˆ—è¡¨åŒ…å« Queueï¼‰å’Œ map(æ˜ å°„)ã€‚</p><a id="more"></a><p>[TOC]</p><h1 id="æ¥å£ç»§æ‰¿å…³ç³»å’Œå®ç°"><a href="#æ¥å£ç»§æ‰¿å…³ç³»å’Œå®ç°" class="headerlink" title="æ¥å£ç»§æ‰¿å…³ç³»å’Œå®ç°"></a>æ¥å£ç»§æ‰¿å…³ç³»å’Œå®ç°</h1><p>é›†åˆç±»å­˜æ”¾äº Java.util åŒ…ä¸­ï¼Œä¸»è¦æœ‰ 3 ç§ï¼šset(é›†ï¼‰ã€list(åˆ—è¡¨åŒ…å« Queueï¼‰å’Œ map(æ˜ å°„)ã€‚</p><ol><li>Collectionï¼šCollection æ˜¯é›†åˆ Listã€Setã€Queue çš„æœ€åŸºæœ¬çš„æ¥å£ã€‚</li><li>Iteratorï¼šè¿­ä»£å™¨ï¼Œå¯ä»¥é€šè¿‡è¿­ä»£å™¨éå†é›†åˆä¸­çš„æ•°æ®</li><li>Mapï¼šæ˜¯æ˜ å°„è¡¨çš„åŸºç¡€æ¥å£</li></ol><h1 id="List"><a href="#List" class="headerlink" title="List"></a>List</h1><p>Java çš„ List æ˜¯éå¸¸å¸¸ç”¨çš„æ•°æ®ç±»å‹ã€‚List æ˜¯æœ‰åºçš„ Collectionã€‚Java List ä¸€å…±ä¸‰ä¸ªå®ç°ç±»ï¼šåˆ†åˆ«æ˜¯ ArrayListã€Vector å’Œ LinkedListã€‚</p><h2 id="ArrayListï¼ˆæ•°ç»„ï¼‰"><a href="#ArrayListï¼ˆæ•°ç»„ï¼‰" class="headerlink" title="ArrayListï¼ˆæ•°ç»„ï¼‰"></a>ArrayListï¼ˆæ•°ç»„ï¼‰</h2><p>ArrayList æ˜¯æœ€å¸¸ç”¨çš„ List å®ç°ç±»ï¼Œå†…éƒ¨æ˜¯é€šè¿‡æ•°ç»„å®ç°çš„ï¼Œå®ƒå…è®¸å¯¹å…ƒç´ è¿›è¡Œå¿«é€Ÿéšæœºè®¿é—®ã€‚æ•°ç»„çš„ç¼ºç‚¹æ˜¯æ¯ä¸ªå…ƒç´ ä¹‹é—´ä¸èƒ½æœ‰é—´éš”ï¼Œå½“æ•°ç»„å¤§å°ä¸æ»¡è¶³æ—¶éœ€è¦å¢åŠ å­˜å‚¨èƒ½åŠ›ï¼Œå°±è¦å°†å·²ç»æœ‰æ•°ç»„çš„æ•°æ®å¤åˆ¶åˆ°æ–°çš„å­˜å‚¨ç©ºé—´ä¸­ã€‚å½“ä»ArrayListçš„ä¸­é—´ä½ç½®æ’å…¥æˆ–è€…åˆ é™¤å…ƒç´ æ—¶ï¼Œéœ€è¦å¯¹æ•°ç»„è¿›è¡Œå¤åˆ¶ã€ç§»åŠ¨ã€ä»£ä»·æ¯”è¾ƒé«˜ã€‚å› æ­¤ï¼Œå®ƒé€‚åˆéšæœºæŸ¥æ‰¾å’Œéå†ï¼Œä¸é€‚åˆæ’å…¥å’Œåˆ é™¤ã€‚</p><h2 id="Vectorï¼ˆæ•°ç»„å®ç°ã€çº¿ç¨‹åŒæ­¥ï¼‰"><a href="#Vectorï¼ˆæ•°ç»„å®ç°ã€çº¿ç¨‹åŒæ­¥ï¼‰" class="headerlink" title="Vectorï¼ˆæ•°ç»„å®ç°ã€çº¿ç¨‹åŒæ­¥ï¼‰"></a>Vectorï¼ˆæ•°ç»„å®ç°ã€çº¿ç¨‹åŒæ­¥ï¼‰</h2><p>Vector ä¸ ArrayList ä¸€æ ·ï¼Œä¹Ÿæ˜¯é€šè¿‡æ•°ç»„å®ç°çš„ï¼Œä¸åŒçš„æ˜¯å®ƒæ”¯æŒçº¿ç¨‹çš„åŒæ­¥ï¼Œå³æŸä¸€æ—¶åˆ»åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤Ÿå†™Vectorï¼Œé¿å…å¤šçº¿ç¨‹åŒæ—¶å†™è€Œå¼•èµ·çš„ä¸ä¸€è‡´æ€§ï¼Œä½†å®ç°åŒæ­¥éœ€è¦å¾ˆé«˜çš„èŠ±è´¹ï¼Œå› æ­¤ï¼Œè®¿é—®å®ƒæ¯”è®¿é—® ArrayList æ…¢ã€‚</p><h2 id="LinkListï¼ˆé“¾è¡¨ï¼‰"><a href="#LinkListï¼ˆé“¾è¡¨ï¼‰" class="headerlink" title="LinkListï¼ˆé“¾è¡¨ï¼‰"></a>LinkListï¼ˆé“¾è¡¨ï¼‰</h2><p>LinkedList æ˜¯ç”¨é“¾è¡¨ç»“æ„å­˜å‚¨æ•°æ®çš„ï¼Œå¾ˆé€‚åˆæ•°æ®çš„åŠ¨æ€æ’å…¥å’Œåˆ é™¤ï¼Œéšæœºè®¿é—®å’Œéå†é€Ÿåº¦æ¯”è¾ƒæ…¢ã€‚å¦å¤–ï¼Œä»–è¿˜æä¾›äº†Listæ¥å£ä¸­æ²¡æœ‰å®šä¹‰çš„æ–¹æ³•ï¼Œä¸“é—¨ç”¨äºæ“ä½œè¡¨å¤´å’Œè¡¨å°¾å…ƒç´ ï¼Œå¯ä»¥å½“ä½œå †æ ˆã€é˜Ÿåˆ—å’ŒåŒå‘é˜Ÿåˆ—ä½¿ç”¨ã€‚</p><h1 id="Set"><a href="#Set" class="headerlink" title="Set"></a>Set</h1><p>Set æ³¨é‡ç‹¬ä¸€æ— äºŒçš„æ€§è´¨,è¯¥ä½“ç³»é›†åˆç”¨äºå­˜å‚¨æ— åº(å­˜å…¥å’Œå–å‡ºçš„é¡ºåºä¸ä¸€å®šç›¸åŒ)å…ƒç´ ï¼Œå€¼ä¸èƒ½é‡å¤ã€‚å¯¹è±¡çš„ç›¸ç­‰æ€§æœ¬è´¨æ˜¯å¯¹è±¡hashCodeå€¼ï¼ˆjavaæ˜¯ä¾æ®å¯¹è±¡çš„å†…å­˜åœ°å€è®¡ç®—å‡ºçš„æ­¤åºå·ï¼‰åˆ¤æ–­çš„ï¼Œå¦‚æœæƒ³è¦è®©ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡è§†ä¸ºç›¸ç­‰çš„ï¼Œå°±å¿…é¡»è¦†ç›– Object çš„ hashCode æ–¹æ³•å’Œ equals æ–¹æ³•ã€‚</p><h2 id="HashSetï¼ˆHash-è¡¨ï¼‰"><a href="#HashSetï¼ˆHash-è¡¨ï¼‰" class="headerlink" title="HashSetï¼ˆHash è¡¨ï¼‰"></a>HashSetï¼ˆHash è¡¨ï¼‰</h2><p>å“ˆå¸Œè¡¨è¾¹å­˜æ”¾çš„æ˜¯å“ˆå¸Œå€¼ã€‚HashSet å­˜å‚¨å…ƒç´ çš„é¡ºåºå¹¶ä¸æ˜¯æŒ‰ç…§å­˜å…¥æ—¶çš„é¡ºåºï¼ˆå’ŒListæ˜¾ç„¶ä¸åŒï¼‰è€Œæ˜¯æŒ‰ç…§å“ˆå¸Œå€¼æ¥å­˜çš„æ‰€ä»¥å–æ•°æ®ä¹Ÿæ˜¯æŒ‰ç…§å“ˆå¸Œå€¼å–å¾—ã€‚å…ƒç´ çš„å“ˆå¸Œå€¼æ˜¯é€šè¿‡å…ƒç´ çš„hashcode æ–¹æ³•æ¥è·å–çš„, HashSet é¦–å…ˆåˆ¤æ–­ä¸¤ä¸ªå…ƒç´ çš„å“ˆå¸Œå€¼ï¼Œå¦‚æœå“ˆå¸Œå€¼ä¸€æ ·ï¼Œæ¥ç€ä¼šæ¯”è¾ƒequals æ–¹æ³• å¦‚æœ equls ç»“æœä¸º true ï¼ŒHashSet å°±è§†ä¸ºåŒä¸€ä¸ªå…ƒç´ ã€‚å¦‚æœ equalsä¸ºfalseå°±ä¸æ˜¯åŒä¸€ä¸ªå…ƒç´ ã€‚å“ˆå¸Œå€¼ç›¸åŒequalsä¸ºfalseçš„å…ƒç´ æ˜¯æ€ä¹ˆå­˜å‚¨å‘¢,å°±æ˜¯åœ¨åŒæ ·çš„å“ˆå¸Œå€¼ä¸‹é¡ºå»¶ï¼ˆå¯ä»¥è®¤ä¸ºå“ˆå¸Œå€¼ç›¸åŒçš„å…ƒç´ æ”¾åœ¨ä¸€ä¸ªå“ˆå¸Œæ¡¶ä¸­ï¼‰ã€‚ä¹Ÿå°±æ˜¯å“ˆå¸Œä¸€æ ·çš„å­˜ä¸€åˆ—ã€‚å¦‚å›¾ 1 è¡¨ç¤º hashCode å€¼ä¸ç›¸åŒçš„æƒ…å†µï¼›å›¾ 2 è¡¨ç¤º hashCode å€¼ç›¸åŒï¼Œä½† equals ä¸ç›¸åŒçš„æƒ…å†µã€‚HashSet é€šè¿‡ hashCodeå€¼æ¥ç¡®å®šå…ƒç´ åœ¨å†…å­˜ä¸­çš„ä½ç½®ã€‚ä¸€ä¸ªhashCodeä½ç½®ä¸Šå¯ä»¥å­˜æ”¾å¤šä¸ªå…ƒç´ ã€‚</p><h2 id="TreeSetï¼ˆäºŒå‰æ ‘ï¼‰"><a href="#TreeSetï¼ˆäºŒå‰æ ‘ï¼‰" class="headerlink" title="TreeSetï¼ˆäºŒå‰æ ‘ï¼‰"></a>TreeSetï¼ˆäºŒå‰æ ‘ï¼‰</h2><ol><li>TreeSet()æ˜¯ä½¿ç”¨äºŒå‰æ ‘çš„åŸç†å¯¹æ–° add()çš„å¯¹è±¡æŒ‰ç…§æŒ‡å®šçš„é¡ºåºæ’åºï¼ˆå‡åºã€é™åºï¼‰ï¼Œæ¯å¢åŠ ä¸€ä¸ªå¯¹è±¡éƒ½ä¼šè¿›è¡Œæ’åºï¼Œå°†å¯¹è±¡æ’å…¥çš„äºŒå‰æ ‘æŒ‡å®šçš„ä½ç½®ã€‚</li><li>Integer å’Œ String å¯¹è±¡éƒ½å¯ä»¥è¿›è¡Œé»˜è®¤çš„ TreeSet æ’åºï¼Œè€Œè‡ªå®šä¹‰ç±»çš„å¯¹è±¡æ˜¯ä¸å¯ä»¥çš„ï¼Œè‡ªå·±å®šä¹‰çš„ç±»å¿…é¡»å®ç° Comparable æ¥å£ï¼Œå¹¶ä¸”è¦†å†™ç›¸åº”çš„ compareTo()å‡½æ•°ï¼Œæ‰å¯ä»¥æ­£å¸¸ä½¿ç”¨ã€‚</li><li>åœ¨è¦†å†™ compare()å‡½æ•°æ—¶ï¼Œè¦è¿”å›ç›¸åº”çš„å€¼æ‰èƒ½ä½¿ TreeSet æŒ‰ç…§ä¸€å®šçš„è§„åˆ™æ¥æ’åº</li><li>æ¯”è¾ƒæ­¤å¯¹è±¡ä¸æŒ‡å®šå¯¹è±¡çš„é¡ºåºã€‚å¦‚æœè¯¥å¯¹è±¡å°äºã€ç­‰äºæˆ–å¤§äºæŒ‡å®šå¯¹è±¡ï¼Œåˆ™åˆ†åˆ«è¿”å›è´Ÿæ•´æ•°ã€é›¶æˆ–æ­£æ•´æ•°ã€‚</li></ol><h2 id="LinkHashSetï¼ˆHashSet-LinkedHashMapï¼‰"><a href="#LinkHashSetï¼ˆHashSet-LinkedHashMapï¼‰" class="headerlink" title="LinkHashSetï¼ˆHashSet+LinkedHashMapï¼‰"></a>LinkHashSetï¼ˆHashSet+LinkedHashMapï¼‰</h2><p> å¯¹äº LinkedHashSet è€Œè¨€ï¼Œå®ƒç»§æ‰¿ä¸ HashSetã€åˆåŸºäº LinkedHashMap æ¥å®ç°çš„ã€‚LinkedHashSet åº•å±‚ä½¿ç”¨ LinkedHashMap æ¥ä¿å­˜æ‰€æœ‰å…ƒç´ ï¼Œå®ƒç»§æ‰¿ä¸ HashSetï¼Œå…¶æ‰€æœ‰çš„æ–¹æ³•æ“ä½œä¸Šåˆä¸ HashSetç›¸åŒï¼Œå› æ­¤LinkedHashSetçš„å®ç°ä¸Šéå¸¸ç®€å•ï¼Œåªæä¾›äº†å››ä¸ªæ„é€ æ–¹æ³•ï¼Œå¹¶é€šè¿‡ä¼ é€’ä¸€ä¸ªæ ‡è¯†å‚æ•°ï¼Œè°ƒç”¨çˆ¶ç±»çš„æ„é€ å™¨ï¼Œåº•å±‚æ„é€ ä¸€ä¸ª LinkedHashMap æ¥å®ç°ï¼Œåœ¨ç›¸å…³æ“ä½œä¸Šä¸çˆ¶ç±» HashSet çš„æ“ä½œç›¸åŒï¼Œç›´æ¥è°ƒç”¨çˆ¶ç±» HashSet çš„æ–¹æ³•å³å¯ã€‚</p><h1 id="Map"><a href="#Map" class="headerlink" title="Map"></a>Map</h1><h2 id="HashMapï¼ˆæ•°ç»„-é“¾è¡¨-çº¢é»‘æ ‘ï¼‰"><a href="#HashMapï¼ˆæ•°ç»„-é“¾è¡¨-çº¢é»‘æ ‘ï¼‰" class="headerlink" title="HashMapï¼ˆæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ï¼‰"></a>HashMapï¼ˆæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ï¼‰</h2><p>HashMap æ ¹æ®é”®çš„ hashCode å€¼å­˜å‚¨æ•°æ®ï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹å¯ä»¥ç›´æ¥å®šä½åˆ°å®ƒçš„å€¼ï¼Œå› è€Œå…·æœ‰å¾ˆå¿«çš„è®¿é—®é€Ÿåº¦ï¼Œä½†éå†é¡ºåºå´æ˜¯ä¸ç¡®å®šçš„ã€‚ HashMapæœ€å¤šåªå…è®¸ä¸€æ¡è®°å½•çš„é”®ä¸º nullï¼Œå…è®¸å¤šæ¡è®°å½•çš„å€¼ä¸º nullã€‚HashMap éçº¿ç¨‹å®‰å…¨ï¼Œå³ä»»ä¸€æ—¶åˆ»å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å†™ HashMapï¼Œå¯èƒ½ä¼šå¯¼<br>è‡´æ•°æ®çš„ä¸ä¸€è‡´ã€‚å¦‚æœéœ€è¦æ»¡è¶³çº¿ç¨‹å®‰å…¨ï¼Œå¯ä»¥ç”¨ Collections çš„ synchronizedMap æ–¹æ³•ä½¿HashMap å…·æœ‰çº¿ç¨‹å®‰å…¨çš„èƒ½åŠ›ï¼Œæˆ–è€…ä½¿ç”¨ ConcurrentHashMapã€‚æˆ‘ä»¬ç”¨ä¸‹é¢è¿™å¼ å›¾æ¥ä»‹ç»HashMap çš„ç»“æ„ã€‚</p><h3 id="JAVA7-å®ç°"><a href="#JAVA7-å®ç°" class="headerlink" title="JAVA7 å®ç°"></a>JAVA7 å®ç°</h3><p>å¤§æ–¹å‘ä¸Šï¼ŒHashMap é‡Œé¢æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œç„¶åæ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ æ˜¯ä¸€ä¸ªå•å‘é“¾è¡¨ã€‚ä¸Šå›¾ä¸­ï¼Œæ¯ä¸ªç»¿è‰²çš„å®ä½“æ˜¯åµŒå¥—ç±» Entry çš„å®ä¾‹ï¼ŒEntry åŒ…å«å››ä¸ªå±æ€§ï¼škey, value, hash å€¼å’Œç”¨äºå•å‘é“¾è¡¨çš„ nextã€‚</p><ol><li>capacityï¼šå½“å‰æ•°ç»„å®¹é‡ï¼Œå§‹ç»ˆä¿æŒ 2^nï¼Œå¯ä»¥æ‰©å®¹ï¼Œæ‰©å®¹åæ•°ç»„å¤§å°ä¸ºå½“å‰çš„ 2 å€ã€‚</li><li>loadFactorï¼šè´Ÿè½½å› å­ï¼Œé»˜è®¤ä¸º 0.75ã€‚</li><li>thresholdï¼šæ‰©å®¹çš„é˜ˆå€¼ï¼Œç­‰äº capacity * loadFactor</li></ol><h3 id="JAVA8-å®ç°"><a href="#JAVA8-å®ç°" class="headerlink" title="JAVA8 å®ç°"></a>JAVA8 å®ç°</h3><p>Java8 å¯¹ HashMap è¿›è¡Œäº†ä¸€äº›ä¿®æ”¹ï¼Œæœ€å¤§çš„ä¸åŒå°±æ˜¯åˆ©ç”¨äº†çº¢é»‘æ ‘ï¼Œæ‰€ä»¥å…¶ç”± æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ ç»„æˆã€‚æ ¹æ®Java7 HashMapçš„ä»‹ç»ï¼Œæˆ‘ä»¬çŸ¥é“ï¼ŒæŸ¥æ‰¾çš„æ—¶å€™ï¼Œæ ¹æ®hashå€¼æˆ‘ä»¬èƒ½å¤Ÿå¿«é€Ÿå®šä½åˆ°æ•°ç»„çš„å…·ä½“ä¸‹æ ‡ï¼Œä½†æ˜¯ä¹‹åçš„è¯ï¼Œéœ€è¦é¡ºç€é“¾è¡¨ä¸€ä¸ªä¸ªæ¯”è¾ƒä¸‹å»æ‰èƒ½æ‰¾åˆ°æˆ‘ä»¬éœ€è¦çš„ï¼Œæ—¶é—´å¤æ‚åº¦å–å†³äºé“¾è¡¨çš„é•¿åº¦ï¼Œä¸º O(n)ã€‚ä¸ºäº†é™ä½è¿™éƒ¨åˆ†çš„å¼€é”€ï¼Œåœ¨Java8ä¸­ï¼Œå½“é“¾è¡¨ä¸­çš„å…ƒç´ è¶…è¿‡äº†8ä¸ªä»¥åï¼Œä¼šå°†é“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ï¼Œåœ¨è¿™äº›ä½ç½®è¿›è¡ŒæŸ¥æ‰¾çš„æ—¶å€™å¯ä»¥é™ä½æ—¶é—´å¤æ‚åº¦ä¸º O(logN)ã€‚</p><h2 id="ConcurrentHashMap"><a href="#ConcurrentHashMap" class="headerlink" title="ConcurrentHashMap"></a>ConcurrentHashMap</h2><h3 id="Segment-æ®µ"><a href="#Segment-æ®µ" class="headerlink" title="Segment æ®µ"></a>Segment æ®µ</h3><p>ConcurrentHashMap å’Œ HashMap æ€è·¯æ˜¯å·®ä¸å¤šçš„ï¼Œä½†æ˜¯å› ä¸ºå®ƒæ”¯æŒå¹¶å‘æ“ä½œï¼Œæ‰€ä»¥è¦å¤æ‚ä¸€äº›ã€‚æ•´ä¸ª ConcurrentHashMap ç”±ä¸€ä¸ªä¸ª Segment ç»„æˆï¼ŒSegment ä»£è¡¨â€éƒ¨åˆ†â€œæˆ–â€ä¸€æ®µâ€œçš„æ„æ€ï¼Œæ‰€ä»¥å¾ˆå¤šåœ°æ–¹éƒ½ä¼šå°†å…¶æè¿°ä¸ºåˆ†æ®µé”ã€‚æ³¨æ„ï¼Œè¡Œæ–‡ä¸­ï¼Œæˆ‘å¾ˆå¤šåœ°æ–¹ç”¨äº†â€œæ§½â€æ¥ä»£è¡¨ä¸€ä¸ªsegmentã€‚</p><h3 id="çº¿ç¨‹å®‰å…¨ï¼ˆSegment-ç»§æ‰¿-ReentrantLock-åŠ é”ï¼‰"><a href="#çº¿ç¨‹å®‰å…¨ï¼ˆSegment-ç»§æ‰¿-ReentrantLock-åŠ é”ï¼‰" class="headerlink" title="çº¿ç¨‹å®‰å…¨ï¼ˆSegment ç»§æ‰¿ ReentrantLock åŠ é”ï¼‰"></a>çº¿ç¨‹å®‰å…¨ï¼ˆSegment ç»§æ‰¿ ReentrantLock åŠ é”ï¼‰</h3><p>ç®€å•ç†è§£å°±æ˜¯ï¼ŒConcurrentHashMap æ˜¯ä¸€ä¸ª Segment æ•°ç»„ï¼ŒSegment é€šè¿‡ç»§æ‰¿ReentrantLock æ¥è¿›è¡ŒåŠ é”ï¼Œæ‰€ä»¥æ¯æ¬¡éœ€è¦åŠ é”çš„æ“ä½œé”ä½çš„æ˜¯ä¸€ä¸ª segmentï¼Œè¿™æ ·åªè¦ä¿è¯æ¯ä¸ª Segment æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä¹Ÿå°±å®ç°äº†å…¨å±€çš„çº¿ç¨‹å®‰å…¨ã€‚</p><h3 id="å¹¶è¡Œåº¦ï¼ˆé»˜è®¤-16ï¼‰"><a href="#å¹¶è¡Œåº¦ï¼ˆé»˜è®¤-16ï¼‰" class="headerlink" title="å¹¶è¡Œåº¦ï¼ˆé»˜è®¤ 16ï¼‰"></a>å¹¶è¡Œåº¦ï¼ˆé»˜è®¤ 16ï¼‰</h3><p>concurrencyLevelï¼šå¹¶è¡Œçº§åˆ«ã€å¹¶å‘æ•°ã€Segment æ•°ï¼Œæ€ä¹ˆç¿»è¯‘ä¸é‡è¦ï¼Œç†è§£å®ƒã€‚é»˜è®¤æ˜¯ 16ï¼Œä¹Ÿå°±æ˜¯è¯´ ConcurrentHashMap æœ‰ 16 ä¸ª Segmentsï¼Œæ‰€ä»¥ç†è®ºä¸Šï¼Œè¿™ä¸ªæ—¶å€™ï¼Œæœ€å¤šå¯ä»¥åŒæ—¶æ”¯æŒ 16 ä¸ªçº¿ç¨‹å¹¶å‘å†™ï¼Œåªè¦å®ƒä»¬çš„æ“ä½œåˆ†åˆ«åˆ†å¸ƒåœ¨ä¸åŒçš„ Segment ä¸Šã€‚è¿™ä¸ªå€¼å¯ä»¥åœ¨åˆå§‹åŒ–çš„æ—¶<br>å€™è®¾ç½®ä¸ºå…¶ä»–å€¼ï¼Œä½†æ˜¯ä¸€æ—¦åˆå§‹åŒ–ä»¥åï¼Œå®ƒæ˜¯ä¸å¯ä»¥æ‰©å®¹çš„ã€‚å†å…·ä½“åˆ°æ¯ä¸ªSegmentå†…éƒ¨ï¼Œå…¶å®æ¯ä¸ªSegmentå¾ˆåƒä¹‹å‰ä»‹ç»çš„HashMapï¼Œä¸è¿‡å®ƒè¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ‰€ä»¥å¤„ç†èµ·æ¥è¦éº»çƒ¦äº›ã€‚</p><h3 id="Java8-å®ç°-ï¼ˆå¼•å…¥äº†çº¢é»‘æ ‘ï¼‰"><a href="#Java8-å®ç°-ï¼ˆå¼•å…¥äº†çº¢é»‘æ ‘ï¼‰" class="headerlink" title="Java8 å®ç° ï¼ˆå¼•å…¥äº†çº¢é»‘æ ‘ï¼‰"></a>Java8 å®ç° ï¼ˆå¼•å…¥äº†çº¢é»‘æ ‘ï¼‰</h3><p>Java8 å¯¹ ConcurrentHashMapè¿›è¡Œäº†æ¯”è¾ƒå¤§çš„æ”¹åŠ¨,Java8 ä¹Ÿå¼•å…¥äº†çº¢é»‘æ ‘</p><h2 id="HashTableï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰"><a href="#HashTableï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰" class="headerlink" title="HashTableï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰"></a>HashTableï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰</h2><p>Hashtable æ˜¯é—ç•™ç±»ï¼Œå¾ˆå¤šæ˜ å°„çš„å¸¸ç”¨åŠŸèƒ½ä¸ HashMap ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯å®ƒæ‰¿è‡ª Dictionary ç±»ï¼Œå¹¶ä¸”æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œä»»ä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å†™ Hashtableï¼Œå¹¶å‘æ€§ä¸å¦‚ ConcurrentHashMapï¼Œå› ä¸º ConcurrentHashMap å¼•å…¥äº†åˆ†æ®µé”ã€‚Hashtable ä¸å»ºè®®åœ¨æ–°ä»£ç ä¸­ä½¿ç”¨ï¼Œä¸éœ€è¦çº¿ç¨‹å®‰å…¨<br>çš„åœºåˆå¯ä»¥ç”¨ HashMap æ›¿æ¢ï¼Œéœ€è¦çº¿ç¨‹å®‰å…¨çš„åœºåˆå¯ä»¥ç”¨ ConcurrentHashMap æ›¿æ¢ã€‚</p><h2 id="TreeMapï¼ˆå¯æ’åºï¼‰"><a href="#TreeMapï¼ˆå¯æ’åºï¼‰" class="headerlink" title="TreeMapï¼ˆå¯æ’åºï¼‰"></a>TreeMapï¼ˆå¯æ’åºï¼‰</h2><p>TreeMap å®ç° SortedMap æ¥å£ï¼Œèƒ½å¤ŸæŠŠå®ƒä¿å­˜çš„è®°å½•æ ¹æ®é”®æ’åºï¼Œé»˜è®¤æ˜¯æŒ‰é”®å€¼çš„å‡åºæ’åºï¼Œä¹Ÿå¯ä»¥æŒ‡å®šæ’åºçš„æ¯”è¾ƒå™¨ï¼Œå½“ç”¨ Iterator éå† TreeMap æ—¶ï¼Œå¾—åˆ°çš„è®°å½•æ˜¯æ’è¿‡åºçš„ã€‚å¦‚æœä½¿ç”¨æ’åºçš„æ˜ å°„ï¼Œå»ºè®®ä½¿ç”¨ TreeMapã€‚åœ¨ä½¿ç”¨ TreeMap æ—¶ï¼Œkey å¿…é¡»å®ç° Comparable æ¥å£æˆ–è€…åœ¨æ„é€  TreeMap ä¼ å…¥è‡ªå®šä¹‰çš„<br>Comparatorï¼Œå¦åˆ™ä¼šåœ¨è¿è¡Œæ—¶æŠ›å‡º java.lang.ClassCastException ç±»å‹çš„å¼‚å¸¸ã€‚</p><p>å‚è€ƒï¼š<a href="https://www.ibm.com/developerworks/cn/java/j-lo-tree/index.html" target="_blank" rel="noopener">https://www.ibm.com/developerworks/cn/java/j-lo-tree/index.html</a></p><h2 id="LinkHashMapï¼ˆè®°å½•æ’å…¥é¡ºåºï¼‰"><a href="#LinkHashMapï¼ˆè®°å½•æ’å…¥é¡ºåºï¼‰" class="headerlink" title="LinkHashMapï¼ˆè®°å½•æ’å…¥é¡ºåºï¼‰"></a>LinkHashMapï¼ˆè®°å½•æ’å…¥é¡ºåºï¼‰</h2><p>LinkedHashMap æ˜¯ HashMap çš„ä¸€ä¸ªå­ç±»ï¼Œä¿å­˜äº†è®°å½•çš„æ’å…¥é¡ºåºï¼Œåœ¨ç”¨Iteratoréå†LinkedHashMapæ—¶ï¼Œå…ˆå¾—åˆ°çš„è®°å½•è‚¯å®šæ˜¯å…ˆæ’å…¥çš„ï¼Œä¹Ÿå¯ä»¥åœ¨æ„é€ æ—¶å¸¦å‚æ•°ï¼ŒæŒ‰ç…§è®¿é—®æ¬¡åºæ’åºã€‚</p><p>å‚è€ƒ 1ï¼š<a href="http://www.importnew.com/28263.html" target="_blank" rel="noopener">http://www.importnew.com/28263.html</a><br>å‚è€ƒ 2ï¼š<a href="http://www.importnew.com/20386.html#comment-648123" target="_blank" rel="noopener">http://www.importnew.com/20386.html#comment-648123</a></p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;é›†åˆç±»å­˜æ”¾äº Java.util åŒ…ä¸­ï¼Œä¸»è¦æœ‰ 3 ç§ï¼šset(é›†ï¼‰ã€list(åˆ—è¡¨åŒ…å« Queueï¼‰å’Œ map(æ˜ å°„)ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="Collection" scheme="http://yoursite.com/tags/Collection/"/>
    
  </entry>
  
  <entry>
    <title>518. é›¶é’±å…‘æ¢ II</title>
    <link href="http://yoursite.com/2021/12/21/518.%20%E9%9B%B6%E9%92%B1%E5%85%91%E6%8D%A2%20II/"/>
    <id>http://yoursite.com/2021/12/21/518. é›¶é’±å…‘æ¢ II/</id>
    <published>2021-12-21T12:51:12.000Z</published>
    <updated>2021-12-21T13:40:00.066Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ coins è¡¨ç¤ºä¸åŒé¢é¢çš„ç¡¬å¸ï¼Œå¦ç»™ä¸€ä¸ªæ•´æ•° amount è¡¨ç¤ºæ€»é‡‘é¢ã€‚</p><p>è¯·ä½ è®¡ç®—å¹¶è¿”å›å¯ä»¥å‡‘æˆæ€»é‡‘é¢çš„ç¡¬å¸ç»„åˆæ•°ã€‚å¦‚æœä»»ä½•ç¡¬å¸ç»„åˆéƒ½æ— æ³•å‡‘å‡ºæ€»é‡‘é¢ï¼Œè¿”å› 0 ã€‚</p><a id="more"></a><p>[TOC]</p><p>å‡è®¾æ¯ä¸€ç§é¢é¢çš„ç¡¬å¸æœ‰æ— é™ä¸ªã€‚<br>é¢˜ç›®æ•°æ®ä¿è¯ç»“æœç¬¦åˆ 32 ä½å¸¦ç¬¦å·æ•´æ•°ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼šamount = 5, coins = [1, 2, 5]è¾“å‡ºï¼š4è§£é‡Šï¼šæœ‰å››ç§æ–¹å¼å¯ä»¥å‡‘æˆæ€»é‡‘é¢ï¼š5=55=2+2+15=2+1+1+15=1+1+1+1+1</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼šamount = 3, coins = [2]è¾“å‡ºï¼š0è§£é‡Šï¼šåªç”¨é¢é¢ 2 çš„ç¡¬å¸ä¸èƒ½å‡‘æˆæ€»é‡‘é¢ 3 ã€‚</code></pre><p>ç¤ºä¾‹ 3ï¼š</p><pre><code>è¾“å…¥ï¼šamount = 10, coins = [10] è¾“å‡ºï¼š1</code></pre><p>æç¤ºï¼š</p><pre><code>1 &lt;= coins.length &lt;= 3001 &lt;= coins[i] &lt;= 5000coins ä¸­çš„æ‰€æœ‰å€¼ äº’ä¸ç›¸åŒ0 &lt;= amount &lt;= 5000</code></pre><h1 id="æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’-1"><a href="#æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’-1" class="headerlink" title="æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’^1"></a>æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’<a href="https://leetcode-cn.com/problems/coin-change-2/solution/ling-qian-dui-huan-ii-by-leetcode-soluti-f7uh/" target="_blank" rel="noopener">^1</a></h1><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[sol1-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> amount, <span class="keyword">int</span>[] coins)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[amount + <span class="number">1</span>];</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> coin : coins) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = coin; i &lt;= amount; i++) &#123;</span><br><span class="line">                dp[i] += dp[i - coin];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[amount];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>C#</summary><figure class="highlight plain"><figcaption><span>[sol1-C#]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Solution &#123;</span><br><span class="line">    public int Change(int amount, int[] coins) &#123;</span><br><span class="line">        int[] dp = new int[amount + 1];</span><br><span class="line">        dp[0] = 1;</span><br><span class="line">        foreach (int coin in coins) &#123;</span><br><span class="line">            for (int i = coin; i &lt;= amount; i++) &#123;</span><br><span class="line">                dp[i] += dp[i - coin];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return dp[amount];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>JavaScript</summary><figure class="highlight javascript"><figcaption><span>[sol1-JavaScript]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> change = <span class="function"><span class="keyword">function</span>(<span class="params">amount, coins</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> dp = <span class="keyword">new</span> <span class="built_in">Array</span>(amount + <span class="number">1</span>).fill(<span class="number">0</span>);</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">const</span> coin <span class="keyword">of</span> coins) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> i = coin; i &lt;= amount; i++) &#123;</span><br><span class="line">            dp[i] += dp[i - coin];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[amount];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>Golang</summary><figure class="highlight go"><figcaption><span>[sol1-Golang]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">change</span><span class="params">(amount <span class="keyword">int</span>, coins []<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    dp := <span class="built_in">make</span>([]<span class="keyword">int</span>, amount+<span class="number">1</span>)</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">1</span></span><br><span class="line">    <span class="keyword">for</span> _, coin := <span class="keyword">range</span> coins &#123;</span><br><span class="line">        <span class="keyword">for</span> i := coin; i &lt;= amount; i++ &#123;</span><br><span class="line">            dp[i] += dp[i-coin]</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[amount]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>C++</summary><figure class="highlight c++"><figcaption><span>[sol1-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> amount, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; coins)</span> </span>&#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; dp(amount + <span class="number">1</span>);</span><br><span class="line">        dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span>&amp; coin : coins) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> i = coin; i &lt;= amount; i++) &#123;</span><br><span class="line">                dp[i] += dp[i - coin];</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[amount];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>C</summary><figure class="highlight c"><figcaption><span>[sol1-C]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">change</span><span class="params">(<span class="keyword">int</span> amount, <span class="keyword">int</span>* coins, <span class="keyword">int</span> coinsSize)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> dp[amount + <span class="number">1</span>];</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">    dp[<span class="number">0</span>] = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; coinsSize; i++) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = coins[i]; j &lt;= amount; j++) &#123;</span><br><span class="line">            dp[j] += dp[j - coins[i]];</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[amount];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ coins è¡¨ç¤ºä¸åŒé¢é¢çš„ç¡¬å¸ï¼Œå¦ç»™ä¸€ä¸ªæ•´æ•° amount è¡¨ç¤ºæ€»é‡‘é¢ã€‚&lt;/p&gt;
&lt;p&gt;è¯·ä½ è®¡ç®—å¹¶è¿”å›å¯ä»¥å‡‘æˆæ€»é‡‘é¢çš„ç¡¬å¸ç»„åˆæ•°ã€‚å¦‚æœä»»ä½•ç¡¬å¸ç»„åˆéƒ½æ— æ³•å‡‘å‡ºæ€»é‡‘é¢ï¼Œè¿”å› 0 ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="Leetcode" scheme="http://yoursite.com/tags/Leetcode/"/>
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
  </entry>
  
  <entry>
    <title>å‰‘æŒ‡ Offer 17. æ‰“å°ä»1åˆ°æœ€å¤§çš„nä½æ•°</title>
    <link href="http://yoursite.com/2021/12/21/%E5%89%91%E6%8C%87%20Offer%2017.%20%E6%89%93%E5%8D%B0%E4%BB%8E1%E5%88%B0%E6%9C%80%E5%A4%A7%E7%9A%84n%E4%BD%8D%E6%95%B0/"/>
    <id>http://yoursite.com/2021/12/21/å‰‘æŒ‡ Offer 17. æ‰“å°ä»1åˆ°æœ€å¤§çš„nä½æ•°/</id>
    <published>2021-12-21T12:15:12.000Z</published>
    <updated>2021-12-22T06:53:17.531Z</updated>
    
    <content type="html"><![CDATA[<p>è¾“å…¥æ•°å­— nï¼ŒæŒ‰é¡ºåºæ‰“å°å‡ºä» 1 åˆ°æœ€å¤§çš„ n ä½åè¿›åˆ¶æ•°ã€‚æ¯”å¦‚è¾“å…¥ 3ï¼Œåˆ™æ‰“å°å‡º 1ã€2ã€3 ä¸€ç›´åˆ°æœ€å¤§çš„ 3 ä½æ•° 999ã€‚</p><a id="more"></a><p>[TOC]</p><p>ç¤ºä¾‹ 1:</p><pre><code>è¾“å…¥: n = 1è¾“å‡º: [1,2,3,4,5,6,7,8,9]</code></pre><p>è¯´æ˜ï¼š</p><pre><code>ç”¨è¿”å›ä¸€ä¸ªæ•´æ•°åˆ—è¡¨æ¥ä»£æ›¿æ‰“å°n ä¸ºæ­£æ•´æ•°</code></pre><h1 id="è§£é¢˜æ€è·¯ï¼š-1"><a href="#è§£é¢˜æ€è·¯ï¼š-1" class="headerlink" title="è§£é¢˜æ€è·¯ï¼š^1"></a>è§£é¢˜æ€è·¯ï¼š<a href="https://leetcode-cn.com/problems/da-yin-cong-1dao-zui-da-de-nwei-shu-lcof/solution/mian-shi-ti-17-da-yin-cong-1-dao-zui-da-de-n-wei-2/" target="_blank" rel="noopener">^1</a></h1><p>é¢˜ç›®è¦æ±‚æ‰“å° â€œä» <em>1</em> è‡³æœ€å¤§çš„ <em>n</em> ä½æ•°çš„åˆ—è¡¨â€ ï¼Œå› æ­¤éœ€è€ƒè™‘ä»¥ä¸‹ä¸¤ä¸ªé—®é¢˜ï¼š</p><ol><li><strong>æœ€å¤§çš„ <em>n</em> ä½æ•°ï¼ˆè®°ä¸º <em>end</em> ï¼‰å’Œä½æ•° <em>n</em> çš„å…³ç³»ï¼š</strong> ä¾‹å¦‚æœ€å¤§çš„ <em>1</em> ä½æ•°æ˜¯ <em>9</em> ï¼Œæœ€å¤§çš„ <em>2</em> ä½æ•°æ˜¯ <em>99</em> ï¼Œæœ€å¤§çš„ <em>3</em> ä½æ•°æ˜¯ <em>999</em> ã€‚åˆ™å¯æ¨å‡ºå…¬å¼ï¼š</li></ol><pre><code>end = 10^n - 1</code></pre><ol start="2"><li><strong>å¤§æ•°è¶Šç•Œé—®é¢˜ï¼š</strong> å½“ <em>n</em> è¾ƒå¤§æ—¶ï¼Œ<em>end</em> ä¼šè¶…å‡º <em>int32</em> æ•´å‹çš„å–å€¼èŒƒå›´ï¼Œè¶…å‡ºå–å€¼èŒƒå›´çš„æ•°å­—æ— æ³•æ­£å¸¸å­˜å‚¨ã€‚ä½†ç”±äºæœ¬é¢˜è¦æ±‚è¿”å› int ç±»å‹æ•°ç»„ï¼Œç›¸å½“äºé»˜è®¤æ‰€æœ‰æ•°å­—éƒ½åœ¨ int32 æ•´å‹å–å€¼èŒƒå›´å†…ï¼Œå› æ­¤ä¸è€ƒè™‘å¤§æ•°è¶Šç•Œé—®é¢˜ã€‚</li></ol><p>å› æ­¤ï¼Œåªéœ€å®šä¹‰åŒºé—´ <em>[1, 10^n - 1]</em> å’Œæ­¥é•¿ <em>1</em> ï¼Œé€šè¿‡ <em>for</em> å¾ªç¯ç”Ÿæˆç»“æœåˆ—è¡¨ <em>res</em> å¹¶è¿”å›å³å¯ã€‚</p><h2 id="å¤æ‚åº¦åˆ†æï¼š"><a href="#å¤æ‚åº¦åˆ†æï¼š" class="headerlink" title="å¤æ‚åº¦åˆ†æï¼š"></a>å¤æ‚åº¦åˆ†æï¼š</h2><ul><li><strong>æ—¶é—´å¤æ‚åº¦ <em>O(10^n)</em> ï¼š</strong> ç”Ÿæˆé•¿åº¦ä¸º <em>10^n</em> çš„åˆ—è¡¨éœ€ä½¿ç”¨ <em>O(10^n)</em> æ—¶é—´ã€‚</li><li><strong>ç©ºé—´å¤æ‚åº¦ <em>O(1)</em> ï¼š</strong> å»ºç«‹åˆ—è¡¨éœ€ä½¿ç”¨ <em>O(1)</em> å¤§å°çš„é¢å¤–ç©ºé—´ï¼ˆ åˆ—è¡¨ä½œä¸ºè¿”å›ç»“æœï¼Œä¸è®¡å…¥é¢å¤–ç©ºé—´ ï¼‰ã€‚</li></ul><h2 id="ä»£ç ï¼š"><a href="#ä»£ç ï¼š" class="headerlink" title="ä»£ç ï¼š"></a>ä»£ç ï¼š</h2><details>    <summary>Python</summary><figure class="highlight python"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">printNumbers</span><span class="params">(self, n: int)</span> -&gt; List[int]:</span></span><br><span class="line">        res = []</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>, <span class="number">10</span> ** n):</span><br><span class="line">            res.append(i)</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure></details><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] printNumbers(<span class="keyword">int</span> n) &#123;</span><br><span class="line">        <span class="keyword">int</span> end = (<span class="keyword">int</span>)Math.pow(<span class="number">10</span>, n) - <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span>[] res = <span class="keyword">new</span> <span class="keyword">int</span>[end];</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; end; i++)</span><br><span class="line">            res[i] = i + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><p>åˆ©ç”¨ Python çš„è¯­è¨€ç‰¹æ€§ï¼Œå¯ä»¥ç®€åŒ–ä»£ç ï¼šå…ˆä½¿ç”¨ <code>range()</code> æ–¹æ³•ç”Ÿæˆå¯è¿­ä»£å¯¹è±¡ï¼Œå†ä½¿ç”¨ <code>list()</code> æ–¹æ³•è½¬åŒ–ä¸ºåˆ—è¡¨å¹¶è¿”å›å³å¯ã€‚</p><details>    <summary>Python</summary><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">printNumbers</span><span class="params">(self, n: int)</span> -&gt; List[int]:</span></span><br><span class="line">        <span class="keyword">return</span> list(range(<span class="number">1</span>, <span class="number">10</span> ** n))</span><br></pre></td></tr></table></figure></details><h1 id="å¤§æ•°æ‰“å°è§£æ³•ï¼š"><a href="#å¤§æ•°æ‰“å°è§£æ³•ï¼š" class="headerlink" title="å¤§æ•°æ‰“å°è§£æ³•ï¼š"></a>å¤§æ•°æ‰“å°è§£æ³•ï¼š</h1><p>å®é™…ä¸Šï¼Œæœ¬é¢˜çš„ä¸»è¦è€ƒç‚¹æ˜¯å¤§æ•°è¶Šç•Œæƒ…å†µä¸‹çš„æ‰“å°ã€‚éœ€è¦è§£å†³ä»¥ä¸‹ä¸‰ä¸ªé—®é¢˜ï¼š</p><h2 id="1-è¡¨ç¤ºå¤§æ•°çš„å˜é‡ç±»å‹ï¼š"><a href="#1-è¡¨ç¤ºå¤§æ•°çš„å˜é‡ç±»å‹ï¼š" class="headerlink" title="1. è¡¨ç¤ºå¤§æ•°çš„å˜é‡ç±»å‹ï¼š"></a>1. è¡¨ç¤ºå¤§æ•°çš„å˜é‡ç±»å‹ï¼š</h2><ul><li>æ— è®ºæ˜¯ short / int / long â€¦ ä»»æ„å˜é‡ç±»å‹ï¼Œæ•°å­—çš„å–å€¼èŒƒå›´éƒ½æ˜¯æœ‰é™çš„ã€‚å› æ­¤ï¼Œå¤§æ•°çš„è¡¨ç¤ºåº”ç”¨å­—ç¬¦ä¸² String ç±»å‹ã€‚</li></ul><h2 id="2-ç”Ÿæˆæ•°å­—çš„å­—ç¬¦ä¸²é›†ï¼š"><a href="#2-ç”Ÿæˆæ•°å­—çš„å­—ç¬¦ä¸²é›†ï¼š" class="headerlink" title="2. ç”Ÿæˆæ•°å­—çš„å­—ç¬¦ä¸²é›†ï¼š"></a>2. ç”Ÿæˆæ•°å­—çš„å­—ç¬¦ä¸²é›†ï¼š</h2><ul><li><p>ä½¿ç”¨ int ç±»å‹æ—¶ï¼Œæ¯è½®å¯é€šè¿‡ <em>+1</em> ç”Ÿæˆä¸‹ä¸ªæ•°å­—ï¼Œè€Œæ­¤æ–¹æ³•æ— æ³•åº”ç”¨è‡³ String ç±»å‹ã€‚å¹¶ä¸”ï¼Œ String ç±»å‹çš„æ•°å­—çš„è¿›ä½æ“ä½œæ•ˆç‡è¾ƒä½ï¼Œä¾‹å¦‚ <code>&quot;9999&quot;</code> è‡³ <code>&quot;10000&quot;</code> éœ€è¦ä»ä¸ªä½åˆ°åƒä½å¾ªç¯åˆ¤æ–­ï¼Œè¿›ä½ 4 æ¬¡ã€‚</p></li><li><p>è§‚å¯Ÿå¯çŸ¥ï¼Œç”Ÿæˆçš„åˆ—è¡¨å®é™…ä¸Šæ˜¯ <em>n</em> ä½ <em>0</em> - <em>9</em> çš„ <strong>å…¨æ’åˆ—</strong> ï¼Œå› æ­¤å¯é¿å¼€è¿›ä½æ“ä½œï¼Œé€šè¿‡é€’å½’ç”Ÿæˆæ•°å­—çš„ String åˆ—è¡¨ã€‚</p></li></ul><h2 id="3-é€’å½’ç”Ÿæˆå…¨æ’åˆ—ï¼š"><a href="#3-é€’å½’ç”Ÿæˆå…¨æ’åˆ—ï¼š" class="headerlink" title="3. é€’å½’ç”Ÿæˆå…¨æ’åˆ—ï¼š"></a>3. é€’å½’ç”Ÿæˆå…¨æ’åˆ—ï¼š</h2><ul><li>åŸºäºåˆ†æ²»ç®—æ³•çš„æ€æƒ³ï¼Œå…ˆå›ºå®šé«˜ä½ï¼Œå‘ä½ä½é€’å½’ï¼Œå½“ä¸ªä½å·²è¢«å›ºå®šæ—¶ï¼Œæ·»åŠ æ•°å­—çš„å­—ç¬¦ä¸²ã€‚ä¾‹å¦‚å½“ <em>n = 2</em> æ—¶ï¼ˆæ•°å­—èŒƒå›´ <em>1 - 99</em> ï¼‰ï¼Œå›ºå®šåä½ä¸º <em>0</em> - <em>9</em> ï¼ŒæŒ‰é¡ºåºä¾æ¬¡å¼€å¯é€’å½’ï¼Œå›ºå®šä¸ªä½ <em>0</em> - <em>9</em> ï¼Œç»ˆæ­¢é€’å½’å¹¶æ·»åŠ æ•°å­—å­—ç¬¦ä¸²ã€‚</li></ul><p><a href="https://pic.leetcode-cn.com/83f4b5930ddc1d42b05c724ea2950ee7f00427b11150c86b45bd88405f8c7c87-Picture1.png" target="_blank" rel="noopener">Picture1.png</a></p><p>æ ¹æ®ä»¥ä¸Šæ–¹æ³•ï¼Œå¯åˆæ­¥ç¼–å†™å…¨æ’åˆ—ä»£ç ï¼š</p><details>    <summary>Python</summary><figure class="highlight python"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">printNumbers</span><span class="params">(self, n: int)</span> -&gt; [int]:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(x)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> x == n: <span class="comment"># ç»ˆæ­¢æ¡ä»¶ï¼šå·²å›ºå®šå®Œæ‰€æœ‰ä½</span></span><br><span class="line">                res.append(<span class="string">''</span>.join(num)) <span class="comment"># æ‹¼æ¥ num å¹¶æ·»åŠ è‡³ res å°¾éƒ¨</span></span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>): <span class="comment"># éå† 0 - 9</span></span><br><span class="line">                num[x] = str(i) <span class="comment"># å›ºå®šç¬¬ x ä½ä¸º i</span></span><br><span class="line">                dfs(x + <span class="number">1</span>) <span class="comment"># å¼€å¯å›ºå®šç¬¬ x + 1 ä½</span></span><br><span class="line">        </span><br><span class="line">        num = [<span class="string">'0'</span>] * n <span class="comment"># èµ·å§‹æ•°å­—å®šä¹‰ä¸º n ä¸ª 0 ç»„æˆçš„å­—ç¬¦åˆ—è¡¨</span></span><br><span class="line">        res = [] <span class="comment"># æ•°å­—å­—ç¬¦ä¸²åˆ—è¡¨</span></span><br><span class="line">        dfs(<span class="number">0</span>) <span class="comment"># å¼€å¯å…¨æ’åˆ—é€’å½’</span></span><br><span class="line">        <span class="keyword">return</span> <span class="string">','</span>.join(res)  <span class="comment"># æ‹¼æ¥æ‰€æœ‰æ•°å­—å­—ç¬¦ä¸²ï¼Œä½¿ç”¨é€—å·éš”å¼€ï¼Œå¹¶è¿”å›</span></span><br></pre></td></tr></table></figure></details><details>    <summary>Java</summary> </details><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    StringBuilder res;</span><br><span class="line">    <span class="keyword">int</span> count = <span class="number">0</span>, n;</span><br><span class="line">    <span class="keyword">char</span>[] num, loop = &#123;<span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'8'</span>, <span class="string">'9'</span>&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">printNumbers</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.n = n;</span><br><span class="line">        res = <span class="keyword">new</span> StringBuilder(); <span class="comment">// æ•°å­—å­—ç¬¦ä¸²é›†</span></span><br><span class="line">        num = <span class="keyword">new</span> <span class="keyword">char</span>[n]; <span class="comment">// å®šä¹‰é•¿åº¦ä¸º n çš„å­—ç¬¦åˆ—è¡¨</span></span><br><span class="line">        dfs(<span class="number">0</span>); <span class="comment">// å¼€å¯å…¨æ’åˆ—é€’å½’</span></span><br><span class="line">        res.deleteCharAt(res.length() - <span class="number">1</span>); <span class="comment">// åˆ é™¤æœ€åå¤šä½™çš„é€—å·</span></span><br><span class="line">        <span class="keyword">return</span> res.toString(); <span class="comment">// è½¬åŒ–ä¸ºå­—ç¬¦ä¸²å¹¶è¿”å›</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x == n) &#123; <span class="comment">// ç»ˆæ­¢æ¡ä»¶ï¼šå·²å›ºå®šå®Œæ‰€æœ‰ä½</span></span><br><span class="line">            res.append(String.valueOf(num) + <span class="string">","</span>); <span class="comment">// æ‹¼æ¥ num å¹¶æ·»åŠ è‡³ res å°¾éƒ¨ï¼Œä½¿ç”¨é€—å·éš”å¼€</span></span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> i : loop) &#123; <span class="comment">// éå† â€˜0â€˜ - â€™9â€˜</span></span><br><span class="line">            num[x] = i; <span class="comment">// å›ºå®šç¬¬ x ä½ä¸º i</span></span><br><span class="line">            dfs(x + <span class="number">1</span>); <span class="comment">// å¼€å¯å›ºå®šç¬¬ x + 1 ä½</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><p>åœ¨æ­¤æ–¹æ³•ä¸‹ï¼Œå„æ•°å­—å­—ç¬¦ä¸²è¢«é€—å·éš”å¼€ï¼Œå…±åŒç»„æˆé•¿å­—ç¬¦ä¸²ã€‚è¿”å›çš„æ•°å­—é›†å­—ç¬¦ä¸²å¦‚ä¸‹æ‰€ç¤ºï¼š</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">è¾“å…¥ï¼šn</span> <span class="string">=</span> <span class="number">1</span></span><br><span class="line"><span class="string">è¾“å‡ºï¼š"0,1,2,3,4,5,6,7,8,9"</span></span><br><span class="line"></span><br><span class="line"><span class="string">è¾“å…¥ï¼šn</span> <span class="string">=</span> <span class="number">2</span></span><br><span class="line"><span class="string">è¾“å‡ºï¼š"00,01,02,...,10,11,12,...,97,98,99"</span></span><br><span class="line"></span><br><span class="line"><span class="string">è¾“å…¥ï¼šn</span> <span class="string">=</span> <span class="number">3</span></span><br><span class="line"><span class="string">è¾“å‡ºï¼š"000,001,002,...,100,101,102,...,997,998,999"</span></span><br></pre></td></tr></table></figure><p>è§‚å¯Ÿå¯çŸ¥ï¼Œå½“å‰çš„ç”Ÿæˆæ–¹æ³•ä»æœ‰ä»¥ä¸‹é—®é¢˜ï¼š</p><ol><li>è¯¸å¦‚00,01,02,â€¦  åº”æ˜¾ç¤ºä¸º0,1,2,â€¦ ï¼Œå³åº” <strong>åˆ é™¤é«˜ä½å¤šä½™çš„ <em>0</em></strong> ;</li><li>æ­¤æ–¹æ³•ä» <em>0</em> å¼€å§‹ç”Ÿæˆï¼Œè€Œé¢˜ç›®è¦æ±‚ <strong>åˆ—è¡¨ä» <em>1</em> å¼€å§‹</strong> ï¼›</li></ol><p>ä»¥ä¸Šä¸¤ä¸ªé—®é¢˜çš„è§£å†³æ–¹æ³•å¦‚ä¸‹ï¼š</p><h2 id="1-åˆ é™¤é«˜ä½å¤šä½™çš„-0-ï¼š"><a href="#1-åˆ é™¤é«˜ä½å¤šä½™çš„-0-ï¼š" class="headerlink" title="1. åˆ é™¤é«˜ä½å¤šä½™çš„ 0 ï¼š"></a>1. åˆ é™¤é«˜ä½å¤šä½™çš„ <em>0</em> ï¼š</h2><ul><li><p><strong>å­—ç¬¦ä¸²å·¦è¾¹ç•Œå®šä¹‰ï¼š</strong> å£°æ˜å˜é‡ <em>start</em> è§„å®šå­—ç¬¦ä¸²çš„å·¦è¾¹ç•Œï¼Œä»¥ä¿è¯æ·»åŠ çš„æ•°å­—å­—ç¬¦ä¸² <code>num[start:]</code> ä¸­æ— é«˜ä½å¤šä½™çš„ <em>0</em> ã€‚ä¾‹å¦‚å½“ <em>n = 2</em> æ—¶ï¼Œ <em>1 - 9</em> æ—¶ <em>start = 1</em> ï¼Œ <em>10 - 99</em> æ—¶ <em>start = 0</em> ã€‚</p></li><li><p><strong>å·¦è¾¹ç•Œ <em>start</em> å˜åŒ–è§„å¾‹ï¼š</strong> è§‚å¯Ÿå¯çŸ¥ï¼Œå½“è¾“å‡ºæ•°å­—çš„æ‰€æœ‰ä½éƒ½æ˜¯ <em>9</em> æ—¶ï¼Œåˆ™ä¸‹ä¸ªæ•°å­—éœ€è¦å‘æ›´é«˜ä½è¿› <em>1</em> ï¼Œæ­¤æ—¶å·¦è¾¹ç•Œ <em>start</em> éœ€è¦å‡ <em>1</em> ï¼ˆå³é«˜ä½å¤šä½™çš„ <em>0</em> å‡å°‘ä¸€ä¸ªï¼‰ã€‚ä¾‹å¦‚å½“ <em>n = 3</em> ï¼ˆæ•°å­—èŒƒå›´ <em>1 - 999</em> ï¼‰æ—¶ï¼Œå·¦è¾¹ç•Œ <em>start</em> éœ€è¦å‡ <em>1</em> çš„æƒ…å†µæœ‰ï¼š â€œ009â€ è¿›ä½è‡³ â€œ010â€ ï¼Œ â€œ099â€ è¿›ä½è‡³ â€œ100â€ ã€‚è®¾æ•°å­—å„ä½ä¸­ <em>9</em> çš„æ•°é‡ä¸º <em>nine</em> ï¼Œæ‰€æœ‰ä½éƒ½ä¸º <em>9</em> çš„åˆ¤æ–­æ¡ä»¶å¯ç”¨ä»¥ä¸‹å…¬å¼è¡¨ç¤ºï¼š</p></li></ul><pre><code>n - start = nine</code></pre><ul><li><strong>ç»Ÿè®¡ <em>nine</em> çš„æ–¹æ³•ï¼š</strong> å›ºå®šç¬¬ <em>x</em> ä½æ—¶ï¼Œå½“ <em>i = 9</em> åˆ™æ‰§è¡Œ <em>nine = nine + 1</em> ï¼Œå¹¶åœ¨å›æº¯å‰æ¢å¤ <em>nine = nine - 1</em> ã€‚</li></ul><h2 id="2-åˆ—è¡¨ä»-1-å¼€å§‹ï¼š"><a href="#2-åˆ—è¡¨ä»-1-å¼€å§‹ï¼š" class="headerlink" title="2. åˆ—è¡¨ä» 1 å¼€å§‹ï¼š"></a>2. åˆ—è¡¨ä» <em>1</em> å¼€å§‹ï¼š</h2><ul><li>åœ¨ä»¥ä¸Šæ–¹æ³•çš„åŸºç¡€ä¸Šï¼Œæ·»åŠ æ•°å­—å­—ç¬¦ä¸²å‰åˆ¤æ–­å…¶æ˜¯å¦ä¸º <code>&quot;0&quot;</code> ï¼Œè‹¥ä¸º <code>&quot;0&quot;</code> åˆ™ç›´æ¥è·³è¿‡ã€‚</li></ul><h2 id="å¤æ‚åº¦åˆ†æï¼š-1"><a href="#å¤æ‚åº¦åˆ†æï¼š-1" class="headerlink" title="å¤æ‚åº¦åˆ†æï¼š"></a>å¤æ‚åº¦åˆ†æï¼š</h2><ul><li><strong>æ—¶é—´å¤æ‚åº¦ <em>O(10^n)</em> ï¼š</strong> é€’å½’çš„ç”Ÿæˆçš„æ’åˆ—çš„æ•°é‡ä¸º <em>10^n</em> ã€‚</li><li><strong>ç©ºé—´å¤æ‚åº¦ <em>O(10^n)</em> ï¼š</strong> ç»“æœåˆ—è¡¨ <em>res</em> çš„é•¿åº¦ä¸º <em>10^n - 1</em> ï¼Œå„æ•°å­—å­—ç¬¦ä¸²çš„é•¿åº¦åŒºé—´ä¸º <em>1, 2, â€¦, n</em> ï¼Œå› æ­¤å ç”¨ <em>O(10^n)</em> å¤§å°çš„é¢å¤–ç©ºé—´ã€‚</li></ul><h2 id="ä»£ç ï¼š-1"><a href="#ä»£ç ï¼š-1" class="headerlink" title="ä»£ç ï¼š"></a>ä»£ç ï¼š</h2><p>ä¸º <strong>æ­£ç¡®è¡¨ç¤ºå¤§æ•°</strong> ï¼Œä»¥ä¸‹ä»£ç çš„è¿”å›å€¼ä¸ºæ•°å­—å­—ç¬¦ä¸²é›†æ‹¼æ¥è€Œæˆçš„é•¿å­—ç¬¦ä¸²ã€‚</p><details>    <summary>Python</summary><figure class="highlight python"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">printNumbers</span><span class="params">(self, n: int)</span> -&gt; [int]:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(x)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> x == n:</span><br><span class="line">                s = <span class="string">''</span>.join(num[self.start:])</span><br><span class="line">                <span class="keyword">if</span> s != <span class="string">'0'</span>: res.append(s)</span><br><span class="line">                <span class="keyword">if</span> n - self.start == self.nine: self.start -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">9</span>: self.nine += <span class="number">1</span></span><br><span class="line">                num[x] = str(i)</span><br><span class="line">                dfs(x + <span class="number">1</span>)</span><br><span class="line">            self.nine -= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        num, res = [<span class="string">'0'</span>] * n, []</span><br><span class="line">        self.nine = <span class="number">0</span></span><br><span class="line">        self.start = n - <span class="number">1</span></span><br><span class="line">        dfs(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="string">','</span>.join(res)</span><br></pre></td></tr></table></figure></details><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    StringBuilder res;</span><br><span class="line">    <span class="keyword">int</span> nine = <span class="number">0</span>, count = <span class="number">0</span>, start, n;</span><br><span class="line">    <span class="keyword">char</span>[] num, loop = &#123;<span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'8'</span>, <span class="string">'9'</span>&#125;;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> String <span class="title">printNumbers</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.n = n;</span><br><span class="line">        res = <span class="keyword">new</span> StringBuilder();</span><br><span class="line">        num = <span class="keyword">new</span> <span class="keyword">char</span>[n];</span><br><span class="line">        start = n - <span class="number">1</span>;</span><br><span class="line">        dfs(<span class="number">0</span>);</span><br><span class="line">        res.deleteCharAt(res.length() - <span class="number">1</span>);</span><br><span class="line">        <span class="keyword">return</span> res.toString();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x == n) &#123;</span><br><span class="line">            String s = String.valueOf(num).substring(start);</span><br><span class="line">            <span class="keyword">if</span>(!s.equals(<span class="string">"0"</span>)) res.append(s + <span class="string">","</span>);</span><br><span class="line">            <span class="keyword">if</span>(n - start == nine) start--;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> i : loop) &#123;</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="string">'9'</span>) nine++;</span><br><span class="line">            num[x] = i;</span><br><span class="line">            dfs(x + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        nine--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><p>æœ¬é¢˜è¦æ±‚è¾“å‡º int ç±»å‹æ•°ç»„ã€‚ä¸º <strong>è¿è¡Œé€šè¿‡</strong> ï¼Œå¯åœ¨æ·»åŠ æ•°å­—å­—ç¬¦ä¸² <em>s</em> å‰ï¼Œå°†å…¶è½¬åŒ–ä¸º int ç±»å‹ã€‚ä»£ç å¦‚ä¸‹æ‰€ç¤ºï¼š</p><details>    <summary>Python</summary><figure class="highlight python"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">printNumbers</span><span class="params">(self, n: int)</span> -&gt; [int]:</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">dfs</span><span class="params">(x)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> x == n:</span><br><span class="line">                s = <span class="string">''</span>.join(num[self.start:])</span><br><span class="line">                <span class="keyword">if</span> s != <span class="string">'0'</span>: res.append(int(s))</span><br><span class="line">                <span class="keyword">if</span> n - self.start == self.nine: self.start -= <span class="number">1</span></span><br><span class="line">                <span class="keyword">return</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">                <span class="keyword">if</span> i == <span class="number">9</span>: self.nine += <span class="number">1</span></span><br><span class="line">                num[x] = str(i)</span><br><span class="line">                dfs(x + <span class="number">1</span>)</span><br><span class="line">            self.nine -= <span class="number">1</span></span><br><span class="line">        </span><br><span class="line">        num, res = [<span class="string">'0'</span>] * n, []</span><br><span class="line">        self.nine = <span class="number">0</span></span><br><span class="line">        self.start = n - <span class="number">1</span></span><br><span class="line">        dfs(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure></details><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[] res;</span><br><span class="line">    <span class="keyword">int</span> nine = <span class="number">0</span>, count = <span class="number">0</span>, start, n;</span><br><span class="line">    <span class="keyword">char</span>[] num, loop = &#123;<span class="string">'0'</span>, <span class="string">'1'</span>, <span class="string">'2'</span>, <span class="string">'3'</span>, <span class="string">'4'</span>, <span class="string">'5'</span>, <span class="string">'6'</span>, <span class="string">'7'</span>, <span class="string">'8'</span>, <span class="string">'9'</span>&#125;;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">int</span>[] printNumbers(<span class="keyword">int</span> n) &#123;</span><br><span class="line">        <span class="keyword">this</span>.n = n;</span><br><span class="line">        res = <span class="keyword">new</span> <span class="keyword">int</span>[(<span class="keyword">int</span>)Math.pow(<span class="number">10</span>, n) - <span class="number">1</span>];</span><br><span class="line">        num = <span class="keyword">new</span> <span class="keyword">char</span>[n];</span><br><span class="line">        start = n - <span class="number">1</span>;</span><br><span class="line">        dfs(<span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span> x)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(x == n) &#123;</span><br><span class="line">            String s = String.valueOf(num).substring(start);</span><br><span class="line">            <span class="keyword">if</span>(!s.equals(<span class="string">"0"</span>)) res[count++] = Integer.parseInt(s);</span><br><span class="line">            <span class="keyword">if</span>(n - start == nine) start--;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">char</span> i : loop) &#123;</span><br><span class="line">            <span class="keyword">if</span>(i == <span class="string">'9'</span>) nine++;</span><br><span class="line">            num[x] = i;</span><br><span class="line">            dfs(x + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">        nine--;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¾“å…¥æ•°å­— nï¼ŒæŒ‰é¡ºåºæ‰“å°å‡ºä» 1 åˆ°æœ€å¤§çš„ n ä½åè¿›åˆ¶æ•°ã€‚æ¯”å¦‚è¾“å…¥ 3ï¼Œåˆ™æ‰“å°å‡º 1ã€2ã€3 ä¸€ç›´åˆ°æœ€å¤§çš„ 3 ä½æ•° 999ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Math" scheme="http://yoursite.com/tags/Math/"/>
    
  </entry>
  
  <entry>
    <title>2103. ç¯å’Œæ†</title>
    <link href="http://yoursite.com/2021/12/19/2103.%20%E7%8E%AF%E5%92%8C%E6%9D%86/"/>
    <id>http://yoursite.com/2021/12/19/2103. ç¯å’Œæ†/</id>
    <published>2021-12-19T02:30:12.000Z</published>
    <updated>2021-12-19T02:31:37.502Z</updated>
    
    <content type="html"><![CDATA[<p>æ‰¾å‡ºæ‰€æœ‰é›†é½å…¨éƒ¨ä¸‰ç§é¢œè‰²ç¯çš„æ†ï¼Œå¹¶è¿”å›è¿™ç§æ†çš„æ•°é‡ã€‚</p><a id="more"></a><p>[TOC]</p><p>æ€»è®¡æœ‰ n ä¸ªç¯ï¼Œç¯çš„é¢œè‰²å¯ä»¥æ˜¯çº¢ã€ç»¿ã€è“ä¸­çš„ä¸€ç§ã€‚è¿™äº›ç¯åˆ†å¸ƒç©¿åœ¨ 10 æ ¹ç¼–å·ä¸º 0 åˆ° 9 çš„æ†ä¸Šã€‚</p><p>ç»™ä½ ä¸€ä¸ªé•¿åº¦ä¸º 2n çš„å­—ç¬¦ä¸² rings ï¼Œè¡¨ç¤ºè¿™ n ä¸ªç¯åœ¨æ†ä¸Šçš„åˆ†å¸ƒã€‚rings ä¸­æ¯ä¸¤ä¸ªå­—ç¬¦å½¢æˆä¸€ä¸ª é¢œè‰²ä½ç½®å¯¹ ï¼Œç”¨äºæè¿°æ¯ä¸ªç¯ï¼š</p><p>ç¬¬ i å¯¹ä¸­çš„ ç¬¬ä¸€ä¸ª å­—ç¬¦è¡¨ç¤ºç¬¬ i ä¸ªç¯çš„ é¢œè‰²ï¼ˆâ€™Râ€™ã€â€™Gâ€™ã€â€™Bâ€™ï¼‰ã€‚<br>ç¬¬ i å¯¹ä¸­çš„ ç¬¬äºŒä¸ª å­—ç¬¦è¡¨ç¤ºç¬¬ i ä¸ªç¯çš„ ä½ç½®ï¼Œä¹Ÿå°±æ˜¯ä½äºå“ªæ ¹æ†ä¸Šï¼ˆâ€™0â€™ åˆ° â€˜9â€™ï¼‰ã€‚<br>ä¾‹å¦‚ï¼Œâ€R3G2B1â€ è¡¨ç¤ºï¼šå…±æœ‰ n == 3 ä¸ªç¯ï¼Œçº¢è‰²çš„ç¯åœ¨ç¼–å·ä¸º 3 çš„æ†ä¸Šï¼Œç»¿è‰²çš„ç¯åœ¨ç¼–å·ä¸º 2 çš„æ†ä¸Šï¼Œè“è‰²çš„ç¯åœ¨ç¼–å·ä¸º 1 çš„æ†ä¸Šã€‚</p><p>æ‰¾å‡ºæ‰€æœ‰é›†é½ å…¨éƒ¨ä¸‰ç§é¢œè‰² ç¯çš„æ†ï¼Œå¹¶è¿”å›è¿™ç§æ†çš„æ•°é‡ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼šrings = &quot;B0B6G0R6R0R6G9&quot;è¾“å‡ºï¼š1è§£é‡Šï¼š- ç¼–å· 0 çš„æ†ä¸Šæœ‰ 3 ä¸ªç¯ï¼Œé›†é½å…¨éƒ¨é¢œè‰²ï¼šçº¢ã€ç»¿ã€è“ã€‚- ç¼–å· 6 çš„æ†ä¸Šæœ‰ 3 ä¸ªç¯ï¼Œä½†åªæœ‰çº¢ã€è“ä¸¤ç§é¢œè‰²ã€‚- ç¼–å· 9 çš„æ†ä¸Šåªæœ‰ 1 ä¸ªç»¿è‰²ç¯ã€‚å› æ­¤ï¼Œé›†é½å…¨éƒ¨ä¸‰ç§é¢œè‰²ç¯çš„æ†çš„æ•°ç›®ä¸º 1 ã€‚</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼šrings = &quot;B0R0G0R9R0B0G0&quot;è¾“å‡ºï¼š1è§£é‡Šï¼š- ç¼–å· 0 çš„æ†ä¸Šæœ‰ 6 ä¸ªç¯ï¼Œé›†é½å…¨éƒ¨é¢œè‰²ï¼šçº¢ã€ç»¿ã€è“ã€‚- ç¼–å· 9 çš„æ†ä¸Šåªæœ‰ 1 ä¸ªçº¢è‰²ç¯ã€‚å› æ­¤ï¼Œé›†é½å…¨éƒ¨ä¸‰ç§é¢œè‰²ç¯çš„æ†çš„æ•°ç›®ä¸º 1 ã€‚</code></pre><p>ç¤ºä¾‹ 3ï¼š</p><pre><code>è¾“å…¥ï¼šrings = &quot;G4&quot;è¾“å‡ºï¼š0è§£é‡Šï¼šåªç»™äº†ä¸€ä¸ªç¯ï¼Œå› æ­¤ï¼Œä¸å­˜åœ¨é›†é½å…¨éƒ¨ä¸‰ç§é¢œè‰²ç¯çš„æ†ã€‚</code></pre><p>æç¤ºï¼š</p><pre><code>rings.length == 2 * n1 &lt;= n &lt;= 100å¦‚ i æ˜¯ å¶æ•° ï¼Œåˆ™ rings[i] çš„å€¼å¯ä»¥å– &apos;R&apos;ã€&apos;G&apos; æˆ– &apos;B&apos;ï¼ˆä¸‹æ ‡ä» 0 å¼€å§‹è®¡æ•°ï¼‰å¦‚ i æ˜¯ å¥‡æ•° ï¼Œåˆ™ rings[i] çš„å€¼å¯ä»¥å– &apos;0&apos; åˆ° &apos;9&apos; ä¸­çš„ä¸€ä¸ªæ•°å­—ï¼ˆä¸‹æ ‡ä» 0 å¼€å§‹è®¡æ•°ï¼‰</code></pre><h1 id="æ–¹æ³•ä¸€ï¼šç»´æŠ¤æ¯æ ¹æ†çš„çŠ¶æ€"><a href="#æ–¹æ³•ä¸€ï¼šç»´æŠ¤æ¯æ ¹æ†çš„çŠ¶æ€" class="headerlink" title="æ–¹æ³•ä¸€ï¼šç»´æŠ¤æ¯æ ¹æ†çš„çŠ¶æ€"></a>æ–¹æ³•ä¸€ï¼šç»´æŠ¤æ¯æ ¹æ†çš„çŠ¶æ€</h1><p><strong>æ€è·¯ä¸ç®—æ³•</strong></p><p>æˆ‘ä»¬å¯ä»¥éå†å­—ç¬¦ä¸²çš„æ¯ä¸ªé¢œè‰²ä½ç½®å¯¹ï¼Œæ¥æ¨¡æ‹Ÿå¥—ç¯çš„è¿‡ç¨‹ã€‚</p><p>å¯¹äºæ¯ä¸€ä¸ªç¯ï¼Œç”±äºæˆ‘ä»¬åªå…³å¿ƒå®ƒä¸Šé¢æœ‰å“ªäº›é¢œè‰²çš„ç¯ï¼Œè€Œä¸åœ¨æ„å…·ä½“çš„æ•°é‡ï¼›åŒæ—¶æ˜¯å¦æœ‰æŸä¸€ç§é¢œè‰²çš„ç¯çš„çŠ¶æ€ç›¸äº’ç‹¬ç«‹ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ª <em>3</em> äºŒè¿›åˆ¶ä½çš„æ•´æ•°æ¥è¡¨ç¤ºæ¯ä¸ªç¯çš„çŠ¶æ€ã€‚å…·ä½“åœ°ï¼Œ<strong>ä»ä½åˆ°é«˜</strong>ç¬¬ä¸€ä½è¡¨ç¤ºæ˜¯å¦æœ‰çº¢è‰²çš„ç¯ï¼Œç¬¬äºŒä½è¡¨ç¤ºæ˜¯å¦æœ‰è“è‰²çš„ç¯ï¼Œç¬¬ä¸‰ä½è¡¨ç¤ºæ˜¯å¦æœ‰ç»¿è‰²çš„ç¯ï¼›æ¯ä¸€ä½ä¸º <em>1</em> åˆ™ä»£è¡¨å½“å‰æ†ä¸Šæœ‰å¯¹åº”é¢œè‰²çš„ç¯ï¼Œä¸º <em>0</em> åˆ™ä»£è¡¨æ²¡æœ‰ã€‚å½“å¥—ä¸ŠæŸç§é¢œè‰²çš„ç¯åï¼Œæ— è®ºè¯¥äºŒè¿›åˆ¶ä½ä¹‹å‰å–å€¼å¦‚ä½•ï¼Œæ–°çš„å–å€¼ä¸€å®šä¸º <em>1</em>ï¼Œè¿™ç­‰ä»·äºå¯¹åº”äºŒè¿›åˆ¶ä½<strong>å¯¹ <em>1</em> å–æˆ–</strong>çš„æ“ä½œã€‚</p><p>æˆ‘ä»¬å¯ä»¥ç”¨ä¸€ä¸ªé•¿åº¦ä¸º <em>10</em> çš„çŠ¶æ€æ•°ç»„æ¥è¡¨ç¤ºæ¯ä¸ªç¯çš„çŠ¶æ€ï¼Œæ•°ç»„ä¸‹æ ‡å³ä¸ºæ†çš„ç¼–å·ã€‚åœ¨æ¨¡æ‹Ÿå¼€å§‹å‰ï¼Œæ‰€æœ‰ç¯çš„çŠ¶æ€å¯¹åº”çš„æ•´æ•°å‡ä¸º <em>0</em>ã€‚åœ¨éå†åˆ°æ¯ä¸ªé¢œè‰²ä½ç½®å¯¹æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆçœ‹ç¬¬äºŒä¸ªå­—ç¬¦å¯»æ‰¾å‡ºå¯¹åº”çš„ä¸‹æ ‡ï¼ŒåŒæ—¶æ ¹æ®ç¯çš„é¢œè‰²å¯¹çŠ¶æ€å€¼çš„å¯¹åº”äºŒè¿›åˆ¶ä½<strong>å¯¹ <em>1</em> å–æˆ–</strong>ã€‚å½“éå†å®Œæˆåï¼Œæˆ‘ä»¬éå†çŠ¶æ€æ•°ç»„ï¼Œç»Ÿè®¡çŠ¶æ€å€¼ä¸º <em>(111)_2 = 7</em> ï¼ˆä»£è¡¨å¯¹åº”æ†ä¸Šæœ‰ä¸‰ç§é¢œè‰²çš„ç¯ï¼‰çš„ä¸ªæ•°ï¼Œå¹¶è¿”å›è¯¥ä¸ªæ•°ä½œä¸ºç­”æ¡ˆã€‚</p><p><strong>ä»£ç </strong></p><details>    <summary>C++</summary><figure class="highlight c++"><figcaption><span>[sol1-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">countPoints</span><span class="params">(<span class="built_in">string</span> rings)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = rings.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; status(<span class="number">10</span>);   <span class="comment">// çŠ¶æ€æ•°ç»„</span></span><br><span class="line">        <span class="comment">// éå†é¢œè‰²ä½ç½®å¯¹ç»´æŠ¤çŠ¶æ€æ•°ç»„</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; n; i += <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> idx = rings[i+<span class="number">1</span>] - <span class="string">'0'</span>;</span><br><span class="line">            <span class="keyword">if</span> (rings[i] == <span class="string">'R'</span>) &#123;</span><br><span class="line">                status[idx] |= <span class="number">1</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> <span class="keyword">if</span> (rings[i] == <span class="string">'G'</span>) &#123;</span><br><span class="line">                status[idx] |= <span class="number">2</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span> &#123;</span><br><span class="line">                status[idx] |= <span class="number">4</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">// ç»Ÿè®¡é›†é½ä¸‰è‰²ç¯çš„æ†çš„æ•°é‡</span></span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">0</span>; i &lt; <span class="number">10</span>; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (status[i] == <span class="number">7</span>) &#123;</span><br><span class="line">                ++res;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>Python3</summary><figure class="highlight python"><figcaption><span>[sol1-Python3]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">countPoints</span><span class="params">(self, rings: str)</span> -&gt; int:</span></span><br><span class="line">        n = len(rings)</span><br><span class="line">        status = [<span class="number">0</span>] * <span class="number">10</span>   <span class="comment"># çŠ¶æ€æ•°ç»„</span></span><br><span class="line">        <span class="comment"># éå†é¢œè‰²ä½ç½®å¯¹ç»´æŠ¤çŠ¶æ€æ•°ç»„</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">0</span>, n, <span class="number">2</span>):</span><br><span class="line">            idx = int(rings[i+<span class="number">1</span>])</span><br><span class="line">            <span class="keyword">if</span> rings[i] == <span class="string">'R'</span>:</span><br><span class="line">                status[idx] |= <span class="number">1</span></span><br><span class="line">            <span class="keyword">elif</span> rings[i] == <span class="string">'G'</span>:</span><br><span class="line">                status[idx] |= <span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                status[idx] |= <span class="number">4</span></span><br><span class="line">        <span class="comment"># ç»Ÿè®¡é›†é½ä¸‰è‰²ç¯çš„æ†çš„æ•°é‡</span></span><br><span class="line">        res = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">10</span>):</span><br><span class="line">            <span class="keyword">if</span> status[i] == <span class="number">7</span>:</span><br><span class="line">                res += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure></details><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li><p>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(n + k)*ï¼Œå…¶ä¸­ *n</em> ä¸ºrings çš„é•¿åº¦ï¼Œ<em>k</em> ä¸ºæ†çš„æ•°é‡ã€‚åˆå§‹åŒ–æ†çŠ¶æ€æ•°ç»„ä¸ç»Ÿè®¡æ•°é‡çš„æ—¶é—´å¤æ‚åº¦ä¸º <em>O(k)</em>ï¼Œéå†å­—ç¬¦ä¸²çš„æ—¶é—´å¤æ‚åº¦ä¸º <em>O(n)</em>ã€‚</p></li><li><p>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(k)</em>ï¼Œå³ä¸ºçŠ¶æ€æ•°ç»„çš„ç©ºé—´å¼€é”€ã€‚</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ‰¾å‡ºæ‰€æœ‰é›†é½å…¨éƒ¨ä¸‰ç§é¢œè‰²ç¯çš„æ†ï¼Œå¹¶è¿”å›è¿™ç§æ†çš„æ•°é‡ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="Hash Table" scheme="http://yoursite.com/tags/Hash-Table/"/>
    
      <category term="String" scheme="http://yoursite.com/tags/String/"/>
    
  </entry>
  
  <entry>
    <title>2104. å­æ•°ç»„èŒƒå›´å’Œ</title>
    <link href="http://yoursite.com/2021/12/19/2104.%20%E5%AD%90%E6%95%B0%E7%BB%84%E8%8C%83%E5%9B%B4%E5%92%8C/"/>
    <id>http://yoursite.com/2021/12/19/2104. å­æ•°ç»„èŒƒå›´å’Œ/</id>
    <published>2021-12-19T02:30:12.000Z</published>
    <updated>2021-12-19T02:51:25.617Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums ã€‚nums ä¸­ï¼Œå­æ•°ç»„çš„ èŒƒå›´ æ˜¯å­æ•°ç»„ä¸­æœ€å¤§å…ƒç´ å’Œæœ€å°å…ƒç´ çš„å·®å€¼ã€‚</p><p>è¿”å› nums ä¸­ æ‰€æœ‰ å­æ•°ç»„èŒƒå›´çš„ å’Œ ã€‚</p><a id="more"></a><p>[TOC]</p><p><strong>å­æ•°ç»„æ˜¯æ•°ç»„ä¸­ä¸€ä¸ªè¿ç»­ éç©º çš„å…ƒç´ åºåˆ—ã€‚</strong></p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼šnums = [1,2,3]è¾“å‡ºï¼š4è§£é‡Šï¼šnums çš„ 6 ä¸ªå­æ•°ç»„å¦‚ä¸‹æ‰€ç¤ºï¼š[1]ï¼ŒèŒƒå›´ = æœ€å¤§ - æœ€å° = 1 - 1 = 0 [2]ï¼ŒèŒƒå›´ = 2 - 2 = 0[3]ï¼ŒèŒƒå›´ = 3 - 3 = 0[1,2]ï¼ŒèŒƒå›´ = 2 - 1 = 1[2,3]ï¼ŒèŒƒå›´ = 3 - 2 = 1[1,2,3]ï¼ŒèŒƒå›´ = 3 - 1 = 2æ‰€æœ‰èŒƒå›´çš„å’Œæ˜¯ 0 + 0 + 0 + 1 + 1 + 2 = 4</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼šnums = [1,3,3]è¾“å‡ºï¼š4è§£é‡Šï¼šnums çš„ 6 ä¸ªå­æ•°ç»„å¦‚ä¸‹æ‰€ç¤ºï¼š[1]ï¼ŒèŒƒå›´ = æœ€å¤§ - æœ€å° = 1 - 1 = 0[3]ï¼ŒèŒƒå›´ = 3 - 3 = 0[3]ï¼ŒèŒƒå›´ = 3 - 3 = 0[1,3]ï¼ŒèŒƒå›´ = 3 - 1 = 2[3,3]ï¼ŒèŒƒå›´ = 3 - 3 = 0[1,3,3]ï¼ŒèŒƒå›´ = 3 - 1 = 2æ‰€æœ‰èŒƒå›´çš„å’Œæ˜¯ 0 + 0 + 0 + 2 + 0 + 2 = 4</code></pre><p>ç¤ºä¾‹ 3ï¼š</p><pre><code>è¾“å…¥ï¼šnums = [4,-2,-3,4,1]è¾“å‡ºï¼š59è§£é‡Šï¼šnums ä¸­æ‰€æœ‰å­æ•°ç»„èŒƒå›´çš„å’Œæ˜¯ 59</code></pre><p>æç¤ºï¼š</p><p>1 &lt;= nums.length &lt;= 1000<br>-109 &lt;= nums[i] &lt;= 109</p><p>è¿›é˜¶ï¼šä½ å¯ä»¥è®¾è®¡ä¸€ç§æ—¶é—´å¤æ‚åº¦ä¸º O(n) çš„è§£å†³æ–¹æ¡ˆå—ï¼Ÿ</p><h1 id="è§£é¢˜æ€è·¯"><a href="#è§£é¢˜æ€è·¯" class="headerlink" title="è§£é¢˜æ€è·¯"></a>è§£é¢˜æ€è·¯</h1><p>1ã€ä¸€ä¸ªå¾ˆè‡ªç„¶çš„æ€è·¯å°±æ˜¯æšä¸¾æ¯ä¸€ä¸ªå­æ•°ç»„ï¼Œæ‰¾åˆ°å­æ•°ç»„çš„æœ€å°å€¼ã€æœ€å¤§å€¼ï¼Œç„¶åæ±‚èŒƒå›´ä¹‹å’Œã€‚è¿™æ ·åšå¤æ‚åº¦è‡³å°‘æ˜¯O(n^2)ã€‚  </p><p>2ã€è¦æ‰¾åˆ°ä¸€ä¸ªO(n)å¤æ‚åº¦çš„æ–¹æ³•ï¼Œåªèƒ½ä¾æ¬¡è€ƒè™‘æ¯ä¸€ä¸ªæ•°å­—ã€‚å½“å‡ºç°æ•°å­—nums[j]æ—¶ï¼Œå®ƒå¯¹èŒƒå›´ä¹‹å’Œæœ‰ä»€ä¹ˆå½±å“å‘¢ï¼Ÿè¿™æ ·é—®é¢˜å°±å˜ä¸ºäº†nums[j]å¯èƒ½æ˜¯å“ªäº›å­æ•°ç»„çš„æœ€å¤§å€¼ã€æœ€å°å€¼å‘¢ï¼Ÿæ²¿ç€è¿™ä¸ªæ€è·¯ï¼Œæˆ‘ä»¬å‘ç°ï¼Œå‡è®¾nums[i]â€¦nums[j]â€¦nums[k]ï¼Œnums[i]æ˜¯nums[j]å·¦è¾¹ç¬¬ä¸€ä¸ªå¤§äºnums[j]çš„æ•°ï¼Œnums[k]æ˜¯nums[j]å³è¾¹ç¬¬ä¸€ä¸ªå¤§äºnums[j]çš„æ•°ï¼Œé‚£ä¹ˆæ˜¾ç„¶åŒºé—´nums(i,k)ä¹‹é—´çš„æœ€å¤§å€¼æ˜¯nums[j]ï¼Œè¿™å°±æ„å‘³ç€è¯¥åŒºé—´å†…æ‰€æœ‰åŒ…å«nums[j]çš„å­æ•°ç»„çš„æœ€å¤§å€¼éƒ½æ˜¯nums[j]ï¼›è€Œä»»ä½•ä¸€ä¸ªåŒ…å«nums[i]æˆ–è€…nums[k]çš„å­æ•°ç»„çš„æœ€å¤§å€¼éƒ½ä¸å¯èƒ½æ˜¯nums[j]ã€‚è¿™æ ·nums[j]ä½œä¸ºæœ€å¤§å€¼ï¼Œè´¡çŒ®çš„èŒƒå›´ä¹‹å’Œå°±æ˜¯åŒºé—´nums(i,k)åŒ…å«nums[j]çš„å­æ•°ç»„ä¸ªæ•° * nums[j]ï¼Œè€Œè¿™ä¸ªå­æ•°ç»„ä¸ªæ•° = (j - i) * (k - j)ã€‚  </p><p>3ã€åŒæ ·çš„æ€è·¯ï¼Œæˆ‘ä»¬å¯ä»¥æ‰¾åˆ°nums[j]ä½œä¸ºæœ€å°å€¼ï¼Œå¯¹èŒƒå›´ä¹‹å’Œçš„è´¡çŒ®ã€‚æˆ‘ä»¬éå†æ‰€æœ‰çš„nums[j]ï¼ŒåŠ ä¸Šå®ƒä½œä¸ºæœ€å¤§å€¼çš„è´¡çŒ®ï¼Œå‡å»å®ƒä½œä¸ºæœ€å°å€¼çš„è´¡çŒ®ï¼Œè¿™æ ·å°±å¯ä»¥æ±‚å‡ºèŒƒå›´ä¹‹å’Œäº†ã€‚  </p><p>4ã€é‚£ä¹ˆå¦‚ä½•æ±‚å¾—nums[j]å·¦å³ä¸¤è¾¹ç¬¬ä¸€ä¸ªå¤§äºå®ƒçš„æ•°å‘¢ï¼Ÿè¿™æ˜¯ä¸€ä¸ªå…¸å‹çš„å•è°ƒæ ˆé—®é¢˜ï¼Œæˆ‘ä»¬æ­£å‘éå†æ•°ç»„ï¼Œç»´æŠ¤ä¸€ä¸ªå•è°ƒé€’å¢æ ˆå’Œä¸€ä¸ªå•è°ƒé€’å‡æ ˆï¼Œå•è°ƒé€’å¢æ ˆçš„æ ˆé¡¶å…ƒç´ å°±æ˜¯å·¦è¾¹ç¬¬ä¸€ä¸ªå°äºnums[j]çš„å…ƒç´ ï¼Œå•è°ƒé€’å‡æ ˆçš„æ ˆé¡¶å…ƒç´ å°±æ˜¯å·¦è¾¹ç¬¬ä¸€ä¸ªå¤§äºnums[j]çš„å…ƒç´ ã€‚åŒæ ·çš„æ–¹æ³•ï¼Œåå‘éå†æ•°ç»„ï¼Œå³å¯æ±‚å¾—nums[j]å³è¾¹ç¬¬ä¸€ä¸ªå¤§äºã€å°äºå®ƒçš„å…ƒç´ ã€‚  </p><p>5ã€æ³¨æ„ä¸€ä¸ªç»†èŠ‚é—®é¢˜ï¼Œå½“æœ‰ç›¸åŒnumå‡ºç°æ—¶ï¼Œå¦‚æœæ˜¯æ­£å‘éå†ï¼Œé‚£ä¹ˆä¸åº”è¯¥ç»§ç»­å¼¹å‡ºæ ˆé¡¶å…ƒç´ ï¼Œå› ä¸ºåœ¨ä¸€ä¸ªå­æ•°ç»„ä¸­ç›¸åŒçš„ä¸¤ä¸ªæ•°åªæœ‰ç¬¬ä¸€ä¸ªä¼šè¢«è®¤ä¸ºæ˜¯æœ€å¤§å€¼ã€æœ€å°å€¼ï¼Œæ‰€ä»¥åæ¥çš„ç¬¬äºŒä¸ªæ²¡æœ‰åŠæ³•å–ä»£ç¬¬ä¸€ä¸ªã€‚è€Œåå‘éå†æ—¶æ°æ°ç›¸åï¼Œåæ¥çš„ç¬¬äºŒä¸ªæ•°åœ¨åŸæ•°ç»„çš„å‰é¢ä½ç½®ï¼Œå®ƒåº”è¯¥å–ä»£ç¬¬ä¸€ä¸ªæ•°ï¼Œæ‰€ä»¥éœ€è¦ç»§ç»­å¼¹å‡ºæ ˆé¡¶å…ƒç´ ã€‚  </p><h2 id="å¤æ‚åº¦é—®é¢˜"><a href="#å¤æ‚åº¦é—®é¢˜" class="headerlink" title="å¤æ‚åº¦é—®é¢˜"></a>å¤æ‚åº¦é—®é¢˜</h2><p>æ—¶é—´å¤æ‚åº¦ï¼šO(n)ï¼Œå•è°ƒæ ˆå’Œåç»­çš„æ±‚èŒƒå›´ä¹‹å’Œï¼Œéƒ½åªéœ€è¦éå†ä¸€æ¬¡æ•°ç»„ã€‚  </p><p>ç©ºé—´å¤æ‚åº¦ï¼šO(n)ï¼Œéœ€è¦ä¿å­˜æ¯ä¸ªæ•°å·¦å³ä¸¤è¾¹ç¬¬ä¸€ä¸ªå¤§äºã€å°äºè‡ªå·±çš„æ•°çš„ä½ç½®ã€‚</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><details>    <summary>cpp</summary><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">long</span> <span class="keyword">long</span> <span class="title">subArrayRanges</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i, size = nums.size();</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> sum = <span class="number">0</span>;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; leftLess(size), leftGreater(size), rightLess(size), rightGreater(size);</span><br><span class="line"></span><br><span class="line">        getLeft(nums, leftLess, leftGreater);</span><br><span class="line">        getRight(nums, rightLess, rightGreater);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; size; ++i) &#123;</span><br><span class="line">            sum += (nums[i] * ((<span class="keyword">long</span> <span class="keyword">long</span>)i - leftGreater[i]) * ((<span class="keyword">long</span> <span class="keyword">long</span>)rightGreater[i] - i));</span><br><span class="line">            sum -= (nums[i] * ((<span class="keyword">long</span> <span class="keyword">long</span>)i - leftLess[i]) * ((<span class="keyword">long</span> <span class="keyword">long</span>)rightLess[i] - i));</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> sum;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getLeft</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; leftLess, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; leftGreater)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i, size = nums.size();</span><br><span class="line">        <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; increasing, decreasing;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; size; ++i) &#123;</span><br><span class="line">            <span class="keyword">while</span> (!increasing.empty() &amp;&amp; nums[increasing.top()] &gt; nums[i]) &#123;</span><br><span class="line">                increasing.pop();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            leftLess[i] = increasing.empty() ? <span class="number">-1</span> : increasing.top();</span><br><span class="line">            increasing.push(i);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (!decreasing.empty() &amp;&amp; nums[decreasing.top()] &lt; nums[i]) &#123;</span><br><span class="line">                decreasing.pop();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            leftGreater[i] = decreasing.empty() ? <span class="number">-1</span> : decreasing.top();</span><br><span class="line">            decreasing.push(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">getRight</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; nums, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; rightLess, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; rightGreater)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> i, size = nums.size();</span><br><span class="line">        <span class="built_in">stack</span>&lt;<span class="keyword">int</span>&gt; increasing, decreasing;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (i = size - <span class="number">1</span>; i &gt;= <span class="number">0</span>; --i) &#123;</span><br><span class="line">            <span class="keyword">while</span> (!increasing.empty() &amp;&amp; nums[increasing.top()] &gt;= nums[i]) &#123;</span><br><span class="line">                increasing.pop();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            rightLess[i] = increasing.empty() ? size : increasing.top();</span><br><span class="line">            increasing.push(i);</span><br><span class="line"></span><br><span class="line">            <span class="keyword">while</span> (!decreasing.empty() &amp;&amp; nums[decreasing.top()] &lt;= nums[i]) &#123;</span><br><span class="line">                decreasing.pop();</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            rightGreater[i] = decreasing.empty() ? size : decreasing.top();</span><br><span class="line">            decreasing.push(i);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™ä½ ä¸€ä¸ªæ•´æ•°æ•°ç»„ nums ã€‚nums ä¸­ï¼Œå­æ•°ç»„çš„ èŒƒå›´ æ˜¯å­æ•°ç»„ä¸­æœ€å¤§å…ƒç´ å’Œæœ€å°å…ƒç´ çš„å·®å€¼ã€‚&lt;/p&gt;
&lt;p&gt;è¿”å› nums ä¸­ æ‰€æœ‰ å­æ•°ç»„èŒƒå›´çš„ å’Œ ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Stack" scheme="http://yoursite.com/tags/Stack/"/>
    
      <category term="Monotonic Stack" scheme="http://yoursite.com/tags/Monotonic-Stack/"/>
    
  </entry>
  
  <entry>
    <title>JVMå­¦ä¹ ç¬”è®°ï¼ˆçº¿ç¨‹ï¼ŒJVMï¼Œåƒåœ¾å›æ”¶ï¼Œå¼•ç”¨ï¼ŒIOï¼Œç±»åŠ è½½ï¼‰</title>
    <link href="http://yoursite.com/2021/12/17/JVM%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0%EF%BC%88%E7%BA%BF%E7%A8%8B%EF%BC%8CJVM%EF%BC%8C%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%EF%BC%8C%E5%BC%95%E7%94%A8%EF%BC%8CIO%EF%BC%8C%E7%B1%BB%E5%8A%A0%E8%BD%BD%EF%BC%89/"/>
    <id>http://yoursite.com/2021/12/17/JVMå­¦ä¹ ç¬”è®°ï¼ˆçº¿ç¨‹ï¼ŒJVMï¼Œåƒåœ¾å›æ”¶ï¼Œå¼•ç”¨ï¼ŒIOï¼Œç±»åŠ è½½ï¼‰/</id>
    <published>2021-12-17T12:30:12.000Z</published>
    <updated>2021-12-29T10:18:30.613Z</updated>
    
    <content type="html"><![CDATA[<p>JVM æ˜¯å¯è¿è¡Œ Java ä»£ç çš„å‡æƒ³è®¡ç®—æœº ï¼ŒåŒ…æ‹¬ä¸€å¥—å­—èŠ‚ç æŒ‡ä»¤é›†ã€ä¸€ç»„å¯„å­˜å™¨ã€ä¸€ä¸ªæ ˆã€ä¸€ä¸ªåƒåœ¾å›æ”¶ï¼Œå † å’Œ ä¸€ä¸ªå­˜å‚¨æ–¹æ³•åŸŸã€‚JVM æ˜¯è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šçš„ï¼Œå®ƒä¸ç¡¬ä»¶æ²¡æœ‰ç›´æ¥çš„äº¤äº’ã€‚</p><a id="more"></a><p>[TOC]</p><h1 id="åŸºæœ¬æ¦‚å¿µï¼š-1"><a href="#åŸºæœ¬æ¦‚å¿µï¼š-1" class="headerlink" title="åŸºæœ¬æ¦‚å¿µï¼š^1"></a>åŸºæœ¬æ¦‚å¿µï¼š<a href="[æ·±å…¥ç†è§£Javaè™šæ‹Ÿæœºï¼šJVMé«˜çº§ç‰¹æ€§ä¸æœ€ä½³å®è·µ](https://weread.qq.com/web/reader/9b832f305933f09b86bd2a9kecc32f3013eccbc87e4b62e)">^1</a></h1><p>JVM æ˜¯å¯è¿è¡Œ Java ä»£ç çš„å‡æƒ³è®¡ç®—æœº ï¼ŒåŒ…æ‹¬ä¸€å¥—å­—èŠ‚ç æŒ‡ä»¤é›†ã€ä¸€ç»„å¯„å­˜å™¨ã€ä¸€ä¸ªæ ˆã€ä¸€ä¸ªåƒåœ¾å›æ”¶ï¼Œå † å’Œ ä¸€ä¸ªå­˜å‚¨æ–¹æ³•åŸŸã€‚JVM æ˜¯è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šçš„ï¼Œå®ƒä¸ç¡¬ä»¶æ²¡æœ‰ç›´æ¥çš„äº¤äº’ã€‚</p><p>æˆ‘ä»¬éƒ½çŸ¥é“ Java æºæ–‡ä»¶ï¼Œé€šè¿‡ç¼–è¯‘å™¨ï¼Œèƒ½å¤Ÿç”Ÿäº§ç›¸åº”çš„.Class æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯å­—èŠ‚ç æ–‡ä»¶ï¼Œè€Œå­—èŠ‚ç æ–‡ä»¶åˆé€šè¿‡ Java è™šæ‹Ÿæœºä¸­çš„è§£é‡Šå™¨ï¼Œç¼–è¯‘æˆç‰¹å®šæœºå™¨ä¸Šçš„æœºå™¨ç  ã€‚<br>ä¹Ÿå°±æ˜¯å¦‚ä¸‹ï¼š</p><p>â‘  Java æºæ–‡ä»¶â€”-&gt;ç¼–è¯‘å™¨â€”-&gt;å­—èŠ‚ç æ–‡ä»¶</p><p>â‘¡ å­—èŠ‚ç æ–‡ä»¶â€”-&gt;JVMâ€”-&gt;æœºå™¨ç </p><p>æ¯ä¸€ç§å¹³å°çš„è§£é‡Šå™¨æ˜¯ä¸åŒçš„ï¼Œä½†æ˜¯å®ç°çš„è™šæ‹Ÿæœºæ˜¯ç›¸åŒçš„ï¼Œè¿™ä¹Ÿå°±æ˜¯Javaä¸ºä»€ä¹ˆèƒ½å¤Ÿè·¨å¹³å°çš„åŸå› äº†ï¼Œå½“ä¸€ä¸ªç¨‹åºä»å¼€å§‹è¿è¡Œï¼Œè¿™æ—¶è™šæ‹Ÿæœºå°±å¼€å§‹å®ä¾‹åŒ–äº†ï¼Œå¤šä¸ªç¨‹åºå¯åŠ¨å°±ä¼šå­˜åœ¨å¤šä¸ªè™šæ‹Ÿæœºå®ä¾‹ã€‚ç¨‹åºé€€å‡ºæˆ–è€…å…³é—­ï¼Œåˆ™è™šæ‹Ÿæœºå®ä¾‹æ¶ˆäº¡ï¼Œå¤šä¸ªè™šæ‹Ÿæœºå®ä¾‹ä¹‹é—´æ•°æ®ä¸èƒ½å…±äº«ã€‚</p><h2 id="çº¿ç¨‹"><a href="#çº¿ç¨‹" class="headerlink" title="çº¿ç¨‹"></a>çº¿ç¨‹</h2><p>è¿™é‡Œæ‰€è¯´çš„çº¿ç¨‹æŒ‡ç¨‹åºæ‰§è¡Œè¿‡ç¨‹ä¸­çš„ä¸€ä¸ªçº¿ç¨‹å®ä½“ã€‚JVM å…è®¸ä¸€ä¸ªåº”ç”¨å¹¶å‘æ‰§è¡Œå¤šä¸ªçº¿ç¨‹ã€‚Hotspot JVM ä¸­çš„ Java çº¿ç¨‹ä¸åŸç”Ÿæ“ä½œç³»ç»Ÿçº¿ç¨‹æœ‰ç›´æ¥çš„æ˜ å°„å…³ç³»ã€‚å½“çº¿ç¨‹æœ¬åœ°å­˜å‚¨ã€ç¼“å†²åŒºåˆ†é…ã€åŒæ­¥å¯¹è±¡ã€æ ˆã€ç¨‹åºè®¡æ•°å™¨ç­‰å‡†å¤‡å¥½ä»¥åï¼Œå°±ä¼šåˆ›å»ºä¸€ä¸ªæ“ä½œç³»ç»ŸåŸç”Ÿçº¿ç¨‹ã€‚Java çº¿ç¨‹ç»“æŸï¼ŒåŸç”Ÿçº¿ç¨‹éšä¹‹è¢«å›æ”¶ã€‚æ“ä½œç³»ç»Ÿè´Ÿè´£è°ƒåº¦æ‰€æœ‰çº¿ç¨‹ï¼Œå¹¶æŠŠå®ƒä»¬åˆ†é…åˆ°ä»»ä½•å¯ç”¨çš„ CPU ä¸Šã€‚å½“åŸç”Ÿçº¿ç¨‹åˆå§‹åŒ–å®Œæ¯•ï¼Œå°±ä¼šè°ƒç”¨ Java çº¿ç¨‹çš„ run() æ–¹æ³•ã€‚å½“çº¿ç¨‹ç»“æŸæ—¶ä¼šé‡Šæ”¾åŸç”Ÿçº¿ç¨‹å’Œ Java çº¿ç¨‹çš„æ‰€æœ‰èµ„æºã€‚</p><p>Hotspot JVM åå°è¿è¡Œçš„ç³»ç»Ÿçº¿ç¨‹ä¸»è¦æœ‰ä¸‹é¢å‡ ä¸ªï¼š</p><table><thead><tr><th>çº¿ç¨‹</th><th>è¯¦æƒ…</th></tr></thead><tbody><tr><td>è™šæ‹Ÿæœºçº¿ç¨‹ï¼ˆVM threadï¼‰</td><td>è¿™ä¸ªçº¿ç¨‹ç­‰å¾… JVM åˆ°è¾¾å®‰å…¨ç‚¹æ“ä½œå‡ºç°ã€‚è¿™äº›æ“ä½œå¿…é¡»è¦åœ¨ç‹¬ç«‹çš„çº¿ç¨‹é‡Œæ‰§è¡Œï¼Œå› ä¸ºå½“å †ä¿®æ”¹æ— æ³•è¿›è¡Œæ—¶ï¼Œçº¿ç¨‹éƒ½éœ€è¦ JVM ä½äºå®‰å…¨ç‚¹ã€‚è¿™äº›æ“ä½œçš„ç±»å‹æœ‰ï¼šstop-theworld åƒåœ¾å›æ”¶ã€çº¿ç¨‹æ ˆdumpã€çº¿ç¨‹æš‚åœã€çº¿ç¨‹åå‘é”ï¼ˆbiased lockingï¼‰è§£é™¤ã€‚</td></tr><tr><td>å‘¨æœŸæ€§ä»»åŠ¡çº¿ç¨‹</td><td>è¿™çº¿ç¨‹è´Ÿè´£å®šæ—¶å™¨äº‹ä»¶ï¼ˆä¹Ÿå°±æ˜¯ä¸­æ–­ï¼‰ï¼Œç”¨æ¥è°ƒåº¦å‘¨æœŸæ€§æ“ä½œçš„æ‰§è¡Œã€‚</td></tr><tr><td>GC çº¿ç¨‹</td><td>è¿™äº›çº¿ç¨‹æ”¯æŒJVMä¸­ä¸åŒçš„åƒåœ¾å›æ”¶æ´»åŠ¨</td></tr><tr><td>ç¼–è¯‘å™¨çº¿ç¨‹</td><td>è¿™äº›çº¿ç¨‹åœ¨è¿è¡Œæ—¶å°†å­—èŠ‚ç åŠ¨æ€ç¼–è¯‘æˆæœ¬åœ°å¹³å°ç›¸å…³çš„æœºå™¨ç ã€‚</td></tr><tr><td>ä¿¡å·åˆ†å‘çº¿ç¨‹</td><td>è¿™ä¸ªçº¿ç¨‹æ¥æ”¶å‘é€åˆ° JVM çš„ä¿¡å·å¹¶è°ƒç”¨é€‚å½“çš„ JVM æ–¹æ³•å¤„ç†</td></tr></tbody></table><h2 id="JVM-å†…å­˜åŒºåŸŸ"><a href="#JVM-å†…å­˜åŒºåŸŸ" class="headerlink" title="JVM å†…å­˜åŒºåŸŸ"></a>JVM å†…å­˜åŒºåŸŸ</h2><p>JVM å†…å­˜åŒºåŸŸä¸»è¦åˆ†ä¸ºçº¿ç¨‹ç§æœ‰åŒºåŸŸã€ç¨‹åºè®¡æ•°å™¨ã€è™šæ‹Ÿæœºæ ˆã€æœ¬åœ°æ–¹æ³•åŒºã€‘ã€çº¿ç¨‹å…±äº«åŒºåŸŸã€JAVA å †ã€æ–¹æ³•åŒºã€‘ã€ç›´æ¥å†…å­˜ã€‚</p><p>çº¿ç¨‹ç§æœ‰æ•°æ®åŒºåŸŸç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒ, ä¾èµ–ç”¨æˆ·çº¿ç¨‹çš„å¯åŠ¨/ç»“æŸ è€Œ åˆ›å»º/é”€æ¯(åœ¨ Hotspot VM å†…,æ¯ä¸ªçº¿ç¨‹éƒ½ä¸æ“ä½œç³»ç»Ÿçš„æœ¬åœ°çº¿ç¨‹ç›´æ¥æ˜ å°„, å› æ­¤è¿™éƒ¨åˆ†å†…å­˜åŒºåŸŸçš„å­˜/å¦è·Ÿéšæœ¬åœ°çº¿ç¨‹çš„ç”Ÿ/æ­»å¯¹åº”)ã€‚</p><p>çº¿ç¨‹å…±äº«åŒºåŸŸéšè™šæ‹Ÿæœºçš„å¯åŠ¨/å…³é—­è€Œåˆ›å»º/é”€æ¯ã€‚ç›´æ¥å†…å­˜å¹¶ä¸æ˜¯ JVM è¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†, ä½†ä¹Ÿä¼šè¢«é¢‘ç¹çš„ä½¿ç”¨: åœ¨ JDK 1.4 å¼•å…¥çš„ NIO æ<br>ä¾›äº†åŸºäº Channel ä¸ Buffer çš„ IO æ–¹å¼, å®ƒå¯ä»¥ä½¿ç”¨ Native å‡½æ•°åº“ç›´æ¥åˆ†é…å †å¤–å†…å­˜, ç„¶åä½¿ç”¨DirectByteBufferå¯¹è±¡ä½œä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨è¿›è¡Œæ“ä½œ(è¯¦è§: Java I/O æ‰©å±•), è¿™æ ·å°±é¿å…äº†åœ¨Javaå †å’ŒNativeå †ä¸­æ¥å›å¤åˆ¶æ•°æ®, å› æ­¤åœ¨ä¸€äº›åœºæ™¯ä¸­å¯ä»¥æ˜¾è‘—æé«˜æ€§èƒ½ã€‚</p><h3 id="ç¨‹åºè®¡æ•°å™¨-çº¿ç¨‹ç§æœ‰"><a href="#ç¨‹åºè®¡æ•°å™¨-çº¿ç¨‹ç§æœ‰" class="headerlink" title="ç¨‹åºè®¡æ•°å™¨(çº¿ç¨‹ç§æœ‰)"></a>ç¨‹åºè®¡æ•°å™¨(çº¿ç¨‹ç§æœ‰)</h3><p>ä¸€å—è¾ƒå°çš„å†…å­˜ç©ºé—´, æ˜¯å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨ï¼Œæ¯æ¡çº¿ç¨‹éƒ½è¦æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œè¿™ç±»å†…å­˜ä¹Ÿç§°ä¸ºâ€œçº¿ç¨‹ç§æœ‰â€çš„å†…å­˜ã€‚<br>æ­£åœ¨æ‰§è¡Œ java æ–¹æ³•çš„è¯ï¼Œè®¡æ•°å™¨è®°å½•çš„æ˜¯è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼ˆå½“å‰æŒ‡ä»¤çš„åœ°å€ï¼‰ã€‚å¦‚æœè¿˜æ˜¯Nativeæ–¹æ³•ï¼Œåˆ™ä¸ºç©ºã€‚è¿™ä¸ªå†…å­˜åŒºåŸŸæ˜¯å”¯ä¸€ä¸€ä¸ªåœ¨è™šæ‹Ÿæœºä¸­æ²¡æœ‰è§„å®šä»»ä½• OutOfMemoryError æƒ…å†µçš„åŒºåŸŸã€‚</p><h3 id="è™šæ‹Ÿæœºæ ˆ-çº¿ç¨‹ç§æœ‰"><a href="#è™šæ‹Ÿæœºæ ˆ-çº¿ç¨‹ç§æœ‰" class="headerlink" title="è™šæ‹Ÿæœºæ ˆ(çº¿ç¨‹ç§æœ‰)"></a>è™šæ‹Ÿæœºæ ˆ(çº¿ç¨‹ç§æœ‰)</h3><p>æ˜¯æè¿°javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼Œæ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§ï¼ˆStackFrameï¼‰ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ã€‚æ¯ä¸€ä¸ªæ–¹æ³•ä»è°ƒç”¨ç›´è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºæ ˆä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹ã€‚æ ˆå¸§ï¼ˆFrameï¼‰æ˜¯ç”¨æ¥å­˜å‚¨æ•°æ®å’Œéƒ¨åˆ†è¿‡ç¨‹ç»“æœçš„æ•°æ®ç»“æ„ï¼ŒåŒæ—¶ä¹Ÿè¢«ç”¨æ¥å¤„ç†åŠ¨æ€é“¾æ¥(Dynamic Linking)ã€ æ–¹æ³•è¿”å›å€¼å’Œå¼‚å¸¸åˆ†æ´¾ï¼ˆDispatch Exceptionï¼‰ã€‚æ ˆå¸§éšç€æ–¹æ³•è°ƒç”¨è€Œåˆ›å»ºï¼Œéšç€æ–¹æ³•ç»“æŸè€Œé”€æ¯â€”â€”æ— è®ºæ–¹æ³•æ˜¯æ­£å¸¸å®Œæˆè¿˜æ˜¯å¼‚å¸¸å®Œæˆï¼ˆæŠ›å‡ºäº†åœ¨æ–¹æ³•å†…æœªè¢«æ•è·çš„å¼‚å¸¸ï¼‰éƒ½ç®—ä½œæ–¹æ³•ç»“æŸã€‚</p><h3 id="æœ¬åœ°æ–¹æ³•åŒº-çº¿ç¨‹ç§æœ‰"><a href="#æœ¬åœ°æ–¹æ³•åŒº-çº¿ç¨‹ç§æœ‰" class="headerlink" title="æœ¬åœ°æ–¹æ³•åŒº(çº¿ç¨‹ç§æœ‰)"></a>æœ¬åœ°æ–¹æ³•åŒº(çº¿ç¨‹ç§æœ‰)</h3><p>æœ¬åœ°æ–¹æ³•åŒºå’Œ Java Stack ä½œç”¨ç±»ä¼¼, åŒºåˆ«æ˜¯è™šæ‹Ÿæœºæ ˆä¸ºæ‰§è¡Œ Java æ–¹æ³•æœåŠ¡, è€Œæœ¬åœ°æ–¹æ³•æ ˆåˆ™ä¸ºNative æ–¹æ³•æœåŠ¡, å¦‚æœä¸€ä¸ª VM å®ç°ä½¿ç”¨ C-linkage æ¨¡å‹æ¥æ”¯æŒ Native è°ƒç”¨, é‚£ä¹ˆè¯¥æ ˆå°†ä¼šæ˜¯ä¸€ä¸ªC æ ˆï¼Œä½† HotSpot VM ç›´æ¥å°±æŠŠæœ¬åœ°æ–¹æ³•æ ˆå’Œè™šæ‹Ÿæœºæ ˆåˆäºŒä¸ºä¸€ã€‚</p><h3 id="å †ï¼ˆHeap-çº¿ç¨‹å…±äº«ï¼‰-è¿è¡Œæ—¶æ•°æ®åŒº"><a href="#å †ï¼ˆHeap-çº¿ç¨‹å…±äº«ï¼‰-è¿è¡Œæ—¶æ•°æ®åŒº" class="headerlink" title="å †ï¼ˆHeap-çº¿ç¨‹å…±äº«ï¼‰-è¿è¡Œæ—¶æ•°æ®åŒº"></a>å †ï¼ˆHeap-çº¿ç¨‹å…±äº«ï¼‰-è¿è¡Œæ—¶æ•°æ®åŒº</h3><p>æ˜¯è¢«çº¿ç¨‹å…±äº«çš„ä¸€å—å†…å­˜åŒºåŸŸï¼Œåˆ›å»ºçš„å¯¹è±¡å’Œæ•°ç»„éƒ½ä¿å­˜åœ¨ Java å †å†…å­˜ä¸­ï¼Œä¹Ÿæ˜¯åƒåœ¾æ”¶é›†å™¨è¿›è¡Œåƒåœ¾æ”¶é›†çš„æœ€é‡è¦çš„å†…å­˜åŒºåŸŸã€‚ç”±äºç°ä»£ VM é‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•, å› æ­¤ Java å †ä» GC çš„è§’åº¦è¿˜å¯ä»¥ç»†åˆ†ä¸º: æ–°ç”Ÿä»£(Eden åŒºã€From Survivor åŒºå’Œ To Survivor åŒº)å’Œè€å¹´ä»£ã€‚</p><h3 id="æ–¹æ³•åŒº-æ°¸ä¹…ä»£ï¼ˆçº¿ç¨‹å…±äº«ï¼‰"><a href="#æ–¹æ³•åŒº-æ°¸ä¹…ä»£ï¼ˆçº¿ç¨‹å…±äº«ï¼‰" class="headerlink" title="æ–¹æ³•åŒº/æ°¸ä¹…ä»£ï¼ˆçº¿ç¨‹å…±äº«ï¼‰"></a>æ–¹æ³•åŒº/æ°¸ä¹…ä»£ï¼ˆçº¿ç¨‹å…±äº«ï¼‰</h3><p>å³æˆ‘ä»¬å¸¸è¯´çš„æ°¸ä¹…ä»£(Permanent Generation), ç”¨äºå­˜å‚¨è¢« JVM åŠ è½½çš„ç±»ä¿¡æ¯ã€å¸¸é‡ã€é™æ€å˜é‡ã€å³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®. HotSpot VMæŠŠGCåˆ†ä»£æ”¶é›†æ‰©å±•è‡³æ–¹æ³•åŒº, å³ä½¿ç”¨Javaå †çš„æ°¸ä¹…ä»£æ¥å®ç°æ–¹æ³•åŒº, è¿™æ · HotSpot çš„åƒåœ¾æ”¶é›†å™¨å°±å¯ä»¥åƒç®¡ç† Java å †ä¸€æ ·ç®¡ç†è¿™éƒ¨åˆ†å†…å­˜,<br>è€Œä¸å¿…ä¸ºæ–¹æ³•åŒºå¼€å‘ä¸“é—¨çš„å†…å­˜ç®¡ç†å™¨(æ°¸ä¹…å¸¦çš„å†…å­˜å›æ”¶çš„ä¸»è¦ç›®æ ‡æ˜¯é’ˆå¯¹å¸¸é‡æ± çš„å›æ”¶å’Œç±»å‹çš„å¸è½½, å› æ­¤æ”¶ç›Šä¸€èˆ¬å¾ˆå°)ã€‚<br>è¿è¡Œæ—¶å¸¸é‡æ± ï¼ˆRuntime Constant Poolï¼‰æ˜¯æ–¹æ³•åŒºçš„ä¸€éƒ¨åˆ†ã€‚Classæ–‡ä»¶ä¸­é™¤äº†æœ‰ç±»çš„ç‰ˆæœ¬ã€å­—æ®µã€æ–¹æ³•ã€æ¥å£ç­‰æè¿°ç­‰ä¿¡æ¯å¤–ï¼Œè¿˜æœ‰ä¸€é¡¹ä¿¡æ¯æ˜¯å¸¸é‡æ± ï¼ˆConstant Pool Tableï¼‰ï¼Œç”¨äºå­˜æ”¾ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼Œè¿™éƒ¨åˆ†å†…å®¹å°†åœ¨ç±»åŠ è½½åå­˜æ”¾åˆ°æ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ã€‚ Java è™šæ‹Ÿæœºå¯¹ Class æ–‡ä»¶çš„æ¯ä¸€éƒ¨åˆ†ï¼ˆè‡ªç„¶ä¹ŸåŒ…æ‹¬å¸¸é‡æ± ï¼‰çš„æ ¼å¼éƒ½æœ‰ä¸¥æ ¼çš„è§„å®šï¼Œæ¯ä¸€ä¸ªå­—èŠ‚ç”¨äºå­˜å‚¨å“ªç§æ•°æ®éƒ½å¿…é¡»ç¬¦åˆè§„èŒƒä¸Šçš„è¦æ±‚ï¼Œè¿™æ ·æ‰ä¼š<br>è¢«è™šæ‹Ÿæœºè®¤å¯ã€è£…è½½å’Œæ‰§è¡Œã€‚</p><h2 id="JVM-è¿è¡Œæ—¶å†…å­˜"><a href="#JVM-è¿è¡Œæ—¶å†…å­˜" class="headerlink" title="JVM è¿è¡Œæ—¶å†…å­˜"></a>JVM è¿è¡Œæ—¶å†…å­˜</h2><p>Java å †ä» GC çš„è§’åº¦è¿˜å¯ä»¥ç»†åˆ†ä¸º: æ–°ç”Ÿä»£(Eden åŒºã€From Survivor åŒºå’Œ To Survivor åŒº)å’Œè€å¹´ä»£ã€‚</p><h3 id="æ–°ç”Ÿä»£"><a href="#æ–°ç”Ÿä»£" class="headerlink" title="æ–°ç”Ÿä»£"></a>æ–°ç”Ÿä»£</h3><p>æ˜¯ç”¨æ¥å­˜æ”¾æ–°ç”Ÿçš„å¯¹è±¡ã€‚ä¸€èˆ¬å æ®å †çš„ 1/3 ç©ºé—´ã€‚ç”±äºé¢‘ç¹åˆ›å»ºå¯¹è±¡ï¼Œæ‰€ä»¥æ–°ç”Ÿä»£ä¼šé¢‘ç¹è§¦å‘MinorGC è¿›è¡Œåƒåœ¾å›æ”¶ã€‚æ–°ç”Ÿä»£åˆåˆ†ä¸º Eden åŒºã€SurvivorFromã€SurvivorTo ä¸‰ä¸ªåŒºã€‚</p><h4 id="Eden-åŒº"><a href="#Eden-åŒº" class="headerlink" title="Eden åŒº"></a>Eden åŒº</h4><p>Java æ–°å¯¹è±¡çš„å‡ºç”Ÿåœ°ï¼ˆå¦‚æœæ–°åˆ›å»ºçš„å¯¹è±¡å ç”¨å†…å­˜å¾ˆå¤§ï¼Œåˆ™ç›´æ¥åˆ†é…åˆ°è€å¹´ä»£ï¼‰ã€‚å½“ Eden åŒºå†…å­˜ä¸å¤Ÿçš„æ—¶å€™å°±ä¼šè§¦å‘ MinorGCï¼Œå¯¹æ–°ç”Ÿä»£åŒºè¿›è¡Œ<br>ä¸€æ¬¡åƒåœ¾å›æ”¶ã€‚</p><h4 id="From-Survivor"><a href="#From-Survivor" class="headerlink" title="From Survivor"></a>From Survivor</h4><p>ä¸Šä¸€æ¬¡ GC çš„å¹¸å­˜è€…ï¼Œä½œä¸ºè¿™ä¸€æ¬¡ GC çš„è¢«æ‰«æè€…ã€‚</p><h4 id="To-Survivor"><a href="#To-Survivor" class="headerlink" title="To Survivor"></a>To Survivor</h4><p>ä¿ç•™äº†ä¸€æ¬¡ MinorGC è¿‡ç¨‹ä¸­çš„å¹¸å­˜è€…ã€‚</p><h4 id="MinorGC-çš„è¿‡ç¨‹ï¼ˆå¤åˆ¶-gt-æ¸…ç©º-gt-äº’æ¢ï¼‰"><a href="#MinorGC-çš„è¿‡ç¨‹ï¼ˆå¤åˆ¶-gt-æ¸…ç©º-gt-äº’æ¢ï¼‰" class="headerlink" title="MinorGC çš„è¿‡ç¨‹ï¼ˆå¤åˆ¶-&gt;æ¸…ç©º-&gt;äº’æ¢ï¼‰"></a>MinorGC çš„è¿‡ç¨‹ï¼ˆå¤åˆ¶-&gt;æ¸…ç©º-&gt;äº’æ¢ï¼‰</h4><p>MinorGC é‡‡ç”¨å¤åˆ¶ç®—æ³•ã€‚</p><p>1ï¼šedenã€From Survivor å¤åˆ¶åˆ° To Survivorï¼Œå¹´é¾„+1</p><p>é¦–å…ˆï¼ŒæŠŠ Eden å’Œ From Survivor åŒºåŸŸä¸­å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ° To SurvivoråŒºåŸŸï¼ˆå¦‚æœæœ‰å¯¹è±¡çš„å¹´é¾„ä»¥åŠè¾¾åˆ°äº†è€å¹´çš„æ ‡å‡†ï¼Œåˆ™èµ‹å€¼åˆ°è€å¹´ä»£åŒºï¼‰ï¼ŒåŒæ—¶æŠŠè¿™äº›å¯¹è±¡çš„å¹´é¾„+1ï¼ˆå¦‚æœ To Survivor ä¸å¤Ÿä½ç½®äº†å°±æ”¾åˆ°è€å¹´åŒºï¼‰ï¼›</p><p>2ï¼šæ¸…ç©º edenã€From Survivor</p><p>ç„¶åï¼Œæ¸…ç©º Eden å’Œ From Survivor ä¸­çš„å¯¹è±¡ï¼›</p><p>3ï¼šTo Survivor å’Œ From Survivor äº’æ¢</p><p>æœ€åï¼ŒTo Survivor å’Œ From Survivor äº’æ¢ï¼ŒåŸ To Survivor æˆä¸ºä¸‹ä¸€æ¬¡ GC æ—¶çš„ From SurvivoråŒºã€‚</p><h3 id="è€å¹´ä»£"><a href="#è€å¹´ä»£" class="headerlink" title="è€å¹´ä»£"></a>è€å¹´ä»£</h3><p>ä¸»è¦å­˜æ”¾åº”ç”¨ç¨‹åºä¸­ç”Ÿå‘½å‘¨æœŸé•¿çš„å†…å­˜å¯¹è±¡ã€‚</p><p> è€å¹´ä»£çš„å¯¹è±¡æ¯”è¾ƒç¨³å®šï¼Œæ‰€ä»¥ MajorGC ä¸ä¼šé¢‘ç¹æ‰§è¡Œã€‚åœ¨è¿›è¡ŒMajorGCå‰ä¸€èˆ¬éƒ½å…ˆè¿›è¡Œäº†ä¸€æ¬¡MinorGCï¼Œä½¿å¾—æœ‰æ–°ç”Ÿä»£çš„å¯¹è±¡æ™‹èº«å…¥è€å¹´ä»£ï¼Œå¯¼è‡´ç©ºé—´ä¸å¤Ÿç”¨æ—¶æ‰è§¦å‘ã€‚å½“æ— æ³•æ‰¾åˆ°è¶³å¤Ÿå¤§çš„è¿ç»­ç©ºé—´åˆ†é…ç»™æ–°åˆ›å»ºçš„è¾ƒå¤§å¯¹è±¡æ—¶ä¹Ÿä¼šæå‰è§¦å‘ä¸€æ¬¡ MajorGC è¿›è¡Œåƒåœ¾å›æ”¶è…¾å‡ºç©ºé—´ã€‚</p><p> MajorGC é‡‡ç”¨æ ‡è®°æ¸…é™¤ç®—æ³•ï¼šé¦–å…ˆæ‰«æä¸€æ¬¡æ‰€æœ‰è€å¹´ä»£ï¼Œæ ‡è®°å‡ºå­˜æ´»çš„å¯¹è±¡ï¼Œç„¶åå›æ”¶æ²¡æœ‰æ ‡è®°çš„å¯¹è±¡ã€‚MajorGC çš„è€—æ—¶æ¯”è¾ƒé•¿ï¼Œå› ä¸ºè¦æ‰«æå†å›æ”¶ã€‚MajorGC ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Œä¸ºäº†å‡å°‘å†…å­˜æŸè€—ï¼Œæˆ‘ä»¬ä¸€èˆ¬éœ€è¦è¿›è¡Œåˆå¹¶æˆ–è€…æ ‡è®°å‡ºæ¥æ–¹ä¾¿ä¸‹æ¬¡ç›´æ¥åˆ†é…ã€‚å½“è€å¹´ä»£ä¹Ÿæ»¡äº†è£…ä¸ä¸‹çš„æ—¶å€™ï¼Œå°±ä¼šæŠ›å‡º OOMï¼ˆOut of Memoryï¼‰å¼‚å¸¸ã€‚</p><h3 id="æ°¸ä¹…ä»£"><a href="#æ°¸ä¹…ä»£" class="headerlink" title="æ°¸ä¹…ä»£"></a>æ°¸ä¹…ä»£</h3><p>æŒ‡å†…å­˜çš„æ°¸ä¹…ä¿å­˜åŒºåŸŸï¼Œä¸»è¦å­˜æ”¾ Class å’Œ Metaï¼ˆå…ƒæ•°æ®ï¼‰çš„ä¿¡æ¯,Class åœ¨è¢«åŠ è½½çš„æ—¶å€™è¢«æ”¾å…¥æ°¸ä¹…åŒºåŸŸï¼Œå®ƒå’Œå’Œå­˜æ”¾å®ä¾‹çš„åŒºåŸŸä¸åŒ,GC ä¸ä¼šåœ¨ä¸»ç¨‹åºè¿è¡ŒæœŸå¯¹æ°¸ä¹…åŒºåŸŸè¿›è¡Œæ¸…ç†ã€‚æ‰€ä»¥è¿™ä¹Ÿå¯¼è‡´äº†æ°¸ä¹…ä»£çš„åŒºåŸŸä¼šéšç€åŠ è½½çš„ Class çš„å¢å¤šè€Œèƒ€æ»¡ï¼Œæœ€ç»ˆæŠ›å‡º OOM å¼‚å¸¸ã€‚</p><h4 id="JAVA8-ä¸å…ƒæ•°æ®"><a href="#JAVA8-ä¸å…ƒæ•°æ®" class="headerlink" title="JAVA8 ä¸å…ƒæ•°æ®"></a>JAVA8 ä¸å…ƒæ•°æ®</h4><p>åœ¨ Java8 ä¸­ï¼Œæ°¸ä¹…ä»£å·²ç»è¢«ç§»é™¤ï¼Œè¢«ä¸€ä¸ªç§°ä¸ºâ€œå…ƒæ•°æ®åŒºâ€ï¼ˆå…ƒç©ºé—´ï¼‰çš„åŒºåŸŸæ‰€å–ä»£ã€‚å…ƒç©ºé—´çš„æœ¬è´¨å’Œæ°¸ä¹…ä»£ç±»ä¼¼ï¼Œå…ƒç©ºé—´ä¸æ°¸ä¹…ä»£ä¹‹é—´æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼šå…ƒç©ºé—´å¹¶ä¸åœ¨è™šæ‹Ÿæœºä¸­ï¼Œè€Œæ˜¯ä½¿ç”¨æœ¬åœ°å†…å­˜ã€‚å› æ­¤ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œå…ƒç©ºé—´çš„å¤§å°ä»…å—æœ¬åœ°å†…å­˜é™åˆ¶ã€‚ç±»çš„å…ƒæ•°æ®æ”¾å…¥ native memory, å­—ç¬¦ä¸²æ± å’Œç±»çš„é™æ€å˜é‡æ”¾å…¥ java å †ä¸­ï¼Œè¿™æ ·å¯ä»¥åŠ è½½å¤šå°‘ç±»çš„å…ƒæ•°æ®å°±ä¸å†ç”±MaxPermSize æ§åˆ¶, è€Œç”±ç³»ç»Ÿçš„å®é™…å¯ç”¨ç©ºé—´æ¥æ§åˆ¶ã€‚</p><h2 id="åƒåœ¾å›æ”¶ä¸ç®—æ³•"><a href="#åƒåœ¾å›æ”¶ä¸ç®—æ³•" class="headerlink" title="åƒåœ¾å›æ”¶ä¸ç®—æ³•"></a>åƒåœ¾å›æ”¶ä¸ç®—æ³•</h2><h3 id="å¦‚ä½•ç¡®å®šåƒåœ¾"><a href="#å¦‚ä½•ç¡®å®šåƒåœ¾" class="headerlink" title="å¦‚ä½•ç¡®å®šåƒåœ¾"></a>å¦‚ä½•ç¡®å®šåƒåœ¾</h3><h4 id="å¼•ç”¨è®¡æ•°æ³•"><a href="#å¼•ç”¨è®¡æ•°æ³•" class="headerlink" title="å¼•ç”¨è®¡æ•°æ³•"></a>å¼•ç”¨è®¡æ•°æ³•</h4><p>åœ¨ Java ä¸­ï¼Œå¼•ç”¨å’Œå¯¹è±¡æ˜¯æœ‰å…³è”çš„ã€‚å¦‚æœè¦æ“ä½œå¯¹è±¡åˆ™å¿…é¡»ç”¨å¼•ç”¨è¿›è¡Œã€‚å› æ­¤ï¼Œå¾ˆæ˜¾ç„¶ä¸€ä¸ªç®€å•<br>çš„åŠæ³•æ˜¯é€šè¿‡å¼•ç”¨è®¡æ•°æ¥åˆ¤æ–­ä¸€ä¸ªå¯¹è±¡æ˜¯å¦å¯ä»¥å›æ”¶ã€‚ç®€å•è¯´ï¼Œå³ä¸€ä¸ªå¯¹è±¡å¦‚æœæ²¡æœ‰ä»»ä½•ä¸ä¹‹å…³è”çš„å¼•ç”¨ï¼Œå³ä»–ä»¬çš„å¼•ç”¨è®¡æ•°éƒ½ä¸º0ï¼Œåˆ™è¯´æ˜å¯¹è±¡ä¸å¤ªå¯èƒ½å†è¢«ç”¨åˆ°ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±æ˜¯å¯å›æ”¶å¯¹è±¡ã€‚</p><h4 id="å¯è¾¾æ€§åˆ†æ"><a href="#å¯è¾¾æ€§åˆ†æ" class="headerlink" title="å¯è¾¾æ€§åˆ†æ"></a>å¯è¾¾æ€§åˆ†æ</h4><p>ä¸ºäº†è§£å†³å¼•ç”¨è®¡æ•°æ³•çš„å¾ªç¯å¼•ç”¨é—®é¢˜ï¼ŒJava ä½¿ç”¨äº†å¯è¾¾æ€§åˆ†æçš„æ–¹æ³•ã€‚é€šè¿‡ä¸€ç³»åˆ—çš„â€œGC rootsâ€å¯¹è±¡ä½œä¸ºèµ·ç‚¹æœç´¢ã€‚å¦‚æœåœ¨â€œGC rootsâ€å’Œä¸€ä¸ªå¯¹è±¡ä¹‹é—´æ²¡æœ‰å¯è¾¾è·¯å¾„ï¼Œåˆ™ç§°è¯¥å¯¹è±¡æ˜¯ä¸å¯è¾¾çš„ã€‚è¦æ³¨æ„çš„æ˜¯ï¼Œä¸å¯è¾¾å¯¹è±¡ä¸ç­‰ä»·äºå¯å›æ”¶å¯¹è±¡ï¼Œä¸å¯è¾¾å¯¹è±¡å˜ä¸ºå¯å›æ”¶å¯¹è±¡è‡³å°‘è¦ç»è¿‡ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹ã€‚ä¸¤æ¬¡æ ‡è®°åä»ç„¶æ˜¯å¯å›æ”¶å¯¹è±¡ï¼Œåˆ™å°†é¢ä¸´å›æ”¶ã€‚</p><h3 id="æ ‡è®°æ¸…é™¤ç®—æ³•ï¼ˆMark-Sweepï¼‰"><a href="#æ ‡è®°æ¸…é™¤ç®—æ³•ï¼ˆMark-Sweepï¼‰" class="headerlink" title="æ ‡è®°æ¸…é™¤ç®—æ³•ï¼ˆMark-Sweepï¼‰"></a>æ ‡è®°æ¸…é™¤ç®—æ³•ï¼ˆMark-Sweepï¼‰</h3><p>æœ€åŸºç¡€çš„åƒåœ¾å›æ”¶ç®—æ³•ï¼Œåˆ†ä¸ºä¸¤ä¸ªé˜¶æ®µï¼Œæ ‡æ³¨å’Œæ¸…é™¤ã€‚æ ‡è®°é˜¶æ®µæ ‡è®°å‡ºæ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œæ¸…é™¤é˜¶æ®µå›æ”¶è¢«æ ‡è®°çš„å¯¹è±¡æ‰€å ç”¨çš„ç©ºé—´ã€‚å¦‚</p><p>è¯¥ç®—æ³•æœ€å¤§çš„é—®é¢˜æ˜¯å†…å­˜ç¢ç‰‡åŒ–ä¸¥é‡ï¼Œåç»­å¯èƒ½å‘ç”Ÿå¤§å¯¹è±¡ä¸èƒ½æ‰¾åˆ°å¯åˆ©ç”¨ç©ºé—´çš„é—®é¢˜ã€‚</p><h3 id="å¤åˆ¶ç®—æ³•ï¼ˆcopyingï¼‰"><a href="#å¤åˆ¶ç®—æ³•ï¼ˆcopyingï¼‰" class="headerlink" title="å¤åˆ¶ç®—æ³•ï¼ˆcopyingï¼‰"></a>å¤åˆ¶ç®—æ³•ï¼ˆcopyingï¼‰</h3><p>ä¸ºäº†è§£å†³ Mark-Sweepç®—æ³•å†…å­˜ç¢ç‰‡åŒ–çš„ç¼ºé™·è€Œè¢«æå‡ºçš„ç®—æ³•ã€‚æŒ‰å†…å­˜å®¹é‡å°†å†…å­˜åˆ’åˆ†ä¸ºç­‰å¤§å°çš„ä¸¤å—ã€‚æ¯æ¬¡åªä½¿ç”¨å…¶ä¸­ä¸€å—ï¼Œå½“è¿™ä¸€å—å†…å­˜æ»¡åå°†å°šå­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å—ä¸Šå»ï¼ŒæŠŠå·²ä½¿ç”¨çš„å†…å­˜æ¸…æ‰è¿™ç§ç®—æ³•è™½ç„¶å®ç°ç®€å•ï¼Œå†…å­˜æ•ˆç‡é«˜ï¼Œä¸æ˜“äº§ç”Ÿç¢ç‰‡ï¼Œä½†æ˜¯æœ€å¤§çš„é—®é¢˜æ˜¯å¯ç”¨å†…å­˜è¢«å‹ç¼©åˆ°äº†åŸæœ¬çš„ä¸€åŠã€‚ä¸”å­˜æ´»å¯¹è±¡å¢å¤šçš„è¯ï¼ŒCopying ç®—æ³•çš„æ•ˆç‡ä¼šå¤§å¤§é™ä½ã€‚</p><h3 id="æ ‡è®°æ•´ç†ç®—æ³•-Mark-Compact"><a href="#æ ‡è®°æ•´ç†ç®—æ³•-Mark-Compact" class="headerlink" title="æ ‡è®°æ•´ç†ç®—æ³•(Mark-Compact)"></a>æ ‡è®°æ•´ç†ç®—æ³•(Mark-Compact)</h3><p>ç»“åˆäº†ä»¥ä¸Šä¸¤ä¸ªç®—æ³•ï¼Œä¸ºäº†é¿å…ç¼ºé™·è€Œæå‡ºã€‚æ ‡è®°é˜¶æ®µå’ŒMark-Sweepç®—æ³•ç›¸åŒï¼Œæ ‡è®°åä¸æ˜¯æ¸…ç†å¯¹è±¡ï¼Œè€Œæ˜¯å°†å­˜æ´»å¯¹è±¡ç§»å‘å†…å­˜çš„ä¸€ç«¯ã€‚ç„¶åæ¸…é™¤ç«¯è¾¹ç•Œå¤–çš„å¯¹è±¡ã€‚</p><h3 id="åˆ†ä»£æ”¶é›†ç®—æ³•"><a href="#åˆ†ä»£æ”¶é›†ç®—æ³•" class="headerlink" title="åˆ†ä»£æ”¶é›†ç®—æ³•"></a>åˆ†ä»£æ”¶é›†ç®—æ³•</h3><p>åˆ†ä»£æ”¶é›†æ³•æ˜¯ç›®å‰å¤§éƒ¨åˆ†JVMæ‰€é‡‡ç”¨çš„æ–¹æ³•ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯æ ¹æ®å¯¹è±¡å­˜æ´»çš„ä¸åŒç”Ÿå‘½å‘¨æœŸå°†å†…å­˜åˆ’åˆ†ä¸ºä¸åŒçš„åŸŸï¼Œä¸€èˆ¬æƒ…å†µä¸‹å°† GC å †åˆ’åˆ†ä¸ºè€ç”Ÿä»£(Tenured/Old Generation)å’Œæ–°ç”Ÿä»£(Young Generation)ã€‚è€ç”Ÿä»£çš„ç‰¹ç‚¹æ˜¯æ¯æ¬¡åƒåœ¾å›æ”¶æ—¶åªæœ‰å°‘é‡å¯¹è±¡éœ€è¦è¢«å›æ”¶ï¼Œæ–°ç”Ÿä»£çš„ç‰¹ç‚¹æ˜¯æ¯æ¬¡åƒåœ¾å›æ”¶æ—¶éƒ½æœ‰å¤§é‡åƒåœ¾éœ€è¦è¢«å›æ”¶ï¼Œå› æ­¤å¯ä»¥æ ¹æ®ä¸åŒåŒºåŸŸé€‰æ‹©ä¸åŒçš„ç®—æ³•ã€‚</p><h4 id="æ–°ç”Ÿä»£ä¸å¤åˆ¶ç®—æ³•"><a href="#æ–°ç”Ÿä»£ä¸å¤åˆ¶ç®—æ³•" class="headerlink" title="æ–°ç”Ÿä»£ä¸å¤åˆ¶ç®—æ³•"></a>æ–°ç”Ÿä»£ä¸å¤åˆ¶ç®—æ³•</h4><p>ç›®å‰å¤§éƒ¨åˆ† JVM çš„ GC å¯¹äºæ–°ç”Ÿä»£éƒ½é‡‡å– Copying ç®—æ³•ï¼Œå› ä¸ºæ–°ç”Ÿä»£ä¸­æ¯æ¬¡åƒåœ¾å›æ”¶éƒ½è¦å›æ”¶å¤§éƒ¨åˆ†å¯¹è±¡ï¼Œå³è¦å¤åˆ¶çš„æ“ä½œæ¯”è¾ƒå°‘ï¼Œä½†é€šå¸¸å¹¶ä¸æ˜¯æŒ‰ç…§ 1ï¼š1 æ¥åˆ’åˆ†æ–°ç”Ÿä»£ã€‚ä¸€èˆ¬å°†æ–°ç”Ÿä»£åˆ’åˆ†ä¸ºä¸€å—è¾ƒå¤§çš„ Eden ç©ºé—´å’Œä¸¤ä¸ªè¾ƒå°çš„ Survivor ç©ºé—´(From Space, To Space)ï¼Œæ¯æ¬¡ä½¿ç”¨Eden ç©ºé—´å’Œå…¶ä¸­çš„ä¸€å— Survivor ç©ºé—´ï¼Œå½“è¿›è¡Œå›æ”¶æ—¶ï¼Œå°†è¯¥ä¸¤å—ç©ºé—´ä¸­è¿˜å­˜æ´»çš„å¯¹è±¡å¤åˆ¶åˆ°å¦ä¸€å— Survivor ç©ºé—´ä¸­ã€‚</p><h4 id="è€å¹´ä»£ä¸æ ‡è®°å¤åˆ¶ç®—æ³•"><a href="#è€å¹´ä»£ä¸æ ‡è®°å¤åˆ¶ç®—æ³•" class="headerlink" title="è€å¹´ä»£ä¸æ ‡è®°å¤åˆ¶ç®—æ³•"></a>è€å¹´ä»£ä¸æ ‡è®°å¤åˆ¶ç®—æ³•</h4><p>è€Œè€å¹´ä»£å› ä¸ºæ¯æ¬¡åªå›æ”¶å°‘é‡å¯¹è±¡ï¼Œå› è€Œé‡‡ç”¨ Mark-Compact ç®—æ³•ã€‚</p><ol><li>JAVA è™šæ‹Ÿæœºæåˆ°è¿‡çš„å¤„äºæ–¹æ³•åŒºçš„æ°¸ç”Ÿä»£(Permanet Generation)ï¼Œå®ƒç”¨æ¥å­˜å‚¨classç±»ï¼Œå¸¸é‡ï¼Œæ–¹æ³•æè¿°ç­‰ã€‚å¯¹æ°¸ç”Ÿä»£çš„å›æ”¶ä¸»è¦åŒ…æ‹¬åºŸå¼ƒå¸¸é‡å’Œæ— ç”¨çš„ç±»ã€‚</li><li>å¯¹è±¡çš„å†…å­˜åˆ†é…ä¸»è¦åœ¨æ–°ç”Ÿä»£çš„ Eden Space å’Œ Survivor Space çš„ From Space(Survivorç›®å‰å­˜æ”¾å¯¹è±¡çš„é‚£ä¸€å—)ï¼Œå°‘æ•°æƒ…å†µä¼šç›´æ¥åˆ†é…åˆ°è€ç”Ÿä»£ã€‚</li><li>å½“æ–°ç”Ÿä»£çš„ Eden Space å’Œ From Spaceç©ºé—´ä¸è¶³æ—¶å°±ä¼šå‘ç”Ÿä¸€æ¬¡ GCï¼Œè¿›è¡Œ GC åï¼ŒEdenSpace å’Œ From Space åŒºçš„å­˜æ´»å¯¹è±¡ä¼šè¢«æŒªåˆ° To Spaceï¼Œç„¶åå°† Eden Space å’Œ From Spaceè¿›è¡Œæ¸…ç†ã€‚</li><li>å¦‚æœ To Spaceæ— æ³•è¶³å¤Ÿå­˜å‚¨æŸä¸ªå¯¹è±¡ï¼Œåˆ™å°†è¿™ä¸ªå¯¹è±¡å­˜å‚¨åˆ°è€ç”Ÿä»£ã€‚</li><li>åœ¨è¿›è¡Œ GC åï¼Œä½¿ç”¨çš„ä¾¿æ˜¯ Eden Space å’Œ To Space äº†ï¼Œå¦‚æ­¤åå¤å¾ªç¯ã€‚</li><li>å½“å¯¹è±¡åœ¨ SurvivoråŒºèº²è¿‡ä¸€æ¬¡GCåï¼Œå…¶å¹´é¾„å°±ä¼š+1ã€‚é»˜è®¤æƒ…å†µä¸‹å¹´é¾„åˆ°è¾¾ 15 çš„å¯¹è±¡ä¼šè¢«ç§»åˆ°è€ç”Ÿä»£ä¸­ã€‚</li></ol><h2 id="JAVA-å››ç§å¼•ç”¨ç±»å‹"><a href="#JAVA-å››ç§å¼•ç”¨ç±»å‹" class="headerlink" title="JAVA å››ç§å¼•ç”¨ç±»å‹"></a>JAVA å››ç§å¼•ç”¨ç±»å‹</h2><h3 id="å¼ºå¼•ç”¨"><a href="#å¼ºå¼•ç”¨" class="headerlink" title="å¼ºå¼•ç”¨"></a>å¼ºå¼•ç”¨</h3><p>åœ¨ Java ä¸­æœ€å¸¸è§çš„å°±æ˜¯å¼ºå¼•ç”¨ï¼ŒæŠŠä¸€ä¸ªå¯¹è±¡èµ‹ç»™ä¸€ä¸ªå¼•ç”¨å˜é‡ï¼Œè¿™ä¸ªå¼•ç”¨å˜é‡å°±æ˜¯ä¸€ä¸ªå¼ºå¼•ç”¨ã€‚å½“ä¸€ä¸ªå¯¹è±¡è¢«å¼ºå¼•ç”¨å˜é‡å¼•ç”¨æ—¶ï¼Œå®ƒå¤„äºå¯è¾¾çŠ¶æ€ï¼Œå®ƒæ˜¯ä¸å¯èƒ½è¢«åƒåœ¾å›æ”¶æœºåˆ¶å›æ”¶çš„ï¼Œå³ä½¿è¯¥å¯¹è±¡ä»¥åæ°¸è¿œéƒ½ä¸ä¼šè¢«ç”¨åˆ° JVM ä¹Ÿä¸ä¼šå›æ”¶ã€‚å› æ­¤å¼ºå¼•ç”¨æ˜¯é€ æˆ Java å†…å­˜æ³„æ¼çš„ä¸»è¦åŸå› ä¹‹ä¸€ã€‚</p><h3 id="è½¯å¼•ç”¨"><a href="#è½¯å¼•ç”¨" class="headerlink" title="è½¯å¼•ç”¨"></a>è½¯å¼•ç”¨</h3><p>è½¯å¼•ç”¨éœ€è¦ç”¨ SoftReferenceç±»æ¥å®ç°ï¼Œå¯¹äºåªæœ‰è½¯å¼•ç”¨çš„å¯¹è±¡æ¥è¯´ï¼Œå½“ç³»ç»Ÿå†…å­˜è¶³å¤Ÿæ—¶å®ƒä¸ä¼šè¢«å›æ”¶ï¼Œå½“ç³»ç»Ÿå†…å­˜ç©ºé—´ä¸è¶³æ—¶å®ƒä¼šè¢«å›æ”¶ã€‚è½¯å¼•ç”¨é€šå¸¸ç”¨åœ¨å¯¹å†…å­˜æ•æ„Ÿçš„ç¨‹åºä¸­ã€‚</p><h3 id="å¼±å¼•ç”¨"><a href="#å¼±å¼•ç”¨" class="headerlink" title="å¼±å¼•ç”¨"></a>å¼±å¼•ç”¨</h3><p>å¼±å¼•ç”¨éœ€è¦ç”¨ WeakReferenceç±»æ¥å®ç°ï¼Œå®ƒæ¯”è½¯å¼•ç”¨çš„ç”Ÿå­˜æœŸæ›´çŸ­ï¼Œå¯¹äºåªæœ‰å¼±å¼•ç”¨çš„å¯¹è±¡æ¥è¯´ï¼Œåªè¦åƒåœ¾å›æ”¶æœºåˆ¶ä¸€è¿è¡Œï¼Œä¸ç®¡JVMçš„å†…å­˜ç©ºé—´æ˜¯å¦è¶³å¤Ÿï¼Œæ€»ä¼šå›æ”¶è¯¥å¯¹è±¡å ç”¨çš„å†…å­˜ã€‚</p><h3 id="è™šå¼•ç”¨"><a href="#è™šå¼•ç”¨" class="headerlink" title="è™šå¼•ç”¨"></a>è™šå¼•ç”¨</h3><p>è™šå¼•ç”¨éœ€è¦ PhantomReferenceç±»æ¥å®ç°ï¼Œå®ƒä¸èƒ½å•ç‹¬ä½¿ç”¨ï¼Œå¿…é¡»å’Œå¼•ç”¨é˜Ÿåˆ—è”åˆä½¿ç”¨ã€‚è™šå¼•ç”¨çš„ä¸»è¦ä½œç”¨æ˜¯è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶çš„çŠ¶æ€ã€‚</p><h2 id="GC-åˆ†ä»£æ”¶é›†ç®—æ³•-VS-åˆ†åŒºæ”¶é›†ç®—æ³•"><a href="#GC-åˆ†ä»£æ”¶é›†ç®—æ³•-VS-åˆ†åŒºæ”¶é›†ç®—æ³•" class="headerlink" title="GC åˆ†ä»£æ”¶é›†ç®—æ³• VS åˆ†åŒºæ”¶é›†ç®—æ³•"></a>GC åˆ†ä»£æ”¶é›†ç®—æ³• VS åˆ†åŒºæ”¶é›†ç®—æ³•</h2><h3 id="åˆ†ä»£æ”¶é›†ç®—æ³•-1"><a href="#åˆ†ä»£æ”¶é›†ç®—æ³•-1" class="headerlink" title="åˆ†ä»£æ”¶é›†ç®—æ³•"></a>åˆ†ä»£æ”¶é›†ç®—æ³•</h3><p>å½“å‰ä¸»æµ VM åƒåœ¾æ”¶é›†éƒ½é‡‡ç”¨â€åˆ†ä»£æ”¶é›†â€(Generational Collection)ç®—æ³•,è¿™ç§ç®—æ³•ä¼šæ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸ºå‡ å—,å¦‚JVMä¸­çš„æ–°ç”Ÿä»£ã€è€å¹´ä»£ã€æ°¸ä¹…ä»£ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®å„å¹´ä»£ç‰¹ç‚¹åˆ†åˆ«é‡‡ç”¨æœ€é€‚å½“çš„ GC ç®—æ³•</p><h4 id="åœ¨æ–°ç”Ÿä»£-å¤åˆ¶ç®—æ³•"><a href="#åœ¨æ–°ç”Ÿä»£-å¤åˆ¶ç®—æ³•" class="headerlink" title="åœ¨æ–°ç”Ÿä»£-å¤åˆ¶ç®—æ³•"></a>åœ¨æ–°ç”Ÿä»£-å¤åˆ¶ç®—æ³•</h4><p>æ¯æ¬¡åƒåœ¾æ”¶é›†éƒ½èƒ½å‘ç°å¤§æ‰¹å¯¹è±¡å·²æ­», åªæœ‰å°‘é‡å­˜æ´». å› æ­¤é€‰ç”¨å¤åˆ¶ç®—æ³•,åªéœ€è¦ä»˜å‡ºå°‘é‡å­˜æ´»å¯¹è±¡çš„å¤åˆ¶æˆæœ¬å°±å¯ä»¥å®Œæˆæ”¶é›†.</p><h4 id="åœ¨è€å¹´ä»£-æ ‡è®°æ•´ç†ç®—æ³•"><a href="#åœ¨è€å¹´ä»£-æ ‡è®°æ•´ç†ç®—æ³•" class="headerlink" title="åœ¨è€å¹´ä»£-æ ‡è®°æ•´ç†ç®—æ³•"></a>åœ¨è€å¹´ä»£-æ ‡è®°æ•´ç†ç®—æ³•</h4><p>å› ä¸ºå¯¹è±¡å­˜æ´»ç‡é«˜ã€æ²¡æœ‰é¢å¤–ç©ºé—´å¯¹å®ƒè¿›è¡Œåˆ†é…æ‹…ä¿, å°±å¿…é¡»é‡‡ç”¨â€œæ ‡è®°â€”æ¸…ç†â€æˆ–â€œæ ‡è®°â€”æ•´ç†â€ç®—æ³•æ¥è¿›è¡Œå›æ”¶, ä¸å¿…è¿›è¡Œå†…å­˜å¤åˆ¶, ä¸”ç›´æ¥è…¾å‡ºç©ºé—²å†…å­˜.</p><h3 id="åˆ†åŒºæ”¶é›†ç®—æ³•"><a href="#åˆ†åŒºæ”¶é›†ç®—æ³•" class="headerlink" title="åˆ†åŒºæ”¶é›†ç®—æ³•"></a>åˆ†åŒºæ”¶é›†ç®—æ³•</h3><p>åˆ†åŒºç®—æ³•åˆ™å°†æ•´ä¸ªå †ç©ºé—´åˆ’åˆ†ä¸ºè¿ç»­çš„ä¸åŒå°åŒºé—´, æ¯ä¸ªå°åŒºé—´ç‹¬ç«‹ä½¿ç”¨, ç‹¬ç«‹å›æ”¶. è¿™æ ·åšçš„å¥½å¤„æ˜¯å¯ä»¥æ§åˆ¶ä¸€æ¬¡å›æ”¶å¤šå°‘ä¸ªå°åŒºé—´ , æ ¹æ®ç›®æ ‡åœé¡¿æ—¶é—´, æ¯æ¬¡åˆç†åœ°å›æ”¶è‹¥å¹²ä¸ªå°åŒºé—´(è€Œä¸æ˜¯æ•´ä¸ªå †), ä»è€Œå‡å°‘ä¸€æ¬¡ GC æ‰€äº§ç”Ÿçš„åœé¡¿ã€‚</p><h2 id="GC-åƒåœ¾æ”¶é›†å™¨"><a href="#GC-åƒåœ¾æ”¶é›†å™¨" class="headerlink" title="GC åƒåœ¾æ”¶é›†å™¨"></a>GC åƒåœ¾æ”¶é›†å™¨</h2><p>Java å †å†…å­˜è¢«åˆ’åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸¤éƒ¨åˆ†ï¼Œæ–°ç”Ÿä»£ä¸»è¦ä½¿ç”¨å¤åˆ¶å’Œæ ‡è®°-æ¸…é™¤åƒåœ¾å›æ”¶ç®—æ³•ï¼›è€å¹´ä»£ä¸»è¦ä½¿ç”¨æ ‡è®°-æ•´ç†åƒåœ¾å›æ”¶ç®—æ³•ï¼Œå› æ­¤ java è™šæ‹Ÿä¸­é’ˆå¯¹æ–°ç”Ÿä»£å’Œè€å¹´ä»£åˆ†åˆ«æä¾›äº†å¤šç§ä¸åŒçš„åƒåœ¾æ”¶é›†å™¨ï¼ŒJDK1.6 ä¸­ Sun HotSpot è™šæ‹Ÿæœºçš„åƒåœ¾æ”¶é›†å™¨å¦‚ä¸‹</p><h3 id="Serial-åƒåœ¾æ”¶é›†å™¨ï¼ˆå•çº¿ç¨‹ã€å¤åˆ¶ç®—æ³•ï¼‰"><a href="#Serial-åƒåœ¾æ”¶é›†å™¨ï¼ˆå•çº¿ç¨‹ã€å¤åˆ¶ç®—æ³•ï¼‰" class="headerlink" title="Serial åƒåœ¾æ”¶é›†å™¨ï¼ˆå•çº¿ç¨‹ã€å¤åˆ¶ç®—æ³•ï¼‰"></a>Serial åƒåœ¾æ”¶é›†å™¨ï¼ˆå•çº¿ç¨‹ã€å¤åˆ¶ç®—æ³•ï¼‰</h3><p>Serialï¼ˆè‹±æ–‡è¿ç»­ï¼‰æ˜¯æœ€åŸºæœ¬åƒåœ¾æ”¶é›†å™¨ï¼Œä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œæ›¾ç»æ˜¯JDK1.3.1 ä¹‹å‰æ–°ç”Ÿä»£å”¯ä¸€çš„åƒåœ¾<br>æ”¶é›†å™¨ã€‚Serialæ˜¯ä¸€ä¸ªå•çº¿ç¨‹çš„æ”¶é›†å™¨ï¼Œå®ƒä¸ä½†åªä¼šä½¿ç”¨ä¸€ä¸ªCPUæˆ–ä¸€æ¡çº¿ç¨‹å»å®Œæˆåƒåœ¾æ”¶é›†å·¥ä½œï¼Œå¹¶ä¸”åœ¨è¿›è¡Œåƒåœ¾æ”¶é›†çš„åŒæ—¶ï¼Œå¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ï¼Œç›´åˆ°åƒåœ¾æ”¶é›†ç»“æŸã€‚<br>Serial åƒåœ¾æ”¶é›†å™¨è™½ç„¶åœ¨æ”¶é›†åƒåœ¾è¿‡ç¨‹ä¸­éœ€è¦æš‚åœæ‰€æœ‰å…¶ä»–çš„å·¥ä½œçº¿ç¨‹ï¼Œä½†æ˜¯å®ƒç®€å•é«˜æ•ˆï¼Œå¯¹äºé™å®šå•ä¸ªCPUç¯å¢ƒæ¥è¯´ï¼Œæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œå¯ä»¥è·å¾—æœ€é«˜çš„å•çº¿ç¨‹åƒåœ¾æ”¶é›†æ•ˆç‡ï¼Œå› æ­¤ Serialåƒåœ¾æ”¶é›†å™¨ä¾ç„¶æ˜¯ java è™šæ‹Ÿæœºè¿è¡Œåœ¨ Client æ¨¡å¼ä¸‹é»˜è®¤çš„æ–°ç”Ÿä»£åƒåœ¾æ”¶é›†å™¨ã€‚</p><h3 id="ParNew-åƒåœ¾æ”¶é›†å™¨ï¼ˆSerial-å¤šçº¿ç¨‹ï¼‰"><a href="#ParNew-åƒåœ¾æ”¶é›†å™¨ï¼ˆSerial-å¤šçº¿ç¨‹ï¼‰" class="headerlink" title="ParNew åƒåœ¾æ”¶é›†å™¨ï¼ˆSerial+å¤šçº¿ç¨‹ï¼‰"></a>ParNew åƒåœ¾æ”¶é›†å™¨ï¼ˆSerial+å¤šçº¿ç¨‹ï¼‰</h3><p>ParNew åƒåœ¾æ”¶é›†å™¨å…¶å®æ˜¯ Serial æ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼Œä¹Ÿä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œé™¤äº†ä½¿ç”¨å¤šçº¿ç¨‹è¿›è¡Œåƒåœ¾æ”¶é›†ä¹‹å¤–ï¼Œå…¶ä½™çš„è¡Œä¸ºå’Œ Serial æ”¶é›†å™¨å®Œå…¨ä¸€æ ·ï¼ŒParNewåƒåœ¾æ”¶é›†å™¨åœ¨åƒåœ¾æ”¶é›†è¿‡ç¨‹ä¸­åŒæ ·ä¹Ÿè¦æš‚åœæ‰€æœ‰å…¶ä»–çš„å·¥ä½œçº¿ç¨‹ã€‚ParNewæ”¶é›†å™¨é»˜è®¤å¼€å¯å’ŒCPUæ•°ç›®ç›¸åŒçš„çº¿ç¨‹æ•°ï¼Œå¯ä»¥é€šè¿‡-XX:ParallelGCThreadså‚æ•°æ¥é™åˆ¶åƒåœ¾æ”¶é›†å™¨çš„çº¿ç¨‹æ•°ã€‚ã€Parallelï¼šå¹³è¡Œçš„ã€‘ParNewè™½ç„¶æ˜¯é™¤äº†å¤šçº¿ç¨‹å¤–å’ŒSerialæ”¶é›†å™¨å‡ ä¹å®Œå…¨ä¸€æ ·ï¼Œä½†æ˜¯ParNewåƒåœ¾æ”¶é›†å™¨æ˜¯å¾ˆå¤šjavaè™šæ‹Ÿæœºè¿è¡Œåœ¨Serveræ¨¡å¼ä¸‹æ–°ç”Ÿä»£çš„é»˜è®¤åƒåœ¾æ”¶é›†å™¨ã€‚</p><h3 id="Parallel-Scavengeæ”¶é›†å™¨ï¼ˆå¤šçº¿ç¨‹å¤åˆ¶ç®—æ³•ã€é«˜æ•ˆï¼‰"><a href="#Parallel-Scavengeæ”¶é›†å™¨ï¼ˆå¤šçº¿ç¨‹å¤åˆ¶ç®—æ³•ã€é«˜æ•ˆï¼‰" class="headerlink" title="Parallel Scavengeæ”¶é›†å™¨ï¼ˆå¤šçº¿ç¨‹å¤åˆ¶ç®—æ³•ã€é«˜æ•ˆï¼‰"></a>Parallel Scavengeæ”¶é›†å™¨ï¼ˆå¤šçº¿ç¨‹å¤åˆ¶ç®—æ³•ã€é«˜æ•ˆï¼‰</h3><p>Parallel Scavenge æ”¶é›†å™¨ä¹Ÿæ˜¯ä¸€ä¸ªæ–°ç”Ÿä»£åƒåœ¾æ”¶é›†å™¨ï¼ŒåŒæ ·ä½¿ç”¨å¤åˆ¶ç®—æ³•ï¼Œä¹Ÿæ˜¯ä¸€ä¸ªå¤šçº¿ç¨‹çš„åƒåœ¾æ”¶é›†å™¨ï¼Œå®ƒé‡ç‚¹å…³æ³¨çš„æ˜¯ç¨‹åºè¾¾åˆ°ä¸€ä¸ªå¯æ§åˆ¶çš„ååé‡ï¼ˆThoughputï¼ŒCPU ç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´/CPU æ€»æ¶ˆè€—æ—¶é—´ï¼Œå³ååé‡=è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´/(è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´+åƒåœ¾æ”¶é›†æ—¶é—´)ï¼‰ï¼Œ<br>é«˜ååé‡å¯ä»¥æœ€é«˜æ•ˆç‡åœ°åˆ©ç”¨ CPU æ—¶é—´ï¼Œå°½å¿«åœ°å®Œæˆç¨‹åºçš„è¿ç®—ä»»åŠ¡ï¼Œä¸»è¦é€‚ç”¨äºåœ¨åå°è¿ç®—è€Œä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡ã€‚è‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥ä¹Ÿæ˜¯ ParallelScavenge æ”¶é›†å™¨ä¸ ParNew æ”¶é›†å™¨çš„ä¸€ä¸ªé‡è¦åŒºåˆ«ã€‚</p><h3 id="Serial-Old-æ”¶é›†å™¨ï¼ˆå•çº¿ç¨‹æ ‡è®°æ•´ç†ç®—æ³•-ï¼‰"><a href="#Serial-Old-æ”¶é›†å™¨ï¼ˆå•çº¿ç¨‹æ ‡è®°æ•´ç†ç®—æ³•-ï¼‰" class="headerlink" title="Serial Old æ”¶é›†å™¨ï¼ˆå•çº¿ç¨‹æ ‡è®°æ•´ç†ç®—æ³• ï¼‰"></a>Serial Old æ”¶é›†å™¨ï¼ˆå•çº¿ç¨‹æ ‡è®°æ•´ç†ç®—æ³• ï¼‰</h3><p>Serial Old æ˜¯ Serial åƒåœ¾æ”¶é›†å™¨å¹´è€ä»£ç‰ˆæœ¬ï¼Œå®ƒåŒæ ·æ˜¯ä¸ªå•çº¿ç¨‹çš„æ”¶é›†å™¨ï¼Œä½¿ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ï¼Œè¿™ä¸ªæ”¶é›†å™¨ä¹Ÿä¸»è¦æ˜¯è¿è¡Œåœ¨ Client é»˜è®¤çš„ java è™šæ‹Ÿæœºé»˜è®¤çš„å¹´è€ä»£åƒåœ¾æ”¶é›†å™¨ã€‚</p><p>åœ¨ Server æ¨¡å¼ä¸‹ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªç”¨é€”ï¼š</p><ol><li>åœ¨ JDK1.5 ä¹‹å‰ç‰ˆæœ¬ä¸­ä¸æ–°ç”Ÿä»£çš„ Parallel Scavenge æ”¶é›†å™¨æ­é…ä½¿ç”¨ã€‚</li><li>ä½œä¸ºå¹´è€ä»£ä¸­ä½¿ç”¨ CMS æ”¶é›†å™¨çš„åå¤‡åƒåœ¾æ”¶é›†æ–¹æ¡ˆã€‚</li></ol><p>æ–°ç”Ÿä»£ Serial ä¸å¹´è€ä»£ Serial Old æ­é…åƒåœ¾æ”¶é›†è¿‡ç¨‹å›¾ï¼š</p><p>æ–°ç”Ÿä»£ Parallel Scavenge æ”¶é›†å™¨ä¸ ParNewæ”¶é›†å™¨å·¥ä½œåŸç†ç±»ä¼¼ï¼Œéƒ½æ˜¯å¤šçº¿ç¨‹çš„æ”¶é›†å™¨ï¼Œéƒ½ä½¿ç”¨çš„æ˜¯å¤åˆ¶ç®—æ³•ï¼Œåœ¨åƒåœ¾æ”¶é›†è¿‡ç¨‹ä¸­éƒ½éœ€è¦æš‚åœæ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ã€‚æ–°ç”Ÿä»£ Parallel<br>Scavenge/ParNew ä¸å¹´è€ä»£ Serial Old æ­é…åƒåœ¾æ”¶é›†è¿‡ç¨‹å›¾</p><h3 id="Parallel-Old-æ”¶é›†å™¨ï¼ˆå¤šçº¿ç¨‹æ ‡è®°æ•´ç†ç®—æ³•ï¼‰"><a href="#Parallel-Old-æ”¶é›†å™¨ï¼ˆå¤šçº¿ç¨‹æ ‡è®°æ•´ç†ç®—æ³•ï¼‰" class="headerlink" title="Parallel Old æ”¶é›†å™¨ï¼ˆå¤šçº¿ç¨‹æ ‡è®°æ•´ç†ç®—æ³•ï¼‰"></a>Parallel Old æ”¶é›†å™¨ï¼ˆå¤šçº¿ç¨‹æ ‡è®°æ•´ç†ç®—æ³•ï¼‰</h3><p>Parallel Old æ”¶é›†å™¨æ˜¯Parallel Scavengeçš„å¹´è€ä»£ç‰ˆæœ¬ï¼Œä½¿ç”¨å¤šçº¿ç¨‹çš„æ ‡è®°-æ•´ç†ç®—æ³•ï¼Œåœ¨ JDK1.6æ‰å¼€å§‹æä¾›ã€‚<br>åœ¨ JDK1.6 ä¹‹å‰ï¼Œæ–°ç”Ÿä»£ä½¿ç”¨ ParallelScavenge æ”¶é›†å™¨åªèƒ½æ­é…å¹´è€ä»£çš„ Serial Oldæ”¶é›†å™¨ï¼Œåªèƒ½ä¿è¯æ–°ç”Ÿä»£çš„ååé‡ä¼˜å…ˆï¼Œæ— æ³•ä¿è¯æ•´ä½“çš„ååé‡ï¼ŒParallel Old æ­£æ˜¯ä¸ºäº†åœ¨å¹´è€ä»£åŒæ ·æä¾›ååé‡ä¼˜å…ˆçš„åƒåœ¾æ”¶é›†å™¨ï¼Œå¦‚æœç³»ç»Ÿå¯¹ååé‡è¦æ±‚æ¯”è¾ƒé«˜ï¼Œå¯ä»¥ä¼˜å…ˆè€ƒè™‘æ–°ç”Ÿä»£ Parallel Scavengeå’Œå¹´è€ä»£ Parallel Old æ”¶é›†å™¨çš„æ­é…ç­–ç•¥ã€‚<br>æ–°ç”Ÿä»£ Parallel Scavenge å’Œå¹´è€ä»£ Parallel Old æ”¶é›†å™¨æ­é…è¿è¡Œè¿‡ç¨‹å›¾ï¼š</p><h3 id="CMS-æ”¶é›†å™¨ï¼ˆå¤šçº¿ç¨‹æ ‡è®°æ¸…é™¤ç®—æ³•ï¼‰"><a href="#CMS-æ”¶é›†å™¨ï¼ˆå¤šçº¿ç¨‹æ ‡è®°æ¸…é™¤ç®—æ³•ï¼‰" class="headerlink" title="CMS æ”¶é›†å™¨ï¼ˆå¤šçº¿ç¨‹æ ‡è®°æ¸…é™¤ç®—æ³•ï¼‰"></a>CMS æ”¶é›†å™¨ï¼ˆå¤šçº¿ç¨‹æ ‡è®°æ¸…é™¤ç®—æ³•ï¼‰</h3><p>Concurrent mark sweep(CMS)æ”¶é›†å™¨æ˜¯ä¸€ç§å¹´è€ä»£åƒåœ¾æ”¶é›†å™¨ï¼Œå…¶æœ€ä¸»è¦ç›®æ ‡æ˜¯è·å–æœ€çŸ­åƒåœ¾å›æ”¶åœé¡¿æ—¶é—´ï¼Œå’Œå…¶ä»–å¹´è€ä»£ä½¿ç”¨æ ‡è®°-æ•´ç†ç®—æ³•ä¸åŒï¼Œå®ƒä½¿ç”¨å¤šçº¿ç¨‹çš„æ ‡è®°-æ¸…é™¤ç®—æ³•ã€‚æœ€çŸ­çš„åƒåœ¾æ”¶é›†åœé¡¿æ—¶é—´å¯ä»¥ä¸ºäº¤äº’æ¯”è¾ƒé«˜çš„ç¨‹åºæé«˜ç”¨æˆ·ä½“éªŒã€‚</p><p>CMS å·¥ä½œæœºåˆ¶ç›¸æ¯”å…¶ä»–çš„åƒåœ¾æ”¶é›†å™¨æ¥è¯´æ›´å¤æ‚ï¼Œæ•´ä¸ªè¿‡ç¨‹åˆ†ä¸ºä»¥ä¸‹ 4 ä¸ªé˜¶æ®µï¼š</p><h4 id="åˆå§‹æ ‡è®°"><a href="#åˆå§‹æ ‡è®°" class="headerlink" title="åˆå§‹æ ‡è®°"></a>åˆå§‹æ ‡è®°</h4><p>åªæ˜¯æ ‡è®°ä¸€ä¸‹ GC Roots èƒ½ç›´æ¥å…³è”çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œä»ç„¶éœ€è¦æš‚åœæ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ã€‚</p><h4 id="å¹¶å‘æ ‡è®°"><a href="#å¹¶å‘æ ‡è®°" class="headerlink" title="å¹¶å‘æ ‡è®°"></a>å¹¶å‘æ ‡è®°</h4><p>è¿›è¡Œ GC Roots è·Ÿè¸ªçš„è¿‡ç¨‹ï¼Œå’Œç”¨æˆ·çº¿ç¨‹ä¸€èµ·å·¥ä½œï¼Œä¸éœ€è¦æš‚åœå·¥ä½œçº¿ç¨‹ã€‚</p><h4 id="é‡æ–°æ ‡è®°"><a href="#é‡æ–°æ ‡è®°" class="headerlink" title="é‡æ–°æ ‡è®°"></a>é‡æ–°æ ‡è®°</h4><p>ä¸ºäº†ä¿®æ­£åœ¨å¹¶å‘æ ‡è®°æœŸé—´ï¼Œå› ç”¨æˆ·ç¨‹åºç»§ç»­è¿è¡Œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œä»ç„¶éœ€è¦æš‚åœæ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ã€‚</p><h4 id="å¹¶å‘æ¸…é™¤"><a href="#å¹¶å‘æ¸…é™¤" class="headerlink" title="å¹¶å‘æ¸…é™¤"></a>å¹¶å‘æ¸…é™¤</h4><p>æ¸…é™¤ GC Roots ä¸å¯è¾¾å¯¹è±¡ï¼Œå’Œç”¨æˆ·çº¿ç¨‹ä¸€èµ·å·¥ä½œï¼Œä¸éœ€è¦æš‚åœå·¥ä½œçº¿ç¨‹ã€‚ç”±äºè€—æ—¶æœ€é•¿çš„å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…é™¤è¿‡ç¨‹ä¸­ï¼Œåƒåœ¾æ”¶é›†çº¿ç¨‹å¯ä»¥å’Œç”¨æˆ·ç°åœ¨ä¸€èµ·å¹¶å‘å·¥ä½œï¼Œæ‰€ä»¥æ€»ä½“ä¸Šæ¥çœ‹CMS æ”¶é›†å™¨çš„å†…å­˜å›æ”¶å’Œç”¨æˆ·çº¿ç¨‹æ˜¯ä¸€èµ·å¹¶å‘åœ°æ‰§è¡Œã€‚<br>CMS æ”¶é›†å™¨å·¥ä½œè¿‡ç¨‹ï¼š</p><h3 id="G1-æ”¶é›†å™¨"><a href="#G1-æ”¶é›†å™¨" class="headerlink" title="G1 æ”¶é›†å™¨"></a>G1 æ”¶é›†å™¨</h3><p>Garbage first åƒåœ¾æ”¶é›†å™¨æ˜¯ç›®å‰åƒåœ¾æ”¶é›†å™¨ç†è®ºå‘å±•çš„æœ€å‰æ²¿æˆæœï¼Œç›¸æ¯”ä¸ CMS æ”¶é›†å™¨ï¼ŒG1 æ”¶é›†å™¨ä¸¤ä¸ªæœ€çªå‡ºçš„æ”¹è¿›æ˜¯ï¼š</p><ol><li>åŸºäºæ ‡è®°-æ•´ç†ç®—æ³•ï¼Œä¸äº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚</li><li>å¯ä»¥éå¸¸ç²¾ç¡®æ§åˆ¶åœé¡¿æ—¶é—´ï¼Œåœ¨ä¸ç‰ºç‰²ååé‡å‰æä¸‹ï¼Œå®ç°ä½åœé¡¿åƒåœ¾å›æ”¶ã€‚G1 æ”¶é›†å™¨é¿å…å…¨åŒºåŸŸåƒåœ¾æ”¶é›†ï¼Œå®ƒæŠŠå †å†…å­˜åˆ’åˆ†ä¸ºå¤§å°å›ºå®šçš„å‡ ä¸ªç‹¬ç«‹åŒºåŸŸï¼Œå¹¶ä¸”è·Ÿè¸ªè¿™äº›åŒºåŸŸçš„åƒåœ¾æ”¶é›†è¿›åº¦ï¼ŒåŒæ—¶åœ¨åå°ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆçº§åˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®æ‰€å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆå›æ”¶åƒåœ¾æœ€å¤šçš„åŒºåŸŸã€‚åŒºåŸŸåˆ’åˆ†å’Œä¼˜å…ˆçº§åŒºåŸŸå›æ”¶æœºåˆ¶ï¼Œç¡®ä¿ G1 æ”¶é›†å™¨å¯ä»¥åœ¨æœ‰é™æ—¶é—´è·å¾—æœ€é«˜çš„åƒåœ¾æ”¶é›†æ•ˆç‡ã€‚</li></ol><h2 id="JAVA-IO-NIO"><a href="#JAVA-IO-NIO" class="headerlink" title="JAVA IO/NIO"></a>JAVA IO/NIO</h2><h3 id="é˜»å¡-IO-æ¨¡å‹"><a href="#é˜»å¡-IO-æ¨¡å‹" class="headerlink" title="é˜»å¡ IO æ¨¡å‹"></a>é˜»å¡ IO æ¨¡å‹</h3><p>æœ€ä¼ ç»Ÿçš„ä¸€ç§ IOæ¨¡å‹ï¼Œå³åœ¨è¯»å†™æ•°æ®è¿‡ç¨‹ä¸­ä¼šå‘ç”Ÿé˜»å¡ç°è±¡ã€‚å½“ç”¨æˆ·çº¿ç¨‹å‘å‡ºIOè¯·æ±‚ä¹‹åï¼Œå†…æ ¸ä¼šå»æŸ¥çœ‹æ•°æ®æ˜¯å¦å°±ç»ªï¼Œå¦‚æœæ²¡æœ‰å°±ç»ªå°±ä¼šç­‰å¾…æ•°æ®å°±ç»ªï¼Œè€Œç”¨æˆ·çº¿ç¨‹å°±ä¼šå¤„äºé˜»å¡çŠ¶æ€ï¼Œç”¨æˆ·çº¿ç¨‹äº¤å‡º CPUã€‚å½“æ•°æ®å°±ç»ªä¹‹åï¼Œå†…æ ¸ä¼šå°†æ•°æ®æ‹·è´åˆ°ç”¨æˆ·çº¿ç¨‹ï¼Œå¹¶è¿”å›ç»“æœç»™ç”¨æˆ·çº¿ç¨‹ï¼Œç”¨æˆ·çº¿ç¨‹æ‰è§£é™¤ block çŠ¶æ€ã€‚å…¸å‹çš„é˜»å¡ IO æ¨¡å‹çš„ä¾‹å­ä¸ºï¼šdata = socket.read();å¦‚æœæ•°æ®æ²¡æœ‰å°±ç»ªï¼Œå°±ä¼šä¸€ç›´é˜»å¡åœ¨ read æ–¹æ³•ã€‚</p><h3 id="éé˜»å¡-IO-æ¨¡å‹"><a href="#éé˜»å¡-IO-æ¨¡å‹" class="headerlink" title="éé˜»å¡ IO æ¨¡å‹"></a>éé˜»å¡ IO æ¨¡å‹</h3><p>å½“ç”¨æˆ·çº¿ç¨‹å‘èµ·ä¸€ä¸ª read æ“ä½œåï¼Œå¹¶ä¸éœ€è¦ç­‰å¾…ï¼Œè€Œæ˜¯é©¬ä¸Šå°±å¾—åˆ°äº†ä¸€ä¸ªç»“æœã€‚å¦‚æœç»“æœæ˜¯ä¸€ä¸ªerror æ—¶ï¼Œå®ƒå°±çŸ¥é“æ•°æ®è¿˜æ²¡æœ‰å‡†å¤‡å¥½ï¼Œäºæ˜¯å®ƒå¯ä»¥å†æ¬¡å‘é€ read æ“ä½œã€‚ä¸€æ—¦å†…æ ¸ä¸­çš„æ•°æ®å‡†å¤‡å¥½äº†ï¼Œå¹¶ä¸”åˆå†æ¬¡æ”¶åˆ°äº†ç”¨æˆ·çº¿ç¨‹çš„è¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒé©¬ä¸Šå°±å°†æ•°æ®æ‹·è´åˆ°äº†ç”¨æˆ·çº¿ç¨‹ï¼Œç„¶åè¿”å›ã€‚æ‰€ä»¥äº‹å®ä¸Šï¼Œåœ¨éé˜»å¡ IO æ¨¡å‹ä¸­ï¼Œç”¨æˆ·çº¿ç¨‹éœ€è¦ä¸æ–­åœ°è¯¢é—®å†…æ ¸æ•°æ®æ˜¯å¦å°±ç»ªï¼Œä¹Ÿå°±è¯´éé˜»å¡ IOä¸ä¼šäº¤å‡º CPUï¼Œè€Œä¼šä¸€ç›´å ç”¨ CPUã€‚å…¸å‹çš„éé˜»å¡ IO æ¨¡å‹ä¸€èˆ¬å¦‚ä¸‹ï¼š</p><pre><code>while(true){    data = socket.read();    if(data!= error){    å¤„ç†æ•°æ®    break;    }}</code></pre><p>ä½†æ˜¯å¯¹äºéé˜»å¡ IO å°±æœ‰ä¸€ä¸ªéå¸¸ä¸¥é‡çš„é—®é¢˜ï¼Œåœ¨ while å¾ªç¯ä¸­éœ€è¦ä¸æ–­åœ°å»è¯¢é—®å†…æ ¸æ•°æ®æ˜¯å¦å°±ç»ªï¼Œè¿™æ ·ä¼šå¯¼è‡´ CPU å ç”¨ç‡éå¸¸é«˜ï¼Œå› æ­¤ä¸€èˆ¬æƒ…å†µä¸‹å¾ˆå°‘ä½¿ç”¨ while å¾ªç¯è¿™ç§æ–¹å¼æ¥è¯»å–æ•°æ®ã€‚ä½†æ˜¯å¯¹äºéé˜»å¡ IO å°±æœ‰ä¸€ä¸ªéå¸¸ä¸¥é‡çš„é—®é¢˜ï¼Œåœ¨ while å¾ªç¯ä¸­éœ€è¦ä¸æ–­åœ°å»è¯¢é—®å†…æ ¸æ•°æ®æ˜¯å¦å°±ç»ªï¼Œè¿™æ ·ä¼šå¯¼è‡´ CPU å ç”¨ç‡éå¸¸é«˜ï¼Œå› æ­¤ä¸€èˆ¬æƒ…å†µä¸‹å¾ˆå°‘ä½¿ç”¨ while å¾ªç¯è¿™ç§æ–¹å¼æ¥è¯»å–æ•°æ®ã€‚</p><h3 id="å¤šè·¯å¤ç”¨-IO-æ¨¡å‹"><a href="#å¤šè·¯å¤ç”¨-IO-æ¨¡å‹" class="headerlink" title="å¤šè·¯å¤ç”¨ IO æ¨¡å‹"></a>å¤šè·¯å¤ç”¨ IO æ¨¡å‹</h3><p>å¤šè·¯å¤ç”¨ IO æ¨¡å‹æ˜¯ç›®å‰ä½¿ç”¨å¾—æ¯”è¾ƒå¤šçš„æ¨¡å‹ã€‚Java NIO å®é™…ä¸Šå°±æ˜¯å¤šè·¯å¤ç”¨ IOã€‚åœ¨å¤šè·¯å¤ç”¨ IOæ¨¡å‹ä¸­ï¼Œä¼šæœ‰ä¸€ä¸ªçº¿ç¨‹ä¸æ–­å»è½®è¯¢å¤šä¸ª socket çš„çŠ¶æ€ï¼Œåªæœ‰å½“ socket çœŸæ­£æœ‰è¯»å†™äº‹ä»¶æ—¶ï¼Œæ‰çœŸæ­£è°ƒç”¨å®é™…çš„ IO è¯»å†™æ“ä½œã€‚å› ä¸ºåœ¨å¤šè·¯å¤ç”¨ IO æ¨¡å‹ä¸­ï¼Œåªéœ€è¦ä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹å°±å¯ä»¥ç®¡ç†å¤šä¸ª<br>socketï¼Œç³»ç»Ÿä¸éœ€è¦å»ºç«‹æ–°çš„è¿›ç¨‹æˆ–è€…çº¿ç¨‹ï¼Œä¹Ÿä¸å¿…ç»´æŠ¤è¿™äº›çº¿ç¨‹å’Œè¿›ç¨‹ï¼Œå¹¶ä¸”åªæœ‰åœ¨çœŸæ­£æœ‰socket è¯»å†™äº‹ä»¶è¿›è¡Œæ—¶ï¼Œæ‰ä¼šä½¿ç”¨ IO èµ„æºï¼Œæ‰€ä»¥å®ƒå¤§å¤§å‡å°‘äº†èµ„æºå ç”¨ã€‚åœ¨ Java NIO ä¸­ï¼Œæ˜¯é€šè¿‡ selector.select()å»æŸ¥è¯¢æ¯ä¸ªé€šé“æ˜¯å¦æœ‰åˆ°è¾¾äº‹ä»¶ï¼Œå¦‚æœæ²¡æœ‰äº‹ä»¶ï¼Œåˆ™ä¸€ç›´é˜»å¡åœ¨é‚£é‡Œï¼Œå› æ­¤è¿™<br>ç§æ–¹å¼ä¼šå¯¼è‡´ç”¨æˆ·çº¿ç¨‹çš„é˜»å¡ã€‚å¤šè·¯å¤ç”¨IOæ¨¡å¼ï¼Œé€šè¿‡ä¸€ä¸ªçº¿ç¨‹å°±å¯ä»¥ç®¡ç†å¤šä¸ªsocketï¼Œåªæœ‰å½“socketçœŸæ­£æœ‰è¯»å†™äº‹ä»¶å‘ç”Ÿæ‰ä¼šå ç”¨èµ„æºæ¥è¿›è¡Œå®é™…çš„è¯»å†™æ“ä½œã€‚å› æ­¤ï¼Œå¤šè·¯å¤ç”¨ IO æ¯”è¾ƒé€‚åˆè¿æ¥æ•°æ¯”è¾ƒå¤šçš„æƒ…å†µã€‚</p><p>å¦å¤–å¤šè·¯å¤ç”¨ IO ä¸ºä½•æ¯”éé˜»å¡ IO æ¨¡å‹çš„æ•ˆç‡é«˜æ˜¯å› ä¸ºåœ¨éé˜»å¡ IO ä¸­ï¼Œä¸æ–­åœ°è¯¢é—® socket çŠ¶æ€æ—¶é€šè¿‡ç”¨æˆ·çº¿ç¨‹å»è¿›è¡Œçš„ï¼Œè€Œåœ¨å¤šè·¯å¤ç”¨ IO ä¸­ï¼Œè½®è¯¢æ¯ä¸ª socket çŠ¶æ€æ˜¯å†…æ ¸åœ¨è¿›è¡Œçš„ï¼Œè¿™ä¸ªæ•ˆç‡è¦æ¯”ç”¨æˆ·çº¿ç¨‹è¦é«˜çš„å¤šã€‚</p><p>ä¸è¿‡è¦æ³¨æ„çš„æ˜¯ï¼Œå¤šè·¯å¤ç”¨ IO æ¨¡å‹æ˜¯é€šè¿‡è½®è¯¢çš„æ–¹å¼æ¥æ£€æµ‹æ˜¯å¦æœ‰äº‹ä»¶åˆ°è¾¾ï¼Œå¹¶ä¸”å¯¹åˆ°è¾¾çš„äº‹ä»¶é€ä¸€è¿›è¡Œå“åº”ã€‚å› æ­¤å¯¹äºå¤šè·¯å¤ç”¨ IO æ¨¡å‹æ¥è¯´ï¼Œä¸€æ—¦äº‹ä»¶å“åº”ä½“å¾ˆå¤§ï¼Œé‚£ä¹ˆå°±ä¼šå¯¼è‡´åç»­çš„äº‹ä»¶è¿Ÿè¿Ÿå¾—ä¸åˆ°å¤„ç†ï¼Œå¹¶ä¸”ä¼šå½±å“æ–°çš„äº‹ä»¶è½®è¯¢ã€‚</p><h3 id="ä¿¡å·é©±åŠ¨-IO-æ¨¡å‹"><a href="#ä¿¡å·é©±åŠ¨-IO-æ¨¡å‹" class="headerlink" title="ä¿¡å·é©±åŠ¨ IO æ¨¡å‹"></a>ä¿¡å·é©±åŠ¨ IO æ¨¡å‹</h3><p>åœ¨ä¿¡å·é©±åŠ¨ IO æ¨¡å‹ä¸­ï¼Œå½“ç”¨æˆ·çº¿ç¨‹å‘èµ·ä¸€ä¸ªIOè¯·æ±‚æ“ä½œï¼Œä¼šç»™å¯¹åº”çš„socketæ³¨å†Œä¸€ä¸ªä¿¡å·å‡½æ•°ï¼Œç„¶åç”¨æˆ·çº¿ç¨‹ä¼šç»§ç»­æ‰§è¡Œï¼Œå½“å†…æ ¸æ•°æ®å°±ç»ªæ—¶ä¼šå‘é€ä¸€ä¸ªä¿¡å·ç»™ç”¨æˆ·çº¿ç¨‹ï¼Œç”¨æˆ·çº¿ç¨‹æ¥æ”¶åˆ°ä¿¡å·ä¹‹åï¼Œä¾¿åœ¨ä¿¡å·å‡½æ•°ä¸­è°ƒç”¨ IO è¯»å†™æ“ä½œæ¥è¿›è¡Œå®é™…çš„ IO è¯·æ±‚æ“ä½œã€‚</p><h3 id="å¼‚æ­¥-IO-æ¨¡å‹"><a href="#å¼‚æ­¥-IO-æ¨¡å‹" class="headerlink" title="å¼‚æ­¥ IO æ¨¡å‹"></a>å¼‚æ­¥ IO æ¨¡å‹</h3><p>å¼‚æ­¥ IO æ¨¡å‹æ‰æ˜¯æœ€ç†æƒ³çš„ IO æ¨¡å‹ï¼Œåœ¨å¼‚æ­¥IOæ¨¡å‹ä¸­ï¼Œå½“ç”¨æˆ·çº¿ç¨‹å‘èµ·readæ“ä½œä¹‹åï¼Œç«‹åˆ»å°±å¯ä»¥å¼€å§‹å»åšå…¶å®ƒçš„äº‹ã€‚è€Œå¦ä¸€æ–¹é¢ï¼Œä»å†…æ ¸çš„è§’åº¦ï¼Œå½“å®ƒå—åˆ°ä¸€ä¸ª asynchronous read ä¹‹åï¼Œå®ƒä¼šç«‹åˆ»è¿”å›ï¼Œè¯´æ˜ read è¯·æ±‚å·²ç»æˆåŠŸå‘èµ·äº†ï¼Œå› æ­¤ä¸ä¼šå¯¹ç”¨æˆ·çº¿ç¨‹äº§ç”Ÿä»»ä½• blockã€‚ç„¶åï¼Œå†…æ ¸ä¼šç­‰å¾…æ•°æ®å‡†å¤‡å®Œæˆï¼Œç„¶åå°†æ•°æ®æ‹·è´åˆ°ç”¨æˆ·çº¿ç¨‹ï¼Œå½“è¿™ä¸€åˆ‡éƒ½å®Œæˆä¹‹åï¼Œå†…æ ¸ä¼šç»™ç”¨æˆ·çº¿ç¨‹å‘é€ä¸€ä¸ªä¿¡å·ï¼Œå‘Šè¯‰å®ƒ read æ“ä½œå®Œæˆäº†ã€‚ä¹Ÿå°±è¯´ç”¨æˆ·çº¿ç¨‹å®Œå…¨ä¸éœ€è¦å®é™…çš„æ•´ä¸ª IO æ“ä½œæ˜¯å¦‚ä½•è¿›è¡Œçš„ï¼Œåªéœ€è¦å…ˆå‘èµ·ä¸€ä¸ªè¯·æ±‚ï¼Œå½“æ¥æ”¶å†…æ ¸è¿”å›çš„æˆåŠŸä¿¡å·æ—¶è¡¨ç¤º IO æ“ä½œå·²ç»å®Œæˆï¼Œå¯ä»¥ç›´æ¥å»ä½¿ç”¨æ•°æ®äº†ã€‚<br>ä¹Ÿå°±è¯´åœ¨å¼‚æ­¥ IO æ¨¡å‹ä¸­ï¼ŒIO æ“ä½œçš„ä¸¤ä¸ªé˜¶æ®µéƒ½ä¸ä¼šé˜»å¡ç”¨æˆ·çº¿ç¨‹ï¼Œè¿™ä¸¤ä¸ªé˜¶æ®µéƒ½æ˜¯ç”±å†…æ ¸è‡ªåŠ¨å®Œæˆï¼Œç„¶åå‘é€ä¸€ä¸ªä¿¡å·å‘ŠçŸ¥ç”¨æˆ·çº¿ç¨‹æ“ä½œå·²å®Œæˆã€‚ç”¨æˆ·çº¿ç¨‹ä¸­ä¸éœ€è¦å†æ¬¡è°ƒç”¨ IO å‡½æ•°è¿›è¡Œå…·ä½“çš„è¯»å†™ã€‚è¿™ç‚¹æ˜¯å’Œä¿¡å·é©±åŠ¨æ¨¡å‹æœ‰æ‰€ä¸åŒçš„ï¼Œåœ¨ä¿¡å·é©±åŠ¨æ¨¡å‹ä¸­ï¼Œå½“ç”¨æˆ·çº¿ç¨‹æ¥æ”¶åˆ°ä¿¡å·è¡¨ç¤ºæ•°æ®å·²ç»å°±ç»ªï¼Œç„¶åéœ€è¦ç”¨æˆ·çº¿ç¨‹è°ƒç”¨ IO å‡½æ•°è¿›è¡Œå®é™…çš„è¯»å†™æ“ä½œï¼›è€Œåœ¨å¼‚æ­¥ IO æ¨¡å‹ä¸­ï¼Œæ”¶åˆ°ä¿¡å·è¡¨ç¤º IO æ“ä½œå·²ç»å®Œæˆï¼Œä¸éœ€è¦å†åœ¨ç”¨æˆ·çº¿ç¨‹ä¸­è°ƒç”¨ IO å‡½æ•°è¿›è¡Œå®é™…çš„è¯»å†™æ“ä½œã€‚<br>æ³¨æ„ï¼Œå¼‚æ­¥ IO æ˜¯éœ€è¦æ“ä½œç³»ç»Ÿçš„åº•å±‚æ”¯æŒï¼Œåœ¨ Java 7 ä¸­ï¼Œæä¾›äº† Asynchronous IOã€‚</p><h3 id="JAVA-IO-åŒ…"><a href="#JAVA-IO-åŒ…" class="headerlink" title="JAVA IO åŒ…"></a>JAVA IO åŒ…</h3><h3 id="JAVA-NIO"><a href="#JAVA-NIO" class="headerlink" title="JAVA NIO"></a>JAVA NIO</h3><p>NIO ä¸»è¦æœ‰ä¸‰å¤§æ ¸å¿ƒéƒ¨åˆ†ï¼šChannel(é€šé“)ï¼ŒBuffer(ç¼“å†²åŒº), Selectorã€‚ä¼ ç»Ÿ IO åŸºäºå­—èŠ‚æµå’Œå­—ç¬¦æµè¿›è¡Œæ“ä½œï¼Œè€Œ NIO åŸºäº Channel å’Œ Buffer(ç¼“å†²åŒº)è¿›è¡Œæ“ä½œï¼Œæ•°æ®æ€»æ˜¯ä»é€šé“è¯»å–åˆ°ç¼“å†²åŒºä¸­ï¼Œæˆ–è€…ä»ç¼“å†²åŒºå†™å…¥åˆ°é€šé“ä¸­ã€‚Selector(é€‰æ‹©åŒº)ç”¨äºç›‘å¬å¤šä¸ªé€šé“çš„äº‹ä»¶ï¼ˆæ¯”å¦‚ï¼šè¿æ¥æ‰“å¼€ï¼Œ<br>æ•°æ®åˆ°è¾¾ï¼‰ã€‚å› æ­¤ï¼Œå•ä¸ªçº¿ç¨‹å¯ä»¥ç›‘å¬å¤šä¸ªæ•°æ®é€šé“ã€‚NIO å’Œä¼ ç»Ÿ IOä¹‹é—´ç¬¬ä¸€ä¸ªæœ€å¤§çš„åŒºåˆ«æ˜¯ï¼ŒIOæ˜¯é¢å‘æµçš„ï¼ŒNIO æ˜¯é¢å‘ç¼“å†²åŒºçš„ã€‚</p><h4 id="NIO-çš„ç¼“å†²åŒº"><a href="#NIO-çš„ç¼“å†²åŒº" class="headerlink" title="NIO çš„ç¼“å†²åŒº"></a>NIO çš„ç¼“å†²åŒº</h4><p>Java IO é¢å‘æµæ„å‘³ç€æ¯æ¬¡ä»æµä¸­è¯»ä¸€ä¸ªæˆ–å¤šä¸ªå­—èŠ‚ï¼Œç›´è‡³è¯»å–æ‰€æœ‰å­—èŠ‚ï¼Œå®ƒä»¬æ²¡æœ‰è¢«ç¼“å­˜åœ¨ä»»ä½•åœ°æ–¹ã€‚æ­¤å¤–ï¼Œå®ƒä¸èƒ½å‰åç§»åŠ¨æµä¸­çš„æ•°æ®ã€‚å¦‚æœéœ€è¦å‰åç§»åŠ¨ä»æµä¸­è¯»å–çš„æ•°æ®ï¼Œéœ€è¦å…ˆå°†å®ƒç¼“å­˜åˆ°ä¸€ä¸ªç¼“å†²åŒºã€‚NIOçš„ç¼“å†²å¯¼å‘æ–¹æ³•ä¸åŒã€‚æ•°æ®è¯»å–åˆ°ä¸€ä¸ªå®ƒç¨åå¤„ç†çš„ç¼“å†²åŒºï¼Œéœ€è¦æ—¶å¯åœ¨ç¼“å†²åŒºä¸­å‰åç§»åŠ¨ã€‚è¿™å°±å¢åŠ äº†å¤„ç†è¿‡ç¨‹ä¸­çš„çµæ´»æ€§ã€‚ä½†æ˜¯ï¼Œè¿˜éœ€è¦æ£€æŸ¥æ˜¯å¦è¯¥ç¼“å†²åŒºä¸­åŒ…å«æ‰€æœ‰æ‚¨éœ€è¦å¤„ç†çš„æ•°æ®ã€‚è€Œä¸”ï¼Œéœ€ç¡®ä¿å½“æ›´å¤šçš„æ•°æ®è¯»å…¥ç¼“å†²åŒºæ—¶ï¼Œä¸è¦è¦†ç›–ç¼“å†²åŒºé‡Œå°šæœªå¤„ç†çš„æ•°æ®ã€‚</p><h4 id="NIO-çš„éé˜»å¡"><a href="#NIO-çš„éé˜»å¡" class="headerlink" title="NIO çš„éé˜»å¡"></a>NIO çš„éé˜»å¡</h4><p>IO çš„å„ç§æµæ˜¯é˜»å¡çš„ã€‚è¿™æ„å‘³ç€ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨read()æˆ–write()æ—¶ï¼Œè¯¥çº¿ç¨‹è¢«é˜»å¡ï¼Œç›´åˆ°æœ‰ä¸€äº›æ•°æ®è¢«è¯»å–ï¼Œæˆ–æ•°æ®å®Œå…¨å†™å…¥ã€‚è¯¥çº¿ç¨‹åœ¨æ­¤æœŸé—´ä¸èƒ½å†å¹²ä»»ä½•äº‹æƒ…äº†ã€‚ NIO çš„éé˜»å¡æ¨¡å¼ï¼Œä½¿ä¸€ä¸ªçº¿ç¨‹ä»æŸé€šé“å‘é€è¯·æ±‚è¯»å–æ•°æ®ï¼Œä½†æ˜¯å®ƒä»…èƒ½å¾—åˆ°ç›®å‰å¯ç”¨çš„æ•°æ®ï¼Œå¦‚æœç›®å‰æ²¡æœ‰æ•°æ®å¯ç”¨æ—¶ï¼Œå°±ä»€ä¹ˆéƒ½ä¸ä¼šè·å–ã€‚è€Œä¸æ˜¯ä¿æŒçº¿ç¨‹é˜»å¡ï¼Œæ‰€ä»¥ç›´è‡³æ•°æ®å˜çš„å¯ä»¥è¯»å–ä¹‹å‰ï¼Œè¯¥çº¿ç¨‹å¯ä»¥ç»§ç»­åšå…¶ä»–çš„äº‹æƒ…ã€‚éé˜»å¡å†™ä¹Ÿæ˜¯å¦‚æ­¤ã€‚ä¸€ä¸ªçº¿ç¨‹è¯·æ±‚å†™å…¥ä¸€äº›æ•°æ®åˆ°æŸé€šé“ï¼Œä½†ä¸éœ€è¦ç­‰å¾…å®ƒå®Œå…¨å†™å…¥ï¼Œè¿™ä¸ªçº¿ç¨‹åŒæ—¶å¯ä»¥å»åšåˆ«çš„äº‹æƒ…ã€‚çº¿ç¨‹é€šå¸¸å°†éé˜»å¡IOçš„ç©ºé—²æ—¶é—´ç”¨äºåœ¨å…¶å®ƒé€šé“ä¸Šæ‰§è¡ŒIOæ“ä½œï¼Œæ‰€ä»¥ä¸€ä¸ªå•ç‹¬çš„çº¿ç¨‹ç°åœ¨å¯ä»¥ç®¡ç†å¤šä¸ªè¾“å…¥å’Œè¾“å‡ºé€šé“ï¼ˆchannelï¼‰ã€‚</p><h3 id="Channel"><a href="#Channel" class="headerlink" title="Channel"></a>Channel</h3><p>é¦–å…ˆè¯´ä¸€ä¸‹ Channelï¼Œå›½å†…å¤§å¤šç¿»è¯‘æˆâ€œé€šé“â€ã€‚Channel å’Œ IO ä¸­çš„ Stream(æµ)æ˜¯å·®ä¸å¤šä¸€ä¸ªç­‰çº§çš„ã€‚åªä¸è¿‡ Stream æ˜¯å•å‘çš„ï¼Œè­¬å¦‚ï¼šInputStream, OutputStreamï¼Œè€Œ Channel æ˜¯åŒå‘çš„ï¼Œæ—¢å¯ä»¥ç”¨æ¥è¿›è¡Œè¯»æ“ä½œï¼Œåˆå¯ä»¥ç”¨æ¥è¿›è¡Œå†™æ“ä½œã€‚</p><p>NIO ä¸­çš„ Channel çš„ä¸»è¦å®ç°æœ‰ï¼š</p><ol><li>FileChannel</li><li>DatagramChannel</li><li>SocketChannel</li><li>ServerSocketChannel<br>è¿™é‡Œçœ‹åå­—å°±å¯ä»¥çŒœå‡ºä¸ªæ‰€ä»¥ç„¶æ¥ï¼šåˆ†åˆ«å¯ä»¥å¯¹åº”æ–‡ä»¶ IOã€UDP å’Œ TCPï¼ˆServer å’Œ Clientï¼‰ã€‚<br>ä¸‹é¢æ¼”ç¤ºçš„æ¡ˆä¾‹åŸºæœ¬ä¸Šå°±æ˜¯å›´ç»•è¿™ 4 ä¸ªç±»å‹çš„ Channel è¿›è¡Œé™ˆè¿°çš„ã€‚</li></ol><h3 id="Buffer"><a href="#Buffer" class="headerlink" title="Buffer"></a>Buffer</h3><p>Bufferï¼Œæ•…åæ€æ„ï¼Œç¼“å†²åŒºï¼Œå®é™…ä¸Šæ˜¯ä¸€ä¸ªå®¹å™¨ï¼Œæ˜¯ä¸€ä¸ªè¿ç»­æ•°ç»„ã€‚Channelæä¾›ä»æ–‡ä»¶ã€ç½‘ç»œè¯»å–æ•°æ®çš„æ¸ é“ï¼Œä½†æ˜¯è¯»å–æˆ–å†™å…¥çš„æ•°æ®éƒ½å¿…é¡»ç»ç”± Bufferã€‚</p><p>ä¸Šé¢çš„å›¾æè¿°äº†ä»ä¸€ä¸ªå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€æ•°æ®ï¼Œç„¶åæœåŠ¡ç«¯æ¥æ”¶æ•°æ®çš„è¿‡ç¨‹ã€‚å®¢æˆ·ç«¯å‘é€æ•°æ®æ—¶ï¼Œå¿…é¡»å…ˆå°†æ•°æ®å­˜å…¥ Buffer ä¸­ï¼Œç„¶åå°† Buffer ä¸­çš„å†…å®¹å†™å…¥é€šé“ã€‚æœåŠ¡ç«¯è¿™è¾¹æ¥æ”¶æ•°æ®å¿…é¡»é€šè¿‡ Channel å°†æ•°æ®è¯»å…¥åˆ° Buffer ä¸­ï¼Œç„¶åå†ä» Buffer ä¸­å–å‡ºæ•°æ®æ¥å¤„ç†ã€‚<br>åœ¨ NIO ä¸­ï¼ŒBuffer æ˜¯ä¸€ä¸ªé¡¶å±‚çˆ¶ç±»ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œå¸¸ç”¨çš„ Buffer çš„å­ç±»æœ‰ï¼šByteBufferã€IntBufferã€ CharBufferã€ LongBufferã€ DoubleBufferã€FloatBufferã€ShortBuffer</p><h3 id="Selector"><a href="#Selector" class="headerlink" title="Selector"></a>Selector</h3><p>Selector ç±»æ˜¯ NIO çš„æ ¸å¿ƒç±»ï¼ŒSelectorèƒ½å¤Ÿæ£€æµ‹å¤šä¸ªæ³¨å†Œçš„é€šé“ä¸Šæ˜¯å¦æœ‰äº‹ä»¶å‘ç”Ÿï¼Œå¦‚æœæœ‰äº‹ä»¶å‘ç”Ÿï¼Œä¾¿è·å–äº‹ä»¶ç„¶åé’ˆå¯¹æ¯ä¸ªäº‹ä»¶è¿›è¡Œç›¸åº”çš„å“åº”å¤„ç†ã€‚è¿™æ ·ä¸€æ¥ï¼Œåªæ˜¯ç”¨ä¸€ä¸ªå•çº¿ç¨‹å°±å¯ä»¥ç®¡ç†å¤šä¸ªé€šé“ï¼Œä¹Ÿå°±æ˜¯ç®¡ç†å¤šä¸ªè¿æ¥ã€‚è¿™æ ·ä½¿å¾—åªæœ‰åœ¨è¿æ¥çœŸæ­£æœ‰è¯»å†™äº‹ä»¶å‘ç”Ÿæ—¶ï¼Œæ‰ä¼šè°ƒç”¨å‡½æ•°æ¥è¿›è¡Œè¯»å†™ï¼Œå°±å¤§å¤§åœ°å‡å°‘äº†ç³»ç»Ÿå¼€é”€ï¼Œå¹¶ä¸”ä¸å¿…ä¸ºæ¯ä¸ªè¿æ¥éƒ½åˆ›å»ºä¸€ä¸ªçº¿ç¨‹ï¼Œä¸ç”¨å»ç»´æŠ¤å¤šä¸ªçº¿ç¨‹ï¼Œå¹¶ä¸”é¿å…äº†å¤šçº¿ç¨‹ä¹‹é—´çš„ä¸Šä¸‹æ–‡åˆ‡æ¢å¯¼è‡´çš„å¼€é”€ã€‚</p><h2 id="JVM-ç±»åŠ è½½æœºåˆ¶"><a href="#JVM-ç±»åŠ è½½æœºåˆ¶" class="headerlink" title="JVM ç±»åŠ è½½æœºåˆ¶"></a>JVM ç±»åŠ è½½æœºåˆ¶</h2><p>JVM ç±»åŠ è½½æœºåˆ¶åˆ†ä¸ºäº”ä¸ªéƒ¨åˆ†ï¼šåŠ è½½ï¼ŒéªŒè¯ï¼Œå‡†å¤‡ï¼Œè§£æï¼Œåˆå§‹åŒ–ï¼Œä¸‹é¢æˆ‘ä»¬å°±åˆ†åˆ«æ¥çœ‹ä¸€ä¸‹è¿™äº”ä¸ªè¿‡ç¨‹ã€‚</p><h4 id="åŠ è½½"><a href="#åŠ è½½" class="headerlink" title="åŠ è½½"></a>åŠ è½½</h4><p>åŠ è½½æ˜¯ç±»åŠ è½½è¿‡ç¨‹ä¸­çš„ä¸€ä¸ªé˜¶æ®µï¼Œè¿™ä¸ªé˜¶æ®µä¼šåœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„ java.lang.Classå¯¹è±¡ï¼Œä½œä¸ºæ–¹æ³•åŒºè¿™ä¸ªç±»çš„å„ç§æ•°æ®çš„å…¥å£ã€‚æ³¨æ„è¿™é‡Œä¸ä¸€å®šéå¾—è¦ä»ä¸€ä¸ª Class æ–‡ä»¶è·å–ï¼Œè¿™é‡Œæ—¢å¯ä»¥ä» ZIP åŒ…ä¸­è¯»å–ï¼ˆæ¯”å¦‚ä» jar åŒ…å’Œ war åŒ…ä¸­è¯»å–ï¼‰ï¼Œä¹Ÿå¯ä»¥åœ¨è¿è¡Œæ—¶è®¡ç®—ç”Ÿæˆï¼ˆåŠ¨æ€ä»£ç†ï¼‰ï¼Œä¹Ÿå¯ä»¥ç”±å…¶å®ƒæ–‡ä»¶ç”Ÿæˆï¼ˆæ¯”å¦‚å°† JSP æ–‡ä»¶è½¬æ¢æˆå¯¹åº”çš„ Class ç±»ï¼‰ã€‚</p><h4 id="éªŒè¯"><a href="#éªŒè¯" class="headerlink" title="éªŒè¯"></a>éªŒè¯</h4><p>è¿™ä¸€é˜¶æ®µçš„ä¸»è¦ç›®çš„æ˜¯ä¸ºäº†ç¡®ä¿ Class æ–‡ä»¶çš„å­—èŠ‚æµä¸­åŒ…å«çš„ä¿¡æ¯æ˜¯å¦ç¬¦åˆå½“å‰è™šæ‹Ÿæœºçš„è¦æ±‚ï¼Œå¹¶ä¸”ä¸ä¼šå±å®³è™šæ‹Ÿæœºè‡ªèº«çš„å®‰å…¨ã€‚</p><h4 id="å‡†å¤‡"><a href="#å‡†å¤‡" class="headerlink" title="å‡†å¤‡"></a>å‡†å¤‡</h4><p>å‡†å¤‡é˜¶æ®µæ˜¯æ­£å¼ä¸ºç±»å˜é‡åˆ†é…å†…å­˜å¹¶è®¾ç½®ç±»å˜é‡çš„åˆå§‹å€¼é˜¶æ®µï¼Œå³åœ¨æ–¹æ³•åŒºä¸­åˆ†é…è¿™äº›å˜é‡æ‰€ä½¿ç”¨çš„å†…å­˜ç©ºé—´ã€‚æ³¨æ„è¿™é‡Œæ‰€è¯´çš„åˆå§‹å€¼æ¦‚å¿µï¼Œæ¯”å¦‚ä¸€ä¸ªç±»å˜é‡å®šä¹‰ä¸ºï¼š<br>public static int v = 8080;<br>å®é™…ä¸Šå˜é‡ v åœ¨å‡†å¤‡é˜¶æ®µè¿‡åçš„åˆå§‹å€¼ä¸º 0 è€Œä¸æ˜¯ 8080ï¼Œå°† v èµ‹å€¼ä¸º 8080 çš„ put static æŒ‡ä»¤æ˜¯ç¨‹åºè¢«ç¼–è¯‘åï¼Œå­˜æ”¾äºç±»æ„é€ å™¨<client>æ–¹æ³•ä¹‹ä¸­ã€‚<br>ä½†æ˜¯æ³¨æ„å¦‚æœå£°æ˜ä¸ºï¼š</client></p><pre><code>public static final int v = 8080;</code></pre><p>åœ¨ç¼–è¯‘é˜¶æ®µä¼šä¸º v ç”Ÿæˆ ConstantValue å±æ€§ï¼Œåœ¨å‡†å¤‡é˜¶æ®µè™šæ‹Ÿæœºä¼šæ ¹æ® ConstantValue å±æ€§å°† vèµ‹å€¼ä¸º 8080ã€‚</p><h4 id="è§£æ"><a href="#è§£æ" class="headerlink" title="è§£æ"></a>è§£æ</h4><p>è§£æé˜¶æ®µæ˜¯æŒ‡è™šæ‹Ÿæœºå°†å¸¸é‡æ± ä¸­çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚ç¬¦å·å¼•ç”¨å°±æ˜¯ class æ–‡ä»¶ä¸­çš„ï¼š</p><ol><li>CONSTANT_Class_info</li><li>CONSTANT_Field_info</li><li>CONSTANT_Method_info</li></ol><p>ç­‰ç±»å‹çš„å¸¸é‡ã€‚</p><h4 id="ç¬¦å·å¼•ç”¨"><a href="#ç¬¦å·å¼•ç”¨" class="headerlink" title="ç¬¦å·å¼•ç”¨"></a>ç¬¦å·å¼•ç”¨</h4><p>ï® ç¬¦å·å¼•ç”¨ä¸è™šæ‹Ÿæœºå®ç°çš„å¸ƒå±€æ— å…³ï¼Œå¼•ç”¨çš„ç›®æ ‡å¹¶ä¸ä¸€å®šè¦å·²ç»åŠ è½½åˆ°å†…å­˜ä¸­ã€‚å„ç§è™šæ‹Ÿæœºå®ç°çš„å†…å­˜å¸ƒå±€å¯ä»¥å„ä¸ç›¸åŒï¼Œä½†æ˜¯å®ƒä»¬èƒ½æ¥å—çš„ç¬¦å·å¼•ç”¨å¿…é¡»æ˜¯ä¸€è‡´çš„ï¼Œå› ä¸ºç¬¦å·å¼•ç”¨çš„å­—é¢é‡å½¢å¼æ˜ç¡®å®šä¹‰åœ¨ Java è™šæ‹Ÿæœºè§„èŒƒçš„ Class æ–‡ä»¶æ ¼å¼ä¸­ã€‚</p><h4 id="ç›´æ¥å¼•ç”¨"><a href="#ç›´æ¥å¼•ç”¨" class="headerlink" title="ç›´æ¥å¼•ç”¨"></a>ç›´æ¥å¼•ç”¨</h4><p>ï® ç›´æ¥å¼•ç”¨å¯ä»¥æ˜¯æŒ‡å‘ç›®æ ‡çš„æŒ‡é’ˆï¼Œç›¸å¯¹åç§»é‡æˆ–æ˜¯ä¸€ä¸ªèƒ½é—´æ¥å®šä½åˆ°ç›®æ ‡çš„å¥æŸ„ã€‚å¦‚æœæœ‰äº†ç›´æ¥å¼•ç”¨ï¼Œé‚£å¼•ç”¨çš„ç›®æ ‡å¿…å®šå·²ç»åœ¨å†…å­˜ä¸­å­˜åœ¨ã€‚</p><h4 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h4><p>åˆå§‹åŒ–é˜¶æ®µæ˜¯ç±»åŠ è½½æœ€åä¸€ä¸ªé˜¶æ®µï¼Œå‰é¢çš„ç±»åŠ è½½é˜¶æ®µä¹‹åï¼Œé™¤äº†åœ¨åŠ è½½é˜¶æ®µå¯ä»¥è‡ªå®šä¹‰ç±»åŠ è½½å™¨ä»¥å¤–ï¼Œå…¶å®ƒæ“ä½œéƒ½ç”±JVMä¸»å¯¼ã€‚åˆ°äº†åˆå§‹é˜¶æ®µï¼Œæ‰å¼€å§‹çœŸæ­£æ‰§è¡Œç±»ä¸­å®šä¹‰çš„ Java ç¨‹åºä»£ç ã€‚</p><h4 id="ç±»æ„é€ å™¨"><a href="#ç±»æ„é€ å™¨" class="headerlink" title="ç±»æ„é€ å™¨"></a>ç±»æ„é€ å™¨<client></client></h4><p>åˆå§‹åŒ–é˜¶æ®µæ˜¯æ‰§è¡Œç±»æ„é€ å™¨<client>æ–¹æ³•çš„è¿‡ç¨‹ã€‚<client>æ–¹æ³•æ˜¯ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ”¶é›†ç±»ä¸­çš„ç±»å˜é‡çš„èµ‹å€¼æ“ä½œå’Œé™æ€è¯­å¥å—ä¸­çš„è¯­å¥åˆå¹¶è€Œæˆçš„ã€‚è™šæ‹Ÿæœºä¼šä¿è¯å­<client>æ–¹æ³•æ‰§è¡Œä¹‹å‰ï¼Œçˆ¶ç±»çš„<client>æ–¹æ³•å·²ç»æ‰§è¡Œå®Œæ¯•ï¼Œå¦‚æœä¸€ä¸ªç±»ä¸­æ²¡æœ‰å¯¹é™æ€å˜é‡èµ‹å€¼ä¹Ÿæ²¡æœ‰é™æ€è¯­å¥å—ï¼Œé‚£ä¹ˆç¼–è¯‘å™¨å¯ä»¥ä¸ä¸ºè¿™ä¸ªç±»ç”Ÿæˆ<client>()æ–¹æ³•ã€‚<br>æ³¨æ„ä»¥ä¸‹å‡ ç§æƒ…å†µä¸ä¼šæ‰§è¡Œç±»åˆå§‹åŒ–ï¼š</client></client></client></client></client></p><ol><li>é€šè¿‡å­ç±»å¼•ç”¨çˆ¶ç±»çš„é™æ€å­—æ®µï¼Œåªä¼šè§¦å‘çˆ¶ç±»çš„åˆå§‹åŒ–ï¼Œè€Œä¸ä¼šè§¦å‘å­ç±»çš„åˆå§‹åŒ–ã€‚</li><li>å®šä¹‰å¯¹è±¡æ•°ç»„ï¼Œä¸ä¼šè§¦å‘è¯¥ç±»çš„åˆå§‹åŒ–ã€‚</li><li>å¸¸é‡åœ¨ç¼–è¯‘æœŸé—´ä¼šå­˜å…¥è°ƒç”¨ç±»çš„å¸¸é‡æ± ä¸­ï¼Œæœ¬è´¨ä¸Šå¹¶æ²¡æœ‰ç›´æ¥å¼•ç”¨å®šä¹‰å¸¸é‡çš„ç±»ï¼Œä¸ä¼šè§¦<br>å‘å®šä¹‰å¸¸é‡æ‰€åœ¨çš„ç±»ã€‚</li><li>é€šè¿‡ç±»åè·å– Class å¯¹è±¡ï¼Œä¸ä¼šè§¦å‘ç±»çš„åˆå§‹åŒ–ã€‚</li><li>é€šè¿‡ Class.forName åŠ è½½æŒ‡å®šç±»æ—¶ï¼Œå¦‚æœæŒ‡å®šå‚æ•° initialize ä¸º false æ—¶ï¼Œä¹Ÿä¸ä¼šè§¦å‘ç±»åˆ<br>å§‹åŒ–ï¼Œå…¶å®è¿™ä¸ªå‚æ•°æ˜¯å‘Šè¯‰è™šæ‹Ÿæœºï¼Œæ˜¯å¦è¦å¯¹ç±»è¿›è¡Œåˆå§‹åŒ–ã€‚</li><li>é€šè¿‡ ClassLoader é»˜è®¤çš„ loadClass æ–¹æ³•ï¼Œä¹Ÿä¸ä¼šè§¦å‘åˆå§‹åŒ–åŠ¨ä½œã€‚</li></ol><h3 id="ç±»åŠ è½½å™¨"><a href="#ç±»åŠ è½½å™¨" class="headerlink" title="ç±»åŠ è½½å™¨"></a>ç±»åŠ è½½å™¨</h3><p>è™šæ‹Ÿæœºè®¾è®¡å›¢é˜ŸæŠŠåŠ è½½åŠ¨ä½œæ”¾åˆ° JVM å¤–éƒ¨å®ç°ï¼Œä»¥ä¾¿è®©åº”ç”¨ç¨‹åºå†³å®šå¦‚ä½•è·å–æ‰€éœ€çš„ç±»ï¼ŒJVM æä¾›äº† 3 ç§ç±»åŠ è½½å™¨ï¼š</p><h4 id="å¯åŠ¨ç±»åŠ è½½å™¨-Bootstrap-ClassLoader"><a href="#å¯åŠ¨ç±»åŠ è½½å™¨-Bootstrap-ClassLoader" class="headerlink" title="å¯åŠ¨ç±»åŠ è½½å™¨(Bootstrap ClassLoader)"></a>å¯åŠ¨ç±»åŠ è½½å™¨(Bootstrap ClassLoader)</h4><ol><li>è´Ÿè´£åŠ è½½ JAVA_HOME\lib ç›®å½•ä¸­çš„ï¼Œæˆ–é€šè¿‡-Xbootclasspath å‚æ•°æŒ‡å®šè·¯å¾„ä¸­çš„ï¼Œä¸”è¢«<br>è™šæ‹Ÿæœºè®¤å¯ï¼ˆæŒ‰æ–‡ä»¶åè¯†åˆ«ï¼Œå¦‚ rt.jarï¼‰çš„ç±»ã€‚</li></ol><h4 id="æ‰©å±•ç±»åŠ è½½å™¨-Extension-ClassLoader"><a href="#æ‰©å±•ç±»åŠ è½½å™¨-Extension-ClassLoader" class="headerlink" title="æ‰©å±•ç±»åŠ è½½å™¨(Extension ClassLoader)"></a>æ‰©å±•ç±»åŠ è½½å™¨(Extension ClassLoader)</h4><ol start="2"><li>è´Ÿè´£åŠ è½½ JAVA_HOME\lib\ext ç›®å½•ä¸­çš„ï¼Œæˆ–é€šè¿‡ java.ext.dirs ç³»ç»Ÿå˜é‡æŒ‡å®šè·¯å¾„ä¸­çš„ç±»<br>åº“ã€‚</li></ol><h4 id="åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨-Application-ClassLoader-ï¼š"><a href="#åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨-Application-ClassLoader-ï¼š" class="headerlink" title="åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨(Application ClassLoader)ï¼š"></a>åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨(Application ClassLoader)ï¼š</h4><ol start="3"><li>è´Ÿè´£åŠ è½½ç”¨æˆ·è·¯å¾„ï¼ˆclasspathï¼‰ä¸Šçš„ç±»åº“ã€‚<br>JVM é€šè¿‡åŒäº²å§”æ´¾æ¨¡å‹è¿›è¡Œç±»çš„åŠ è½½ï¼Œå½“ç„¶æˆ‘ä»¬ä¹Ÿå¯ä»¥é€šè¿‡ç»§æ‰¿ java.lang.ClassLoaderå®ç°è‡ªå®šä¹‰çš„ç±»åŠ è½½å™¨ã€‚</li></ol><h3 id="åŒäº²å§”æ´¾"><a href="#åŒäº²å§”æ´¾" class="headerlink" title="åŒäº²å§”æ´¾"></a>åŒäº²å§”æ´¾</h3><p>å½“ä¸€ä¸ªç±»æ”¶åˆ°äº†ç±»åŠ è½½è¯·æ±‚ï¼Œä»–é¦–å…ˆä¸ä¼šå°è¯•è‡ªå·±å»åŠ è½½è¿™ä¸ªç±»ï¼Œè€Œæ˜¯æŠŠè¿™ä¸ªè¯·æ±‚å§”æ´¾ç»™çˆ¶ç±»å»å®Œæˆï¼Œæ¯ä¸€ä¸ªå±‚æ¬¡ç±»åŠ è½½å™¨éƒ½æ˜¯å¦‚æ­¤ï¼Œå› æ­¤æ‰€æœ‰çš„åŠ è½½è¯·æ±‚éƒ½åº”è¯¥ä¼ é€åˆ°å¯åŠ¨ç±»åŠ è½½å…¶ä¸­ï¼Œåªæœ‰å½“çˆ¶ç±»åŠ è½½å™¨åé¦ˆè‡ªå·±æ— æ³•å®Œæˆè¿™ä¸ªè¯·æ±‚çš„æ—¶å€™ï¼ˆåœ¨å®ƒçš„åŠ è½½è·¯å¾„ä¸‹æ²¡æœ‰æ‰¾åˆ°æ‰€éœ€åŠ è½½çš„Classï¼‰ï¼Œå­ç±»åŠ è½½å™¨æ‰ä¼šå°è¯•è‡ªå·±å»åŠ è½½ã€‚é‡‡ç”¨åŒäº²å§”æ´¾çš„ä¸€ä¸ªå¥½å¤„æ˜¯æ¯”å¦‚åŠ è½½ä½äºrt.jaråŒ…ä¸­çš„ç±»java.lang.Objectï¼Œä¸ç®¡æ˜¯å“ªä¸ªåŠ è½½å™¨åŠ è½½è¿™ä¸ªç±»ï¼Œæœ€ç»ˆéƒ½æ˜¯å§”æ‰˜ç»™é¡¶å±‚çš„å¯åŠ¨ç±»åŠ è½½å™¨è¿›è¡ŒåŠ è½½ï¼Œè¿™æ ·å°±ä¿è¯äº†ä½¿ç”¨ä¸åŒçš„ç±»åŠ è½½å™¨æœ€ç»ˆå¾—åˆ°çš„éƒ½æ˜¯åŒæ ·ä¸€ä¸ª Object å¯¹è±¡ã€‚</p><h3 id="OSGIï¼ˆåŠ¨æ€æ¨¡å‹ç³»ç»Ÿï¼‰"><a href="#OSGIï¼ˆåŠ¨æ€æ¨¡å‹ç³»ç»Ÿï¼‰" class="headerlink" title="OSGIï¼ˆåŠ¨æ€æ¨¡å‹ç³»ç»Ÿï¼‰"></a>OSGIï¼ˆåŠ¨æ€æ¨¡å‹ç³»ç»Ÿï¼‰</h3><p>OSGi(Open Service Gateway Initiative)ï¼Œæ˜¯é¢å‘ Java çš„åŠ¨æ€æ¨¡å‹ç³»ç»Ÿï¼Œæ˜¯ Java åŠ¨æ€åŒ–æ¨¡å—åŒ–ç³»ç»Ÿçš„ä¸€ç³»åˆ—è§„èŒƒã€‚</p><h4 id="åŠ¨æ€æ”¹å˜æ„é€ "><a href="#åŠ¨æ€æ”¹å˜æ„é€ " class="headerlink" title="åŠ¨æ€æ”¹å˜æ„é€ "></a>åŠ¨æ€æ”¹å˜æ„é€ </h4><p>OSGi æœåŠ¡å¹³å°æä¾›åœ¨å¤šç§ç½‘ç»œè®¾å¤‡ä¸Šæ— éœ€é‡å¯çš„åŠ¨æ€æ”¹å˜æ„é€ çš„åŠŸèƒ½ã€‚ä¸ºäº†æœ€å°åŒ–è€¦åˆåº¦å’Œä¿ƒä½¿è¿™äº›è€¦åˆåº¦å¯ç®¡ç†ï¼ŒOSGiæŠ€æœ¯æä¾›ä¸€ç§é¢å‘æœåŠ¡çš„æ¶æ„ï¼Œå®ƒèƒ½ä½¿è¿™äº›ç»„ä»¶åŠ¨æ€åœ°å‘ç°å¯¹æ–¹ã€‚</p><h4 id="æ¨¡å—åŒ–ç¼–ç¨‹ä¸çƒ­æ’æ‹”"><a href="#æ¨¡å—åŒ–ç¼–ç¨‹ä¸çƒ­æ’æ‹”" class="headerlink" title="æ¨¡å—åŒ–ç¼–ç¨‹ä¸çƒ­æ’æ‹”"></a>æ¨¡å—åŒ–ç¼–ç¨‹ä¸çƒ­æ’æ‹”</h4><p>OSGi æ—¨åœ¨ä¸ºå®ç° Java ç¨‹åºçš„æ¨¡å—åŒ–ç¼–ç¨‹æä¾›åŸºç¡€æ¡ä»¶ï¼ŒåŸºäºOSGiçš„ç¨‹åºå¾ˆå¯èƒ½å¯ä»¥å®ç°æ¨¡å—çº§çš„çƒ­æ’æ‹”åŠŸèƒ½ï¼Œå½“ç¨‹åºå‡çº§æ›´æ–°æ—¶ï¼Œå¯ä»¥åªåœç”¨ã€é‡æ–°å®‰è£…ç„¶åå¯åŠ¨ç¨‹åºçš„å…¶ä¸­ä¸€éƒ¨åˆ†ï¼Œè¿™å¯¹ä¼ä¸šçº§ç¨‹åºå¼€å‘æ¥è¯´æ˜¯éå¸¸å…·æœ‰è¯±æƒ‘åŠ›çš„ç‰¹æ€§ã€‚<br>OSGi æç»˜äº†ä¸€ä¸ªå¾ˆç¾å¥½çš„æ¨¡å—åŒ–å¼€å‘ç›®æ ‡ï¼Œè€Œä¸”å®šä¹‰äº†å®ç°è¿™ä¸ªç›®æ ‡çš„æ‰€éœ€è¦æœåŠ¡ä¸æ¶æ„ï¼ŒåŒæ—¶ä¹Ÿæœ‰æˆç†Ÿçš„æ¡†æ¶è¿›è¡Œå®ç°æ”¯æŒã€‚ä½†å¹¶éæ‰€æœ‰çš„åº”ç”¨éƒ½é€‚åˆé‡‡ç”¨ OSGi ä½œä¸ºåŸºç¡€æ¶æ„ï¼Œå®ƒåœ¨æä¾›å¼ºå¤§åŠŸèƒ½åŒæ—¶ï¼Œä¹Ÿå¼•å…¥äº†é¢å¤–çš„å¤æ‚åº¦ï¼Œå› ä¸ºå®ƒä¸éµå®ˆäº†ç±»åŠ è½½çš„åŒäº²å§”æ‰˜æ¨¡å‹ã€‚</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;JVM æ˜¯å¯è¿è¡Œ Java ä»£ç çš„å‡æƒ³è®¡ç®—æœº ï¼ŒåŒ…æ‹¬ä¸€å¥—å­—èŠ‚ç æŒ‡ä»¤é›†ã€ä¸€ç»„å¯„å­˜å™¨ã€ä¸€ä¸ªæ ˆã€ä¸€ä¸ªåƒåœ¾å›æ”¶ï¼Œå † å’Œ ä¸€ä¸ªå­˜å‚¨æ–¹æ³•åŸŸã€‚JVM æ˜¯è¿è¡Œåœ¨æ“ä½œç³»ç»Ÿä¹‹ä¸Šçš„ï¼Œå®ƒä¸ç¡¬ä»¶æ²¡æœ‰ç›´æ¥çš„äº¤äº’ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="Java" scheme="http://yoursite.com/tags/Java/"/>
    
      <category term="JVM" scheme="http://yoursite.com/tags/JVM/"/>
    
  </entry>
  
  <entry>
    <title>875. çˆ±åƒé¦™è•‰çš„ç‚ç‚</title>
    <link href="http://yoursite.com/2021/12/17/875.%20%E7%88%B1%E5%90%83%E9%A6%99%E8%95%89%E7%9A%84%E7%8F%82%E7%8F%82/"/>
    <id>http://yoursite.com/2021/12/17/875. çˆ±åƒé¦™è•‰çš„ç‚ç‚/</id>
    <published>2021-12-17T11:30:12.000Z</published>
    <updated>2021-12-17T11:16:14.922Z</updated>
    
    <content type="html"><![CDATA[<p>è¿”å›å¥¹å¯ä»¥åœ¨ H å°æ—¶å†…åƒæ‰æ‰€æœ‰é¦™è•‰çš„æœ€å°é€Ÿåº¦ Kï¼ˆK ä¸ºæ•´æ•°ï¼‰ã€‚</p><a id="more"></a><p>[TOC]</p><p>ç‚ç‚å–œæ¬¢åƒé¦™è•‰ã€‚è¿™é‡Œæœ‰ N å †é¦™è•‰ï¼Œç¬¬ i å †ä¸­æœ‰ piles[i] æ ¹é¦™è•‰ã€‚è­¦å«å·²ç»ç¦»å¼€äº†ï¼Œå°†åœ¨ H å°æ—¶åå›æ¥ã€‚</p><p>ç‚ç‚å¯ä»¥å†³å®šå¥¹åƒé¦™è•‰çš„é€Ÿåº¦ K ï¼ˆå•ä½ï¼šæ ¹/å°æ—¶ï¼‰ã€‚æ¯ä¸ªå°æ—¶ï¼Œå¥¹å°†ä¼šé€‰æ‹©ä¸€å †é¦™è•‰ï¼Œä»ä¸­åƒæ‰ K æ ¹ã€‚å¦‚æœè¿™å †é¦™è•‰å°‘äº K æ ¹ï¼Œå¥¹å°†åƒæ‰è¿™å †çš„æ‰€æœ‰é¦™è•‰ï¼Œç„¶åè¿™ä¸€å°æ—¶å†…ä¸ä¼šå†åƒæ›´å¤šçš„é¦™è•‰ã€‚  </p><p>ç‚ç‚å–œæ¬¢æ…¢æ…¢åƒï¼Œä½†ä»ç„¶æƒ³åœ¨è­¦å«å›æ¥å‰åƒæ‰æ‰€æœ‰çš„é¦™è•‰ã€‚</p><p>è¿”å›å¥¹å¯ä»¥åœ¨ H å°æ—¶å†…åƒæ‰æ‰€æœ‰é¦™è•‰çš„æœ€å°é€Ÿåº¦ Kï¼ˆK ä¸ºæ•´æ•°ï¼‰ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥: piles = [3,6,7,11], H = 8è¾“å‡º: 4</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥: piles = [30,11,23,4,20], H = 5è¾“å‡º: 30</code></pre><p>ç¤ºä¾‹ 3ï¼š</p><pre><code>è¾“å…¥: piles = [30,11,23,4,20], H = 6è¾“å‡º: 23</code></pre><p>æç¤ºï¼š</p><pre><code>1 &lt;= piles.length &lt;= 10^4piles.length &lt;= H &lt;= 10^91 &lt;= piles[i] &lt;= 10^9</code></pre><h1 id="äºŒåˆ†æŸ¥æ‰¾-1"><a href="#äºŒåˆ†æŸ¥æ‰¾-1" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾^1"></a>äºŒåˆ†æŸ¥æ‰¾<a href="https://leetcode-cn.com/problems/koko-eating-bananas/solution/ai-chi-xiang-jiao-de-ke-ke-by-leetcode/" target="_blank" rel="noopener">^1</a></h1><p><strong>æ€è·¯</strong></p><p>å¦‚æœç‚ç‚èƒ½ä»¥ <code>K</code> çš„è¿›é£Ÿé€Ÿåº¦æœ€ç»ˆåƒå®Œæ‰€æœ‰çš„é¦™è•‰ï¼ˆåœ¨ <code>H</code> å°æ—¶å†…ï¼‰ï¼Œé‚£ä¹ˆå¥¹ä¹Ÿå¯ä»¥ç”¨æ›´å¿«çš„é€Ÿåº¦åƒå®Œã€‚</p><p>å½“ç‚ç‚èƒ½ä»¥ <code>K</code> çš„è¿›é£Ÿé€Ÿåº¦åƒå®Œé¦™è•‰æ—¶ï¼Œæˆ‘ä»¬ä»¤ <code>possible(K)</code> ä¸º <code>true</code>ï¼Œé‚£ä¹ˆå°±å­˜åœ¨ <code>X</code> ä½¿å¾—å½“ <code>K &gt;= X</code> æ—¶ï¼Œ <code>possible(K) = True</code>ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå½“åˆå§‹æ¡ä»¶ä¸º <code>piles = [3, 6, 7, 11]</code> å’Œ <code>H = 8</code> æ—¶ï¼Œå­˜åœ¨ <code>X = 4</code> ä½¿å¾— <code>possible(1) = possible(2) = possible(3) = False</code>ï¼Œä¸” <code>possible(4) = possible(5) = ... = True</code>ã€‚</p><p><strong>ç®—æ³•</strong></p><p>æˆ‘ä»¬å¯ä»¥äºŒåˆ†æŸ¥æ‰¾ <code>possible(K)</code> çš„å€¼æ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªä½¿å¾— <code>possible(X)</code> ä¸º <code>True</code> çš„ <code>X</code>ï¼šè¿™å°†æ˜¯æˆ‘ä»¬çš„ç­”æ¡ˆã€‚æˆ‘ä»¬çš„å¾ªç¯ä¸­ï¼Œä¸å˜é‡ <code>possible(hi)</code> æ€»ä¸º <code>True</code>ï¼Œ <code>lo</code> æ€»å°äºç­‰äºç­”æ¡ˆã€‚æœ‰å…³äºŒåˆ†æŸ¥æ‰¾çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://leetcode-cn.com/explore/learn/card/binary-search/" target="_blank" rel="noopener">ã€ŠåŠ›æ‰£æ¢ç´¢ï¼šäºŒåˆ†æŸ¥æ‰¾ã€‹</a>ã€‚</p><p>ä¸ºäº†æ‰¾åˆ° <code>possible(K)</code> çš„å€¼ï¼Œ (å³<code>ç‚ç‚</code>æ˜¯å¦èƒ½ä»¥ <code>K</code> çš„è¿›é£Ÿé€Ÿåº¦åœ¨ <code>H</code> å°æ—¶å†…åƒå®Œæ‰€æœ‰çš„é¦™è•‰ï¼‰ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿè¿™ä¸€æƒ…æ™¯ã€‚å¯¹äºæ¯ä¸€å †ï¼ˆå¤§å° <code>p &gt; 0</code>ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æ–­å‡ºç‚ç‚å°†åœ¨ <code>Math.ceil(p / K) = ((p-1) // K) + 1</code> å°æ—¶å†…åƒå®Œè¿™ä¸€å †ï¼Œæˆ‘ä»¬å°†æ¯ä¸€å †çš„å®Œæˆæ—¶é—´åŠ åœ¨ä¸€èµ·å¹¶ä¸ <code>H</code> è¿›è¡Œæ¯”è¾ƒã€‚</p><details>    <summary>cpp</summary><figure class="highlight cpp"><figcaption><span>[2q2E5AzB-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minEatingSpeed</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; piles, <span class="keyword">int</span> H)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> lo = <span class="number">1</span>, hi = <span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">9</span>);</span><br><span class="line">        <span class="keyword">while</span> (lo &lt; hi) &#123;</span><br><span class="line">            <span class="keyword">int</span> mi = lo + (hi - lo) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (!possible(piles, H, mi))</span><br><span class="line">                lo = mi + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                hi = mi;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> lo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Can Koko eat all bananas in H hours with eating speed K?</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">possible</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; piles, <span class="keyword">int</span> H, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> time = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> p: piles)</span><br><span class="line">            time += (p - <span class="number">1</span>) / K + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> time &lt;= H;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[2q2E5AzB-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minEatingSpeed</span><span class="params">(<span class="keyword">int</span>[] piles, <span class="keyword">int</span> H)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> lo = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> hi = <span class="number">1_000_000_000</span>;</span><br><span class="line">        <span class="keyword">while</span> (lo &lt; hi) &#123;</span><br><span class="line">            <span class="keyword">int</span> mi = (lo + hi) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (!possible(piles, H, mi))</span><br><span class="line">                lo = mi + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                hi = mi;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> lo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Can Koko eat all bananas in H hours with eating speed K?</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">possible</span><span class="params">(<span class="keyword">int</span>[] piles, <span class="keyword">int</span> H, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> time = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> p: piles)</span><br><span class="line">            time += (p-<span class="number">1</span>) / K + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> time &lt;= H;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>Python</summary><figure class="highlight python"><figcaption><span>[2q2E5AzB-Python]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minEatingSpeed</span><span class="params">(self, piles, H)</span>:</span></span><br><span class="line">        <span class="comment"># Can Koko eat all bananas in H hours with eating speed K?</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">possible</span><span class="params">(K)</span>:</span></span><br><span class="line">            <span class="keyword">return</span> sum((p<span class="number">-1</span>) / K + <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> piles) &lt;= H</span><br><span class="line"></span><br><span class="line">        lo, hi = <span class="number">1</span>, max(piles)</span><br><span class="line">        <span class="keyword">while</span> lo &lt; hi:</span><br><span class="line">            mi = (lo + hi) / <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> possible(mi):</span><br><span class="line">                lo = mi + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                hi = mi</span><br><span class="line">        <span class="keyword">return</span> lo</span><br></pre></td></tr></table></figure></details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿”å›å¥¹å¯ä»¥åœ¨ H å°æ—¶å†…åƒæ‰æ‰€æœ‰é¦™è•‰çš„æœ€å°é€Ÿåº¦ Kï¼ˆK ä¸ºæ•´æ•°ï¼‰ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Binary Search" scheme="http://yoursite.com/tags/Binary-Search/"/>
    
  </entry>
  
  <entry>
    <title>å‰‘æŒ‡ Offer II 073. ç‹’ç‹’åƒé¦™è•‰</title>
    <link href="http://yoursite.com/2021/12/17/%E5%89%91%E6%8C%87%20Offer%20II%20073.%20%E7%8B%92%E7%8B%92%E5%90%83%E9%A6%99%E8%95%89/"/>
    <id>http://yoursite.com/2021/12/17/å‰‘æŒ‡ Offer II 073. ç‹’ç‹’åƒé¦™è•‰/</id>
    <published>2021-12-17T11:30:12.000Z</published>
    <updated>2021-12-17T11:16:09.347Z</updated>
    
    <content type="html"><![CDATA[<p>è¿”å›å¥¹å¯ä»¥åœ¨ H å°æ—¶å†…åƒæ‰æ‰€æœ‰é¦™è•‰çš„æœ€å°é€Ÿåº¦ Kï¼ˆK ä¸ºæ•´æ•°ï¼‰ã€‚</p><a id="more"></a><p>[TOC]</p><p>ç‚ç‚å–œæ¬¢åƒé¦™è•‰ã€‚è¿™é‡Œæœ‰ N å †é¦™è•‰ï¼Œç¬¬ i å †ä¸­æœ‰ piles[i] æ ¹é¦™è•‰ã€‚è­¦å«å·²ç»ç¦»å¼€äº†ï¼Œå°†åœ¨ H å°æ—¶åå›æ¥ã€‚</p><p>ç‚ç‚å¯ä»¥å†³å®šå¥¹åƒé¦™è•‰çš„é€Ÿåº¦ K ï¼ˆå•ä½ï¼šæ ¹/å°æ—¶ï¼‰ã€‚æ¯ä¸ªå°æ—¶ï¼Œå¥¹å°†ä¼šé€‰æ‹©ä¸€å †é¦™è•‰ï¼Œä»ä¸­åƒæ‰ K æ ¹ã€‚å¦‚æœè¿™å †é¦™è•‰å°‘äº K æ ¹ï¼Œå¥¹å°†åƒæ‰è¿™å †çš„æ‰€æœ‰é¦™è•‰ï¼Œç„¶åè¿™ä¸€å°æ—¶å†…ä¸ä¼šå†åƒæ›´å¤šçš„é¦™è•‰ã€‚  </p><p>ç‚ç‚å–œæ¬¢æ…¢æ…¢åƒï¼Œä½†ä»ç„¶æƒ³åœ¨è­¦å«å›æ¥å‰åƒæ‰æ‰€æœ‰çš„é¦™è•‰ã€‚</p><p>è¿”å›å¥¹å¯ä»¥åœ¨ H å°æ—¶å†…åƒæ‰æ‰€æœ‰é¦™è•‰çš„æœ€å°é€Ÿåº¦ Kï¼ˆK ä¸ºæ•´æ•°ï¼‰ã€‚</p><p>æ³¨æ„ï¼šæœ¬é¢˜ä¸<a href="https://leetcode-cn.com/problems/nZZqjQ/" target="_blank" rel="noopener">875. çˆ±åƒé¦™è•‰çš„ç‚ç‚</a>ç›¸åŒ</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥: piles = [3,6,7,11], H = 8è¾“å‡º: 4</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥: piles = [30,11,23,4,20], H = 5è¾“å‡º: 30</code></pre><p>ç¤ºä¾‹ 3ï¼š</p><pre><code>è¾“å…¥: piles = [30,11,23,4,20], H = 6è¾“å‡º: 23</code></pre><p>æç¤ºï¼š</p><pre><code>1 &lt;= piles.length &lt;= 10^4piles.length &lt;= H &lt;= 10^91 &lt;= piles[i] &lt;= 10^9</code></pre><h1 id="äºŒåˆ†æŸ¥æ‰¾-1"><a href="#äºŒåˆ†æŸ¥æ‰¾-1" class="headerlink" title="äºŒåˆ†æŸ¥æ‰¾^1"></a>äºŒåˆ†æŸ¥æ‰¾<a href="https://leetcode-cn.com/problems/koko-eating-bananas/solution/ai-chi-xiang-jiao-de-ke-ke-by-leetcode/" target="_blank" rel="noopener">^1</a></h1><p><strong>æ€è·¯</strong></p><p>å¦‚æœç‚ç‚èƒ½ä»¥ <code>K</code> çš„è¿›é£Ÿé€Ÿåº¦æœ€ç»ˆåƒå®Œæ‰€æœ‰çš„é¦™è•‰ï¼ˆåœ¨ <code>H</code> å°æ—¶å†…ï¼‰ï¼Œé‚£ä¹ˆå¥¹ä¹Ÿå¯ä»¥ç”¨æ›´å¿«çš„é€Ÿåº¦åƒå®Œã€‚</p><p>å½“ç‚ç‚èƒ½ä»¥ <code>K</code> çš„è¿›é£Ÿé€Ÿåº¦åƒå®Œé¦™è•‰æ—¶ï¼Œæˆ‘ä»¬ä»¤ <code>possible(K)</code> ä¸º <code>true</code>ï¼Œé‚£ä¹ˆå°±å­˜åœ¨ <code>X</code> ä½¿å¾—å½“ <code>K &gt;= X</code> æ—¶ï¼Œ <code>possible(K) = True</code>ã€‚</p><p>ä¸¾ä¸ªä¾‹å­ï¼Œå½“åˆå§‹æ¡ä»¶ä¸º <code>piles = [3, 6, 7, 11]</code> å’Œ <code>H = 8</code> æ—¶ï¼Œå­˜åœ¨ <code>X = 4</code> ä½¿å¾— <code>possible(1) = possible(2) = possible(3) = False</code>ï¼Œä¸” <code>possible(4) = possible(5) = ... = True</code>ã€‚</p><p><strong>ç®—æ³•</strong></p><p>æˆ‘ä»¬å¯ä»¥äºŒåˆ†æŸ¥æ‰¾ <code>possible(K)</code> çš„å€¼æ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªä½¿å¾— <code>possible(X)</code> ä¸º <code>True</code> çš„ <code>X</code>ï¼šè¿™å°†æ˜¯æˆ‘ä»¬çš„ç­”æ¡ˆã€‚æˆ‘ä»¬çš„å¾ªç¯ä¸­ï¼Œä¸å˜é‡ <code>possible(hi)</code> æ€»ä¸º <code>True</code>ï¼Œ <code>lo</code> æ€»å°äºç­‰äºç­”æ¡ˆã€‚æœ‰å…³äºŒåˆ†æŸ¥æ‰¾çš„æ›´å¤šä¿¡æ¯ï¼Œè¯·å‚é˜…<a href="https://leetcode-cn.com/explore/learn/card/binary-search/" target="_blank" rel="noopener">ã€ŠåŠ›æ‰£æ¢ç´¢ï¼šäºŒåˆ†æŸ¥æ‰¾ã€‹</a>ã€‚</p><p>ä¸ºäº†æ‰¾åˆ° <code>possible(K)</code> çš„å€¼ï¼Œ (å³<code>ç‚ç‚</code>æ˜¯å¦èƒ½ä»¥ <code>K</code> çš„è¿›é£Ÿé€Ÿåº¦åœ¨ <code>H</code> å°æ—¶å†…åƒå®Œæ‰€æœ‰çš„é¦™è•‰ï¼‰ï¼Œæˆ‘ä»¬æ¨¡æ‹Ÿè¿™ä¸€æƒ…æ™¯ã€‚å¯¹äºæ¯ä¸€å †ï¼ˆå¤§å° <code>p &gt; 0</code>ï¼‰ï¼Œæˆ‘ä»¬å¯ä»¥æ¨æ–­å‡ºç‚ç‚å°†åœ¨ <code>Math.ceil(p / K) = ((p-1) // K) + 1</code> å°æ—¶å†…åƒå®Œè¿™ä¸€å †ï¼Œæˆ‘ä»¬å°†æ¯ä¸€å †çš„å®Œæˆæ—¶é—´åŠ åœ¨ä¸€èµ·å¹¶ä¸ <code>H</code> è¿›è¡Œæ¯”è¾ƒã€‚</p><details>    <summary>cpp</summary><figure class="highlight cpp"><figcaption><span>[2q2E5AzB-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minEatingSpeed</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; piles, <span class="keyword">int</span> H)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> lo = <span class="number">1</span>, hi = <span class="built_in">pow</span>(<span class="number">10</span>, <span class="number">9</span>);</span><br><span class="line">        <span class="keyword">while</span> (lo &lt; hi) &#123;</span><br><span class="line">            <span class="keyword">int</span> mi = lo + (hi - lo) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (!possible(piles, H, mi))</span><br><span class="line">                lo = mi + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                hi = mi;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> lo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Can Koko eat all bananas in H hours with eating speed K?</span></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">possible</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; piles, <span class="keyword">int</span> H, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> time = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> p: piles)</span><br><span class="line">            time += (p - <span class="number">1</span>) / K + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> time &lt;= H;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[2q2E5AzB-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minEatingSpeed</span><span class="params">(<span class="keyword">int</span>[] piles, <span class="keyword">int</span> H)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> lo = <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">int</span> hi = <span class="number">1_000_000_000</span>;</span><br><span class="line">        <span class="keyword">while</span> (lo &lt; hi) &#123;</span><br><span class="line">            <span class="keyword">int</span> mi = (lo + hi) / <span class="number">2</span>;</span><br><span class="line">            <span class="keyword">if</span> (!possible(piles, H, mi))</span><br><span class="line">                lo = mi + <span class="number">1</span>;</span><br><span class="line">            <span class="keyword">else</span></span><br><span class="line">                hi = mi;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> lo;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Can Koko eat all bananas in H hours with eating speed K?</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">possible</span><span class="params">(<span class="keyword">int</span>[] piles, <span class="keyword">int</span> H, <span class="keyword">int</span> K)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> time = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> p: piles)</span><br><span class="line">            time += (p-<span class="number">1</span>) / K + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">return</span> time &lt;= H;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>Python</summary><figure class="highlight python"><figcaption><span>[2q2E5AzB-Python]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span><span class="params">(object)</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minEatingSpeed</span><span class="params">(self, piles, H)</span>:</span></span><br><span class="line">        <span class="comment"># Can Koko eat all bananas in H hours with eating speed K?</span></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">possible</span><span class="params">(K)</span>:</span></span><br><span class="line">            <span class="keyword">return</span> sum((p<span class="number">-1</span>) / K + <span class="number">1</span> <span class="keyword">for</span> p <span class="keyword">in</span> piles) &lt;= H</span><br><span class="line"></span><br><span class="line">        lo, hi = <span class="number">1</span>, max(piles)</span><br><span class="line">        <span class="keyword">while</span> lo &lt; hi:</span><br><span class="line">            mi = (lo + hi) / <span class="number">2</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> possible(mi):</span><br><span class="line">                lo = mi + <span class="number">1</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                hi = mi</span><br><span class="line">        <span class="keyword">return</span> lo</span><br></pre></td></tr></table></figure></details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿”å›å¥¹å¯ä»¥åœ¨ H å°æ—¶å†…åƒæ‰æ‰€æœ‰é¦™è•‰çš„æœ€å°é€Ÿåº¦ Kï¼ˆK ä¸ºæ•´æ•°ï¼‰ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Binary Search" scheme="http://yoursite.com/tags/Binary-Search/"/>
    
  </entry>
  
  <entry>
    <title>403. é’è›™è¿‡æ²³</title>
    <link href="http://yoursite.com/2021/12/17/403.%20%E9%9D%92%E8%9B%99%E8%BF%87%E6%B2%B3/"/>
    <id>http://yoursite.com/2021/12/17/403. é’è›™è¿‡æ²³/</id>
    <published>2021-12-17T07:30:12.000Z</published>
    <updated>2021-12-17T10:33:56.730Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€åªé’è›™æƒ³è¦è¿‡æ²³ã€‚ å‡å®šæ²³æµè¢«ç­‰åˆ†ä¸ºè‹¥å¹²ä¸ªå•å…ƒæ ¼ï¼Œå¹¶ä¸”åœ¨æ¯ä¸€ä¸ªå•å…ƒæ ¼å†…éƒ½æœ‰å¯èƒ½æ”¾æœ‰ä¸€å—çŸ³å­ï¼ˆä¹Ÿæœ‰å¯èƒ½æ²¡æœ‰ï¼‰ã€‚ é’è›™å¯ä»¥è·³ä¸ŠçŸ³å­ï¼Œä½†æ˜¯ä¸å¯ä»¥è·³å…¥æ°´ä¸­ã€‚</p><p>ç»™ä½ çŸ³å­çš„ä½ç½®åˆ—è¡¨ stonesï¼ˆç”¨å•å…ƒæ ¼åºå· å‡åº è¡¨ç¤ºï¼‰ï¼Œ è¯·åˆ¤å®šé’è›™èƒ½å¦æˆåŠŸè¿‡æ²³ï¼ˆå³èƒ½å¦åœ¨æœ€åä¸€æ­¥è·³è‡³æœ€åä¸€å—çŸ³å­ä¸Šï¼‰ã€‚</p><a id="more"></a><p>[TOC]</p><p>å¼€å§‹æ—¶ï¼Œ é’è›™é»˜è®¤å·²ç«™åœ¨ç¬¬ä¸€å—çŸ³å­ä¸Šï¼Œå¹¶å¯ä»¥å‡å®šå®ƒç¬¬ä¸€æ­¥åªèƒ½è·³è·ƒä¸€ä¸ªå•ä½ï¼ˆå³åªèƒ½ä»å•å…ƒæ ¼ 1 è·³è‡³å•å…ƒæ ¼ 2 ï¼‰ã€‚</p><p>å¦‚æœé’è›™ä¸Šä¸€æ­¥è·³è·ƒäº† k ä¸ªå•ä½ï¼Œé‚£ä¹ˆå®ƒæ¥ä¸‹æ¥çš„è·³è·ƒè·ç¦»åªèƒ½é€‰æ‹©ä¸º k - 1ã€k æˆ– k + 1 ä¸ªå•ä½ã€‚ å¦è¯·æ³¨æ„ï¼Œé’è›™åªèƒ½å‘å‰æ–¹ï¼ˆç»ˆç‚¹çš„æ–¹å‘ï¼‰è·³è·ƒã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼šstones = [0,1,3,5,6,8,12,17]è¾“å‡ºï¼štrueè§£é‡Šï¼šé’è›™å¯ä»¥æˆåŠŸè¿‡æ²³ï¼ŒæŒ‰ç…§å¦‚ä¸‹æ–¹æ¡ˆè·³è·ƒï¼šè·³ 1 ä¸ªå•ä½åˆ°ç¬¬ 2 å—çŸ³å­, ç„¶åè·³ 2 ä¸ªå•ä½åˆ°ç¬¬ 3 å—çŸ³å­, æ¥ç€ è·³ 2 ä¸ªå•ä½åˆ°ç¬¬ 4 å—çŸ³å­, ç„¶åè·³ 3 ä¸ªå•ä½åˆ°ç¬¬ 6 å—çŸ³å­, è·³ 4 ä¸ªå•ä½åˆ°ç¬¬ 7 å—çŸ³å­, æœ€åï¼Œè·³ 5 ä¸ªå•ä½åˆ°ç¬¬ 8 ä¸ªçŸ³å­ï¼ˆå³æœ€åä¸€å—çŸ³å­ï¼‰ã€‚</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼šstones = [0,1,2,3,4,8,9,11]è¾“å‡ºï¼šfalseè§£é‡Šï¼šè¿™æ˜¯å› ä¸ºç¬¬ 5 å’Œç¬¬ 6 ä¸ªçŸ³å­ä¹‹é—´çš„é—´è·å¤ªå¤§ï¼Œæ²¡æœ‰å¯é€‰çš„æ–¹æ¡ˆä¾›é’è›™è·³è·ƒè¿‡å»ã€‚</code></pre><p>æç¤ºï¼š</p><pre><code>2 &lt;= stones.length &lt;= 20000 &lt;= stones[i] &lt;= 231 - 1stones[0] == 0</code></pre><h1 id="æ–¹æ³•ä¸€ï¼šè®°å¿†åŒ–æœç´¢-äºŒåˆ†æŸ¥æ‰¾-1"><a href="#æ–¹æ³•ä¸€ï¼šè®°å¿†åŒ–æœç´¢-äºŒåˆ†æŸ¥æ‰¾-1" class="headerlink" title="æ–¹æ³•ä¸€ï¼šè®°å¿†åŒ–æœç´¢ + äºŒåˆ†æŸ¥æ‰¾^1"></a>æ–¹æ³•ä¸€ï¼šè®°å¿†åŒ–æœç´¢ + äºŒåˆ†æŸ¥æ‰¾<a href="https://leetcode-cn.com/problems/frog-jump/solution/qing-wa-guo-he-by-leetcode-solution-mbuo/" target="_blank" rel="noopener">^1</a></h1><p><strong>æ€è·¯åŠç®—æ³•</strong></p><p>æœ€ç›´æ¥çš„æƒ³æ³•æ˜¯ä½¿ç”¨æ·±åº¦ä¼˜å…ˆæœç´¢çš„æ–¹å¼å°è¯•æ‰€æœ‰è·³è·ƒæ–¹æ¡ˆï¼Œç›´åˆ°æˆ‘ä»¬æ‰¾åˆ°ä¸€ç»„å¯è¡Œè§£ä¸ºæ­¢ã€‚ä½†æ˜¯ä¸åŠ ä¼˜åŒ–çš„è¯¥ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦åœ¨æœ€åæƒ…å†µä¸‹æ˜¯æŒ‡æ•°çº§çš„ï¼Œå› æ­¤è€ƒè™‘ä¼˜åŒ–ã€‚</p><p>æ³¨æ„åˆ°å½“é’è›™æ¯æ¬¡èƒ½å¤Ÿè·³è·ƒçš„è·ç¦»ä»…å–å†³äºé’è›™çš„ã€Œä¸Šä¸€æ¬¡è·³è·ƒè·ç¦»ã€ã€‚è€Œé’è›™æ­¤åèƒ½å¦åˆ°è¾¾ç»ˆç‚¹ï¼Œåªå’Œå®ƒã€Œç°åœ¨æ‰€å¤„çš„çŸ³å­ç¼–å·ã€ä»¥åŠã€Œä¸Šä¸€æ¬¡è·³è·ƒè·ç¦»ã€æœ‰å…³ã€‚å› æ­¤æˆ‘ä»¬å¯ä»¥å°†è¿™ä¸¤ä¸ªç»´åº¦ç»¼åˆè®°å½•ä¸ºä¸€ä¸ªçŠ¶æ€ã€‚ä½¿ç”¨è®°å¿†åŒ–æœç´¢çš„æ–¹å¼ä¼˜åŒ–æ—¶é—´å¤æ‚åº¦ã€‚</p><p>å…·ä½“åœ°ï¼Œå½“é’è›™ä½äºç¬¬ <em>i</em> ä¸ªçŸ³å­ï¼Œä¸Šæ¬¡è·³è·ƒè·ç¦»ä¸º lastDis æ—¶ï¼Œå®ƒå½“å‰èƒ½å¤Ÿè·³è·ƒçš„è·ç¦»èŒƒå›´ä¸º[lastDis-1,lastDis+1]ã€‚æˆ‘ä»¬éœ€è¦åˆ†åˆ«åˆ¤æ–­è¿™ä¸‰ä¸ªè·ç¦»å¯¹åº”çš„ä¸‰ä¸ªä½ç½®æ˜¯å¦å­˜åœ¨çŸ³å­ã€‚æ³¨æ„åˆ°ç»™å®šçš„çŸ³å­åˆ—è¡¨ä¸ºå‡åºï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥åˆ©ç”¨äºŒåˆ†æŸ¥æ‰¾æ¥ä¼˜åŒ–æŸ¥æ‰¾çŸ³å­çš„æ—¶é—´å¤æ‚åº¦ã€‚æ¯æ¬¡æˆ‘ä»¬æ‰¾åˆ°äº†ç¬¦åˆè¦æ±‚çš„ä½ç½®ï¼Œæˆ‘ä»¬å°±å°è¯•è¿›è¡Œä¸€æ¬¡é€’å½’æœç´¢å³å¯ã€‚</p><p>ä¸ºäº†ä¼˜åŒ–ç¼–ç ï¼Œæˆ‘ä»¬å¯ä»¥è®¤ä¸ºé’è›™çš„åˆå§‹çŠ¶æ€ä¸ºï¼šã€Œç°åœ¨æ‰€å¤„çš„çŸ³å­ç¼–å·ã€ä¸º <em>0</em>ï¼ˆçŸ³å­ä» <em>0</em> å¼€å§‹ç¼–å·ï¼‰ï¼Œã€Œä¸Šä¸€æ¬¡è·³è·ƒè·ç¦»ã€ä¸º <em>0</em>ï¼ˆè¿™æ ·å¯ä»¥ä¿è¯é’è›™çš„ç¬¬ä¸€æ¬¡è·³è·ƒè·ç¦»ä¸º <em>1</em>ï¼‰ã€‚</p><p><strong>ä»£ç </strong></p><details>    <summary>C++</summary><figure class="highlight c++"><figcaption><span>[sol1-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="built_in">unordered_map</span>&lt;<span class="keyword">int</span>, <span class="keyword">int</span>&gt;&gt; rec;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; stones, <span class="keyword">int</span> i, <span class="keyword">int</span> lastDis)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i == stones.size() - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (rec[i].count(lastDis)) &#123;</span><br><span class="line">            <span class="keyword">return</span> rec[i][lastDis];</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> curDis = lastDis - <span class="number">1</span>; curDis &lt;= lastDis + <span class="number">1</span>; curDis++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (curDis &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">int</span> j = lower_bound(stones.begin(), stones.end(), curDis + stones[i]) - stones.begin();</span><br><span class="line">                <span class="keyword">if</span> (j != stones.size() &amp;&amp; stones[j] == curDis + stones[i] &amp;&amp; dfs(stones, j, curDis)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> rec[i][lastDis] = <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rec[i][lastDis] = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canCross</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; stones)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = stones.size();</span><br><span class="line">        rec.resize(n);</span><br><span class="line">        <span class="keyword">return</span> dfs(stones, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[sol1-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> Boolean[][] rec;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canCross</span><span class="params">(<span class="keyword">int</span>[] stones)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = stones.length;</span><br><span class="line">        rec = <span class="keyword">new</span> Boolean[n][n];</span><br><span class="line">        <span class="keyword">return</span> dfs(stones, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">private</span> <span class="keyword">boolean</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span>[] stones, <span class="keyword">int</span> i, <span class="keyword">int</span> lastDis)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (i == stones.length - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (rec[i][lastDis] != <span class="keyword">null</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> rec[i][lastDis];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> curDis = lastDis - <span class="number">1</span>; curDis &lt;= lastDis + <span class="number">1</span>; curDis++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (curDis &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">int</span> j = Arrays.binarySearch(stones, i + <span class="number">1</span>, stones.length, curDis + stones[i]);</span><br><span class="line">                <span class="keyword">if</span> (j &gt;= <span class="number">0</span> &amp;&amp; dfs(stones, j, curDis)) &#123;</span><br><span class="line">                    <span class="keyword">return</span> rec[i][lastDis] = <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> rec[i][lastDis] = <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>JavaScript</summary><figure class="highlight javascript"><figcaption><span>[sol1-JavaScript]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canCross = <span class="function"><span class="keyword">function</span>(<span class="params">stones</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> n = stones.length;</span><br><span class="line">    rec = <span class="keyword">new</span> <span class="built_in">Array</span>(n).fill(<span class="number">0</span>).map(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Map</span>());</span><br><span class="line"></span><br><span class="line">    <span class="keyword">const</span> dfs = <span class="function">(<span class="params">stones, i, lastDis</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span> (i === stones.length - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (rec[i].has(lastDis)) &#123;</span><br><span class="line">            <span class="keyword">return</span> rec[i].get(lastDis);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> curDis = lastDis - <span class="number">1</span>; curDis &lt;= lastDis + <span class="number">1</span>; curDis++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (curDis &gt; <span class="number">0</span>) &#123;</span><br><span class="line">                <span class="keyword">const</span> j = lower_bound(stones, curDis + stones[i]);</span><br><span class="line">                <span class="keyword">if</span> (j !== stones.length &amp;&amp; stones[j] === curDis + stones[i] &amp;&amp; dfs(stones, j, curDis)) &#123;</span><br><span class="line">                    rec[i].set(lastDis, <span class="literal">true</span>);</span><br><span class="line">                    <span class="keyword">return</span> rec[i].get(lastDis);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        rec[i].set(lastDis, <span class="literal">false</span>);</span><br><span class="line">        <span class="keyword">return</span> rec[i].get(lastDis);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> dfs(stones, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">lower_bound</span>(<span class="params">nums, target</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">let</span> lo = <span class="number">0</span>, hi = nums.length;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">while</span> (lo &lt; hi) &#123;</span><br><span class="line">        <span class="keyword">const</span> mid = lo + <span class="built_in">Math</span>.floor((hi - lo) / <span class="number">2</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (nums[mid] &gt;= target) &#123;</span><br><span class="line">            hi = mid;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            lo = mid + <span class="number">1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> lo;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>Golang</summary><figure class="highlight go"><figcaption><span>[sol1-Golang]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">canCross</span><span class="params">(stones []<span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    n := <span class="built_in">len</span>(stones)</span><br><span class="line">    dp := <span class="built_in">make</span>([]<span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">bool</span>, n<span class="number">-1</span>)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="keyword">range</span> dp &#123;</span><br><span class="line">        dp[i] = <span class="keyword">map</span>[<span class="keyword">int</span>]<span class="keyword">bool</span>&#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">var</span> dfs <span class="function"><span class="keyword">func</span><span class="params">(<span class="keyword">int</span>, <span class="keyword">int</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function">    <span class="title">dfs</span> = <span class="title">func</span><span class="params">(i, lastDis <span class="keyword">int</span>)</span> <span class="params">(res <span class="keyword">bool</span>)</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> i == n<span class="number">-1</span> &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> res, has := dp[i][lastDis]; has &#123;</span><br><span class="line">            <span class="keyword">return</span> res</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">defer</span> <span class="function"><span class="keyword">func</span><span class="params">()</span></span> &#123; dp[i][lastDis] = res &#125;()</span><br><span class="line">        <span class="keyword">for</span> curDis := lastDis - <span class="number">1</span>; curDis &lt;= lastDis+<span class="number">1</span>; curDis++ &#123;</span><br><span class="line">            <span class="keyword">if</span> curDis &gt; <span class="number">0</span> &#123;</span><br><span class="line">                j := sort.SearchInts(stones, curDis+stones[i])</span><br><span class="line">                <span class="keyword">if</span> j != n &amp;&amp; stones[j] == curDis+stones[i] &amp;&amp; dfs(j, curDis) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dfs(<span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>C</summary><figure class="highlight c"><figcaption><span>[sol1-C]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HashTable</span> &#123;</span></span><br><span class="line">    <span class="keyword">int</span> key, val;</span><br><span class="line">    UT_hash_handle hh;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">struct</span> <span class="title">HashTable</span>** <span class="title">rec</span>;</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">count</span><span class="params">(struct HashTable** hashTable, <span class="keyword">int</span> ikey)</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">HashTable</span>* <span class="title">tmp</span>;</span></span><br><span class="line">    HASH_FIND_INT(*hashTable, &amp;ikey, tmp);</span><br><span class="line">    <span class="keyword">return</span> tmp != <span class="literal">NULL</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">modify</span><span class="params">(struct HashTable** hashTable, <span class="keyword">int</span> ikey, <span class="keyword">int</span> ival)</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">HashTable</span>* <span class="title">tmp</span>;</span></span><br><span class="line">    HASH_FIND_INT(*hashTable, &amp;ikey, tmp);</span><br><span class="line">    <span class="keyword">if</span> (tmp == <span class="literal">NULL</span>) &#123;</span><br><span class="line">        tmp = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct HashTable));</span><br><span class="line">        tmp-&gt;key = ikey, tmp-&gt;val = ival;</span><br><span class="line">        HASH_ADD_INT(*hashTable, key, tmp);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        tmp-&gt;val = ival;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> ival;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">query</span><span class="params">(struct HashTable** hashTable, <span class="keyword">int</span> ikey)</span> </span>&#123;</span><br><span class="line">    <span class="class"><span class="keyword">struct</span> <span class="title">HashTable</span>* <span class="title">tmp</span>;</span></span><br><span class="line">    HASH_FIND_INT(*hashTable, &amp;ikey, tmp);</span><br><span class="line">    <span class="keyword">return</span> tmp-&gt;val;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">lower_bound</span><span class="params">(<span class="keyword">int</span>* stones, <span class="keyword">int</span> stonesSize, <span class="keyword">int</span> target)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> left = <span class="number">0</span>, right = stonesSize;</span><br><span class="line">    <span class="keyword">while</span> (left &lt; right) &#123;</span><br><span class="line">        <span class="keyword">int</span> mid = (left + right) &gt;&gt; <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">if</span> (stones[mid] &lt; target) &#123;</span><br><span class="line">            left = mid + <span class="number">1</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            right = mid;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> left;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">dfs</span><span class="params">(<span class="keyword">int</span>* stones, <span class="keyword">int</span> stonesSize, <span class="keyword">int</span> i, <span class="keyword">int</span> lastDis)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (i == stonesSize - <span class="number">1</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (count(&amp;rec[i], lastDis)) &#123;</span><br><span class="line">        <span class="keyword">return</span> query(&amp;rec[i], lastDis);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> curDis = lastDis - <span class="number">1</span>; curDis &lt;= lastDis + <span class="number">1</span>; curDis++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (curDis &gt; <span class="number">0</span>) &#123;</span><br><span class="line">            <span class="keyword">int</span> j = lower_bound(stones, stonesSize, curDis + stones[i]);</span><br><span class="line">            <span class="keyword">if</span> (j != stonesSize &amp;&amp; stones[j] == curDis + stones[i] &amp;&amp; dfs(stones, stonesSize, j, curDis)) &#123;</span><br><span class="line">                <span class="keyword">return</span> modify(&amp;rec[i], lastDis, <span class="literal">true</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> modify(&amp;rec[i], lastDis, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">canCross</span><span class="params">(<span class="keyword">int</span>* stones, <span class="keyword">int</span> stonesSize)</span> </span>&#123;</span><br><span class="line">    rec = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(struct HashTable*) * stonesSize);</span><br><span class="line">    <span class="built_in">memset</span>(rec, <span class="number">0</span>, <span class="keyword">sizeof</span>(struct HashTable*) * stonesSize);</span><br><span class="line">    <span class="keyword">return</span> dfs(stones, stonesSize, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h1 id="æ–¹æ³•äºŒï¼šåŠ¨æ€è§„åˆ’"><a href="#æ–¹æ³•äºŒï¼šåŠ¨æ€è§„åˆ’" class="headerlink" title="æ–¹æ³•äºŒï¼šåŠ¨æ€è§„åˆ’"></a>æ–¹æ³•äºŒï¼šåŠ¨æ€è§„åˆ’</h1><p><strong>æ€è·¯åŠç®—æ³•</strong></p><p>ã€‚</p><p><strong>ä»£ç </strong></p><details>    <summary>C++</summary><figure class="highlight c++"><figcaption><span>[sol2-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">canCross</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; stones)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = stones.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&gt; dp(n, <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;(n));</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (stones[i] - stones[i - <span class="number">1</span>] &gt; i) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">                <span class="keyword">int</span> k = stones[i] - stones[j];</span><br><span class="line">                <span class="keyword">if</span> (k &gt; j + <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                dp[i][k] = dp[j][k - <span class="number">1</span>] || dp[j][k] || dp[j][k + <span class="number">1</span>];</span><br><span class="line">                <span class="keyword">if</span> (i == n - <span class="number">1</span> &amp;&amp; dp[i][k]) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[sol2-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">canCross</span><span class="params">(<span class="keyword">int</span>[] stones)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = stones.length;</span><br><span class="line">        <span class="keyword">boolean</span>[][] dp = <span class="keyword">new</span> <span class="keyword">boolean</span>[n][n];</span><br><span class="line">        dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="keyword">true</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">if</span> (stones[i] - stones[i - <span class="number">1</span>] &gt; i) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">            <span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">                <span class="keyword">int</span> k = stones[i] - stones[j];</span><br><span class="line">                <span class="keyword">if</span> (k &gt; j + <span class="number">1</span>) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                dp[i][k] = dp[j][k - <span class="number">1</span>] || dp[j][k] || dp[j][k + <span class="number">1</span>];</span><br><span class="line">                <span class="keyword">if</span> (i == n - <span class="number">1</span> &amp;&amp; dp[i][k]) &#123;</span><br><span class="line">                    <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>JavaScript</summary><figure class="highlight javascript"><figcaption><span>[sol2-JavaScript]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> canCross = <span class="function"><span class="keyword">function</span>(<span class="params">stones</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> n = stones.length;</span><br><span class="line">    <span class="keyword">const</span> dp = <span class="keyword">new</span> <span class="built_in">Array</span>(n).fill(<span class="number">0</span>).map(<span class="function"><span class="params">()</span> =&gt;</span> <span class="keyword">new</span> <span class="built_in">Array</span>(n).fill(<span class="number">0</span>));</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (stones[i] - stones[i - <span class="number">1</span>] &gt; i) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">1</span>; i &lt; n; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">let</span> j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">            <span class="keyword">const</span> k = stones[i] - stones[j];</span><br><span class="line">            <span class="keyword">if</span> (k &gt; j + <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            dp[i][k] = dp[j][k - <span class="number">1</span>] || dp[j][k] || dp[j][k + <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (i === n - <span class="number">1</span> &amp;&amp; dp[i][k]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>Golang</summary><figure class="highlight go"><figcaption><span>[sol2-Golang]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">canCross</span><span class="params">(stones []<span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">    n := <span class="built_in">len</span>(stones)</span><br><span class="line">    dp := <span class="built_in">make</span>([][]<span class="keyword">bool</span>, n)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="keyword">range</span> dp &#123;</span><br><span class="line">        dp[i] = <span class="built_in">make</span>([]<span class="keyword">bool</span>, n)</span><br><span class="line">    &#125;</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="literal">true</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">1</span>; i &lt; n; i++ &#123;</span><br><span class="line">        <span class="keyword">if</span> stones[i]-stones[i<span class="number">-1</span>] &gt; i &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">1</span>; i &lt; n; i++ &#123;</span><br><span class="line">        <span class="keyword">for</span> j := i - <span class="number">1</span>; j &gt;= <span class="number">0</span>; j-- &#123;</span><br><span class="line">            k := stones[i] - stones[j]</span><br><span class="line">            <span class="keyword">if</span> k &gt; j+<span class="number">1</span> &#123;</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line">            dp[i][k] = dp[j][k<span class="number">-1</span>] || dp[j][k] || dp[j][k+<span class="number">1</span>]</span><br><span class="line">            <span class="keyword">if</span> i == n<span class="number">-1</span> &amp;&amp; dp[i][k] &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>C</summary><figure class="highlight c"><figcaption><span>[sol2-C]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">canCross</span><span class="params">(<span class="keyword">int</span>* stones, <span class="keyword">int</span> stonesSize)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> dp[stonesSize][stonesSize];</span><br><span class="line">    <span class="built_in">memset</span>(dp, <span class="number">0</span>, <span class="keyword">sizeof</span>(dp));</span><br><span class="line">    dp[<span class="number">0</span>][<span class="number">0</span>] = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; stonesSize; ++i) &#123;</span><br><span class="line">        <span class="keyword">if</span> (stones[i] - stones[i - <span class="number">1</span>] &gt; i) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">1</span>; i &lt; stonesSize; ++i) &#123;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> j = i - <span class="number">1</span>; j &gt;= <span class="number">0</span>; --j) &#123;</span><br><span class="line">            <span class="keyword">int</span> k = stones[i] - stones[j];</span><br><span class="line">            <span class="keyword">if</span> (k &gt; j + <span class="number">1</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            dp[i][k] = dp[j][k - <span class="number">1</span>] || dp[j][k] || dp[j][k + <span class="number">1</span>];</span><br><span class="line">            <span class="keyword">if</span> (i == stonesSize - <span class="number">1</span> &amp;&amp; dp[i][k]) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li><p>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(n^2)*ï¼Œå…¶ä¸­ *n</em> æ˜¯çŸ³å­çš„æ•°é‡ã€‚å› ä¸ºé’è›™ä»…èƒ½åœ¨çŸ³å­é—´è·³è·ƒï¼Œä¸”ä¸èƒ½å‘åæ–¹ï¼ˆèµ·ç‚¹çš„æ–¹å‘ï¼‰è·³è·ƒï¼Œè€Œç¬¬ <em>i</em> ä¸ªçŸ³å­åæ–¹åªæœ‰ <em>i-1</em> ä¸ªçŸ³å­ï¼Œå› æ­¤åœ¨ä»»æ„ä½ç½®ï¼Œé’è›™çš„ã€Œä¸Šä¸€æ¬¡è·³è·ƒè·ç¦»ã€è‡³å¤šåªæœ‰ <em>n</em> ç§ï¼ŒçŠ¶æ€æ€»æ•°ä¸º <em>n^2*ã€‚æœ€åæƒ…å†µä¸‹æˆ‘ä»¬è¦éå†æ¯ä¸€ä¸ªçŠ¶æ€ï¼Œæ¯æ¬¡æˆ‘ä»¬åªéœ€è¦ *O(1)</em> çš„æ—¶é—´è®¡ç®—å½“å‰çŠ¶æ€æ˜¯å¦å¯è¾¾ï¼Œç›¸ä¹˜å³å¯å¾—åˆ°æœ€ç»ˆæ—¶é—´å¤æ‚åº¦ã€‚</p></li><li><p>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(n^2)*ï¼Œå…¶ä¸­ *n</em> æ˜¯çŸ³å­çš„æ•°é‡ã€‚æˆ‘ä»¬éœ€è¦è®°å½•å…¨éƒ¨ <em>n^2</em> ä¸ªçŠ¶æ€ã€‚</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸€åªé’è›™æƒ³è¦è¿‡æ²³ã€‚ å‡å®šæ²³æµè¢«ç­‰åˆ†ä¸ºè‹¥å¹²ä¸ªå•å…ƒæ ¼ï¼Œå¹¶ä¸”åœ¨æ¯ä¸€ä¸ªå•å…ƒæ ¼å†…éƒ½æœ‰å¯èƒ½æ”¾æœ‰ä¸€å—çŸ³å­ï¼ˆä¹Ÿæœ‰å¯èƒ½æ²¡æœ‰ï¼‰ã€‚ é’è›™å¯ä»¥è·³ä¸ŠçŸ³å­ï¼Œä½†æ˜¯ä¸å¯ä»¥è·³å…¥æ°´ä¸­ã€‚&lt;/p&gt;
&lt;p&gt;ç»™ä½ çŸ³å­çš„ä½ç½®åˆ—è¡¨ stonesï¼ˆç”¨å•å…ƒæ ¼åºå· å‡åº è¡¨ç¤ºï¼‰ï¼Œ è¯·åˆ¤å®šé’è›™èƒ½å¦æˆåŠŸè¿‡æ²³ï¼ˆå³èƒ½å¦åœ¨æœ€åä¸€æ­¥è·³è‡³æœ€åä¸€å—çŸ³å­ä¸Šï¼‰ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
  </entry>
  
  <entry>
    <title>1884. é¸¡è›‹æ‰è½-ä¸¤æšé¸¡è›‹</title>
    <link href="http://yoursite.com/2021/12/16/1884.%20%E9%B8%A1%E8%9B%8B%E6%8E%89%E8%90%BD-%E4%B8%A4%E6%9E%9A%E9%B8%A1%E8%9B%8B/"/>
    <id>http://yoursite.com/2021/12/16/1884. é¸¡è›‹æ‰è½-ä¸¤æšé¸¡è›‹/</id>
    <published>2021-12-16T14:30:12.000Z</published>
    <updated>2021-12-17T07:31:29.457Z</updated>
    
    <content type="html"><![CDATA[<p>è¯·ä½ è®¡ç®—å¹¶è¿”å›è¦ç¡®å®š f ç¡®åˆ‡çš„å€¼ çš„ æœ€å°æ“ä½œæ¬¡æ•° æ˜¯å¤šå°‘ï¼Ÿ</p><a id="more"></a><p>[TOC]</p><p>ç»™ä½  2 æšç›¸åŒ çš„é¸¡è›‹ï¼Œå’Œä¸€æ ‹ä»ç¬¬ 1 å±‚åˆ°ç¬¬ n å±‚å…±æœ‰ n å±‚æ¥¼çš„å»ºç­‘ã€‚</p><p>å·²çŸ¥å­˜åœ¨æ¥¼å±‚ f ï¼Œæ»¡è¶³ 0 &lt;= f &lt;= n ï¼Œä»»ä½•ä» é«˜äº f çš„æ¥¼å±‚è½ä¸‹çš„é¸¡è›‹éƒ½ ä¼šç¢ ï¼Œä» f æ¥¼å±‚æˆ–æ¯”å®ƒä½ çš„æ¥¼å±‚è½ä¸‹çš„é¸¡è›‹éƒ½ ä¸ä¼šç¢ ã€‚</p><p>æ¯æ¬¡æ“ä½œï¼Œä½ å¯ä»¥å–ä¸€æš æ²¡æœ‰ç¢ çš„é¸¡è›‹å¹¶æŠŠå®ƒä»ä»»ä¸€æ¥¼å±‚ x æ‰”ä¸‹ï¼ˆæ»¡è¶³ 1 &lt;= x &lt;= nï¼‰ã€‚å¦‚æœé¸¡è›‹ç¢äº†ï¼Œä½ å°±ä¸èƒ½å†æ¬¡ä½¿ç”¨å®ƒã€‚å¦‚æœæŸæšé¸¡è›‹æ‰”ä¸‹åæ²¡æœ‰æ‘”ç¢ï¼Œåˆ™å¯ä»¥åœ¨ä¹‹åçš„æ“ä½œä¸­ é‡å¤ä½¿ç”¨ è¿™æšé¸¡è›‹ã€‚</p><p>è¯·ä½ è®¡ç®—å¹¶è¿”å›è¦ç¡®å®š f ç¡®åˆ‡çš„å€¼ çš„ æœ€å°æ“ä½œæ¬¡æ•° æ˜¯å¤šå°‘ï¼Ÿ</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼šn = 2è¾“å‡ºï¼š2è§£é‡Šï¼šæˆ‘ä»¬å¯ä»¥å°†ç¬¬ä¸€æšé¸¡è›‹ä» 1 æ¥¼æ‰”ä¸‹ï¼Œç„¶åå°†ç¬¬äºŒæšä» 2 æ¥¼æ‰”ä¸‹ã€‚å¦‚æœç¬¬ä¸€æšé¸¡è›‹ç¢äº†ï¼Œå¯çŸ¥ f = 0ï¼›å¦‚æœç¬¬äºŒæšé¸¡è›‹ç¢äº†ï¼Œä½†ç¬¬ä¸€æšæ²¡ç¢ï¼Œå¯çŸ¥ f = 1ï¼›å¦åˆ™ï¼Œå½“ä¸¤ä¸ªé¸¡è›‹éƒ½æ²¡ç¢æ—¶ï¼Œå¯çŸ¥ f = 2ã€‚</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼šn = 100è¾“å‡ºï¼š14è§£é‡Šï¼šä¸€ç§æœ€ä¼˜çš„ç­–ç•¥æ˜¯ï¼š- å°†ç¬¬ä¸€æšé¸¡è›‹ä» 9 æ¥¼æ‰”ä¸‹ã€‚å¦‚æœç¢äº†ï¼Œé‚£ä¹ˆ f åœ¨ 0 å’Œ 8 ä¹‹é—´ã€‚å°†ç¬¬äºŒæšä» 1 æ¥¼æ‰”ä¸‹ï¼Œç„¶åæ¯æ‰”ä¸€æ¬¡ä¸Šä¸€å±‚æ¥¼ï¼Œåœ¨ 8 æ¬¡å†…æ‰¾åˆ° f ã€‚æ€»æ“ä½œæ¬¡æ•° = 1 + 8 = 9 ã€‚- å¦‚æœç¬¬ä¸€æšé¸¡è›‹æ²¡æœ‰ç¢ï¼Œé‚£ä¹ˆå†æŠŠç¬¬ä¸€æšé¸¡è›‹ä» 22 å±‚æ‰”ä¸‹ã€‚å¦‚æœç¢äº†ï¼Œé‚£ä¹ˆ f åœ¨ 9 å’Œ 21 ä¹‹é—´ã€‚å°†ç¬¬äºŒæšé¸¡è›‹ä» 10 æ¥¼æ‰”ä¸‹ï¼Œç„¶åæ¯æ‰”ä¸€æ¬¡ä¸Šä¸€å±‚æ¥¼ï¼Œåœ¨ 12 æ¬¡å†…æ‰¾åˆ° f ã€‚æ€»æ“ä½œæ¬¡æ•° = 2 + 12 = 14 ã€‚- å¦‚æœç¬¬ä¸€æšé¸¡è›‹æ²¡æœ‰å†æ¬¡ç¢æ‰ï¼Œåˆ™æŒ‰ç…§ç±»ä¼¼çš„æ–¹æ³•ä» 34, 45, 55, 64, 72, 79, 85, 90, 94, 97, 99 å’Œ 100 æ¥¼åˆ†åˆ«æ‰”ä¸‹ç¬¬ä¸€æšé¸¡è›‹ã€‚ä¸ç®¡ç»“æœå¦‚ä½•ï¼Œæœ€å¤šéœ€è¦æ‰” 14 æ¬¡æ¥ç¡®å®š f ã€‚</code></pre><p>æç¤ºï¼š</p><pre><code>1 &lt;= n &lt;= 1000</code></pre><p>æ­¤é¢˜å¯å‚è§<a href="https://leetcode-cn.com/problems/super-egg-drop/solution/ji-dan-diao-luo-by-leetcode-solution-2/" target="_blank" rel="noopener">887. é¸¡è›‹æ‰è½</a></p><h1 id="æŸ¥è¡¨-åŠ¨æ€è§„åˆ’"><a href="#æŸ¥è¡¨-åŠ¨æ€è§„åˆ’" class="headerlink" title="æŸ¥è¡¨+åŠ¨æ€è§„åˆ’"></a>æŸ¥è¡¨+åŠ¨æ€è§„åˆ’</h1><p><strong>å‡½æ•°å®šä¹‰ï¼š</strong><br><code>dp(n, k)</code>è¡¨ç¤ºç°åœ¨æœ‰<code>n</code>å±‚æ¥¼éœ€è¦éªŒè¯ï¼Œæ­¤æ—¶ä½ æ‰‹é‡Œæœ‰<code>k</code>ä¸ªé¸¡è›‹ï¼Œè¿”å›æ­¤æ—¶çš„æœ€å°æ“ä½œæ¬¡æ•°ã€‚</p><p><strong>base caseï¼š</strong></p><ul><li>å¦‚æœæ²¡æœ‰æ¥¼å±‚éœ€è¦éªŒè¯äº†(<code>n == 0</code>)ï¼Œé‚£ä½ ä¸ç®¡æœ‰å‡ ä¸ªé¸¡è›‹éƒ½ä¸ç”¨æ“ä½œäº†ã€‚</li><li>å¦‚æœä½ æ‰‹é‡Œåªæœ‰ä¸€ä¸ªé¸¡è›‹äº†(<code>k == 1</code>)ï¼Œé‚£ä½ åªèƒ½ä»1æ¥¼å¼€å§‹è¯•ï¼š1æ¥¼ã€2æ¥¼ã€â€¦ã€næ¥¼ï¼Œå…±éœ€è¦<code>n</code>æ¬¡æ“ä½œã€‚</li></ul><p><strong>çŠ¶æ€è½¬ç§»ï¼š</strong><br>ç°åœ¨ä½ æ‰‹é‡Œæœ‰<code>k</code>ä¸ªé¸¡è›‹ï¼Œæ¥ä¸‹æ¥ä½ è¦é€‰ä¸€å±‚æ¥¼æ‰”é¸¡è›‹ï¼Œå‡è®¾ä½ é€‰æ‹©äº†ç¬¬<code>i</code>å±‚æ¥¼ï¼Œæœ‰ä¸¤ç§æƒ…å†µï¼š</p><ol><li><strong>é¸¡è›‹ç¢äº†</strong>ã€‚ä½ çŸ¥é“ä½ è¦ç¡®å®šçš„<code>f</code>ä¸€å®šåœ¨[0, i-1]èŒƒå›´å†…äº†ï¼Œä¹Ÿå°±æ˜¯éœ€è¦éªŒè¯çš„æ¥¼å±‚æ•°å˜æˆäº†<code>i-1</code>ï¼Œé™¤æ­¤ä¹‹å¤–ä½ è¿˜æŸå¤±äº†ä¸€ä¸ªé¸¡è›‹ï¼Œåªå‰©ä¸‹<code>k-1</code>ä¸ªé¸¡è›‹äº†ã€‚</li><li><strong>é¸¡è›‹æ²¡ç¢</strong>ã€‚ä½ çŸ¥é“ä½ è¦ç¡®å®šçš„<code>f</code>ä¸€å®šåœ¨[i, n]èŒƒå›´å†…äº†ï¼Œæ¥ä¸‹æ¥éœ€è¦éªŒè¯çš„æ¥¼å±‚æ•°å˜æˆäº†<code>n-i</code>ï¼Œå¹¶ä¸”ä½ æ²¡æœ‰æŸå¤±é¸¡è›‹ï¼Œä½ è¿˜æœ‰<code>k</code>ä¸ªé¸¡è›‹ã€‚</li></ol><p>é¢˜ç›®çš„è¦æ±‚å¯ä»¥è§£é‡Šä¸ºï¼š<strong>æœ€åæƒ…å†µä¸‹æœ€å°‘éœ€è¦æ“ä½œå‡ æ¬¡</strong>ã€‚<strong>æœ€åæƒ…å†µ</strong>å°±æ˜¯åœ¨è¿™ä¸¤ç§æƒ…å†µä¹‹é—´ï¼Œé€‰æ‹©é‚£ä¸ªéœ€è¦<strong>æ“ä½œæ¬¡æ•°æœ€å¤§</strong>çš„ï¼Œå†åŠ ä¸Šè‡ªå·±è¿™ä¸€æ¬¡æ‰”é¸¡è›‹çš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯<code>Math.max(dp(i-1, k-1), dp(n-i, k)) + 1</code>ï¼Œè¿™ä¸ªå€¼å°±æ˜¯ä½ é€‰æ‹©ä»ç¬¬<code>i</code>å±‚æ¥¼æ‰”é¸¡è›‹ï¼Œæœ€åæƒ…å†µä¸‹éœ€è¦çš„æ“ä½œæ¬¡æ•°ã€‚</p><p><code>dp(n, k)</code>éœ€è¦çš„æ“ä½œæ¬¡æ•°ï¼Œæ˜¯ä½ <strong>åœ¨æ‰€æœ‰æ¥¼å±‚ä¸­é€‰æ‹©ä¸€ä¸ªæœ€åæƒ…å†µä¸‹éœ€è¦çš„æ“ä½œæ¬¡æ•°æœ€å°</strong>çš„æ¥¼å±‚æ‰”é¸¡è›‹ã€‚æ‰€ä»¥éœ€è¦éå†æ‰€æœ‰æ¥¼å±‚ï¼Œæ‰¾åˆ°<code>Math.min(res, Math.max(dp(i-1, k-1), dp(n-i, k)) + 1)</code>ã€‚</p><p>ä¸ºäº†é¿å…é‡å¤è®¡ç®—ï¼ŒåŠ ä¸Š<strong>å¤‡å¿˜å½•</strong>ã€‚</p><h2 id="ä»£ç "><a href="#ä»£ç " class="headerlink" title="ä»£ç "></a>ä»£ç </h2><details>    <summary>java</summary><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span>[][] memo;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">twoEggDrop</span><span class="params">(<span class="keyword">int</span> n)</span> </span>&#123;</span><br><span class="line">        memo = <span class="keyword">new</span> <span class="keyword">int</span>[n+<span class="number">1</span>][<span class="number">3</span>];</span><br><span class="line">        <span class="keyword">return</span> dp(n, <span class="number">2</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">dp</span><span class="params">(<span class="keyword">int</span> n, <span class="keyword">int</span> k)</span></span>&#123;</span><br><span class="line">        <span class="comment">// base case</span></span><br><span class="line">        <span class="keyword">if</span>(n == <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(k == <span class="number">1</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> n;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// æŸ¥è¡¨</span></span><br><span class="line">        <span class="keyword">if</span>(memo[n][k] != <span class="number">0</span>)&#123;</span><br><span class="line">            <span class="keyword">return</span> memo[n][k];</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">int</span> res = Integer.MAX_VALUE;</span><br><span class="line">        <span class="comment">// é€‰ä¸€å±‚æ¥¼æ‰”é¸¡è›‹</span></span><br><span class="line">        <span class="keyword">for</span>(<span class="keyword">int</span> i = <span class="number">1</span>; i &lt;= n; i++)&#123;</span><br><span class="line">            res = Math.min(res, Math.max(dp(i-<span class="number">1</span>, k-<span class="number">1</span>), dp(n-i, k)) + <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        memo[n][k] = res;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¯·ä½ è®¡ç®—å¹¶è¿”å›è¦ç¡®å®š f ç¡®åˆ‡çš„å€¼ çš„ æœ€å°æ“ä½œæ¬¡æ•° æ˜¯å¤šå°‘ï¼Ÿ&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="Math" scheme="http://yoursite.com/tags/Math/"/>
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
  </entry>
  
  <entry>
    <title>1377. T ç§’åé’è›™çš„ä½ç½®</title>
    <link href="http://yoursite.com/2021/12/16/1377.%20T%20%E7%A7%92%E5%90%8E%E9%9D%92%E8%9B%99%E7%9A%84%E4%BD%8D%E7%BD%AE/"/>
    <id>http://yoursite.com/2021/12/16/1377. T ç§’åé’è›™çš„ä½ç½®/</id>
    <published>2021-12-16T12:30:12.000Z</published>
    <updated>2021-12-16T14:29:09.224Z</updated>
    
    <content type="html"><![CDATA[<p>è¿”å›é’è›™åœ¨ t ç§’åä½äºç›®æ ‡é¡¶ç‚¹ target ä¸Šçš„æ¦‚ç‡ã€‚</p><a id="more"></a><p>[TOC]</p><p>ç»™ä½ ä¸€æ£µç”± n ä¸ªé¡¶ç‚¹ç»„æˆçš„æ— å‘æ ‘ï¼Œé¡¶ç‚¹ç¼–å·ä» 1 åˆ° nã€‚é’è›™ä» é¡¶ç‚¹ 1 å¼€å§‹èµ·è·³ã€‚è§„åˆ™å¦‚ä¸‹ï¼š</p><p>åœ¨ä¸€ç§’å†…ï¼Œé’è›™ä»å®ƒæ‰€åœ¨çš„å½“å‰é¡¶ç‚¹è·³åˆ°å¦ä¸€ä¸ª æœªè®¿é—® è¿‡çš„é¡¶ç‚¹ï¼ˆå¦‚æœå®ƒä»¬ç›´æ¥ç›¸è¿ï¼‰ã€‚<br>é’è›™æ— æ³•è·³å›å·²ç»è®¿é—®è¿‡çš„é¡¶ç‚¹ã€‚<br>å¦‚æœé’è›™å¯ä»¥è·³åˆ°å¤šä¸ªä¸åŒé¡¶ç‚¹ï¼Œé‚£ä¹ˆå®ƒè·³åˆ°å…¶ä¸­ä»»æ„ä¸€ä¸ªé¡¶ç‚¹ä¸Šçš„æœºç‡éƒ½ç›¸åŒã€‚<br>å¦‚æœé’è›™ä¸èƒ½è·³åˆ°ä»»ä½•æœªè®¿é—®è¿‡çš„é¡¶ç‚¹ä¸Šï¼Œé‚£ä¹ˆå®ƒæ¯æ¬¡è·³è·ƒéƒ½ä¼šåœç•™åœ¨åŸåœ°ã€‚<br>æ— å‘æ ‘çš„è¾¹ç”¨æ•°ç»„ edges æè¿°ï¼Œå…¶ä¸­ edges[i] = [fromi, toi] æ„å‘³ç€å­˜åœ¨ä¸€æ¡ç›´æ¥è¿é€š fromi å’Œ toi ä¸¤ä¸ªé¡¶ç‚¹çš„è¾¹ã€‚</p><p>è¿”å›é’è›™åœ¨ t ç§’åä½äºç›®æ ‡é¡¶ç‚¹ target ä¸Šçš„æ¦‚ç‡ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼šn = 7, edges = [[1,2],[1,3],[1,7],[2,4],[2,6],[3,5]], t = 2, target = 4è¾“å‡ºï¼š0.16666666666666666 è§£é‡Šï¼šä¸Šå›¾æ˜¾ç¤ºäº†é’è›™çš„è·³è·ƒè·¯å¾„ã€‚é’è›™ä»é¡¶ç‚¹ 1 èµ·è·³ï¼Œç¬¬ 1 ç§’ æœ‰ 1/3 çš„æ¦‚ç‡è·³åˆ°é¡¶ç‚¹ 2 ï¼Œç„¶åç¬¬ 2 ç§’ æœ‰ 1/2 çš„æ¦‚ç‡è·³åˆ°é¡¶ç‚¹ 4ï¼Œå› æ­¤é’è›™åœ¨ 2 ç§’åä½äºé¡¶ç‚¹ 4 çš„æ¦‚ç‡æ˜¯ 1/3 * 1/2 = 1/6 = 0.16666666666666666 ã€‚ </code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼šn = 7, edges = [[1,2],[1,3],[1,7],[2,4],[2,6],[3,5]], t = 1, target = 7è¾“å‡ºï¼š0.3333333333333333è§£é‡Šï¼šä¸Šå›¾æ˜¾ç¤ºäº†é’è›™çš„è·³è·ƒè·¯å¾„ã€‚é’è›™ä»é¡¶ç‚¹ 1 èµ·è·³ï¼Œæœ‰ 1/3 = 0.3333333333333333 çš„æ¦‚ç‡èƒ½å¤Ÿ 1 ç§’ åè·³åˆ°é¡¶ç‚¹ 7 ã€‚ </code></pre><p>ç¤ºä¾‹ 3ï¼š</p><pre><code>è¾“å…¥ï¼šn = 7, edges = [[1,2],[1,3],[1,7],[2,4],[2,6],[3,5]], t = 20, target = 6è¾“å‡ºï¼š0.16666666666666666</code></pre><p>æç¤ºï¼š</p><pre><code>1 &lt;= n &lt;= 100edges.length == n-1edges[i].length == 21 &lt;= edges[i][0], edges[i][1] &lt;= n1 &lt;= t &lt;= 501 &lt;= target &lt;= nä¸å‡†ç¡®å€¼è¯¯å·®åœ¨ 10^-5 ä¹‹å†…çš„ç»“æœå°†è¢«åˆ¤å®šä¸ºæ­£ç¡®ã€‚</code></pre><h1 id="BFS"><a href="#BFS" class="headerlink" title="BFS"></a>BFS</h1><p>æœ´ç´ BFSæœç´ ï¼Œä¸­é—´éœ€è¦æ³¨æ„å·²ç»è®¿é—®è¿‡çš„ç‚¹ä¸èƒ½è®¡ç®—åˆ°æ¦‚ç‡å½“ä¸­ï¼Œ<br>è¿™ä¸ªé’è›™å°±ç®—æ˜¯å½“å‰å®ƒå·²ç»åˆ°è¾¾targetï¼Œåªè¦è¿˜æœ‰å…¶ä»–æ²¡æœ‰è®¿é—®è¿‡çš„ç‚¹ï¼Œä»–è¿˜æ˜¯ä¼šç»§ç»­è·³ï¼Œç›´åˆ°æ—¶é—´ç”¨å®Œã€‚</p><details>    <summary>Java</summary><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">class Solution &#123;</span><br><span class="line">    class node &#123;</span><br><span class="line">        int id;</span><br><span class="line">        double p; //æ¦‚ç‡</span><br><span class="line">        int t; //æ—¶é—´</span><br><span class="line"></span><br><span class="line">        node(int i, double pp, int tt) &#123;</span><br><span class="line">            id = i;</span><br><span class="line">            p = pp;</span><br><span class="line">            t = tt;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public double frogPosition(int n, int[][] edges, int t, int target) &#123;</span><br><span class="line">        Set&lt;Integer&gt;[] sets = new Set[n + 1];</span><br><span class="line">        for (int i = 0; i &lt;= n; i++) &#123;</span><br><span class="line">            sets[i] = new HashSet&lt;&gt;();</span><br><span class="line">        &#125;</span><br><span class="line">        for (int[] e : edges) &#123;</span><br><span class="line">            sets[e[0]].add(e[1]);</span><br><span class="line">            //å› ä¸ºæ˜¯æ— å‘å›¾ï¼Œæœ‰çš„edgesé¡ºåºå¯èƒ½ä»å­èŠ‚ç‚¹æŒ‡å‘çˆ¶èŠ‚ç‚¹</span><br><span class="line">            sets[e[1]].add(e[0]);</span><br><span class="line">        &#125;</span><br><span class="line">        Queue&lt;node&gt; q = new LinkedList&lt;&gt;();</span><br><span class="line">        q.add(new node(1, 1.0, 0));</span><br><span class="line">        boolean[] vis = new boolean[n + 1];</span><br><span class="line">        vis[1] = true;</span><br><span class="line">        while (!q.isEmpty()) &#123;</span><br><span class="line">            node u = q.poll();</span><br><span class="line">            if (u.t == t &amp;&amp; u.id == target) &#123;</span><br><span class="line">                return u.p;</span><br><span class="line">            &#125;</span><br><span class="line">            //ç»Ÿè®¡ä¸‹ä¸€æ­¥å¯èƒ½çš„æ‰€æœ‰é€‰æ‹©æ•°</span><br><span class="line">            int sz = 0;</span><br><span class="line">            for (int nb : sets[u.id]) &#123;</span><br><span class="line">                if (!vis[nb]) &#123;</span><br><span class="line">                    sz++;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            if (u.t &lt; t) &#123;</span><br><span class="line">                boolean find = false;</span><br><span class="line">                for (int nb : sets[u.id]) &#123;</span><br><span class="line">                    if (vis[nb]) &#123;</span><br><span class="line">                        continue;</span><br><span class="line">                    &#125;</span><br><span class="line">                    //ä¸‹ä¸€å±‚æœ‰æœªè®¿é—®çš„èŠ‚ç‚¹å³åŠ å…¥é˜Ÿåˆ—</span><br><span class="line">                    find = true;</span><br><span class="line">                    vis[nb] = true;</span><br><span class="line">                    q.add(new node(nb, u.p / sz, u.t + 1));</span><br><span class="line">                &#125;</span><br><span class="line">                //ä¸‹ä¸€å±‚æ— æœªè®¿é—®çš„èŠ‚ç‚¹</span><br><span class="line">                if (find == false) &#123;</span><br><span class="line">                    q.add(new node(u.id, u.p, u.t + 1));</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return 0.0;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿”å›é’è›™åœ¨ t ç§’åä½äºç›®æ ‡é¡¶ç‚¹ target ä¸Šçš„æ¦‚ç‡ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="Tree" scheme="http://yoursite.com/tags/Tree/"/>
    
      <category term="Depth-First Search" scheme="http://yoursite.com/tags/Depth-First-Search/"/>
    
      <category term="Breadth-First Search" scheme="http://yoursite.com/tags/Breadth-First-Search/"/>
    
      <category term="Graph" scheme="http://yoursite.com/tags/Graph/"/>
    
  </entry>
  
  <entry>
    <title>1419. æ•°é’è›™</title>
    <link href="http://yoursite.com/2021/12/16/1419.%20%E6%95%B0%E9%9D%92%E8%9B%99/"/>
    <id>http://yoursite.com/2021/12/16/1419. æ•°é’è›™/</id>
    <published>2021-12-16T09:43:12.000Z</published>
    <updated>2021-12-16T10:34:52.080Z</updated>
    
    <content type="html"><![CDATA[<p>ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² croakOfFrogsï¼Œå®ƒè¡¨ç¤ºä¸åŒé’è›™å‘å‡ºçš„è›™é¸£å£°ï¼ˆå­—ç¬¦ä¸² â€œcroakâ€ ï¼‰çš„ç»„åˆã€‚ç”±äºåŒä¸€æ—¶é—´å¯ä»¥æœ‰å¤šåªé’è›™å‘±å‘±ä½œå“ï¼Œæ‰€ä»¥croakOfFrogs ä¸­ä¼šæ··åˆå¤šä¸ª â€œcroakâ€ ã€‚è¯·ä½ è¿”å›æ¨¡æ‹Ÿå­—ç¬¦ä¸²ä¸­æ‰€æœ‰è›™é¸£æ‰€éœ€ä¸åŒé’è›™çš„æœ€å°‘æ•°ç›®ã€‚</p><a id="more"></a><p>[TOC]</p><p>æ³¨æ„ï¼šè¦æƒ³å‘å‡ºè›™é¸£ â€œcroakâ€ï¼Œé’è›™å¿…é¡» ä¾åº è¾“å‡º â€˜câ€™, â€™râ€™, â€™oâ€™, â€™aâ€™, â€™kâ€™ è¿™ 5 ä¸ªå­—æ¯ã€‚å¦‚æœæ²¡æœ‰è¾“å‡ºå…¨éƒ¨äº”ä¸ªå­—æ¯ï¼Œé‚£ä¹ˆå®ƒå°±ä¸ä¼šå‘å‡ºå£°éŸ³ã€‚</p><p>å¦‚æœå­—ç¬¦ä¸² croakOfFrogs ä¸æ˜¯ç”±è‹¥å¹²æœ‰æ•ˆçš„ â€œcroakâ€ å­—ç¬¦æ··åˆè€Œæˆï¼Œè¯·è¿”å› -1 ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼šcroakOfFrogs = &quot;croakcroak&quot;è¾“å‡ºï¼š1 è§£é‡Šï¼šä¸€åªé’è›™ â€œå‘±å‘±â€ ä¸¤æ¬¡</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼šcroakOfFrogs = &quot;crcoakroak&quot;è¾“å‡ºï¼š2 è§£é‡Šï¼šæœ€å°‘éœ€è¦ä¸¤åªé’è›™ï¼Œâ€œå‘±å‘±â€ å£°ç”¨é»‘ä½“æ ‡æ³¨ç¬¬ä¸€åªé’è›™ &quot;crcoakroak&quot;ç¬¬äºŒåªé’è›™ &quot;crcoakroak&quot;</code></pre><p>ç¤ºä¾‹ 3ï¼š</p><pre><code>è¾“å…¥ï¼šcroakOfFrogs = &quot;croakcrook&quot;è¾“å‡ºï¼š-1è§£é‡Šï¼šç»™å‡ºçš„å­—ç¬¦ä¸²ä¸æ˜¯ &quot;croak&quot; çš„æœ‰æ•ˆç»„åˆã€‚</code></pre><p>ç¤ºä¾‹ 4ï¼š</p><pre><code>è¾“å…¥ï¼šcroakOfFrogs = &quot;croakcroa&quot;è¾“å‡ºï¼š-1</code></pre><p>æç¤ºï¼š</p><pre><code>1 &lt;= croakOfFrogs.length &lt;= 10^5å­—ç¬¦ä¸²ä¸­çš„å­—ç¬¦åªæœ‰ &apos;c&apos;, &apos;r&apos;, &apos;o&apos;, &apos;a&apos; æˆ–è€… &apos;k&apos;</code></pre><p>æ€æƒ³å°±æ˜¯ç»´æŠ¤croakçš„ä¸ªæ•°ï¼Œå¦‚æœé‡åˆ°å½“å‰å­—æ¯ï¼Œåˆ™è‚¯å®šæ˜¯ç”±å‰é¢å­—æ¯è¿‡æ¥ï¼Œå‰é¢å­—æ¯æ•°-1ã€‚<br>å¦‚é‡åˆ°rï¼Œåˆ™å¿…æ˜¯c-&gt;rï¼Œæ‰€ä»¥câ€“<br>kä»£è¡¨ç»“å°¾ï¼Œå…¶å®ä¹Ÿæ˜¯é’è›™çš„èµ·å§‹ï¼ˆä¸€æ¬¡å–Šå«ç»“æŸï¼‰ï¼Œæ‰€ä»¥é‡åˆ°cçš„æ—¶å€™ï¼Œå…ˆå»æ¶ˆè€—kï¼Œæ²¡æœ‰käº†ï¼Œéœ€è¦æ–°é’è›™ï¼Œç­”æ¡ˆ+1</p><details>    <summary>Java</summary><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">public int minNumberOfFrogs(String croakOfFrogs) &#123;</span><br><span class="line">        int c,r,o,a,k;</span><br><span class="line">        c = 0; r = 0; o = 0; a = 0;k = 0;</span><br><span class="line">        char []chars = croakOfFrogs.toCharArray();</span><br><span class="line">        int res = 0;</span><br><span class="line">        for(int i = 0;i &lt; chars.length;i++)&#123;</span><br><span class="line">            if(chars[i] == &apos;c&apos;)&#123;</span><br><span class="line">                if(k &gt; 0)&#123;k--;&#125;else&#123;res++;&#125;</span><br><span class="line">                c++;</span><br><span class="line">            &#125;else if(chars[i] == &apos;r&apos;)&#123;</span><br><span class="line">                c--;r++;</span><br><span class="line">            &#125;else if(chars[i] == &apos;o&apos;)&#123;</span><br><span class="line">                r--;o++;</span><br><span class="line">            &#125;else if(chars[i] == &apos;a&apos;)&#123;</span><br><span class="line">                o--;a++;</span><br><span class="line">            &#125;else if(chars[i] == &apos;k&apos;)&#123;</span><br><span class="line">                a--;k++;</span><br><span class="line">            &#125;</span><br><span class="line">            if(c &lt; 0 || r &lt; 0 || o &lt; 0 || a &lt; 0)&#123;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if(c != 0 || r != 0 || o != 0 || a != 0)&#123;</span><br><span class="line">            return -1;</span><br><span class="line">        &#125;</span><br><span class="line">        return res;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>Java switch caseå†™æ³•</summary><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">class Solution &#123;</span><br><span class="line">    public int minNumberOfFrogs(String croakOfFrogs) &#123;</span><br><span class="line">        int c = 0;</span><br><span class="line">        int r = 0;</span><br><span class="line">        int o = 0;</span><br><span class="line">        int a = 0;</span><br><span class="line">        int k = 0;</span><br><span class="line">        int res = 0;</span><br><span class="line">        char[] chars = croakOfFrogs.toCharArray();</span><br><span class="line">        for (char character : chars) &#123;</span><br><span class="line">            switch (character) &#123;</span><br><span class="line">                case &apos;c&apos;:</span><br><span class="line">                    if (k &gt; 0) &#123;</span><br><span class="line">                        k--;</span><br><span class="line">                    &#125; else &#123;</span><br><span class="line">                        res++;</span><br><span class="line">                    &#125;</span><br><span class="line">                    c++;</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;r&apos;:</span><br><span class="line">                    c--;</span><br><span class="line">                    r++;</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;o&apos;:</span><br><span class="line">                    r--;</span><br><span class="line">                    o++;</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;a&apos;:</span><br><span class="line">                    o--;</span><br><span class="line">                    a++;</span><br><span class="line">                    break;</span><br><span class="line">                case &apos;k&apos;:</span><br><span class="line">                    a--;</span><br><span class="line">                    k++;</span><br><span class="line">                    break;</span><br><span class="line">            &#125;</span><br><span class="line">            if (c &lt; 0 || r &lt; 0 || o &lt; 0 || a &lt; 0 || k&lt;0) &#123;</span><br><span class="line">                break;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        if (c != 0 || r != 0 || o != 0 || a != 0) &#123;</span><br><span class="line">            res = -1;</span><br><span class="line">        &#125;</span><br><span class="line">        return res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ç»™ä½ ä¸€ä¸ªå­—ç¬¦ä¸² croakOfFrogsï¼Œå®ƒè¡¨ç¤ºä¸åŒé’è›™å‘å‡ºçš„è›™é¸£å£°ï¼ˆå­—ç¬¦ä¸² â€œcroakâ€ ï¼‰çš„ç»„åˆã€‚ç”±äºåŒä¸€æ—¶é—´å¯ä»¥æœ‰å¤šåªé’è›™å‘±å‘±ä½œå“ï¼Œæ‰€ä»¥croakOfFrogs ä¸­ä¼šæ··åˆå¤šä¸ª â€œcroakâ€ ã€‚è¯·ä½ è¿”å›æ¨¡æ‹Ÿå­—ç¬¦ä¸²ä¸­æ‰€æœ‰è›™é¸£æ‰€éœ€ä¸åŒé’è›™çš„æœ€å°‘æ•°ç›®ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="String" scheme="http://yoursite.com/tags/String/"/>
    
      <category term="Counting" scheme="http://yoursite.com/tags/Counting/"/>
    
  </entry>
  
  <entry>
    <title>1936. æ–°å¢çš„æœ€å°‘å°é˜¶æ•°</title>
    <link href="http://yoursite.com/2021/12/16/1936.%20%E6%96%B0%E5%A2%9E%E7%9A%84%E6%9C%80%E5%B0%91%E5%8F%B0%E9%98%B6%E6%95%B0/"/>
    <id>http://yoursite.com/2021/12/16/1936. æ–°å¢çš„æœ€å°‘å°é˜¶æ•°/</id>
    <published>2021-12-16T08:28:12.000Z</published>
    <updated>2021-12-16T09:39:28.211Z</updated>
    
    <content type="html"><![CDATA[<p>è¿”å›çˆ¬åˆ°æœ€åä¸€é˜¶æ—¶å¿…é¡»æ·»åŠ åˆ°æ¢¯å­ä¸Šçš„ æœ€å°‘å°é˜¶æ•°ã€‚</p><a id="more"></a><p>[TOC]</p><p>ç»™ä½ ä¸€ä¸ª ä¸¥æ ¼é€’å¢ çš„æ•´æ•°æ•°ç»„ rungs ï¼Œç”¨äºè¡¨ç¤ºæ¢¯å­ä¸Šæ¯ä¸€å°é˜¶çš„ é«˜åº¦ ã€‚å½“å‰ä½ æ­£ç«™åœ¨é«˜åº¦ä¸º 0 çš„åœ°æ¿ä¸Šï¼Œå¹¶æ‰“ç®—çˆ¬åˆ°æœ€åä¸€ä¸ªå°é˜¶ã€‚</p><p>å¦ç»™ä½ ä¸€ä¸ªæ•´æ•° dist ã€‚æ¯æ¬¡ç§»åŠ¨ä¸­ï¼Œä½ å¯ä»¥åˆ°è¾¾ä¸‹ä¸€ä¸ªè·ç¦»ä½ å½“å‰ä½ç½®ï¼ˆåœ°æ¿æˆ–å°é˜¶ï¼‰ä¸è¶…è¿‡disté«˜åº¦çš„å°é˜¶ã€‚å½“ç„¶ï¼Œä½ ä¹Ÿå¯ä»¥åœ¨ä»»ä½•æ­£ æ•´æ•° é«˜åº¦å¤„æ’å…¥å°šä¸å­˜åœ¨çš„æ–°å°é˜¶ã€‚</p><p>è¿”å›çˆ¬åˆ°æœ€åä¸€é˜¶æ—¶å¿…é¡»æ·»åŠ åˆ°æ¢¯å­ä¸Šçš„ æœ€å°‘å°é˜¶æ•°ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼šrungs = [1,3,5,10], dist = 2è¾“å‡ºï¼š2è§£é‡Šï¼šç°åœ¨æ— æ³•åˆ°è¾¾æœ€åä¸€é˜¶ã€‚åœ¨é«˜åº¦ä¸º 7 å’Œ 8 çš„ä½ç½®å¢è®¾æ–°çš„å°é˜¶ï¼Œä»¥çˆ¬ä¸Šæ¢¯å­ã€‚ æ¢¯å­åœ¨é«˜åº¦ä¸º [1,3,5,7,8,10] çš„ä½ç½®ä¸Šæœ‰å°é˜¶ã€‚</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼šrungs = [3,6,8,10], dist = 3è¾“å‡ºï¼š0è§£é‡Šï¼šè¿™ä¸ªæ¢¯å­æ— éœ€å¢è®¾æ–°å°é˜¶ä¹Ÿå¯ä»¥çˆ¬ä¸Šå»ã€‚</code></pre><p>ç¤ºä¾‹ 3ï¼š</p><pre><code>è¾“å…¥ï¼šrungs = [3,4,6,7], dist = 2è¾“å‡ºï¼š1è§£é‡Šï¼šç°åœ¨æ— æ³•ä»åœ°æ¿åˆ°è¾¾æ¢¯å­çš„ç¬¬ä¸€é˜¶ã€‚ åœ¨é«˜åº¦ä¸º 1 çš„ä½ç½®å¢è®¾æ–°çš„å°é˜¶ï¼Œä»¥çˆ¬ä¸Šæ¢¯å­ã€‚ æ¢¯å­åœ¨é«˜åº¦ä¸º [1,3,4,6,7] çš„ä½ç½®ä¸Šæœ‰å°é˜¶ã€‚</code></pre><p>ç¤ºä¾‹ 4ï¼š</p><pre><code>è¾“å…¥ï¼šrungs = [5], dist = 10è¾“å‡ºï¼š0è§£é‡Šï¼šè¿™ä¸ªæ¢¯å­æ— éœ€å¢è®¾æ–°å°é˜¶ä¹Ÿå¯ä»¥çˆ¬ä¸Šå»ã€‚</code></pre><p>æç¤ºï¼š</p><pre><code>1 &lt;= rungs.length &lt;= 1051 &lt;= rungs[i] &lt;= 1091 &lt;= dist &lt;= 109rungs ä¸¥æ ¼é€’å¢</code></pre><h1 id="æ–¹æ³•ä¸€ï¼šæ¨¡æ‹Ÿ-è´ªå¿ƒ"><a href="#æ–¹æ³•ä¸€ï¼šæ¨¡æ‹Ÿ-è´ªå¿ƒ" class="headerlink" title="æ–¹æ³•ä¸€ï¼šæ¨¡æ‹Ÿ + è´ªå¿ƒ"></a>æ–¹æ³•ä¸€ï¼šæ¨¡æ‹Ÿ + è´ªå¿ƒ</h1><p><strong>æ€è·¯ä¸ç®—æ³•</strong><a href="https://leetcode-cn.com/problems/add-minimum-number-of-rungs/solution/xin-zeng-de-zui-shao-tai-jie-shu-by-leet-y0de/" target="_blank" rel="noopener">^1</a></p><p><strong>ä»£ç </strong></p><details>    <summary>C++</summary><figure class="highlight c++"><figcaption><span>[sol1-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">addRungs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; rungs, <span class="keyword">int</span> dist)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;   <span class="comment">// éœ€è¦å¢è®¾çš„æ¢¯å­æ•°ç›®</span></span><br><span class="line">        <span class="keyword">int</span> curr = <span class="number">0</span>;   <span class="comment">// å½“å‰é«˜åº¦</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> h: rungs)&#123;</span><br><span class="line">            <span class="comment">// éå†æ•°ç»„è®¡ç®—é«˜åº¦å·®å’Œæœ€å°‘æ·»åŠ æ•°ç›®ï¼Œå¹¶æ›´æ–°å½“å‰é«˜åº¦</span></span><br><span class="line">            <span class="keyword">int</span> d = h - curr;</span><br><span class="line">            res += (d - <span class="number">1</span>) / dist;</span><br><span class="line">            curr = h;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>Python3</summary><figure class="highlight python"><figcaption><span>[sol1-Python3]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">addRungs</span><span class="params">(self, rungs: List[int], dist: int)</span> -&gt; int:</span></span><br><span class="line">        res = <span class="number">0</span>   <span class="comment"># éœ€è¦å¢è®¾çš„æ¢¯å­æ•°ç›®</span></span><br><span class="line">        curr = <span class="number">0</span>   <span class="comment"># å½“å‰é«˜åº¦</span></span><br><span class="line">        <span class="keyword">for</span> h <span class="keyword">in</span> rungs:</span><br><span class="line">            <span class="comment"># éå†æ•°ç»„è®¡ç®—é«˜åº¦å·®å’Œæœ€å°‘æ·»åŠ æ•°ç›®ï¼Œå¹¶æ›´æ–°å½“å‰é«˜åº¦</span></span><br><span class="line">            d = h - curr</span><br><span class="line">            res += (h - curr - <span class="number">1</span>) // dist</span><br><span class="line">            curr = h</span><br><span class="line">        <span class="keyword">return</span> res</span><br></pre></td></tr></table></figure></details><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[sol1-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">addRungs</span><span class="params">(<span class="keyword">int</span>[] rungs, <span class="keyword">int</span> dist)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> res = <span class="number">0</span>;    <span class="comment">// éœ€è¦å¢è®¾çš„æ¢¯å­æ•°ç›®</span></span><br><span class="line">        <span class="keyword">int</span> curr = <span class="number">0</span>;   <span class="comment">// å½“å‰é«˜åº¦</span></span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> h : rungs) &#123;</span><br><span class="line">            <span class="comment">// éå†æ•°ç»„è®¡ç®—é«˜åº¦å·®å’Œæœ€å°‘æ·»åŠ æ•°ç›®ï¼Œå¹¶æ›´æ–°å½“å‰é«˜åº¦</span></span><br><span class="line">            <span class="keyword">int</span> d = h - curr;</span><br><span class="line">            res += (d - <span class="number">1</span>) / dist;</span><br><span class="line">            curr = h;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿”å›çˆ¬åˆ°æœ€åä¸€é˜¶æ—¶å¿…é¡»æ·»åŠ åˆ°æ¢¯å­ä¸Šçš„ æœ€å°‘å°é˜¶æ•°ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
  </entry>
  
  <entry>
    <title>746. ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯</title>
    <link href="http://yoursite.com/2021/12/16/746.%20%E4%BD%BF%E7%94%A8%E6%9C%80%E5%B0%8F%E8%8A%B1%E8%B4%B9%E7%88%AC%E6%A5%BC%E6%A2%AF/"/>
    <id>http://yoursite.com/2021/12/16/746. ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯/</id>
    <published>2021-12-16T08:12:12.000Z</published>
    <updated>2021-12-16T08:23:50.543Z</updated>
    
    <content type="html"><![CDATA[<p>æ•°ç»„çš„æ¯ä¸ªä¸‹æ ‡ä½œä¸ºä¸€ä¸ªé˜¶æ¢¯ï¼Œç¬¬ i ä¸ªé˜¶æ¢¯å¯¹åº”ç€ä¸€ä¸ªéè´Ÿæ•°çš„ä½“åŠ›èŠ±è´¹å€¼ cost[i]ï¼ˆä¸‹æ ‡ä» 0 å¼€å§‹ï¼‰ã€‚</p><p>æ¯å½“ä½ çˆ¬ä¸Šä¸€ä¸ªé˜¶æ¢¯ä½ éƒ½è¦èŠ±è´¹å¯¹åº”çš„ä½“åŠ›å€¼ï¼Œä¸€æ—¦æ”¯ä»˜äº†ç›¸åº”çš„ä½“åŠ›å€¼ï¼Œä½ å°±å¯ä»¥é€‰æ‹©å‘ä¸Šçˆ¬ä¸€ä¸ªé˜¶æ¢¯æˆ–è€…çˆ¬ä¸¤ä¸ªé˜¶æ¢¯ã€‚</p><p>è¯·ä½ æ‰¾å‡ºè¾¾åˆ°æ¥¼å±‚é¡¶éƒ¨çš„æœ€ä½èŠ±è´¹ã€‚åœ¨å¼€å§‹æ—¶ï¼Œä½ å¯ä»¥é€‰æ‹©ä»ä¸‹æ ‡ä¸º 0 æˆ– 1 çš„å…ƒç´ ä½œä¸ºåˆå§‹é˜¶æ¢¯ã€‚</p><a id="more"></a><p>[TOC]</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼šcost = [10, 15, 20]è¾“å‡ºï¼š15è§£é‡Šï¼šæœ€ä½èŠ±è´¹æ˜¯ä» cost[1] å¼€å§‹ï¼Œç„¶åèµ°ä¸¤æ­¥å³å¯åˆ°é˜¶æ¢¯é¡¶ï¼Œä¸€å…±èŠ±è´¹ 15 ã€‚</code></pre><p> ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼šcost = [1, 100, 1, 1, 1, 100, 1, 1, 100, 1]è¾“å‡ºï¼š6è§£é‡Šï¼šæœ€ä½èŠ±è´¹æ–¹å¼æ˜¯ä» cost[0] å¼€å§‹ï¼Œé€ä¸ªç»è¿‡é‚£äº› 1 ï¼Œè·³è¿‡ cost[3] ï¼Œä¸€å…±èŠ±è´¹ 6 ã€‚</code></pre><p>æç¤ºï¼š</p><pre><code>cost çš„é•¿åº¦èŒƒå›´æ˜¯ [2, 1000]ã€‚cost[i] å°†ä¼šæ˜¯ä¸€ä¸ªæ•´å‹æ•°æ®ï¼ŒèŒƒå›´ä¸º [0, 999] ã€‚</code></pre><h1 id="æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’-1"><a href="#æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’-1" class="headerlink" title="æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’^1"></a>æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’<a href="https://leetcode-cn.com/problems/min-cost-climbing-stairs/solution/shi-yong-zui-xiao-hua-fei-pa-lou-ti-by-l-ncf8/" target="_blank" rel="noopener">^1</a></h1><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[sol1-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(<span class="keyword">int</span>[] cost)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = cost.length;</span><br><span class="line">        <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">1</span>];</span><br><span class="line">        dp[<span class="number">0</span>] = dp[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            dp[i] = Math.min(dp[i - <span class="number">1</span>] + cost[i - <span class="number">1</span>], dp[i - <span class="number">2</span>] + cost[i - <span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>C#</summary><figure class="highlight plain"><figcaption><span>[sol1-C#]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Solution &#123;</span><br><span class="line">    public int MinCostClimbingStairs(int[] cost) &#123;</span><br><span class="line">        int n = cost.Length;</span><br><span class="line">        int[] dp = new int[n + 1];</span><br><span class="line">        dp[0] = dp[1] = 0;</span><br><span class="line">        for (int i = 2; i &lt;= n; i++) &#123;</span><br><span class="line">            dp[i] = Math.Min(dp[i - 1] + cost[i - 1], dp[i - 2] + cost[i - 2]);</span><br><span class="line">        &#125;</span><br><span class="line">        return dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>JavaScript</summary><figure class="highlight javascript"><figcaption><span>[sol1-JavaScript]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> minCostClimbingStairs = <span class="function"><span class="keyword">function</span>(<span class="params">cost</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> n = cost.length;</span><br><span class="line">    <span class="keyword">const</span> dp = <span class="keyword">new</span> <span class="built_in">Array</span>(n + <span class="number">1</span>);</span><br><span class="line">    dp[<span class="number">0</span>] = dp[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        dp[i] = <span class="built_in">Math</span>.min(dp[i - <span class="number">1</span>] + cost[i - <span class="number">1</span>], dp[i - <span class="number">2</span>] + cost[i - <span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[n];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>C++</summary><figure class="highlight c++"><figcaption><span>[sol1-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; cost)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = cost.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; dp(n + <span class="number">1</span>);</span><br><span class="line">        dp[<span class="number">0</span>] = dp[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            dp[i] = min(dp[i - <span class="number">1</span>] + cost[i - <span class="number">1</span>], dp[i - <span class="number">2</span>] + cost[i - <span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>Golang</summary><figure class="highlight go"><figcaption><span>[sol1-Golang]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">minCostClimbingStairs</span><span class="params">(cost []<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    n := <span class="built_in">len</span>(cost)</span><br><span class="line">    dp := <span class="built_in">make</span>([]<span class="keyword">int</span>, n+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">2</span>; i &lt;= n; i++ &#123;</span><br><span class="line">        dp[i] = min(dp[i<span class="number">-1</span>]+cost[i<span class="number">-1</span>], dp[i<span class="number">-2</span>]+cost[i<span class="number">-2</span>])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[n]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">min</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> a &lt; b &#123;</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>Python3</summary><figure class="highlight python"><figcaption><span>[sol1-Python3]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minCostClimbingStairs</span><span class="params">(self, cost: List[int])</span> -&gt; int:</span></span><br><span class="line">        n = len(cost)</span><br><span class="line">        dp = [<span class="number">0</span>] * (n + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, n + <span class="number">1</span>):</span><br><span class="line">            dp[i] = min(dp[i - <span class="number">1</span>] + cost[i - <span class="number">1</span>], dp[i - <span class="number">2</span>] + cost[i - <span class="number">2</span>])</span><br><span class="line">        <span class="keyword">return</span> dp[n]</span><br></pre></td></tr></table></figure></details><details>    <summary>C</summary><figure class="highlight c"><figcaption><span>[sol1-C]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(<span class="keyword">int</span>* cost, <span class="keyword">int</span> costSize)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> dp[costSize + <span class="number">1</span>];</span><br><span class="line">    dp[<span class="number">0</span>] = dp[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= costSize; i++) &#123;</span><br><span class="line">        dp[i] = fmin(dp[i - <span class="number">1</span>] + cost[i - <span class="number">1</span>], dp[i - <span class="number">2</span>] + cost[i - <span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[costSize];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><p>ä¸Šè¿°ä»£ç çš„æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦éƒ½æ˜¯ <em>O(n)</em> ã€‚å¯ä»¥ä½¿ç”¨æ»šåŠ¨æ•°ç»„çš„æ€æƒ³ï¼Œå°†ç©ºé—´å¤æ‚åº¦ä¼˜åŒ–åˆ° <em>O(1)</em>ã€‚</p><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[sol2-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(<span class="keyword">int</span>[] cost)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = cost.length;</span><br><span class="line">        <span class="keyword">int</span> prev = <span class="number">0</span>, curr = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> next = Math.min(curr + cost[i - <span class="number">1</span>], prev + cost[i - <span class="number">2</span>]);</span><br><span class="line">            prev = curr;</span><br><span class="line">            curr = next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> curr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>JavaScript</summary><figure class="highlight javascript"><figcaption><span>[sol2-JavaScript]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> minCostClimbingStairs = <span class="function"><span class="keyword">function</span>(<span class="params">cost</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> n = cost.length;</span><br><span class="line">    <span class="keyword">let</span> prev = <span class="number">0</span>, curr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> next = <span class="built_in">Math</span>.min(curr + cost[i - <span class="number">1</span>], prev + cost[i - <span class="number">2</span>]);</span><br><span class="line">        prev = curr;</span><br><span class="line">        curr = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> curr;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>C++</summary><figure class="highlight c++"><figcaption><span>[sol2-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; cost)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = cost.size();</span><br><span class="line">        <span class="keyword">int</span> prev = <span class="number">0</span>, curr = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> next = min(curr + cost[i - <span class="number">1</span>], prev + cost[i - <span class="number">2</span>]);</span><br><span class="line">            prev = curr;</span><br><span class="line">            curr = next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> curr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>C#</summary><figure class="highlight plain"><figcaption><span>[sol2-C#]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Solution &#123;</span><br><span class="line">    public int MinCostClimbingStairs(int[] cost) &#123;</span><br><span class="line">        int n = cost.Length;</span><br><span class="line">        int prev = 0, curr = 0;</span><br><span class="line">        for (int i = 2; i &lt;= n; i++) &#123;</span><br><span class="line">            int next = Math.Min(curr + cost[i - 1], prev + cost[i - 2]);</span><br><span class="line">            prev = curr;</span><br><span class="line">            curr = next;</span><br><span class="line">        &#125;</span><br><span class="line">        return curr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>Golang</summary><figure class="highlight go"><figcaption><span>[sol2-Golang]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">minCostClimbingStairs</span><span class="params">(cost []<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    n := <span class="built_in">len</span>(cost)</span><br><span class="line">    pre, cur := <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">2</span>; i &lt;= n; i++ &#123;</span><br><span class="line">        pre, cur = cur, min(cur+cost[i<span class="number">-1</span>], pre+cost[i<span class="number">-2</span>])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cur</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">min</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> a &lt; b &#123;</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>Python3</summary><figure class="highlight python"><figcaption><span>[sol2-Python3]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minCostClimbingStairs</span><span class="params">(self, cost: List[int])</span> -&gt; int:</span></span><br><span class="line">        n = len(cost)</span><br><span class="line">        prev = curr = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, n + <span class="number">1</span>):</span><br><span class="line">            nxt = min(curr + cost[i - <span class="number">1</span>], prev + cost[i - <span class="number">2</span>])</span><br><span class="line">            prev, curr = curr, nxt</span><br><span class="line">        <span class="keyword">return</span> curr</span><br></pre></td></tr></table></figure></details><details>    <summary>C</summary><figure class="highlight c"><figcaption><span>[sol2-C]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(<span class="keyword">int</span>* cost, <span class="keyword">int</span> costSize)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> prev = <span class="number">0</span>, curr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= costSize; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> next = fmin(curr + cost[i - <span class="number">1</span>], prev + cost[i - <span class="number">2</span>]);</span><br><span class="line">        prev = curr;</span><br><span class="line">        curr = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> curr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li><p>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(n)*ï¼Œå…¶ä¸­ *n</em> æ˜¯æ•°ç»„cost çš„é•¿åº¦ã€‚éœ€è¦ä¾æ¬¡è®¡ç®—æ¯ä¸ªdp å€¼ï¼Œæ¯ä¸ªå€¼çš„è®¡ç®—éœ€è¦å¸¸æ•°æ—¶é—´ï¼Œå› æ­¤æ€»æ—¶é—´å¤æ‚åº¦æ˜¯ <em>O(n)</em>ã€‚</p></li><li><p>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(1)</em>ã€‚ä½¿ç”¨æ»šåŠ¨æ•°ç»„çš„æ€æƒ³ï¼Œåªéœ€è¦ä½¿ç”¨æœ‰é™çš„é¢å¤–ç©ºé—´ã€‚</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ•°ç»„çš„æ¯ä¸ªä¸‹æ ‡ä½œä¸ºä¸€ä¸ªé˜¶æ¢¯ï¼Œç¬¬ i ä¸ªé˜¶æ¢¯å¯¹åº”ç€ä¸€ä¸ªéè´Ÿæ•°çš„ä½“åŠ›èŠ±è´¹å€¼ cost[i]ï¼ˆä¸‹æ ‡ä» 0 å¼€å§‹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ¯å½“ä½ çˆ¬ä¸Šä¸€ä¸ªé˜¶æ¢¯ä½ éƒ½è¦èŠ±è´¹å¯¹åº”çš„ä½“åŠ›å€¼ï¼Œä¸€æ—¦æ”¯ä»˜äº†ç›¸åº”çš„ä½“åŠ›å€¼ï¼Œä½ å°±å¯ä»¥é€‰æ‹©å‘ä¸Šçˆ¬ä¸€ä¸ªé˜¶æ¢¯æˆ–è€…çˆ¬ä¸¤ä¸ªé˜¶æ¢¯ã€‚&lt;/p&gt;
&lt;p&gt;è¯·ä½ æ‰¾å‡ºè¾¾åˆ°æ¥¼å±‚é¡¶éƒ¨çš„æœ€ä½èŠ±è´¹ã€‚åœ¨å¼€å§‹æ—¶ï¼Œä½ å¯ä»¥é€‰æ‹©ä»ä¸‹æ ‡ä¸º 0 æˆ– 1 çš„å…ƒç´ ä½œä¸ºåˆå§‹é˜¶æ¢¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
  </entry>
  
  <entry>
    <title>å‰‘æŒ‡ Offer II 088. çˆ¬æ¥¼æ¢¯çš„æœ€å°‘æˆæœ¬</title>
    <link href="http://yoursite.com/2021/12/16/%E5%89%91%E6%8C%87%20Offer%20II%20088.%20%E7%88%AC%E6%A5%BC%E6%A2%AF%E7%9A%84%E6%9C%80%E5%B0%91%E6%88%90%E6%9C%AC/"/>
    <id>http://yoursite.com/2021/12/16/å‰‘æŒ‡ Offer II 088. çˆ¬æ¥¼æ¢¯çš„æœ€å°‘æˆæœ¬/</id>
    <published>2021-12-16T08:12:12.000Z</published>
    <updated>2021-12-16T08:25:41.154Z</updated>
    
    <content type="html"><![CDATA[<p>æ•°ç»„çš„æ¯ä¸ªä¸‹æ ‡ä½œä¸ºä¸€ä¸ªé˜¶æ¢¯ï¼Œç¬¬ i ä¸ªé˜¶æ¢¯å¯¹åº”ç€ä¸€ä¸ªéè´Ÿæ•°çš„ä½“åŠ›èŠ±è´¹å€¼ cost[i]ï¼ˆä¸‹æ ‡ä» 0 å¼€å§‹ï¼‰ã€‚</p><p>æ¯å½“ä½ çˆ¬ä¸Šä¸€ä¸ªé˜¶æ¢¯ä½ éƒ½è¦èŠ±è´¹å¯¹åº”çš„ä½“åŠ›å€¼ï¼Œä¸€æ—¦æ”¯ä»˜äº†ç›¸åº”çš„ä½“åŠ›å€¼ï¼Œä½ å°±å¯ä»¥é€‰æ‹©å‘ä¸Šçˆ¬ä¸€ä¸ªé˜¶æ¢¯æˆ–è€…çˆ¬ä¸¤ä¸ªé˜¶æ¢¯ã€‚</p><p>è¯·ä½ æ‰¾å‡ºè¾¾åˆ°æ¥¼å±‚é¡¶éƒ¨çš„æœ€ä½èŠ±è´¹ã€‚åœ¨å¼€å§‹æ—¶ï¼Œä½ å¯ä»¥é€‰æ‹©ä»ä¸‹æ ‡ä¸º 0 æˆ– 1 çš„å…ƒç´ ä½œä¸ºåˆå§‹é˜¶æ¢¯ã€‚</p><a id="more"></a><p>[TOC]</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼šcost = [10, 15, 20]è¾“å‡ºï¼š15è§£é‡Šï¼šæœ€ä½èŠ±è´¹æ˜¯ä» cost[1] å¼€å§‹ï¼Œç„¶åèµ°ä¸¤æ­¥å³å¯åˆ°é˜¶æ¢¯é¡¶ï¼Œä¸€å…±èŠ±è´¹ 15 ã€‚</code></pre><p> ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼šcost = [1, 100, 1, 1, 1, 100, 1, 1, 100, 1]è¾“å‡ºï¼š6è§£é‡Šï¼šæœ€ä½èŠ±è´¹æ–¹å¼æ˜¯ä» cost[0] å¼€å§‹ï¼Œé€ä¸ªç»è¿‡é‚£äº› 1 ï¼Œè·³è¿‡ cost[3] ï¼Œä¸€å…±èŠ±è´¹ 6 ã€‚</code></pre><p>æç¤ºï¼š</p><pre><code>cost çš„é•¿åº¦èŒƒå›´æ˜¯ [2, 1000]ã€‚cost[i] å°†ä¼šæ˜¯ä¸€ä¸ªæ•´å‹æ•°æ®ï¼ŒèŒƒå›´ä¸º [0, 999] ã€‚</code></pre><p>æ³¨æ„ï¼šæœ¬é¢˜ä¸<a href="https://leetcode-cn.com/problems/min-cost-climbing-stairs/" target="_blank" rel="noopener">746. ä½¿ç”¨æœ€å°èŠ±è´¹çˆ¬æ¥¼æ¢¯</a>ç›¸åŒï¼š </p><h1 id="æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’-1"><a href="#æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’-1" class="headerlink" title="æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’^1"></a>æ–¹æ³•ä¸€ï¼šåŠ¨æ€è§„åˆ’<a href="https://leetcode-cn.com/problems/min-cost-climbing-stairs/solution/shi-yong-zui-xiao-hua-fei-pa-lou-ti-by-l-ncf8/" target="_blank" rel="noopener">^1</a></h1><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[sol1-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(<span class="keyword">int</span>[] cost)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = cost.length;</span><br><span class="line">        <span class="keyword">int</span>[] dp = <span class="keyword">new</span> <span class="keyword">int</span>[n + <span class="number">1</span>];</span><br><span class="line">        dp[<span class="number">0</span>] = dp[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            dp[i] = Math.min(dp[i - <span class="number">1</span>] + cost[i - <span class="number">1</span>], dp[i - <span class="number">2</span>] + cost[i - <span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>C#</summary><figure class="highlight plain"><figcaption><span>[sol1-C#]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">public class Solution &#123;</span><br><span class="line">    public int MinCostClimbingStairs(int[] cost) &#123;</span><br><span class="line">        int n = cost.Length;</span><br><span class="line">        int[] dp = new int[n + 1];</span><br><span class="line">        dp[0] = dp[1] = 0;</span><br><span class="line">        for (int i = 2; i &lt;= n; i++) &#123;</span><br><span class="line">            dp[i] = Math.Min(dp[i - 1] + cost[i - 1], dp[i - 2] + cost[i - 2]);</span><br><span class="line">        &#125;</span><br><span class="line">        return dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>JavaScript</summary><figure class="highlight javascript"><figcaption><span>[sol1-JavaScript]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> minCostClimbingStairs = <span class="function"><span class="keyword">function</span>(<span class="params">cost</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> n = cost.length;</span><br><span class="line">    <span class="keyword">const</span> dp = <span class="keyword">new</span> <span class="built_in">Array</span>(n + <span class="number">1</span>);</span><br><span class="line">    dp[<span class="number">0</span>] = dp[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        dp[i] = <span class="built_in">Math</span>.min(dp[i - <span class="number">1</span>] + cost[i - <span class="number">1</span>], dp[i - <span class="number">2</span>] + cost[i - <span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[n];</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>C++</summary><figure class="highlight c++"><figcaption><span>[sol1-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; cost)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = cost.size();</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; dp(n + <span class="number">1</span>);</span><br><span class="line">        dp[<span class="number">0</span>] = dp[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            dp[i] = min(dp[i - <span class="number">1</span>] + cost[i - <span class="number">1</span>], dp[i - <span class="number">2</span>] + cost[i - <span class="number">2</span>]);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> dp[n];</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>Golang</summary><figure class="highlight go"><figcaption><span>[sol1-Golang]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">minCostClimbingStairs</span><span class="params">(cost []<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    n := <span class="built_in">len</span>(cost)</span><br><span class="line">    dp := <span class="built_in">make</span>([]<span class="keyword">int</span>, n+<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">2</span>; i &lt;= n; i++ &#123;</span><br><span class="line">        dp[i] = min(dp[i<span class="number">-1</span>]+cost[i<span class="number">-1</span>], dp[i<span class="number">-2</span>]+cost[i<span class="number">-2</span>])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[n]</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">min</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> a &lt; b &#123;</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>Python3</summary><figure class="highlight python"><figcaption><span>[sol1-Python3]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minCostClimbingStairs</span><span class="params">(self, cost: List[int])</span> -&gt; int:</span></span><br><span class="line">        n = len(cost)</span><br><span class="line">        dp = [<span class="number">0</span>] * (n + <span class="number">1</span>)</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, n + <span class="number">1</span>):</span><br><span class="line">            dp[i] = min(dp[i - <span class="number">1</span>] + cost[i - <span class="number">1</span>], dp[i - <span class="number">2</span>] + cost[i - <span class="number">2</span>])</span><br><span class="line">        <span class="keyword">return</span> dp[n]</span><br></pre></td></tr></table></figure></details><details>    <summary>C</summary><figure class="highlight c"><figcaption><span>[sol1-C]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(<span class="keyword">int</span>* cost, <span class="keyword">int</span> costSize)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> dp[costSize + <span class="number">1</span>];</span><br><span class="line">    dp[<span class="number">0</span>] = dp[<span class="number">1</span>] = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= costSize; i++) &#123;</span><br><span class="line">        dp[i] = fmin(dp[i - <span class="number">1</span>] + cost[i - <span class="number">1</span>], dp[i - <span class="number">2</span>] + cost[i - <span class="number">2</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> dp[costSize];</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><p>ä¸Šè¿°ä»£ç çš„æ—¶é—´å¤æ‚åº¦å’Œç©ºé—´å¤æ‚åº¦éƒ½æ˜¯ <em>O(n)</em> ã€‚å¯ä»¥ä½¿ç”¨æ»šåŠ¨æ•°ç»„çš„æ€æƒ³ï¼Œå°†ç©ºé—´å¤æ‚åº¦ä¼˜åŒ–åˆ° <em>O(1)</em>ã€‚</p><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[sol2-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(<span class="keyword">int</span>[] cost)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = cost.length;</span><br><span class="line">        <span class="keyword">int</span> prev = <span class="number">0</span>, curr = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> next = Math.min(curr + cost[i - <span class="number">1</span>], prev + cost[i - <span class="number">2</span>]);</span><br><span class="line">            prev = curr;</span><br><span class="line">            curr = next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> curr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>JavaScript</summary><figure class="highlight javascript"><figcaption><span>[sol2-JavaScript]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> minCostClimbingStairs = <span class="function"><span class="keyword">function</span>(<span class="params">cost</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> n = cost.length;</span><br><span class="line">    <span class="keyword">let</span> prev = <span class="number">0</span>, curr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">        <span class="keyword">let</span> next = <span class="built_in">Math</span>.min(curr + cost[i - <span class="number">1</span>], prev + cost[i - <span class="number">2</span>]);</span><br><span class="line">        prev = curr;</span><br><span class="line">        curr = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> curr;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>C++</summary><figure class="highlight c++"><figcaption><span>[sol2-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; cost)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">int</span> n = cost.size();</span><br><span class="line">        <span class="keyword">int</span> prev = <span class="number">0</span>, curr = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= n; i++) &#123;</span><br><span class="line">            <span class="keyword">int</span> next = min(curr + cost[i - <span class="number">1</span>], prev + cost[i - <span class="number">2</span>]);</span><br><span class="line">            prev = curr;</span><br><span class="line">            curr = next;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> curr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>C#</summary><figure class="highlight plain"><figcaption><span>[sol2-C#]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public class Solution &#123;</span><br><span class="line">    public int MinCostClimbingStairs(int[] cost) &#123;</span><br><span class="line">        int n = cost.Length;</span><br><span class="line">        int prev = 0, curr = 0;</span><br><span class="line">        for (int i = 2; i &lt;= n; i++) &#123;</span><br><span class="line">            int next = Math.Min(curr + cost[i - 1], prev + cost[i - 2]);</span><br><span class="line">            prev = curr;</span><br><span class="line">            curr = next;</span><br><span class="line">        &#125;</span><br><span class="line">        return curr;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>Golang</summary><figure class="highlight go"><figcaption><span>[sol2-Golang]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">minCostClimbingStairs</span><span class="params">(cost []<span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    n := <span class="built_in">len</span>(cost)</span><br><span class="line">    pre, cur := <span class="number">0</span>, <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> i := <span class="number">2</span>; i &lt;= n; i++ &#123;</span><br><span class="line">        pre, cur = cur, min(cur+cost[i<span class="number">-1</span>], pre+cost[i<span class="number">-2</span>])</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> cur</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">min</span><span class="params">(a, b <span class="keyword">int</span>)</span> <span class="title">int</span></span> &#123;</span><br><span class="line">    <span class="keyword">if</span> a &lt; b &#123;</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> b</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>Python3</summary><figure class="highlight python"><figcaption><span>[sol2-Python3]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">minCostClimbingStairs</span><span class="params">(self, cost: List[int])</span> -&gt; int:</span></span><br><span class="line">        n = len(cost)</span><br><span class="line">        prev = curr = <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, n + <span class="number">1</span>):</span><br><span class="line">            nxt = min(curr + cost[i - <span class="number">1</span>], prev + cost[i - <span class="number">2</span>])</span><br><span class="line">            prev, curr = curr, nxt</span><br><span class="line">        <span class="keyword">return</span> curr</span><br></pre></td></tr></table></figure></details><details>    <summary>C</summary><figure class="highlight c"><figcaption><span>[sol2-C]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">int</span> <span class="title">minCostClimbingStairs</span><span class="params">(<span class="keyword">int</span>* cost, <span class="keyword">int</span> costSize)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> prev = <span class="number">0</span>, curr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = <span class="number">2</span>; i &lt;= costSize; i++) &#123;</span><br><span class="line">        <span class="keyword">int</span> next = fmin(curr + cost[i - <span class="number">1</span>], prev + cost[i - <span class="number">2</span>]);</span><br><span class="line">        prev = curr;</span><br><span class="line">        curr = next;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> curr;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><p><strong>å¤æ‚åº¦åˆ†æ</strong></p><ul><li><p>æ—¶é—´å¤æ‚åº¦ï¼š<em>O(n)*ï¼Œå…¶ä¸­ *n</em> æ˜¯æ•°ç»„cost çš„é•¿åº¦ã€‚éœ€è¦ä¾æ¬¡è®¡ç®—æ¯ä¸ªdp å€¼ï¼Œæ¯ä¸ªå€¼çš„è®¡ç®—éœ€è¦å¸¸æ•°æ—¶é—´ï¼Œå› æ­¤æ€»æ—¶é—´å¤æ‚åº¦æ˜¯ <em>O(n)</em>ã€‚</p></li><li><p>ç©ºé—´å¤æ‚åº¦ï¼š<em>O(1)</em>ã€‚ä½¿ç”¨æ»šåŠ¨æ•°ç»„çš„æ€æƒ³ï¼Œåªéœ€è¦ä½¿ç”¨æœ‰é™çš„é¢å¤–ç©ºé—´ã€‚</p></li></ul>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;æ•°ç»„çš„æ¯ä¸ªä¸‹æ ‡ä½œä¸ºä¸€ä¸ªé˜¶æ¢¯ï¼Œç¬¬ i ä¸ªé˜¶æ¢¯å¯¹åº”ç€ä¸€ä¸ªéè´Ÿæ•°çš„ä½“åŠ›èŠ±è´¹å€¼ cost[i]ï¼ˆä¸‹æ ‡ä» 0 å¼€å§‹ï¼‰ã€‚&lt;/p&gt;
&lt;p&gt;æ¯å½“ä½ çˆ¬ä¸Šä¸€ä¸ªé˜¶æ¢¯ä½ éƒ½è¦èŠ±è´¹å¯¹åº”çš„ä½“åŠ›å€¼ï¼Œä¸€æ—¦æ”¯ä»˜äº†ç›¸åº”çš„ä½“åŠ›å€¼ï¼Œä½ å°±å¯ä»¥é€‰æ‹©å‘ä¸Šçˆ¬ä¸€ä¸ªé˜¶æ¢¯æˆ–è€…çˆ¬ä¸¤ä¸ªé˜¶æ¢¯ã€‚&lt;/p&gt;
&lt;p&gt;è¯·ä½ æ‰¾å‡ºè¾¾åˆ°æ¥¼å±‚é¡¶éƒ¨çš„æœ€ä½èŠ±è´¹ã€‚åœ¨å¼€å§‹æ—¶ï¼Œä½ å¯ä»¥é€‰æ‹©ä»ä¸‹æ ‡ä¸º 0 æˆ– 1 çš„å…ƒç´ ä½œä¸ºåˆå§‹é˜¶æ¢¯ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="Array" scheme="http://yoursite.com/tags/Array/"/>
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
  </entry>
  
  <entry>
    <title>70. çˆ¬æ¥¼æ¢¯</title>
    <link href="http://yoursite.com/2021/12/16/70.%20%E7%88%AC%E6%A5%BC%E6%A2%AF/"/>
    <id>http://yoursite.com/2021/12/16/70. çˆ¬æ¥¼æ¢¯/</id>
    <published>2021-12-16T07:12:12.000Z</published>
    <updated>2021-12-16T07:30:09.737Z</updated>
    
    <content type="html"><![CDATA[<p>å‡è®¾ä½ æ­£åœ¨çˆ¬æ¥¼æ¢¯ã€‚éœ€è¦ n é˜¶ä½ æ‰èƒ½åˆ°è¾¾æ¥¼é¡¶ã€‚</p><p>æ¯æ¬¡ä½ å¯ä»¥çˆ¬ 1 æˆ– 2 ä¸ªå°é˜¶ã€‚ä½ æœ‰å¤šå°‘ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥çˆ¬åˆ°æ¥¼é¡¶å‘¢ï¼Ÿ</p><a id="more"></a><p>[TOC]</p><p>æ³¨æ„ï¼šç»™å®š n æ˜¯ä¸€ä¸ªæ­£æ•´æ•°ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼š 2è¾“å‡ºï¼š 2è§£é‡Šï¼š æœ‰ä¸¤ç§æ–¹æ³•å¯ä»¥çˆ¬åˆ°æ¥¼é¡¶ã€‚1.  1 é˜¶ + 1 é˜¶2.  2 é˜¶</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼š 3è¾“å‡ºï¼š 3è§£é‡Šï¼š æœ‰ä¸‰ç§æ–¹æ³•å¯ä»¥çˆ¬åˆ°æ¥¼é¡¶ã€‚1.  1 é˜¶ + 1 é˜¶ + 1 é˜¶2.  1 é˜¶ + 2 é˜¶3.  2 é˜¶ + 1 é˜¶</code></pre><p>å…·ä½“è§£æ³•å’Œæ–æ³¢é‚£å¥‘æ•°åˆ—ä¸€æ ·ï¼ŒåŠ¨æ€è§„åˆ’ï¼ŒçŸ©é˜µå¿«é€Ÿå¹‚å’Œé½æ¬¡çº¿æ€§é€’æ¨æ–¹ç¨‹å–é€šè§£ã€‚æœ¬æ¥å·²ç»è¿™æ ·å°±ç©åˆ°æè‡´äº†<a href="https://leetcode-cn.com/problems/climbing-stairs/solution/pa-lou-ti-by-leetcode-solution/" target="_blank" rel="noopener">^1</a>ï¼Œæ²¡æƒ³åˆ°è¿˜æœ‰å·ä¸­å·ï¼Œè¯„è®ºé‡Œæœ‰äººæåˆ°å­—èŠ‚é¢è¯•è¿˜ä¼šä¿®æ”¹æ¡ä»¶ï¼Œè¿™æ ·å°±åˆä¸ºä¹‹ä¸€å˜ã€‚</p><h1 id="åŠ å…¥æ–°çš„é™åˆ¶æ¡ä»¶ï¼šä¸èƒ½è¿ç»­è·³ä¸¤ä¸ªå°é˜¶ã€‚"><a href="#åŠ å…¥æ–°çš„é™åˆ¶æ¡ä»¶ï¼šä¸èƒ½è¿ç»­è·³ä¸¤ä¸ªå°é˜¶ã€‚" class="headerlink" title="åŠ å…¥æ–°çš„é™åˆ¶æ¡ä»¶ï¼šä¸èƒ½è¿ç»­è·³ä¸¤ä¸ªå°é˜¶ã€‚"></a>åŠ å…¥æ–°çš„é™åˆ¶æ¡ä»¶ï¼šä¸èƒ½è¿ç»­è·³ä¸¤ä¸ªå°é˜¶ã€‚</h1><p> 1ã€æ¯æ¬¡ä½ å¯ä»¥çˆ¬ 1 æˆ– 2 ä¸ªå°é˜¶ã€‚</p><p> 2ã€ä¸èƒ½è¿ç»­è·³ä¸¤ä¸ªå°é˜¶ã€‚ï¼ˆä¸ªäººç†è§£ä¸ºè¿™æ¬¡è·³äº†ä¸¤ä¸ªå°é˜¶ï¼Œä¸‹æ¬¡ä¸èƒ½å†è·³ä¸¤ä¸ªå°é˜¶ï¼‰</p><p> å‡è®¾ï¼š</p><pre><code>f(x) è¡¨ç¤ºçˆ¬åˆ°ç¬¬ x çº§å°é˜¶çš„æ–¹æ¡ˆæ•°ï¼Œ g(x, 1) è¡¨ç¤ºçˆ¬åˆ°ç¬¬ x çº§å°é˜¶å¹¶ä¸”æœ€åä¸€æ­¥åªè·¨è¶Šä¸€ä¸ªå°é˜¶çš„æ–¹æ¡ˆæ•°ï¼Œ g(x, 2) è¡¨ç¤ºçˆ¬åˆ°ç¬¬ x çº§å°é˜¶å¹¶ä¸”æœ€åä¸€æ­¥è·¨è¶Šäº†ä¸¤ä¸ªå°é˜¶çš„æ–¹æ¡ˆæ•°ã€‚ç”± ï¼šf(x) = g(x, 1)+g(x,2)ï¼Œ g(x, 1) = f(x-1)ï¼Œ g(x, 2) = g(x-2, 1) // æœ€åä¸€æ­¥è·¨è¶Šäº†ä¸¤æ­¥ï¼Œé‚£ä¹ˆä¸Šä¸€æ­¥åªèƒ½è·¨è¶Šä¸€æ­¥å¾—ï¼šf(x) = g(x, 1) + g(x, 2)       = f(x-1) + g(x-2, 1)       = f(x-1) + f((x-2)-1)      = f(x-1) + f(x-3)</code></pre><p>é¢˜ç›®é‡Œâ€œä¸èƒ½è¿ç»­è·³ä¸¤ä¸ªå°é˜¶â€ï¼Œå³ä¸€æ—¦è·³äº†ä¸¤ä¸ªå°é˜¶ï¼Œåˆ™ä¸‹ä¸€æ­¥åªèƒ½è·³ä¸€æ­¥ï¼ˆ2-&gt;1ï¼‰ï¼ŒæŠŠå®ƒä»¬è¿åœ¨ä¸€èµ·å°±ä¸€å…±è·³äº†ä¸‰ä¸ªå°é˜¶ï¼Œæ‰€ä»¥é—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºè¦ä¹ˆè·³ä¸€ä¸ªå°é˜¶ï¼Œè¦ä¹ˆè·³ä¸‰ä¸ªå°é˜¶ï¼ˆå½“ç„¶è¿˜æ˜¯æœ‰ç‚¹åŒºåˆ«çš„ï¼Œåªä¸è¿‡å› ä¸ºç»“æœæ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å¯ä»¥è¿™ä¹ˆè½¬åŒ–ï¼‰ï¼Œäºæ˜¯å°±æœ‰äº† f(x) = f(x-1) + f(x-3)</p><pre><code>public int climbStarts2(int n) {        if(n == 1) return 1; // é˜²æ­¢æ•°ç»„æº¢å‡ºï¼ˆf[2]ï¼‰        int[] f = new int[n+1];        f[0] = 1;        f[1] = 1;        f[2] = 2;        for(int i = 3; i &lt;= n; i++) {            f[i] = f[i-1] + f[i-3];        }        return f[n];    }</code></pre><p>ç»“åˆæ‰§è¡Œæ ‘ä¼šæ›´å¿«ç†è§£ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line">                         6</span><br><span class="line">                   /            \</span><br><span class="line">                  5              4</span><br><span class="line">             /        \         /</span><br><span class="line">            4          3       3</span><br><span class="line">        /       \     /      /   \</span><br><span class="line">       3         2   2      2     1</span><br><span class="line">     /  \       /   / \    / \   /</span><br><span class="line">    2    1     1   1   0  1   0 0</span><br><span class="line">   / \   /    /   /      /</span><br><span class="line">  1   0 0    0   0      0</span><br><span class="line"> /</span><br><span class="line">0</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ª n = 6 æ—¶ç»˜åˆ¶çš„ä¸€ä¸ªå¸¦æƒäºŒå‰æ ‘ï¼Œå…¶ä¸­å·¦èŠ‚ç‚¹ä¸ºæƒ 1ï¼Œå³èŠ‚ç‚¹ä¸ºæƒ 2ï¼Œå¾ˆæ˜æ˜¾ï¼Œé—®é¢˜çš„è§£ä¸ºæ ‘çš„éç©ºå¶èŠ‚ç‚¹ä¸ªæ•°ã€‚</p><p>æ ¹èŠ‚ç‚¹ä¸º f(x)<br>æ ¹èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹ä¸º g(x, 1)ï¼Œåˆä¸º f(x - 1)ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªåŒç±»å‹çš„å­é—®é¢˜<br>æ ¹èŠ‚ç‚¹çš„å³èŠ‚ç‚¹ä¸º g(x, 2)<br>è€Œçœ‹èŠ‚ç‚¹ g(x, 2)ï¼Œå…¶ä¸åŒ…å«éç©ºå³èŠ‚ç‚¹ï¼Œå³å®ƒçš„è§£ç­‰åŒäºå®ƒçš„å·¦èŠ‚ç‚¹çš„è§£ï¼Œå†å°†å…¶ç›¸å¯¹äºæ ¹èŠ‚ç‚¹ï¼Œå¯ä»¥æ˜æ˜¾çœ‹å‡ºå…¶ä¸º f(x - 3)</p><p>æœ€ç»ˆç»“æœä¾¿ä¸ºï¼šf(x) = f(x - 1) + f(x - 3)</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;å‡è®¾ä½ æ­£åœ¨çˆ¬æ¥¼æ¢¯ã€‚éœ€è¦ n é˜¶ä½ æ‰èƒ½åˆ°è¾¾æ¥¼é¡¶ã€‚&lt;/p&gt;
&lt;p&gt;æ¯æ¬¡ä½ å¯ä»¥çˆ¬ 1 æˆ– 2 ä¸ªå°é˜¶ã€‚ä½ æœ‰å¤šå°‘ç§ä¸åŒçš„æ–¹æ³•å¯ä»¥çˆ¬åˆ°æ¥¼é¡¶å‘¢ï¼Ÿ&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="Math" scheme="http://yoursite.com/tags/Math/"/>
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
      <category term="Recursion" scheme="http://yoursite.com/tags/Recursion/"/>
    
      <category term="Memoization" scheme="http://yoursite.com/tags/Memoization/"/>
    
  </entry>
  
  <entry>
    <title>å‰‘æŒ‡ Offer 10- II. é’è›™è·³å°é˜¶é—®é¢˜</title>
    <link href="http://yoursite.com/2021/12/16/%E5%89%91%E6%8C%87%20Offer%2010-%20II.%20%E9%9D%92%E8%9B%99%E8%B7%B3%E5%8F%B0%E9%98%B6%E9%97%AE%E9%A2%98/"/>
    <id>http://yoursite.com/2021/12/16/å‰‘æŒ‡ Offer 10- II. é’è›™è·³å°é˜¶é—®é¢˜/</id>
    <published>2021-12-16T07:12:12.000Z</published>
    <updated>2021-12-16T07:30:03.599Z</updated>
    
    <content type="html"><![CDATA[<p>ä¸€åªé’è›™ä¸€æ¬¡å¯ä»¥è·³ä¸Š1çº§å°é˜¶ï¼Œä¹Ÿå¯ä»¥è·³ä¸Š2çº§å°é˜¶ã€‚æ±‚è¯¥é’è›™è·³ä¸Šä¸€ä¸ª n çº§çš„å°é˜¶æ€»å…±æœ‰å¤šå°‘ç§è·³æ³•ã€‚</p><a id="more"></a><p>[TOC]</p><p>ç­”æ¡ˆéœ€è¦å–æ¨¡ 1e9+7ï¼ˆ1000000007ï¼‰ï¼Œå¦‚è®¡ç®—åˆå§‹ç»“æœä¸ºï¼š1000000008ï¼Œè¯·è¿”å› 1ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼šn = 2è¾“å‡ºï¼š2</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥ï¼šn = 7è¾“å‡ºï¼š21</code></pre><p>ç¤ºä¾‹ 3ï¼š</p><pre><code>è¾“å…¥ï¼šn = 0è¾“å‡ºï¼š1</code></pre><p>æç¤ºï¼š</p><p>0 &lt;= n &lt;= 100</p><p>æ³¨æ„ï¼šæœ¬é¢˜ä¸<a href="https://leetcode-cn.com/problems/climbing-stairs/" target="_blank" rel="noopener">70. çˆ¬æ¥¼æ¢¯</a>ç›¸åŒ</p><p>å…·ä½“è§£æ³•å’Œæ–æ³¢é‚£å¥‘æ•°åˆ—ä¸€æ ·ï¼ŒåŠ¨æ€è§„åˆ’ï¼ŒçŸ©é˜µå¿«é€Ÿå¹‚å’Œé½æ¬¡çº¿æ€§é€’æ¨æ–¹ç¨‹å–é€šè§£ã€‚æœ¬æ¥å·²ç»è¿™æ ·å°±ç©åˆ°æè‡´äº†<a href="https://leetcode-cn.com/problems/climbing-stairs/solution/pa-lou-ti-by-leetcode-solution/" target="_blank" rel="noopener">^1</a>ï¼Œæ²¡æƒ³åˆ°è¿˜æœ‰å·ä¸­å·ï¼Œè¯„è®ºé‡Œæœ‰äººæåˆ°å­—èŠ‚é¢è¯•è¿˜ä¼šä¿®æ”¹æ¡ä»¶ï¼Œè¿™æ ·å°±åˆä¸ºä¹‹ä¸€å˜ã€‚</p><h1 id="åŠ å…¥æ–°çš„é™åˆ¶æ¡ä»¶ï¼šä¸èƒ½è¿ç»­è·³ä¸¤ä¸ªå°é˜¶ã€‚"><a href="#åŠ å…¥æ–°çš„é™åˆ¶æ¡ä»¶ï¼šä¸èƒ½è¿ç»­è·³ä¸¤ä¸ªå°é˜¶ã€‚" class="headerlink" title="åŠ å…¥æ–°çš„é™åˆ¶æ¡ä»¶ï¼šä¸èƒ½è¿ç»­è·³ä¸¤ä¸ªå°é˜¶ã€‚"></a>åŠ å…¥æ–°çš„é™åˆ¶æ¡ä»¶ï¼šä¸èƒ½è¿ç»­è·³ä¸¤ä¸ªå°é˜¶ã€‚</h1><p> 1ã€æ¯æ¬¡ä½ å¯ä»¥çˆ¬ 1 æˆ– 2 ä¸ªå°é˜¶ã€‚</p><p> 2ã€ä¸èƒ½è¿ç»­è·³ä¸¤ä¸ªå°é˜¶ã€‚ï¼ˆä¸ªäººç†è§£ä¸ºè¿™æ¬¡è·³äº†ä¸¤ä¸ªå°é˜¶ï¼Œä¸‹æ¬¡ä¸èƒ½å†è·³ä¸¤ä¸ªå°é˜¶ï¼‰</p><p> å‡è®¾ï¼š</p><pre><code>f(x) è¡¨ç¤ºçˆ¬åˆ°ç¬¬ x çº§å°é˜¶çš„æ–¹æ¡ˆæ•°ï¼Œ g(x, 1) è¡¨ç¤ºçˆ¬åˆ°ç¬¬ x çº§å°é˜¶å¹¶ä¸”æœ€åä¸€æ­¥åªè·¨è¶Šä¸€ä¸ªå°é˜¶çš„æ–¹æ¡ˆæ•°ï¼Œ g(x, 2) è¡¨ç¤ºçˆ¬åˆ°ç¬¬ x çº§å°é˜¶å¹¶ä¸”æœ€åä¸€æ­¥è·¨è¶Šäº†ä¸¤ä¸ªå°é˜¶çš„æ–¹æ¡ˆæ•°ã€‚ç”± ï¼šf(x) = g(x, 1)+g(x,2)ï¼Œ g(x, 1) = f(x-1)ï¼Œ g(x, 2) = g(x-2, 1) // æœ€åä¸€æ­¥è·¨è¶Šäº†ä¸¤æ­¥ï¼Œé‚£ä¹ˆä¸Šä¸€æ­¥åªèƒ½è·¨è¶Šä¸€æ­¥å¾—ï¼šf(x) = g(x, 1) + g(x, 2)       = f(x-1) + g(x-2, 1)       = f(x-1) + f((x-2)-1)      = f(x-1) + f(x-3)</code></pre><p>é¢˜ç›®é‡Œâ€œä¸èƒ½è¿ç»­è·³ä¸¤ä¸ªå°é˜¶â€ï¼Œå³ä¸€æ—¦è·³äº†ä¸¤ä¸ªå°é˜¶ï¼Œåˆ™ä¸‹ä¸€æ­¥åªèƒ½è·³ä¸€æ­¥ï¼ˆ2-&gt;1ï¼‰ï¼ŒæŠŠå®ƒä»¬è¿åœ¨ä¸€èµ·å°±ä¸€å…±è·³äº†ä¸‰ä¸ªå°é˜¶ï¼Œæ‰€ä»¥é—®é¢˜å¯ä»¥è½¬åŒ–ä¸ºè¦ä¹ˆè·³ä¸€ä¸ªå°é˜¶ï¼Œè¦ä¹ˆè·³ä¸‰ä¸ªå°é˜¶ï¼ˆå½“ç„¶è¿˜æ˜¯æœ‰ç‚¹åŒºåˆ«çš„ï¼Œåªä¸è¿‡å› ä¸ºç»“æœæ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥å¯ä»¥è¿™ä¹ˆè½¬åŒ–ï¼‰ï¼Œäºæ˜¯å°±æœ‰äº† f(x) = f(x-1) + f(x-3)</p><pre><code>public int climbStarts2(int n) {        if(n == 1) return 1; // é˜²æ­¢æ•°ç»„æº¢å‡ºï¼ˆf[2]ï¼‰        int[] f = new int[n+1];        f[0] = 1;        f[1] = 1;        f[2] = 2;        for(int i = 3; i &lt;= n; i++) {            f[i] = f[i-1] + f[i-3];        }        return f[n];    }</code></pre><p>ç»“åˆæ‰§è¡Œæ ‘ä¼šæ›´å¿«ç†è§£ï¼š</p><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">    </span><br><span class="line">                         6</span><br><span class="line">                   /            \</span><br><span class="line">                  5              4</span><br><span class="line">             /        \         /</span><br><span class="line">            4          3       3</span><br><span class="line">        /       \     /      /   \</span><br><span class="line">       3         2   2      2     1</span><br><span class="line">     /  \       /   / \    / \   /</span><br><span class="line">    2    1     1   1   0  1   0 0</span><br><span class="line">   / \   /    /   /      /</span><br><span class="line">  1   0 0    0   0      0</span><br><span class="line"> /</span><br><span class="line">0</span><br></pre></td></tr></table></figure><p>è¿™æ˜¯ä¸€ä¸ª n = 6 æ—¶ç»˜åˆ¶çš„ä¸€ä¸ªå¸¦æƒäºŒå‰æ ‘ï¼Œå…¶ä¸­å·¦èŠ‚ç‚¹ä¸ºæƒ 1ï¼Œå³èŠ‚ç‚¹ä¸ºæƒ 2ï¼Œå¾ˆæ˜æ˜¾ï¼Œé—®é¢˜çš„è§£ä¸ºæ ‘çš„éç©ºå¶èŠ‚ç‚¹ä¸ªæ•°ã€‚</p><p>æ ¹èŠ‚ç‚¹ä¸º f(x)<br>æ ¹èŠ‚ç‚¹çš„å·¦èŠ‚ç‚¹ä¸º g(x, 1)ï¼Œåˆä¸º f(x - 1)ï¼Œå› ä¸ºå®ƒæ˜¯ä¸€ä¸ªåŒç±»å‹çš„å­é—®é¢˜<br>æ ¹èŠ‚ç‚¹çš„å³èŠ‚ç‚¹ä¸º g(x, 2)<br>è€Œçœ‹èŠ‚ç‚¹ g(x, 2)ï¼Œå…¶ä¸åŒ…å«éç©ºå³èŠ‚ç‚¹ï¼Œå³å®ƒçš„è§£ç­‰åŒäºå®ƒçš„å·¦èŠ‚ç‚¹çš„è§£ï¼Œå†å°†å…¶ç›¸å¯¹äºæ ¹èŠ‚ç‚¹ï¼Œå¯ä»¥æ˜æ˜¾çœ‹å‡ºå…¶ä¸º f(x - 3)</p><p>æœ€ç»ˆç»“æœä¾¿ä¸ºï¼šf(x) = f(x - 1) + f(x - 3)</p>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;ä¸€åªé’è›™ä¸€æ¬¡å¯ä»¥è·³ä¸Š1çº§å°é˜¶ï¼Œä¹Ÿå¯ä»¥è·³ä¸Š2çº§å°é˜¶ã€‚æ±‚è¯¥é’è›™è·³ä¸Šä¸€ä¸ª n çº§çš„å°é˜¶æ€»å…±æœ‰å¤šå°‘ç§è·³æ³•ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="Math" scheme="http://yoursite.com/tags/Math/"/>
    
      <category term="Dynamic Programming" scheme="http://yoursite.com/tags/Dynamic-Programming/"/>
    
      <category term="Recursion" scheme="http://yoursite.com/tags/Recursion/"/>
    
      <category term="Memoization" scheme="http://yoursite.com/tags/Memoization/"/>
    
  </entry>
  
  <entry>
    <title>1414. å’Œä¸º K çš„æœ€å°‘æ–æ³¢é‚£å¥‘æ•°å­—æ•°ç›®</title>
    <link href="http://yoursite.com/2021/12/15/842.%20%E5%B0%86%E6%95%B0%E7%BB%84%E6%8B%86%E5%88%86%E6%88%90%E6%96%90%E6%B3%A2%E9%82%A3%E5%A5%91%E5%BA%8F%E5%88%97/"/>
    <id>http://yoursite.com/2021/12/15/842. å°†æ•°ç»„æ‹†åˆ†æˆæ–æ³¢é‚£å¥‘åºåˆ—/</id>
    <published>2021-12-15T13:30:12.000Z</published>
    <updated>2021-12-15T14:42:44.038Z</updated>
    
    <content type="html"><![CDATA[<p>è¿”å›ä» S æ‹†åˆ†å‡ºæ¥çš„ä»»æ„ä¸€ç»„æ–æ³¢é‚£å¥‘å¼çš„åºåˆ—å—ï¼Œå¦‚æœä¸èƒ½æ‹†åˆ†åˆ™è¿”å› []ã€‚</p><a id="more"></a><p>[TOC]</p><p>ç»™å®šä¸€ä¸ªæ•°å­—å­—ç¬¦ä¸² Sï¼Œæ¯”å¦‚ S = â€œ123456579â€ï¼Œæˆ‘ä»¬å¯ä»¥å°†å®ƒåˆ†æˆæ–æ³¢é‚£å¥‘å¼çš„åºåˆ— [123, 456, 579]ã€‚</p><p>å½¢å¼ä¸Šï¼Œæ–æ³¢é‚£å¥‘å¼åºåˆ—æ˜¯ä¸€ä¸ªéè´Ÿæ•´æ•°åˆ—è¡¨ Fï¼Œä¸”æ»¡è¶³ï¼š</p><p>0 &lt;= F[i] &lt;= 2^31 - 1ï¼Œï¼ˆä¹Ÿå°±æ˜¯è¯´ï¼Œæ¯ä¸ªæ•´æ•°éƒ½ç¬¦åˆ 32 ä½æœ‰ç¬¦å·æ•´æ•°ç±»å‹ï¼‰ï¼›<br>F.length &gt;= 3ï¼›<br>å¯¹äºæ‰€æœ‰çš„0 &lt;= i &lt; F.length - 2ï¼Œéƒ½æœ‰ F[i] + F[i+1] = F[i+2] æˆç«‹ã€‚<br>å¦å¤–ï¼Œè¯·æ³¨æ„ï¼Œå°†å­—ç¬¦ä¸²æ‹†åˆ†æˆå°å—æ—¶ï¼Œæ¯ä¸ªå—çš„æ•°å­—ä¸€å®šä¸è¦ä»¥é›¶å¼€å¤´ï¼Œé™¤éè¿™ä¸ªå—æ˜¯æ•°å­— 0 æœ¬èº«ã€‚</p><p>è¿”å›ä» S æ‹†åˆ†å‡ºæ¥çš„ä»»æ„ä¸€ç»„æ–æ³¢é‚£å¥‘å¼çš„åºåˆ—å—ï¼Œå¦‚æœä¸èƒ½æ‹†åˆ†åˆ™è¿”å› []ã€‚</p><p>ç¤ºä¾‹ 1ï¼š</p><pre><code>è¾“å…¥ï¼š&quot;123456579&quot;è¾“å‡ºï¼š[123,456,579]</code></pre><p>ç¤ºä¾‹ 2ï¼š</p><pre><code>è¾“å…¥: &quot;11235813&quot;è¾“å‡º: [1,1,2,3,5,8,13]</code></pre><p>ç¤ºä¾‹ 3ï¼š</p><pre><code>è¾“å…¥: &quot;112358130&quot;è¾“å‡º: []è§£é‡Š: è¿™é¡¹ä»»åŠ¡æ— æ³•å®Œæˆã€‚</code></pre><p>ç¤ºä¾‹ 4ï¼š</p><pre><code>è¾“å…¥ï¼š&quot;0123&quot;è¾“å‡ºï¼š[]è§£é‡Šï¼šæ¯ä¸ªå—çš„æ•°å­—ä¸èƒ½ä»¥é›¶å¼€å¤´ï¼Œå› æ­¤ &quot;01&quot;ï¼Œ&quot;2&quot;ï¼Œ&quot;3&quot; ä¸æ˜¯æœ‰æ•ˆç­”æ¡ˆã€‚</code></pre><p>ç¤ºä¾‹ 5ï¼š</p><pre><code>è¾“å…¥: &quot;1101111&quot;è¾“å‡º: [110, 1, 111]è§£é‡Š: è¾“å‡º [11,0,11,11] ä¹ŸåŒæ ·è¢«æ¥å—ã€‚</code></pre><p>æç¤ºï¼š</p><pre><code>1 &lt;= S.length &lt;= 200å­—ç¬¦ä¸² S ä¸­åªå«æœ‰æ•°å­—ã€‚</code></pre><h1 id="å›æº¯æ³•æ¨¡æ¿-1"><a href="#å›æº¯æ³•æ¨¡æ¿-1" class="headerlink" title="å›æº¯æ³•æ¨¡æ¿^1"></a>å›æº¯æ³•æ¨¡æ¿<a href="https://leetcode-cn.com/problems/split-array-into-fibonacci-sequence/solution/javahui-su-suan-fa-tu-wen-xiang-jie-ji-b-vg5z/" target="_blank" rel="noopener">^1</a></h1><details>    <summary>å›æº¯æ³•æ¨¡æ¿</summary><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">private void backtrack(&quot;åŸå§‹å‚æ•°&quot;) &#123;</span><br><span class="line">    //ç»ˆæ­¢æ¡ä»¶(é€’å½’å¿…é¡»è¦æœ‰ç»ˆæ­¢æ¡ä»¶)</span><br><span class="line">    if (&quot;ç»ˆæ­¢æ¡ä»¶&quot;) &#123;</span><br><span class="line">        //ä¸€äº›é€»è¾‘æ“ä½œï¼ˆå¯æœ‰å¯æ— ï¼Œè§†æƒ…å†µè€Œå®šï¼‰</span><br><span class="line">        return;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    for (int i = &quot;forå¾ªç¯å¼€å§‹çš„å‚æ•°&quot;; i &lt; &quot;forå¾ªç¯ç»“æŸçš„å‚æ•°&quot;; i++) &#123;</span><br><span class="line">        //ä¸€äº›é€»è¾‘æ“ä½œï¼ˆå¯æœ‰å¯æ— ï¼Œè§†æƒ…å†µè€Œå®šï¼‰</span><br><span class="line"></span><br><span class="line">        //åšå‡ºé€‰æ‹©</span><br><span class="line"></span><br><span class="line">        //é€’å½’</span><br><span class="line">        backtrack(&quot;æ–°çš„å‚æ•°&quot;);</span><br><span class="line">        //ä¸€äº›é€»è¾‘æ“ä½œï¼ˆå¯æœ‰å¯æ— ï¼Œè§†æƒ…å†µè€Œå®šï¼‰</span><br><span class="line"></span><br><span class="line">        //æ’¤é”€é€‰æ‹©</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><h1 id="æ–¹æ³•ä¸€ï¼šå›æº¯-å‰ªæ-2"><a href="#æ–¹æ³•ä¸€ï¼šå›æº¯-å‰ªæ-2" class="headerlink" title="æ–¹æ³•ä¸€ï¼šå›æº¯ + å‰ªæ^2"></a>æ–¹æ³•ä¸€ï¼šå›æº¯ + å‰ªæ<a href="https://leetcode-cn.com/problems/split-array-into-fibonacci-sequence/solution/jiang-shu-zu-chai-fen-cheng-fei-bo-na-qi-ts6c/" target="_blank" rel="noopener">^2</a></h1><p>å°†ç»™å®šçš„å­—ç¬¦ä¸²æ‹†åˆ†æˆæ–æ³¢é‚£å¥‘å¼åºåˆ—ï¼Œå¯ä»¥é€šè¿‡å›æº¯çš„æ–¹æ³•å®ç°ã€‚</p><p>ä½¿ç”¨åˆ—è¡¨å­˜å‚¨æ‹†åˆ†å‡ºçš„æ•°ï¼Œå›æº¯è¿‡ç¨‹ä¸­ç»´æŠ¤è¯¥åˆ—è¡¨çš„å…ƒç´ ï¼Œåˆ—è¡¨åˆå§‹ä¸ºç©ºã€‚éå†å­—ç¬¦ä¸²çš„æ‰€æœ‰å¯èƒ½çš„å‰ç¼€ï¼Œä½œä¸ºå½“å‰è¢«æ‹†åˆ†å‡ºçš„æ•°ï¼Œç„¶åå¯¹å‰©ä½™éƒ¨åˆ†ç»§ç»­æ‹†åˆ†ï¼Œç›´åˆ°æ•´ä¸ªå­—ç¬¦ä¸²æ‹†åˆ†å®Œæ¯•ã€‚</p><p>æ ¹æ®æ–æ³¢é‚£å¥‘å¼åºåˆ—çš„è¦æ±‚ï¼Œä»ç¬¬ <em>3</em> ä¸ªæ•°å¼€å§‹ï¼Œæ¯ä¸ªæ•°éƒ½ç­‰äºå‰ <em>2</em> ä¸ªæ•°çš„å’Œï¼Œå› æ­¤ä»ç¬¬ <em>3</em> ä¸ªæ•°å¼€å§‹ï¼Œéœ€è¦åˆ¤æ–­æ‹†åˆ†å‡ºçš„æ•°æ˜¯å¦ç­‰äºå‰ <em>2</em> ä¸ªæ•°çš„å’Œï¼Œåªæœ‰æ»¡è¶³è¦æ±‚æ—¶æ‰è¿›è¡Œæ‹†åˆ†ï¼Œå¦åˆ™ä¸è¿›è¡Œæ‹†åˆ†ã€‚</p><p>å›æº¯è¿‡ç¨‹ä¸­ï¼Œè¿˜æœ‰ä¸‰å¤„å¯ä»¥è¿›è¡Œå‰ªææ“ä½œã€‚</p><ul><li><p>æ‹†åˆ†å‡ºçš„æ•°å¦‚æœä¸æ˜¯ <em>0</em>ï¼Œåˆ™ä¸èƒ½ä»¥ <em>0</em> å¼€å¤´ï¼Œå› æ­¤å¦‚æœå­—ç¬¦ä¸²å‰©ä¸‹çš„éƒ¨åˆ†ä»¥ <em>0</em> å¼€å¤´ï¼Œå°±ä¸éœ€è¦è€ƒè™‘æ‹†åˆ†å‡ºé•¿åº¦å¤§äº <em>1</em> çš„æ•°ï¼Œå› ä¸ºé•¿åº¦å¤§äº <em>1</em> çš„æ•°ä»¥ <em>0</em> å¼€å¤´æ˜¯ä¸ç¬¦åˆè¦æ±‚çš„ï¼Œä¸å¯èƒ½ç»§ç»­æ‹†åˆ†å¾—åˆ°æ–æ³¢é‚£å¥‘å¼åºåˆ—ï¼›</p></li><li><p>æ‹†åˆ†å‡ºçš„æ•°å¿…é¡»ç¬¦åˆ <em>32</em> ä½æœ‰ç¬¦å·æ•´æ•°ç±»å‹ï¼Œå³æ¯ä¸ªæ•°å¿…é¡»åœ¨ <em>[0,2^{31}-1]</em> çš„èŒƒå›´å†…ï¼Œå¦‚æœæ‹†åˆ†å‡ºçš„æ•°å¤§äº <em>2^{31}-1</em>ï¼Œåˆ™ä¸ç¬¦åˆè¦æ±‚ï¼Œé•¿åº¦æ›´å¤§çš„æ•°çš„æ•°å€¼ä¹Ÿä¸€å®šæ›´å¤§ï¼Œä¸€å®šä¹Ÿå¤§äº <em>2^{31}-1</em>ï¼Œå› æ­¤ä¸å¯èƒ½ç»§ç»­æ‹†åˆ†å¾—åˆ°æ–æ³¢é‚£å¥‘å¼åºåˆ—ï¼›</p></li><li><p>å¦‚æœåˆ—è¡¨ä¸­è‡³å°‘æœ‰ <em>2</em> ä¸ªæ•°ï¼Œå¹¶ä¸”æ‹†åˆ†å‡ºçš„æ•°å·²ç»å¤§äºæœ€å <em>2</em> ä¸ªæ•°çš„å’Œï¼Œå°±ä¸éœ€è¦ç»§ç»­å°è¯•æ‹†åˆ†äº†ã€‚</p></li></ul><p>å½“æ•´ä¸ªå­—ç¬¦ä¸²æ‹†åˆ†å®Œæ¯•æ—¶ï¼Œå¦‚æœåˆ—è¡¨ä¸­è‡³å°‘æœ‰ <em>3</em> ä¸ªæ•°ï¼Œåˆ™å¾—åˆ°ä¸€ä¸ªç¬¦åˆè¦æ±‚çš„æ–æ³¢é‚£å¥‘å¼åºåˆ—ï¼Œè¿”å›åˆ—è¡¨ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°ç¬¦åˆè¦æ±‚çš„æ–æ³¢é‚£å¥‘å¼åºåˆ—ï¼Œåˆ™è¿”å›ç©ºåˆ—è¡¨ã€‚</p><p>å®ç°æ–¹é¢ï¼Œå›æº¯éœ€è¦å¸¦è¿”å›å€¼ï¼Œè¡¨ç¤ºæ˜¯å¦å­˜åœ¨ç¬¦åˆè¦æ±‚çš„æ–æ³¢é‚£å¥‘å¼åºåˆ—ã€‚</p><p>ä½†æ˜¯ä»£ç éƒ¨åˆ†å®ç°çš„è¿‡äºç¹çï¼Œç®€æ´ç‰ˆå¯ä»¥å‚è§<a href="https://leetcode-cn.com/problems/split-array-into-fibonacci-sequence/solution/javahui-su-suan-fa-tu-wen-xiang-jie-ji-b-vg5z/" target="_blank" rel="noopener">^1</a></p><details>    <summary>Java</summary><figure class="highlight java"><figcaption><span>[sol1-Java]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> List&lt;Integer&gt; <span class="title">splitIntoFibonacci</span><span class="params">(String S)</span> </span>&#123;</span><br><span class="line">    List&lt;Integer&gt; res = <span class="keyword">new</span> ArrayList&lt;&gt;();</span><br><span class="line">    backtrack(S.toCharArray(), res, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">boolean</span> <span class="title">backtrack</span><span class="params">(<span class="keyword">char</span>[] digit, List&lt;Integer&gt; res, <span class="keyword">int</span> index)</span> </span>&#123;</span><br><span class="line">    <span class="comment">//è¾¹ç•Œæ¡ä»¶åˆ¤æ–­ï¼Œå¦‚æœæˆªå–å®Œäº†ï¼Œå¹¶ä¸”resé•¿åº¦å¤§äºç­‰äº3ï¼Œè¡¨ç¤ºæ‰¾åˆ°äº†ä¸€ä¸ªç»„åˆã€‚</span></span><br><span class="line">    <span class="keyword">if</span> (index == digit.length &amp;&amp; res.size() &gt;= <span class="number">3</span>) &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = index; i &lt; digit.length; i++) &#123;</span><br><span class="line">        <span class="comment">//ä¸¤ä½ä»¥ä¸Šçš„æ•°å­—ä¸èƒ½ä»¥0å¼€å¤´</span></span><br><span class="line">        <span class="keyword">if</span> (digit[index] == <span class="string">'0'</span> &amp;&amp; i &gt; index) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="comment">//æˆªå–å­—ç¬¦ä¸²è½¬åŒ–ä¸ºæ•°å­—</span></span><br><span class="line">        <span class="keyword">long</span> num = subDigit(digit, index, i + <span class="number">1</span>);</span><br><span class="line">        <span class="comment">//å¦‚æœæˆªå–çš„æ•°å­—å¤§äºintçš„æœ€å¤§å€¼ï¼Œåˆ™ç»ˆæ­¢æˆªå–</span></span><br><span class="line">        <span class="keyword">if</span> (num &gt; Integer.MAX_VALUE) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">int</span> size = res.size();</span><br><span class="line">        <span class="comment">//å¦‚æœæˆªå–çš„æ•°å­—å¤§äºresä¸­å‰ä¸¤ä¸ªæ•°å­—çš„å’Œï¼Œè¯´æ˜è¿™æ¬¡æˆªå–çš„å¤ªå¤§ï¼Œç›´æ¥ç»ˆæ­¢ï¼Œå› ä¸ºåé¢è¶Šæˆªå–è¶Šå¤§</span></span><br><span class="line">        <span class="keyword">if</span> (size &gt;= <span class="number">2</span> &amp;&amp; num &gt; res.get(size - <span class="number">1</span>) + res.get(size - <span class="number">2</span>)) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (size &lt;= <span class="number">1</span> || num == res.get(size - <span class="number">1</span>) + res.get(size - <span class="number">2</span>)) &#123;</span><br><span class="line">            <span class="comment">//æŠŠæ•°å­—numæ·»åŠ åˆ°é›†åˆresä¸­</span></span><br><span class="line">            res.add((<span class="keyword">int</span>) num);</span><br><span class="line">            <span class="comment">//å¦‚æœæ‰¾åˆ°äº†å°±ç›´æ¥è¿”å›</span></span><br><span class="line">            <span class="keyword">if</span> (backtrack(digit, res, i + <span class="number">1</span>))</span><br><span class="line">                <span class="keyword">return</span> <span class="keyword">true</span>;</span><br><span class="line">            <span class="comment">//å¦‚æœæ²¡æ‰¾åˆ°ï¼Œå°±ä¼šèµ°å›æº¯è¿™ä¸€æ­¥ï¼Œç„¶åæŠŠä¸Šä¸€æ­¥æ·»åŠ åˆ°é›†åˆresä¸­çš„æ•°å­—ç»™ç§»é™¤æ‰</span></span><br><span class="line">            res.remove(res.size() - <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="keyword">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//ç›¸å½“äºæˆªå–å­—ç¬¦ä¸²Sä¸­çš„å­ä¸²ç„¶åè½¬æ¢ä¸ºåè¿›åˆ¶æ•°å­—</span></span><br><span class="line"><span class="function"><span class="keyword">private</span> <span class="keyword">long</span> <span class="title">subDigit</span><span class="params">(<span class="keyword">char</span>[] digit, <span class="keyword">int</span> start, <span class="keyword">int</span> end)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">long</span> res = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = start; i &lt; end; i++) &#123;</span><br><span class="line">        res = res * <span class="number">10</span> + digit[i] - <span class="string">'0'</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> res;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>C++</summary><figure class="highlight c++"><figcaption><span>[sol1-C++]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span> &#123;</span></span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; splitIntoFibonacci(<span class="built_in">string</span> num) &#123;</span><br><span class="line">        <span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt; <span class="built_in">list</span>;</span><br><span class="line">        backtrack(<span class="built_in">list</span>, num, num.length(), <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">list</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">bool</span> <span class="title">backtrack</span><span class="params">(<span class="built_in">vector</span>&lt;<span class="keyword">int</span>&gt;&amp; <span class="built_in">list</span>, <span class="built_in">string</span> num, <span class="keyword">int</span> length, <span class="keyword">int</span> index, <span class="keyword">long</span> <span class="keyword">long</span> sum, <span class="keyword">int</span> prev)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">if</span> (index == length) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">list</span>.size() &gt;= <span class="number">3</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">long</span> <span class="keyword">long</span> curr = <span class="number">0</span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="keyword">int</span> i = index; i &lt; length; i++) &#123;</span><br><span class="line">            <span class="keyword">if</span> (i &gt; index &amp;&amp; num[index] == <span class="string">'0'</span>) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            curr = curr * <span class="number">10</span> + num[i] - <span class="string">'0'</span>;</span><br><span class="line">            <span class="keyword">if</span> (curr &gt; INT_MAX) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">if</span> (<span class="built_in">list</span>.size() &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">                <span class="keyword">if</span> (curr &lt; sum) &#123;</span><br><span class="line">                    <span class="keyword">continue</span>;</span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">else</span> <span class="keyword">if</span> (curr &gt; sum) &#123;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">list</span>.push_back(curr);</span><br><span class="line">            <span class="keyword">if</span> (backtrack(<span class="built_in">list</span>, num, length, i + <span class="number">1</span>, prev + curr, curr)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="built_in">list</span>.pop_back();</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure></details><details>    <summary>JavaScript</summary><figure class="highlight javascript"><figcaption><span>[sol1-JavaScript]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> splitIntoFibonacci = <span class="function"><span class="keyword">function</span>(<span class="params">num</span>) </span>&#123;</span><br><span class="line">    <span class="keyword">const</span> list = <span class="keyword">new</span> <span class="built_in">Array</span>().fill(<span class="number">0</span>);</span><br><span class="line">    backtrack(list, num, num.length, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> list;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> backtrack = <span class="function">(<span class="params">list, num, length, index, sum, prev</span>) =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (index === length) &#123;</span><br><span class="line">        <span class="keyword">return</span> list.length &gt;= <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> currLong = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">let</span> i = index; i &lt; length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; index &amp;&amp; num[index] === <span class="string">'0'</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        currLong = currLong * <span class="number">10</span> + num[i].charCodeAt() - <span class="string">'0'</span>.charCodeAt();</span><br><span class="line">        <span class="keyword">if</span> (currLong &gt; <span class="built_in">Math</span>.pow(<span class="number">2</span>, <span class="number">31</span>) - <span class="number">1</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">let</span> curr = currLong;</span><br><span class="line">        <span class="keyword">if</span> (list.length &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (curr &lt; sum) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (curr &gt; sum) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        list.push(curr);</span><br><span class="line">        <span class="keyword">if</span> (backtrack(list, num, length, i + <span class="number">1</span>, prev + curr, curr)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            list.splice(list.length - <span class="number">1</span>, <span class="number">1</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>Python3</summary><figure class="highlight python"><figcaption><span>[sol1-Python3]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Solution</span>:</span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">splitIntoFibonacci</span><span class="params">(self, num: str)</span> -&gt; List[int]:</span></span><br><span class="line">        ans = list()</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">def</span> <span class="title">backtrack</span><span class="params">(index: int)</span>:</span></span><br><span class="line">            <span class="keyword">if</span> index == len(num):</span><br><span class="line">                <span class="keyword">return</span> len(ans) &gt;= <span class="number">3</span></span><br><span class="line">            </span><br><span class="line">            curr = <span class="number">0</span></span><br><span class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(index, len(num)):</span><br><span class="line">                <span class="keyword">if</span> i &gt; index <span class="keyword">and</span> num[index] == <span class="string">"0"</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                curr = curr * <span class="number">10</span> + ord(num[i]) - ord(<span class="string">"0"</span>)</span><br><span class="line">                <span class="keyword">if</span> curr &gt; <span class="number">2</span>**<span class="number">31</span> - <span class="number">1</span>:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                </span><br><span class="line">                <span class="keyword">if</span> len(ans) &lt; <span class="number">2</span> <span class="keyword">or</span> curr == ans[<span class="number">-2</span>] + ans[<span class="number">-1</span>]:</span><br><span class="line">                    ans.append(curr)</span><br><span class="line">                    <span class="keyword">if</span> backtrack(i + <span class="number">1</span>):</span><br><span class="line">                        <span class="keyword">return</span> <span class="keyword">True</span></span><br><span class="line">                    ans.pop()</span><br><span class="line">                <span class="keyword">elif</span> len(ans) &gt; <span class="number">2</span> <span class="keyword">and</span> curr &gt; ans[<span class="number">-2</span>] + ans[<span class="number">-1</span>]:</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">        </span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">False</span></span><br><span class="line">        </span><br><span class="line">        backtrack(<span class="number">0</span>)</span><br><span class="line">        <span class="keyword">return</span> ans</span><br></pre></td></tr></table></figure></details><details>    <summary>Golang</summary><figure class="highlight golang"><figcaption><span>[sol1-Golang]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">splitIntoFibonacci</span><span class="params">(num <span class="keyword">string</span>)</span> <span class="params">(F []<span class="keyword">int</span>)</span></span> &#123;</span><br><span class="line">    n := <span class="built_in">len</span>(num)</span><br><span class="line">    <span class="keyword">var</span> backtrack <span class="function"><span class="keyword">func</span><span class="params">(index, sum, prev <span class="keyword">int</span>)</span> <span class="title">bool</span></span></span><br><span class="line"><span class="function">    <span class="title">backtrack</span> = <span class="title">func</span><span class="params">(index, sum, prev <span class="keyword">int</span>)</span> <span class="title">bool</span></span> &#123;</span><br><span class="line">        <span class="keyword">if</span> index == n &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">len</span>(F) &gt;= <span class="number">3</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        cur := <span class="number">0</span></span><br><span class="line">        <span class="keyword">for</span> i := index; i &lt; n; i++ &#123;</span><br><span class="line">            <span class="comment">// æ¯ä¸ªå—çš„æ•°å­—ä¸€å®šä¸è¦ä»¥é›¶å¼€å¤´ï¼Œé™¤éè¿™ä¸ªå—æ˜¯æ•°å­— 0 æœ¬èº«</span></span><br><span class="line">            <span class="keyword">if</span> i &gt; index &amp;&amp; num[index] == <span class="string">'0'</span> &#123;</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            cur = cur*<span class="number">10</span> + <span class="keyword">int</span>(num[i]-<span class="string">'0'</span>)</span><br><span class="line">            <span class="comment">// æ‹†å‡ºçš„æ•´æ•°è¦ç¬¦åˆ 32 ä½æœ‰ç¬¦å·æ•´æ•°ç±»å‹</span></span><br><span class="line">            <span class="keyword">if</span> cur &gt; math.MaxInt32 &#123;</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// F[i] + F[i+1] = F[i+2]</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">len</span>(F) &gt;= <span class="number">2</span> &#123;</span><br><span class="line">                <span class="keyword">if</span> cur &lt; sum &#123;</span><br><span class="line">                    <span class="keyword">continue</span></span><br><span class="line">                &#125;</span><br><span class="line">                <span class="keyword">if</span> cur &gt; sum &#123;</span><br><span class="line">                    <span class="keyword">break</span></span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// cur ç¬¦åˆè¦æ±‚ï¼ŒåŠ å…¥åºåˆ— F</span></span><br><span class="line">            F = <span class="built_in">append</span>(F, cur)</span><br><span class="line">            <span class="keyword">if</span> backtrack(i+<span class="number">1</span>, prev+cur, cur) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span></span><br><span class="line">            &#125;</span><br><span class="line">            F = F[:<span class="built_in">len</span>(F)<span class="number">-1</span>]</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">false</span></span><br><span class="line">    &#125;</span><br><span class="line">    backtrack(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    <span class="keyword">return</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details><details>    <summary>C</summary><figure class="highlight c"><figcaption><span>[sol1-C]</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">bool</span> <span class="title">backtrack</span><span class="params">(<span class="keyword">int</span>* <span class="built_in">list</span>, <span class="keyword">int</span>* listSize, <span class="keyword">char</span>* num, <span class="keyword">int</span> length, <span class="keyword">int</span> index, <span class="keyword">long</span> <span class="keyword">long</span> sum, <span class="keyword">int</span> prev)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (index == length) &#123;</span><br><span class="line">        <span class="keyword">return</span> (*listSize) &gt;= <span class="number">3</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">long</span> <span class="keyword">long</span> curr = <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">for</span> (<span class="keyword">int</span> i = index; i &lt; length; i++) &#123;</span><br><span class="line">        <span class="keyword">if</span> (i &gt; index &amp;&amp; num[index] == <span class="string">'0'</span>) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        curr = curr * <span class="number">10</span> + num[i] - <span class="string">'0'</span>;</span><br><span class="line">        <span class="keyword">if</span> (curr &gt; INT_MAX) &#123;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> ((*listSize) &gt;= <span class="number">2</span>) &#123;</span><br><span class="line">            <span class="keyword">if</span> (curr &lt; sum) &#123;</span><br><span class="line">                <span class="keyword">continue</span>;</span><br><span class="line">            &#125; <span class="keyword">else</span> <span class="keyword">if</span> (curr &gt; sum) &#123;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">list</span>[(*listSize)++] = curr;</span><br><span class="line">        <span class="keyword">if</span> (backtrack(<span class="built_in">list</span>, listSize, num, length, i + <span class="number">1</span>, prev + curr, curr)) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        (*listSize)--;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">int</span>* <span class="title">splitIntoFibonacci</span><span class="params">(<span class="keyword">char</span>* num, <span class="keyword">int</span>* returnSize)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">int</span> n = <span class="built_in">strlen</span>(num);</span><br><span class="line">    <span class="keyword">int</span>* <span class="built_in">list</span> = <span class="built_in">malloc</span>(<span class="keyword">sizeof</span>(<span class="keyword">int</span>) * n);</span><br><span class="line">    *returnSize = <span class="number">0</span>;</span><br><span class="line">    backtrack(<span class="built_in">list</span>, returnSize, num, <span class="built_in">strlen</span>(num), <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">list</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></details>]]></content>
    
    <summary type="html">
    
      &lt;p&gt;è¿”å›ä» S æ‹†åˆ†å‡ºæ¥çš„ä»»æ„ä¸€ç»„æ–æ³¢é‚£å¥‘å¼çš„åºåˆ—å—ï¼Œå¦‚æœä¸èƒ½æ‹†åˆ†åˆ™è¿”å› []ã€‚&lt;/p&gt;
    
    </summary>
    
      <category term="2021å¹´12æœˆ" scheme="http://yoursite.com/categories/2021%E5%B9%B412%E6%9C%88/"/>
    
    
      <category term="LeetCode" scheme="http://yoursite.com/tags/LeetCode/"/>
    
      <category term="String" scheme="http://yoursite.com/tags/String/"/>
    
      <category term="Backtracking" scheme="http://yoursite.com/tags/Backtracking/"/>
    
  </entry>
  
</feed>
